{"version":3,"sources":["useOverflowContainer.js"],"sourcesContent":["import * as React from 'react';\nimport { createOverflowManager } from '@fluentui/priority-overflow';\nimport { canUseDOM, useEventCallback, useFirstMount, useIsomorphicLayoutEffect } from '@fluentui/react-utilities';\nimport { DATA_OVERFLOWING, DATA_OVERFLOW_DIVIDER, DATA_OVERFLOW_ITEM, DATA_OVERFLOW_MENU } from './constants';\nconst noop = ()=>null;\n/**\n * @internal\n * @param update - Callback when overflow state changes\n * @param options - Options to configure the overflow container\n * @returns - ref to attach to an intrinsic HTML element and imperative functions\n */ export const useOverflowContainer = (update, options)=>{\n    const { overflowAxis = 'horizontal', overflowDirection = 'end', padding = 10, minimumVisible = 0, onUpdateItemVisibility = noop } = options;\n    const onUpdateOverflow = useEventCallback(update);\n    const overflowOptions = React.useMemo(()=>({\n            overflowAxis,\n            overflowDirection,\n            padding,\n            minimumVisible,\n            onUpdateItemVisibility,\n            onUpdateOverflow\n        }), [\n        minimumVisible,\n        onUpdateItemVisibility,\n        overflowAxis,\n        overflowDirection,\n        padding,\n        onUpdateOverflow\n    ]);\n    const firstMount = useFirstMount();\n    // DOM ref to the overflow container element\n    const containerRef = React.useRef(null);\n    const [overflowManager, setOverflowManager] = React.useState(()=>canUseDOM() ? createOverflowManager() : null);\n    // On first mount there is no need to create an overflow manager and re-render\n    useIsomorphicLayoutEffect(()=>{\n        if (firstMount && containerRef.current) {\n            overflowManager === null || overflowManager === void 0 ? void 0 : overflowManager.observe(containerRef.current, overflowOptions);\n        }\n    }, [\n        firstMount,\n        overflowManager,\n        overflowOptions\n    ]);\n    useIsomorphicLayoutEffect(()=>{\n        if (!containerRef.current || !canUseDOM() || firstMount) {\n            return;\n        }\n        const newOverflowManager = createOverflowManager();\n        newOverflowManager.observe(containerRef.current, overflowOptions);\n        setOverflowManager(newOverflowManager);\n    }, [\n        overflowOptions,\n        firstMount\n    ]);\n    /* Clean up overflow manager on unmount */ React.useEffect(()=>()=>{\n            overflowManager === null || overflowManager === void 0 ? void 0 : overflowManager.disconnect();\n        }, [\n        overflowManager\n    ]);\n    const registerItem = React.useCallback((item)=>{\n        overflowManager === null || overflowManager === void 0 ? void 0 : overflowManager.addItem(item);\n        item.element.setAttribute(DATA_OVERFLOW_ITEM, '');\n        return ()=>{\n            item.element.removeAttribute(DATA_OVERFLOWING);\n            item.element.removeAttribute(DATA_OVERFLOW_ITEM);\n            overflowManager === null || overflowManager === void 0 ? void 0 : overflowManager.removeItem(item.id);\n        };\n    }, [\n        overflowManager\n    ]);\n    const registerDivider = React.useCallback((divider)=>{\n        const el = divider.element;\n        overflowManager === null || overflowManager === void 0 ? void 0 : overflowManager.addDivider(divider);\n        el.setAttribute(DATA_OVERFLOW_DIVIDER, '');\n        return ()=>{\n            divider.groupId && (overflowManager === null || overflowManager === void 0 ? void 0 : overflowManager.removeDivider(divider.groupId));\n            el.removeAttribute(DATA_OVERFLOW_DIVIDER);\n        };\n    }, [\n        overflowManager\n    ]);\n    const registerOverflowMenu = React.useCallback((el)=>{\n        overflowManager === null || overflowManager === void 0 ? void 0 : overflowManager.addOverflowMenu(el);\n        el.setAttribute(DATA_OVERFLOW_MENU, '');\n        return ()=>{\n            overflowManager === null || overflowManager === void 0 ? void 0 : overflowManager.removeOverflowMenu();\n            el.removeAttribute(DATA_OVERFLOW_MENU);\n        };\n    }, [\n        overflowManager\n    ]);\n    const updateOverflow = React.useCallback(()=>{\n        overflowManager === null || overflowManager === void 0 ? void 0 : overflowManager.update();\n    }, [\n        overflowManager\n    ]);\n    return {\n        registerItem,\n        registerDivider,\n        registerOverflowMenu,\n        updateOverflow,\n        containerRef\n    };\n};\nexport const updateVisibilityAttribute = ({ item, visible })=>{\n    if (visible) {\n        item.element.removeAttribute(DATA_OVERFLOWING);\n    } else {\n        item.element.setAttribute(DATA_OVERFLOWING, '');\n    }\n};\n"],"names":["useOverflowContainer","updateVisibilityAttribute","noop","update","options","overflowAxis","overflowDirection","padding","minimumVisible","onUpdateItemVisibility","onUpdateOverflow","useEventCallback","overflowOptions","React","useMemo","firstMount","useFirstMount","containerRef","useRef","overflowManager","setOverflowManager","useState","canUseDOM","createOverflowManager","useIsomorphicLayoutEffect","current","observe","newOverflowManager","useEffect","disconnect","registerItem","useCallback","item","addItem","element","setAttribute","DATA_OVERFLOW_ITEM","removeAttribute","DATA_OVERFLOWING","removeItem","id","registerDivider","divider","el","addDivider","DATA_OVERFLOW_DIVIDER","groupId","removeDivider","registerOverflowMenu","addOverflowMenu","DATA_OVERFLOW_MENU","removeOverflowMenu","updateOverflow","visible"],"mappings":"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"}