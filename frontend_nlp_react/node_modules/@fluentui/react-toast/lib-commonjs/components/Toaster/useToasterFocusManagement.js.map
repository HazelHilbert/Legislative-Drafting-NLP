{"version":3,"sources":["useToasterFocusManagement.js"],"sourcesContent":["import { isHTMLElement } from '@fluentui/react-utilities';\nimport * as React from 'react';\nimport { useFluent_unstable as useFluent } from '@fluentui/react-shared-contexts';\nimport { ArrowDown, ArrowUp } from '@fluentui/keyboard-keys';\nimport { toastContainerClassNames } from '../ToastContainer';\nconst noop = ()=>undefined;\n/**\n * @internal\n */ export function useToasterFocusManagement_unstable(pauseAllToasts, playAllToasts) {\n    const { targetDocument } = useFluent();\n    const cleanupListenersRef = React.useRef(noop);\n    return React.useCallback((el)=>{\n        if (!el || !targetDocument) {\n            cleanupListenersRef.current();\n            cleanupListenersRef.current = noop;\n            return;\n        }\n        const toastContainerWalker = targetDocument.createTreeWalker(el, NodeFilter.SHOW_ELEMENT, {\n            acceptNode (node) {\n                if (isHTMLElement(node) && node.classList.contains(toastContainerClassNames.root)) {\n                    return NodeFilter.FILTER_ACCEPT;\n                }\n                return NodeFilter.FILTER_SKIP;\n            }\n        });\n        /**\n       * FIXME: https://github.com/microsoft/tabster/issues/299\n       * Toasts  should be arrow navigable and focus should be trapped in a stack of tasts\n       * This is a temporary measure, Tabster does not have an API yet to enable mover arrow keys from within grouppers\n       * Once tabster fully supports this use case, remove this hook\n       */ const keydownListener = (e)=>{\n            const { target, key } = e;\n            if (!isHTMLElement(target)) {\n                return;\n            }\n            if (key === ArrowDown) {\n                toastContainerWalker.currentNode = target;\n                let nextToastContainer = toastContainerWalker.nextNode();\n                if (!nextToastContainer) {\n                    toastContainerWalker.currentNode = el;\n                    nextToastContainer = toastContainerWalker.nextNode();\n                }\n                if (isHTMLElement(nextToastContainer)) {\n                    nextToastContainer.focus();\n                }\n            }\n            if (key === ArrowUp) {\n                toastContainerWalker.currentNode = target;\n                let prevToastContainer = toastContainerWalker.previousNode();\n                if (prevToastContainer && prevToastContainer.contains(target)) {\n                    prevToastContainer = toastContainerWalker.previousNode();\n                }\n                if (!prevToastContainer) {\n                    toastContainerWalker.currentNode = el;\n                    prevToastContainer = toastContainerWalker.lastChild();\n                }\n                if (isHTMLElement(prevToastContainer)) {\n                    prevToastContainer.focus();\n                }\n            }\n        };\n        const focusInListener = (e)=>{\n            if (isHTMLElement(e.currentTarget) && !e.currentTarget.contains(isHTMLElement(e.relatedTarget) ? e.relatedTarget : null)) {\n                pauseAllToasts();\n            }\n        };\n        const focusOutListener = (e)=>{\n            if (isHTMLElement(e.currentTarget) && !e.currentTarget.contains(isHTMLElement(e.relatedTarget) ? e.relatedTarget : null)) {\n                playAllToasts();\n            }\n        };\n        el.addEventListener('keydown', keydownListener);\n        el.addEventListener('focusin', focusInListener);\n        el.addEventListener('focusout', focusOutListener);\n        cleanupListenersRef.current = ()=>{\n            el.removeEventListener('keydown', keydownListener);\n            el.removeEventListener('focusin', focusInListener);\n            el.removeEventListener('focusout', focusOutListener);\n        };\n    }, [\n        targetDocument,\n        pauseAllToasts,\n        playAllToasts\n    ]);\n}\n"],"names":["useToasterFocusManagement_unstable","noop","undefined","pauseAllToasts","playAllToasts","targetDocument","useFluent","cleanupListenersRef","React","useRef","useCallback","el","current","toastContainerWalker","createTreeWalker","NodeFilter","SHOW_ELEMENT","acceptNode","node","isHTMLElement","classList","contains","toastContainerClassNames","root","FILTER_ACCEPT","FILTER_SKIP","keydownListener","e","target","key","ArrowDown","currentNode","nextToastContainer","nextNode","focus","ArrowUp","prevToastContainer","previousNode","lastChild","focusInListener","currentTarget","relatedTarget","focusOutListener","addEventListener","removeEventListener"],"mappings":";;;;+BAQoBA;;;eAAAA;;;;gCARU;iEACP;qCACyB;8BACb;gCACM;AACzC,MAAMC,OAAO,IAAIC;AAGN,SAASF,mCAAmCG,cAAc,EAAEC,aAAa;IAChF,MAAM,EAAEC,cAAc,EAAE,GAAGC,IAAAA,uCAAS;IACpC,MAAMC,sBAAsBC,OAAMC,MAAM,CAACR;IACzC,OAAOO,OAAME,WAAW,CAAC,CAACC;QACtB,IAAI,CAACA,MAAM,CAACN,gBAAgB;YACxBE,oBAAoBK,OAAO;YAC3BL,oBAAoBK,OAAO,GAAGX;YAC9B;QACJ;QACA,MAAMY,uBAAuBR,eAAeS,gBAAgB,CAACH,IAAII,WAAWC,YAAY,EAAE;YACtFC,YAAYC,IAAI;gBACZ,IAAIC,IAAAA,6BAAa,EAACD,SAASA,KAAKE,SAAS,CAACC,QAAQ,CAACC,wCAAwB,CAACC,IAAI,GAAG;oBAC/E,OAAOR,WAAWS,aAAa;gBACnC;gBACA,OAAOT,WAAWU,WAAW;YACjC;QACJ;QACA;;;;;OAKD,GAAG,MAAMC,kBAAkB,CAACC;YACvB,MAAM,EAAEC,MAAM,EAAEC,GAAG,EAAE,GAAGF;YACxB,IAAI,CAACR,IAAAA,6BAAa,EAACS,SAAS;gBACxB;YACJ;YACA,IAAIC,QAAQC,uBAAS,EAAE;gBACnBjB,qBAAqBkB,WAAW,GAAGH;gBACnC,IAAII,qBAAqBnB,qBAAqBoB,QAAQ;gBACtD,IAAI,CAACD,oBAAoB;oBACrBnB,qBAAqBkB,WAAW,GAAGpB;oBACnCqB,qBAAqBnB,qBAAqBoB,QAAQ;gBACtD;gBACA,IAAId,IAAAA,6BAAa,EAACa,qBAAqB;oBACnCA,mBAAmBE,KAAK;gBAC5B;YACJ;YACA,IAAIL,QAAQM,qBAAO,EAAE;gBACjBtB,qBAAqBkB,WAAW,GAAGH;gBACnC,IAAIQ,qBAAqBvB,qBAAqBwB,YAAY;gBAC1D,IAAID,sBAAsBA,mBAAmBf,QAAQ,CAACO,SAAS;oBAC3DQ,qBAAqBvB,qBAAqBwB,YAAY;gBAC1D;gBACA,IAAI,CAACD,oBAAoB;oBACrBvB,qBAAqBkB,WAAW,GAAGpB;oBACnCyB,qBAAqBvB,qBAAqByB,SAAS;gBACvD;gBACA,IAAInB,IAAAA,6BAAa,EAACiB,qBAAqB;oBACnCA,mBAAmBF,KAAK;gBAC5B;YACJ;QACJ;QACA,MAAMK,kBAAkB,CAACZ;YACrB,IAAIR,IAAAA,6BAAa,EAACQ,EAAEa,aAAa,KAAK,CAACb,EAAEa,aAAa,CAACnB,QAAQ,CAACF,IAAAA,6BAAa,EAACQ,EAAEc,aAAa,IAAId,EAAEc,aAAa,GAAG,OAAO;gBACtHtC;YACJ;QACJ;QACA,MAAMuC,mBAAmB,CAACf;YACtB,IAAIR,IAAAA,6BAAa,EAACQ,EAAEa,aAAa,KAAK,CAACb,EAAEa,aAAa,CAACnB,QAAQ,CAACF,IAAAA,6BAAa,EAACQ,EAAEc,aAAa,IAAId,EAAEc,aAAa,GAAG,OAAO;gBACtHrC;YACJ;QACJ;QACAO,GAAGgC,gBAAgB,CAAC,WAAWjB;QAC/Bf,GAAGgC,gBAAgB,CAAC,WAAWJ;QAC/B5B,GAAGgC,gBAAgB,CAAC,YAAYD;QAChCnC,oBAAoBK,OAAO,GAAG;YAC1BD,GAAGiC,mBAAmB,CAAC,WAAWlB;YAClCf,GAAGiC,mBAAmB,CAAC,WAAWL;YAClC5B,GAAGiC,mBAAmB,CAAC,YAAYF;QACvC;IACJ,GAAG;QACCrC;QACAF;QACAC;KACH;AACL"}