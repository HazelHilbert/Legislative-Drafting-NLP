{"version":3,"sources":["useToastContainer.js"],"sourcesContent":["import * as React from 'react';\nimport { getIntrinsicElementProps, useMergedRefs, useEventCallback, useId, slot } from '@fluentui/react-utilities';\nimport { useFluent_unstable } from '@fluentui/react-shared-contexts';\nimport { Delete, Tab } from '@fluentui/keyboard-keys';\nimport { useFocusableGroup, useFocusFinders } from '@fluentui/react-tabster';\nimport { Timer } from '../Timer/Timer';\nconst intentPolitenessMap = {\n    success: 'assertive',\n    warning: 'assertive',\n    error: 'assertive',\n    info: 'polite'\n};\n/**\n * Create the state required to render ToastContainer.\n *\n * The returned state can be modified with hooks such as useToastContainerStyles_unstable,\n * before being passed to renderToastContainer_unstable.\n *\n * @param props - props from this instance of ToastContainer\n * @param ref - reference to root HTMLElement of ToastContainer\n */ export const useToastContainer_unstable = (props, ref)=>{\n    const { visible, children, close: closeProp, remove, updateId, announce, data, timeout: timerTimeout, politeness: desiredPoliteness, intent = 'info', pauseOnHover, pauseOnWindowBlur, imperativeRef, tryRestoreFocus, ...rest } = props;\n    const titleId = useId('toast-title');\n    const bodyId = useId('toast-body');\n    const toastRef = React.useRef(null);\n    const { targetDocument } = useFluent_unstable();\n    const [running, setRunning] = React.useState(false);\n    const imperativePauseRef = React.useRef(false);\n    const focusedToastBeforeClose = React.useRef(false);\n    const focusableGroupAttribute = useFocusableGroup({\n        tabBehavior: 'limited-trap-focus',\n        // Users should only use Tab to focus into the toast\n        // Escape is already reserved to dismiss all toasts\n        ignoreDefaultKeydown: {\n            Tab: true,\n            Escape: true,\n            Enter: true\n        }\n    });\n    const close = useEventCallback(()=>{\n        var _toastRef_current;\n        const activeElement = targetDocument === null || targetDocument === void 0 ? void 0 : targetDocument.activeElement;\n        if (activeElement && ((_toastRef_current = toastRef.current) === null || _toastRef_current === void 0 ? void 0 : _toastRef_current.contains(activeElement))) {\n            focusedToastBeforeClose.current = true;\n        }\n        closeProp();\n    });\n    const onStatusChange = useEventCallback((status)=>{\n        var _props_onStatusChange;\n        return (_props_onStatusChange = props.onStatusChange) === null || _props_onStatusChange === void 0 ? void 0 : _props_onStatusChange.call(props, null, {\n            status,\n            ...props\n        });\n    });\n    const pause = useEventCallback(()=>setRunning(false));\n    const play = useEventCallback(()=>{\n        var _toastRef_current;\n        if (imperativePauseRef.current) {\n            return;\n        }\n        var _targetDocument_activeElement;\n        const containsActive = !!((_toastRef_current = toastRef.current) === null || _toastRef_current === void 0 ? void 0 : _toastRef_current.contains((_targetDocument_activeElement = targetDocument === null || targetDocument === void 0 ? void 0 : targetDocument.activeElement) !== null && _targetDocument_activeElement !== void 0 ? _targetDocument_activeElement : null));\n        if (timerTimeout < 0) {\n            setRunning(true);\n            return;\n        }\n        if (!containsActive) {\n            setRunning(true);\n        }\n    });\n    React.useImperativeHandle(imperativeRef, ()=>({\n            focus: ()=>{\n                if (!toastRef.current) {\n                    return;\n                }\n                toastRef.current.focus();\n            },\n            play: ()=>{\n                imperativePauseRef.current = false;\n                play();\n            },\n            pause: ()=>{\n                imperativePauseRef.current = true;\n                pause();\n            }\n        }));\n    React.useEffect(()=>{\n        return ()=>onStatusChange('unmounted');\n    }, [\n        onStatusChange\n    ]);\n    React.useEffect(()=>{\n        if (!targetDocument) {\n            return;\n        }\n        if (pauseOnWindowBlur) {\n            var _targetDocument_defaultView, _targetDocument_defaultView1;\n            (_targetDocument_defaultView = targetDocument.defaultView) === null || _targetDocument_defaultView === void 0 ? void 0 : _targetDocument_defaultView.addEventListener('focus', play);\n            (_targetDocument_defaultView1 = targetDocument.defaultView) === null || _targetDocument_defaultView1 === void 0 ? void 0 : _targetDocument_defaultView1.addEventListener('blur', pause);\n            return ()=>{\n                var _targetDocument_defaultView, _targetDocument_defaultView1;\n                (_targetDocument_defaultView = targetDocument.defaultView) === null || _targetDocument_defaultView === void 0 ? void 0 : _targetDocument_defaultView.removeEventListener('focus', play);\n                (_targetDocument_defaultView1 = targetDocument.defaultView) === null || _targetDocument_defaultView1 === void 0 ? void 0 : _targetDocument_defaultView1.removeEventListener('blur', pause);\n            };\n        }\n    }, [\n        targetDocument,\n        pause,\n        play,\n        pauseOnWindowBlur\n    ]);\n    // It's impossible to animate to height: auto in CSS, the actual pixel value must be known\n    // Get the height of the toast before animation styles have been applied and set a CSS\n    // variable with its height. The CSS variable will be used by the styles\n    const onTransitionEntering = ()=>{\n        if (!toastRef.current) {\n            return;\n        }\n        const element = toastRef.current;\n        element.style.setProperty('--fui-toast-height', `${element.scrollHeight}px`);\n    };\n    // Users never actually use ToastContainer as a JSX but imperatively through useToastContainerController\n    const userRootSlot = data.root;\n    // Using a ref callback here because addEventListener supports `once`\n    const toastAnimationRef = React.useCallback((el)=>{\n        if (el && toastRef.current) {\n            toastRef.current.addEventListener('animationend', ()=>{\n                // start toast once it's fully animated in\n                play();\n                onStatusChange('visible');\n            }, {\n                once: true\n            });\n        }\n    }, [\n        play,\n        onStatusChange\n    ]);\n    const onMouseEnter = useEventCallback((e)=>{\n        var _userRootSlot_onMouseEnter;\n        pause();\n        userRootSlot === null || userRootSlot === void 0 ? void 0 : (_userRootSlot_onMouseEnter = userRootSlot.onMouseEnter) === null || _userRootSlot_onMouseEnter === void 0 ? void 0 : _userRootSlot_onMouseEnter.call(userRootSlot, e);\n    });\n    const onMouseLeave = useEventCallback((e)=>{\n        var _userRootSlot_onMouseEnter;\n        play();\n        userRootSlot === null || userRootSlot === void 0 ? void 0 : (_userRootSlot_onMouseEnter = userRootSlot.onMouseEnter) === null || _userRootSlot_onMouseEnter === void 0 ? void 0 : _userRootSlot_onMouseEnter.call(userRootSlot, e);\n    });\n    const { findFirstFocusable, findLastFocusable } = useFocusFinders();\n    const onKeyDown = useEventCallback((e)=>{\n        var _userRootSlot_onKeyDown;\n        if (e.key === Delete) {\n            e.preventDefault();\n            close();\n        }\n        if (e.key === Tab && e.currentTarget === e.target) {\n            e.preventDefault();\n            if (e.shiftKey) {\n                var _findLastFocusable;\n                (_findLastFocusable = findLastFocusable(e.currentTarget)) === null || _findLastFocusable === void 0 ? void 0 : _findLastFocusable.focus();\n            } else {\n                var _findFirstFocusable;\n                (_findFirstFocusable = findFirstFocusable(e.currentTarget)) === null || _findFirstFocusable === void 0 ? void 0 : _findFirstFocusable.focus();\n            }\n        }\n        userRootSlot === null || userRootSlot === void 0 ? void 0 : (_userRootSlot_onKeyDown = userRootSlot.onKeyDown) === null || _userRootSlot_onKeyDown === void 0 ? void 0 : _userRootSlot_onKeyDown.call(userRootSlot, e);\n    });\n    React.useEffect(()=>{\n        var _toastRef_current;\n        if (!visible) {\n            return;\n        }\n        const politeness = desiredPoliteness !== null && desiredPoliteness !== void 0 ? desiredPoliteness : intentPolitenessMap[intent];\n        var _toastRef_current_textContent;\n        announce((_toastRef_current_textContent = (_toastRef_current = toastRef.current) === null || _toastRef_current === void 0 ? void 0 : _toastRef_current.textContent) !== null && _toastRef_current_textContent !== void 0 ? _toastRef_current_textContent : '', {\n            politeness\n        });\n    }, [\n        announce,\n        desiredPoliteness,\n        toastRef,\n        visible,\n        updateId,\n        intent\n    ]);\n    React.useEffect(()=>{\n        return ()=>{\n            if (focusedToastBeforeClose.current) {\n                focusedToastBeforeClose.current = false;\n                tryRestoreFocus();\n            }\n        };\n    }, [\n        tryRestoreFocus\n    ]);\n    return {\n        components: {\n            timer: Timer,\n            root: 'div'\n        },\n        timer: slot.always({\n            key: updateId,\n            onTimeout: close,\n            running,\n            timeout: timerTimeout !== null && timerTimeout !== void 0 ? timerTimeout : -1\n        }, {\n            elementType: Timer\n        }),\n        root: slot.always(getIntrinsicElementProps('div', {\n            // FIXME:\n            // `ref` is wrongly assigned to be `HTMLElement` instead of `HTMLDivElement`\n            // but since it would be a breaking change to fix it, we are casting ref to it's proper type\n            ref: useMergedRefs(ref, toastRef, toastAnimationRef),\n            children,\n            tabIndex: 0,\n            role: 'listitem',\n            'aria-labelledby': titleId,\n            'aria-describedby': bodyId,\n            ...rest,\n            ...userRootSlot,\n            ...focusableGroupAttribute,\n            onMouseEnter,\n            onMouseLeave,\n            onKeyDown\n        }), {\n            elementType: 'div'\n        }),\n        timerTimeout,\n        transitionTimeout: 500,\n        running,\n        visible,\n        remove,\n        close,\n        onTransitionEntering,\n        updateId,\n        nodeRef: toastRef,\n        intent,\n        titleId,\n        bodyId\n    };\n};\n"],"names":["useToastContainer_unstable","intentPolitenessMap","success","warning","error","info","props","ref","visible","children","close","closeProp","remove","updateId","announce","data","timeout","timerTimeout","politeness","desiredPoliteness","intent","pauseOnHover","pauseOnWindowBlur","imperativeRef","tryRestoreFocus","rest","titleId","useId","bodyId","toastRef","React","useRef","targetDocument","useFluent_unstable","running","setRunning","useState","imperativePauseRef","focusedToastBeforeClose","focusableGroupAttribute","useFocusableGroup","tabBehavior","ignoreDefaultKeydown","Tab","Escape","Enter","useEventCallback","_toastRef_current","activeElement","current","contains","onStatusChange","status","_props_onStatusChange","call","pause","play","_targetDocument_activeElement","containsActive","useImperativeHandle","focus","useEffect","_targetDocument_defaultView","_targetDocument_defaultView1","defaultView","addEventListener","removeEventListener","onTransitionEntering","element","style","setProperty","scrollHeight","userRootSlot","root","toastAnimationRef","useCallback","el","once","onMouseEnter","e","_userRootSlot_onMouseEnter","onMouseLeave","findFirstFocusable","findLastFocusable","useFocusFinders","onKeyDown","_userRootSlot_onKeyDown","key","Delete","preventDefault","currentTarget","target","shiftKey","_findLastFocusable","_findFirstFocusable","_toastRef_current_textContent","textContent","components","timer","Timer","slot","always","onTimeout","elementType","getIntrinsicElementProps","useMergedRefs","tabIndex","role","transitionTimeout","nodeRef"],"mappings":"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"}