{"version":3,"sources":["useAriaLive.js"],"sourcesContent":["import * as React from 'react';\nimport { createPriorityQueue, useEventCallback, slot } from '@fluentui/react-utilities';\n/** The duration the message needs to be in present in DOM for screen readers to register a change and announce */ const MESSAGE_DURATION = 500;\n/**\n * Create the state required to render AriaLive.\n *\n * The returned state can be modified with hooks such as useAriaLiveStyles_unstable,\n * before being passed to renderAriaLive_unstable.\n *\n * @param props - props from this instance of AriaLive\n */ export const useAriaLive_unstable = (props)=>{\n    const [currentMessage, setCurrentMessage] = React.useState(undefined);\n    // Can't rely on Date.now() if user invokes announce more than once in a code block\n    const order = React.useRef(0);\n    const [messageQueue] = React.useState(()=>createPriorityQueue((a, b)=>{\n            if (a.politeness === b.politeness) {\n                return a.createdAt - b.createdAt;\n            }\n            return a.politeness === 'assertive' ? -1 : 1;\n        }));\n    const announce = useEventCallback((message, options)=>{\n        const { politeness } = options;\n        if (message === (currentMessage === null || currentMessage === void 0 ? void 0 : currentMessage.message)) {\n            return;\n        }\n        const liveMessage = {\n            message,\n            politeness,\n            createdAt: order.current++\n        };\n        if (!currentMessage) {\n            setCurrentMessage(liveMessage);\n        } else {\n            messageQueue.enqueue(liveMessage);\n        }\n    });\n    React.useEffect(()=>{\n        const timeout = setTimeout(()=>{\n            if (messageQueue.peek()) {\n                setCurrentMessage(messageQueue.dequeue());\n            } else {\n                setCurrentMessage(undefined);\n            }\n        }, MESSAGE_DURATION);\n        return ()=>clearTimeout(timeout);\n    }, [\n        currentMessage,\n        messageQueue\n    ]);\n    React.useImperativeHandle(props.announceRef, ()=>announce);\n    const politeMessage = (currentMessage === null || currentMessage === void 0 ? void 0 : currentMessage.politeness) === 'polite' ? currentMessage.message : undefined;\n    const assertiveMessage = (currentMessage === null || currentMessage === void 0 ? void 0 : currentMessage.politeness) === 'assertive' ? currentMessage.message : undefined;\n    return {\n        components: {\n            assertive: 'div',\n            polite: 'div'\n        },\n        assertive: slot.always(props.assertive, {\n            defaultProps: {\n                'aria-live': 'assertive',\n                children: assertiveMessage\n            },\n            elementType: 'div'\n        }),\n        polite: slot.always(props.polite, {\n            defaultProps: {\n                'aria-live': 'polite',\n                children: politeMessage\n            },\n            elementType: 'div'\n        })\n    };\n};\n"],"names":["useAriaLive_unstable","MESSAGE_DURATION","props","currentMessage","setCurrentMessage","React","useState","undefined","order","useRef","messageQueue","createPriorityQueue","a","b","politeness","createdAt","announce","useEventCallback","message","options","liveMessage","current","enqueue","useEffect","timeout","setTimeout","peek","dequeue","clearTimeout","useImperativeHandle","announceRef","politeMessage","assertiveMessage","components","assertive","polite","slot","always","defaultProps","children","elementType"],"mappings":";;;;+BAUiBA;;;eAAAA;;;;iEAVM;gCACqC;AAC5D,gHAAgH,GAAG,MAAMC,mBAAmB;AAQjI,MAAMD,uBAAuB,CAACE;IACrC,MAAM,CAACC,gBAAgBC,kBAAkB,GAAGC,OAAMC,QAAQ,CAACC;IAC3D,mFAAmF;IACnF,MAAMC,QAAQH,OAAMI,MAAM,CAAC;IAC3B,MAAM,CAACC,aAAa,GAAGL,OAAMC,QAAQ,CAAC,IAAIK,IAAAA,mCAAmB,EAAC,CAACC,GAAGC;YAC1D,IAAID,EAAEE,UAAU,KAAKD,EAAEC,UAAU,EAAE;gBAC/B,OAAOF,EAAEG,SAAS,GAAGF,EAAEE,SAAS;YACpC;YACA,OAAOH,EAAEE,UAAU,KAAK,cAAc,CAAC,IAAI;QAC/C;IACJ,MAAME,WAAWC,IAAAA,gCAAgB,EAAC,CAACC,SAASC;QACxC,MAAM,EAAEL,UAAU,EAAE,GAAGK;QACvB,IAAID,YAAaf,CAAAA,mBAAmB,QAAQA,mBAAmB,KAAK,IAAI,KAAK,IAAIA,eAAee,OAAO,AAAD,GAAI;YACtG;QACJ;QACA,MAAME,cAAc;YAChBF;YACAJ;YACAC,WAAWP,MAAMa,OAAO;QAC5B;QACA,IAAI,CAAClB,gBAAgB;YACjBC,kBAAkBgB;QACtB,OAAO;YACHV,aAAaY,OAAO,CAACF;QACzB;IACJ;IACAf,OAAMkB,SAAS,CAAC;QACZ,MAAMC,UAAUC,WAAW;YACvB,IAAIf,aAAagB,IAAI,IAAI;gBACrBtB,kBAAkBM,aAAaiB,OAAO;YAC1C,OAAO;gBACHvB,kBAAkBG;YACtB;QACJ,GAAGN;QACH,OAAO,IAAI2B,aAAaJ;IAC5B,GAAG;QACCrB;QACAO;KACH;IACDL,OAAMwB,mBAAmB,CAAC3B,MAAM4B,WAAW,EAAE,IAAId;IACjD,MAAMe,gBAAgB,AAAC5B,CAAAA,mBAAmB,QAAQA,mBAAmB,KAAK,IAAI,KAAK,IAAIA,eAAeW,UAAU,AAAD,MAAO,WAAWX,eAAee,OAAO,GAAGX;IAC1J,MAAMyB,mBAAmB,AAAC7B,CAAAA,mBAAmB,QAAQA,mBAAmB,KAAK,IAAI,KAAK,IAAIA,eAAeW,UAAU,AAAD,MAAO,cAAcX,eAAee,OAAO,GAAGX;IAChK,OAAO;QACH0B,YAAY;YACRC,WAAW;YACXC,QAAQ;QACZ;QACAD,WAAWE,oBAAI,CAACC,MAAM,CAACnC,MAAMgC,SAAS,EAAE;YACpCI,cAAc;gBACV,aAAa;gBACbC,UAAUP;YACd;YACAQ,aAAa;QACjB;QACAL,QAAQC,oBAAI,CAACC,MAAM,CAACnC,MAAMiC,MAAM,EAAE;YAC9BG,cAAc;gBACV,aAAa;gBACbC,UAAUR;YACd;YACAS,aAAa;QACjB;IACJ;AACJ"}