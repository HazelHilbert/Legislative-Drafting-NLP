{"version":3,"sources":["useDialogSurface.js"],"sourcesContent":["import * as React from 'react';\nimport { useEventCallback, useMergedRefs, isResolvedShorthand, slot, getIntrinsicElementProps } from '@fluentui/react-utilities';\nimport { useDialogContext_unstable } from '../../contexts';\nimport { Escape } from '@fluentui/keyboard-keys';\nimport { useDialogTransitionContext_unstable } from '../../contexts/dialogTransitionContext';\n/**\n * Create the state required to render DialogSurface.\n *\n * The returned state can be modified with hooks such as useDialogSurfaceStyles_unstable,\n * before being passed to renderDialogSurface_unstable.\n *\n * @param props - props from this instance of DialogSurface\n * @param ref - reference to root HTMLElement of DialogSurface\n */ export const useDialogSurface_unstable = (props, ref)=>{\n    const modalType = useDialogContext_unstable((ctx)=>ctx.modalType);\n    const isNestedDialog = useDialogContext_unstable((ctx)=>ctx.isNestedDialog);\n    const transitionStatus = useDialogTransitionContext_unstable();\n    const modalAttributes = useDialogContext_unstable((ctx)=>ctx.modalAttributes);\n    const dialogRef = useDialogContext_unstable((ctx)=>ctx.dialogRef);\n    const requestOpenChange = useDialogContext_unstable((ctx)=>ctx.requestOpenChange);\n    const dialogTitleID = useDialogContext_unstable((ctx)=>ctx.dialogTitleId);\n    const handledBackdropClick = useEventCallback((event)=>{\n        if (isResolvedShorthand(props.backdrop)) {\n            var _props_backdrop_onClick, _props_backdrop;\n            (_props_backdrop_onClick = (_props_backdrop = props.backdrop).onClick) === null || _props_backdrop_onClick === void 0 ? void 0 : _props_backdrop_onClick.call(_props_backdrop, event);\n        }\n        if (modalType === 'modal' && !event.isDefaultPrevented()) {\n            requestOpenChange({\n                event,\n                open: false,\n                type: 'backdropClick'\n            });\n        }\n    });\n    const handleKeyDown = useEventCallback((event)=>{\n        var _props_onKeyDown;\n        (_props_onKeyDown = props.onKeyDown) === null || _props_onKeyDown === void 0 ? void 0 : _props_onKeyDown.call(props, event);\n        if (event.key === Escape && !event.isDefaultPrevented()) {\n            requestOpenChange({\n                event,\n                open: false,\n                type: 'escapeKeyDown'\n            });\n            // stop propagation to avoid conflicting with other elements that listen for `Escape`\n            // e,g: nested Dialog, Popover, Menu and Tooltip\n            event.preventDefault();\n        }\n    });\n    const backdrop = slot.optional(props.backdrop, {\n        renderByDefault: modalType !== 'non-modal',\n        defaultProps: {\n            'aria-hidden': 'true'\n        },\n        elementType: 'div'\n    });\n    if (backdrop) {\n        backdrop.onClick = handledBackdropClick;\n    }\n    return {\n        components: {\n            backdrop: 'div',\n            root: 'div'\n        },\n        backdrop,\n        isNestedDialog,\n        transitionStatus,\n        mountNode: props.mountNode,\n        root: slot.always(getIntrinsicElementProps('div', {\n            tabIndex: -1,\n            'aria-modal': modalType !== 'non-modal',\n            role: modalType === 'alert' ? 'alertdialog' : 'dialog',\n            'aria-labelledby': props['aria-label'] ? undefined : dialogTitleID,\n            ...props,\n            ...modalAttributes,\n            onKeyDown: handleKeyDown,\n            // FIXME:\n            // `DialogSurfaceElement` is wrongly assigned to be `HTMLElement` instead of `HTMLDivElement`\n            // but since it would be a breaking change to fix it, we are casting ref to it's proper type\n            ref: useMergedRefs(ref, dialogRef)\n        }), {\n            elementType: 'div'\n        })\n    };\n};\n"],"names":["useDialogSurface_unstable","props","ref","modalType","useDialogContext_unstable","ctx","isNestedDialog","transitionStatus","useDialogTransitionContext_unstable","modalAttributes","dialogRef","requestOpenChange","dialogTitleID","dialogTitleId","handledBackdropClick","useEventCallback","event","isResolvedShorthand","backdrop","_props_backdrop_onClick","_props_backdrop","onClick","call","isDefaultPrevented","open","type","handleKeyDown","_props_onKeyDown","onKeyDown","key","Escape","preventDefault","slot","optional","renderByDefault","defaultProps","elementType","components","root","mountNode","always","getIntrinsicElementProps","tabIndex","role","undefined","useMergedRefs"],"mappings":";;;;+BAaiBA;;;eAAAA;;;;iEAbM;gCAC8E;0BAC3D;8BACnB;yCAC6B;AASzC,MAAMA,4BAA4B,CAACC,OAAOC;IACjD,MAAMC,YAAYC,IAAAA,mCAAyB,EAAC,CAACC,MAAMA,IAAIF,SAAS;IAChE,MAAMG,iBAAiBF,IAAAA,mCAAyB,EAAC,CAACC,MAAMA,IAAIC,cAAc;IAC1E,MAAMC,mBAAmBC,IAAAA,4DAAmC;IAC5D,MAAMC,kBAAkBL,IAAAA,mCAAyB,EAAC,CAACC,MAAMA,IAAII,eAAe;IAC5E,MAAMC,YAAYN,IAAAA,mCAAyB,EAAC,CAACC,MAAMA,IAAIK,SAAS;IAChE,MAAMC,oBAAoBP,IAAAA,mCAAyB,EAAC,CAACC,MAAMA,IAAIM,iBAAiB;IAChF,MAAMC,gBAAgBR,IAAAA,mCAAyB,EAAC,CAACC,MAAMA,IAAIQ,aAAa;IACxE,MAAMC,uBAAuBC,IAAAA,gCAAgB,EAAC,CAACC;QAC3C,IAAIC,IAAAA,mCAAmB,EAAChB,MAAMiB,QAAQ,GAAG;YACrC,IAAIC,yBAAyBC;YAC5BD,CAAAA,0BAA0B,AAACC,CAAAA,kBAAkBnB,MAAMiB,QAAQ,AAAD,EAAGG,OAAO,AAAD,MAAO,QAAQF,4BAA4B,KAAK,IAAI,KAAK,IAAIA,wBAAwBG,IAAI,CAACF,iBAAiBJ;QACnL;QACA,IAAIb,cAAc,WAAW,CAACa,MAAMO,kBAAkB,IAAI;YACtDZ,kBAAkB;gBACdK;gBACAQ,MAAM;gBACNC,MAAM;YACV;QACJ;IACJ;IACA,MAAMC,gBAAgBX,IAAAA,gCAAgB,EAAC,CAACC;QACpC,IAAIW;QACHA,CAAAA,mBAAmB1B,MAAM2B,SAAS,AAAD,MAAO,QAAQD,qBAAqB,KAAK,IAAI,KAAK,IAAIA,iBAAiBL,IAAI,CAACrB,OAAOe;QACrH,IAAIA,MAAMa,GAAG,KAAKC,oBAAM,IAAI,CAACd,MAAMO,kBAAkB,IAAI;YACrDZ,kBAAkB;gBACdK;gBACAQ,MAAM;gBACNC,MAAM;YACV;YACA,qFAAqF;YACrF,gDAAgD;YAChDT,MAAMe,cAAc;QACxB;IACJ;IACA,MAAMb,WAAWc,oBAAI,CAACC,QAAQ,CAAChC,MAAMiB,QAAQ,EAAE;QAC3CgB,iBAAiB/B,cAAc;QAC/BgC,cAAc;YACV,eAAe;QACnB;QACAC,aAAa;IACjB;IACA,IAAIlB,UAAU;QACVA,SAASG,OAAO,GAAGP;IACvB;IACA,OAAO;QACHuB,YAAY;YACRnB,UAAU;YACVoB,MAAM;QACV;QACApB;QACAZ;QACAC;QACAgC,WAAWtC,MAAMsC,SAAS;QAC1BD,MAAMN,oBAAI,CAACQ,MAAM,CAACC,IAAAA,wCAAwB,EAAC,OAAO;YAC9CC,UAAU,CAAC;YACX,cAAcvC,cAAc;YAC5BwC,MAAMxC,cAAc,UAAU,gBAAgB;YAC9C,mBAAmBF,KAAK,CAAC,aAAa,GAAG2C,YAAYhC;YACrD,GAAGX,KAAK;YACR,GAAGQ,eAAe;YAClBmB,WAAWF;YACX,SAAS;YACT,6FAA6F;YAC7F,4FAA4F;YAC5FxB,KAAK2C,IAAAA,6BAAa,EAAC3C,KAAKQ;QAC5B,IAAI;YACA0B,aAAa;QACjB;IACJ;AACJ"}