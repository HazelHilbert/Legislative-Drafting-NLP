{"version":3,"sources":["useTableCompositeNavigation.js"],"sourcesContent":["import * as React from 'react';\nimport { useFluent_unstable as useFluent } from '@fluentui/react-shared-contexts';\nimport { ArrowDown, ArrowRight, ArrowUp } from '@fluentui/keyboard-keys';\nimport { useArrowNavigationGroup, useFocusableGroup, useMergedTabsterAttributes_unstable, useFocusFinders } from '@fluentui/react-tabster';\nimport { isHTMLElement } from '@fluentui/react-utilities';\nimport { TabsterTypes, dispatchGroupperMoveFocusEvent, dispatchMoverMoveFocusEvent } from '@fluentui/react-tabster';\nexport function useTableCompositeNavigation() {\n    const horizontalAttr = useArrowNavigationGroup({\n        axis: 'horizontal'\n    });\n    const gridAttr = useArrowNavigationGroup({\n        axis: 'grid'\n    });\n    const groupperAttr = useFocusableGroup({\n        tabBehavior: 'limited-trap-focus'\n    });\n    const { findFirstFocusable } = useFocusFinders();\n    const { targetDocument } = useFluent();\n    const rowAttr = useMergedTabsterAttributes_unstable(horizontalAttr, groupperAttr);\n    const onKeyDown = React.useCallback((e)=>{\n        if (!targetDocument) {\n            return;\n        }\n        let activeElement = targetDocument.activeElement;\n        if (!activeElement || !e.currentTarget.contains(activeElement)) {\n            return;\n        }\n        const activeElementRole = activeElement.getAttribute('role');\n        // Enter groupper when in row focus mode to navigate cells\n        if (e.key === ArrowRight && activeElementRole === 'row' && isHTMLElement(activeElement)) {\n            var _findFirstFocusable;\n            (_findFirstFocusable = findFirstFocusable(activeElement)) === null || _findFirstFocusable === void 0 ? void 0 : _findFirstFocusable.focus();\n        }\n        if (activeElementRole === 'row') {\n            return;\n        }\n        const isInCell = (()=>{\n            let cur = isHTMLElement(activeElement) ? activeElement : null;\n            while(cur){\n                const curRole = cur.getAttribute('role');\n                if (curRole === 'cell' || curRole === 'gridcell') {\n                    return true;\n                }\n                cur = cur.parentElement;\n            }\n            return false;\n        })();\n        // Escape groupper focus trap before arrow down\n        if ((e.key === ArrowDown || e.key === ArrowUp) && isInCell) {\n            dispatchGroupperMoveFocusEvent(activeElement, TabsterTypes.GroupperMoveFocusActions.Escape);\n            activeElement = targetDocument.activeElement;\n            if (activeElement) {\n                dispatchMoverMoveFocusEvent(activeElement, TabsterTypes.MoverKeys[e.key]);\n            }\n        }\n    }, [\n        targetDocument,\n        findFirstFocusable\n    ]);\n    return {\n        onTableKeyDown: onKeyDown,\n        tableTabsterAttribute: gridAttr,\n        tableRowTabsterAttribute: rowAttr\n    };\n}\n"],"names":["useTableCompositeNavigation","horizontalAttr","useArrowNavigationGroup","axis","gridAttr","groupperAttr","useFocusableGroup","tabBehavior","findFirstFocusable","useFocusFinders","targetDocument","useFluent","rowAttr","useMergedTabsterAttributes_unstable","onKeyDown","React","useCallback","e","activeElement","currentTarget","contains","activeElementRole","getAttribute","key","ArrowRight","isHTMLElement","_findFirstFocusable","focus","isInCell","cur","curRole","parentElement","ArrowDown","ArrowUp","dispatchGroupperMoveFocusEvent","TabsterTypes","GroupperMoveFocusActions","Escape","dispatchMoverMoveFocusEvent","MoverKeys","onTableKeyDown","tableTabsterAttribute","tableRowTabsterAttribute"],"mappings":";;;;+BAMgBA;;;eAAAA;;;;iEANO;qCACyB;8BACD;8BACkE;gCACnF;AAEvB,SAASA;IACZ,MAAMC,iBAAiBC,IAAAA,qCAAuB,EAAC;QAC3CC,MAAM;IACV;IACA,MAAMC,WAAWF,IAAAA,qCAAuB,EAAC;QACrCC,MAAM;IACV;IACA,MAAME,eAAeC,IAAAA,+BAAiB,EAAC;QACnCC,aAAa;IACjB;IACA,MAAM,EAAEC,kBAAkB,EAAE,GAAGC,IAAAA,6BAAe;IAC9C,MAAM,EAAEC,cAAc,EAAE,GAAGC,IAAAA,uCAAS;IACpC,MAAMC,UAAUC,IAAAA,iDAAmC,EAACZ,gBAAgBI;IACpE,MAAMS,YAAYC,OAAMC,WAAW,CAAC,CAACC;QACjC,IAAI,CAACP,gBAAgB;YACjB;QACJ;QACA,IAAIQ,gBAAgBR,eAAeQ,aAAa;QAChD,IAAI,CAACA,iBAAiB,CAACD,EAAEE,aAAa,CAACC,QAAQ,CAACF,gBAAgB;YAC5D;QACJ;QACA,MAAMG,oBAAoBH,cAAcI,YAAY,CAAC;QACrD,0DAA0D;QAC1D,IAAIL,EAAEM,GAAG,KAAKC,wBAAU,IAAIH,sBAAsB,SAASI,IAAAA,6BAAa,EAACP,gBAAgB;YACrF,IAAIQ;YACHA,CAAAA,sBAAsBlB,mBAAmBU,cAAa,MAAO,QAAQQ,wBAAwB,KAAK,IAAI,KAAK,IAAIA,oBAAoBC,KAAK;QAC7I;QACA,IAAIN,sBAAsB,OAAO;YAC7B;QACJ;QACA,MAAMO,WAAW,AAAC,CAAA;YACd,IAAIC,MAAMJ,IAAAA,6BAAa,EAACP,iBAAiBA,gBAAgB;YACzD,MAAMW,IAAI;gBACN,MAAMC,UAAUD,IAAIP,YAAY,CAAC;gBACjC,IAAIQ,YAAY,UAAUA,YAAY,YAAY;oBAC9C,OAAO;gBACX;gBACAD,MAAMA,IAAIE,aAAa;YAC3B;YACA,OAAO;QACX,CAAA;QACA,+CAA+C;QAC/C,IAAI,AAACd,CAAAA,EAAEM,GAAG,KAAKS,uBAAS,IAAIf,EAAEM,GAAG,KAAKU,qBAAO,AAAD,KAAML,UAAU;YACxDM,IAAAA,4CAA8B,EAAChB,eAAeiB,0BAAY,CAACC,wBAAwB,CAACC,MAAM;YAC1FnB,gBAAgBR,eAAeQ,aAAa;YAC5C,IAAIA,eAAe;gBACfoB,IAAAA,yCAA2B,EAACpB,eAAeiB,0BAAY,CAACI,SAAS,CAACtB,EAAEM,GAAG,CAAC;YAC5E;QACJ;IACJ,GAAG;QACCb;QACAF;KACH;IACD,OAAO;QACHgC,gBAAgB1B;QAChB2B,uBAAuBrC;QACvBsC,0BAA0B9B;IAC9B;AACJ"}