"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "useStaticVirtualizerMeasure", {
    enumerable: true,
    get: function() {
        return useStaticVirtualizerMeasure;
    }
});
const _interop_require_wildcard = require("@swc/helpers/_/_interop_require_wildcard");
const _react = /*#__PURE__*/ _interop_require_wildcard._(require("react"));
const _useResizeObserverRef = require("./useResizeObserverRef");
const useStaticVirtualizerMeasure = (virtualizerProps)=>{
    const { defaultItemSize, direction = 'vertical' } = virtualizerProps;
    const [state, setState] = _react.useState({
        virtualizerLength: 0,
        bufferSize: 0,
        bufferItems: 0
    });
    const { virtualizerLength, bufferItems, bufferSize } = state;
    const resizeCallback = _react.useCallback((_entries, _observer, scrollRef)=>{
        if (!(scrollRef === null || scrollRef === void 0 ? void 0 : scrollRef.current)) {
            return;
        }
        const containerSize = direction === 'vertical' ? scrollRef === null || scrollRef === void 0 ? void 0 : scrollRef.current.getBoundingClientRect().height : scrollRef === null || scrollRef === void 0 ? void 0 : scrollRef.current.getBoundingClientRect().width;
        /*
       * Number of items required to cover viewport.
       */ const length = Math.ceil(containerSize / defaultItemSize + 1);
        /*
       * Number of items to append at each end, i.e. 'preload' each side before entering view.
       */ const newBufferItems = Math.max(Math.floor(length / 4), 2);
        /*
       * This is how far we deviate into the bufferItems to detect a redraw.
       */ const newBufferSize = Math.max(Math.floor(length / 8 * defaultItemSize), 1);
        const totalLength = length + newBufferItems * 2 + 1;
        setState({
            virtualizerLength: totalLength,
            bufferItems: newBufferItems,
            bufferSize: newBufferSize
        });
    }, [
        defaultItemSize,
        direction
    ]);
    const scrollRef = (0, _useResizeObserverRef.useResizeObserverRef_unstable)(resizeCallback);
    return {
        virtualizerLength,
        bufferItems,
        bufferSize,
        scrollRef
    };
};
