{"version":3,"file":"osfmos.js","sourceRoot":"","sources":["../../../shared_src/jscript/XmlUtil.ts","../../../shared_src/jscript/osfhosts.ts","../../../shared_src/defines.ts","../../../shared_src/runtime/Utilities/WAC/RequirementsChecker.ts","../../../shared_src/jscript/Telemetry/TelemetryManager.ts","../../../shared_src/jscript/Telemetry/TypeScriptUsageTypes.ts","../../../shared_src/runtime/CommonData.ts","../../../shared_src/jscript/SP.OmexExtMgrCommon.ts","../../../shared_src/jscript/officeutil/msajaxfactory.ts","../../../shared_src/jscript/officeutil/msajaxbase.ts","../../../shared_src/jscript/officexdmshared.ts","../../../shared_src/jscript/officeutil/officeutil.ts","../../../shared_src/jscript/officexdm.ts","../../../shared_src/jscript/officeutil/officewacutil.ts","../../../shared_src/jscript/OSF.Constants.ts","../../../shared_src/jscript/OsfCommon.ts","../../../shared_src/jscript/SP.ExtMgrCommon.ts","../../../shared_src/runtime/Utilities/WAC/MosAcquisitions.ts","../../../shared_src/runtime/Utilities/WAC/OSFConstants.ts","../../../shared_src/runtime/CatalogCommon/CommonUtil.ts","../../../shared_src/jscript/ribbon/RibbonIdMap.ts","../../../shared_src/runtime/Utilities/WAC/ParserUtility.ts","../../../shared_src/jscript/AddinCommandsManifestParser.ts","../../../shared_src/runtime/Utilities/WAC/OSFManifest.ts","../../../shared_src/runtime/Utilities/WAC/OfficeAppManifest.ts","../../../shared_src/runtime/Utilities/WAC/MosAppMetadata.ts","../../../shared_src/runtime/Utilities/WAC/OsfManifestManagerV2.ts","../../../shared_src/runtime/Utilities/WAC/ExtendedManifest.ts","../../../shared_src/runtime/Utilities/WAC/ExtendedManifestCacheEntry.ts","../../../shared_src/runtime/Utilities/WAC/ExtendedManifestTokens.ts"],"names":[],"mappings":"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","sourcesContent":["// IMPORTANT!! When changing this file make sure to make the same change in file %SRCROOT%\\osfjs\\mos\\converter\\src\\xmlUtil.ts\r\nnamespace OSF {\r\n    //constants to prevent DOS attack\r\n    export enum XmlConstants {\r\n        MaxXmlSize = 1048576,\r\n        MaxElementDepth = 64\r\n    }\r\n\r\n    /// <summary>\r\n    /// Xpath 3 Provider\r\n    /// </summary>\r\n    /// <param name=\"xmldoc\">xml string</param>\r\n    /// <param name=\"xmlNamespaces\">namespaces</param>\r\n    /// <accessibility>private</accessibility>\r\n    export class Xpath3Provider {\r\n        _defaultNamespace: any;\r\n        _evaluator: any;\r\n        _namespaceMapping: any;\r\n        _resolver: any;\r\n        _xmldoc: any;\r\n        constructor(xml, xmlNamespaces) {\r\n            this._xmldoc = new DOMParser().parseFromString(xml, \"text/xml\");\r\n            this._evaluator = new XPathEvaluator();\r\n            this._namespaceMapping = {};\r\n            this._defaultNamespace = null;\r\n            var namespaces = xmlNamespaces.split(' ');\r\n            var matches;\r\n            for (var i = 0; i < namespaces.length; ++i) {\r\n                matches = /xmlns=\"([^\"]*)\"/g.exec(namespaces[i]);\r\n                if (matches) {\r\n                    this._defaultNamespace = matches[1];\r\n                    continue;\r\n                }\r\n                matches = /xmlns:([^=]*)=\"([^\"]*)\"/g.exec(namespaces[i]);\r\n                if (matches) {\r\n                    this._namespaceMapping[matches[1]] = matches[2];\r\n                    continue;\r\n                }\r\n            }\r\n            this._resolver = this;\r\n        }\r\n        lookupNamespaceURI(prefix) {\r\n            var ns = this._namespaceMapping[prefix];\r\n            return ns || this._defaultNamespace;\r\n        }\r\n        addNamespaceMapping(namespacePrefix, namespaceUri) {\r\n            var ns = this._namespaceMapping[namespacePrefix];\r\n            if (ns) {\r\n                return false; // the namespace prefix is already defined\r\n            }\r\n            else {\r\n                this._namespaceMapping[namespacePrefix] = namespaceUri;\r\n                return true;\r\n            }\r\n        }\r\n        getNamespaceMapping(): any {\r\n            return this._namespaceMapping;\r\n        }\r\n        selectSingleNode(name, contextNode) {\r\n            var xpath = (contextNode ? \"./\" : \"/\") + name;\r\n            contextNode = contextNode || this.getDocumentElement();\r\n            var result = this._evaluator.evaluate(xpath, contextNode, this._resolver, XPathResult.FIRST_ORDERED_NODE_TYPE, null);\r\n            if (result) {\r\n                return result.singleNodeValue;\r\n            }\r\n            else {\r\n                return null;\r\n            }\r\n        }\r\n        selectNodes(name, contextNode) {\r\n            var xpath = (contextNode ? \"./\" : \"/\") + name;\r\n            contextNode = contextNode || this.getDocumentElement();\r\n            var result = this._evaluator.evaluate(xpath, contextNode, this._resolver, XPathResult.ORDERED_NODE_ITERATOR_TYPE, null);\r\n            var nodes = [];\r\n            if (result) {\r\n                var node = result.iterateNext();\r\n                while (node) {\r\n                    nodes.push(node);\r\n                    node = result.iterateNext();\r\n                }\r\n            }\r\n            return nodes;\r\n        }\r\n        selectNodesByXPath(xpath, contextNode) {\r\n            var result = this._evaluator.evaluate(xpath, contextNode, this._resolver, XPathResult.ORDERED_NODE_ITERATOR_TYPE, null);\r\n            var nodes = [];\r\n            if (result) {\r\n                var node = result.iterateNext();\r\n                while (node) {\r\n                    nodes.push(node);\r\n                    node = result.iterateNext();\r\n                }\r\n            }\r\n            return nodes;\r\n        }\r\n        getDocumentElement() {\r\n            return this._xmldoc.documentElement;\r\n        }\r\n    }\r\n\r\n    /// <summary>\r\n    /// IE Xpath Provider\r\n    /// </summary>\r\n    /// <param name=\"xmldoc\">xml string</param>\r\n    /// <param name=\"xmlNamespaces\">namespaces</param>\r\n    /// <accessibility>private</accessibility>\r\n    export class IEXpathProvider {\r\n        _xmldoc: any;\r\n        constructor(xml, xmlNamespaces) {\r\n            var xmldoc = null;\r\n            var msxmlVersions = ['MSXML2.DOMDocument.6.0'];\r\n            for (var i = 0; i < msxmlVersions.length; i++) {\r\n                try {\r\n                    xmldoc = new ActiveXObject(msxmlVersions[i]);\r\n                    xmldoc.setProperty('ResolveExternals', false);\r\n                    xmldoc.setProperty('ValidateOnParse', false);\r\n                    xmldoc.setProperty('ProhibitDTD', true);\r\n                    xmldoc.setProperty('MaxXMLSize', OSF.XmlConstants.MaxXmlSize);\r\n                    xmldoc.setProperty('MaxElementDepth', OSF.XmlConstants.MaxElementDepth);\r\n                    xmldoc.async = false;\r\n                    xmldoc.loadXML(xml);\r\n                    xmldoc.setProperty(\"SelectionLanguage\", \"XPath\");\r\n                    xmldoc.setProperty(\"SelectionNamespaces\", xmlNamespaces);\r\n                    break;\r\n                }\r\n                catch (ex) {\r\n                    OsfMsAjaxFactory.msAjaxDebug.trace(\"xml doc creating error:\" + ex);\r\n                }\r\n            }\r\n            this._xmldoc = xmldoc;\r\n        }\r\n        selectSingleNode(name, contextNode) {\r\n            var xpath = (contextNode ? \"./\" : \"/\") + name;\r\n            contextNode = contextNode || this.getDocumentElement();\r\n            return contextNode.selectSingleNode(xpath);\r\n        }\r\n        addNamespaceMapping(namespacePrefix, namespaceUri) {\r\n            var existingNamespaces = this._xmldoc.getProperty(\"SelectionNamespaces\");\r\n            var newNamespacePrefix = \"xmlns:\" + namespacePrefix + \"=\";\r\n            var newNamespaceMappingString = \"xmlns:\" + namespacePrefix + \"=\\\"\" + namespaceUri + \"\\\"\";\r\n            if (existingNamespaces.indexOf(newNamespacePrefix) != -1) {\r\n                return false; // the namespace prefix is already defined\r\n            }\r\n            existingNamespaces = existingNamespaces + \" \" + newNamespaceMappingString;\r\n            this._xmldoc.setProperty(\"SelectionNamespaces\", existingNamespaces);\r\n            return true;\r\n        }\r\n        getNamespaceMapping(): any {\r\n            return null;\r\n        }\r\n        selectNodes(name, contextNode) {\r\n            var xpath = (contextNode ? \"./\" : \"/\") + name;\r\n            contextNode = contextNode || this.getDocumentElement();\r\n            return contextNode.selectNodes(xpath);\r\n        }\r\n        selectNodesByXPath(xpath, contextNode) {\r\n            return contextNode.selectNodes(xpath);\r\n        }\r\n        getDocumentElement() {\r\n            return this._xmldoc.documentElement;\r\n        }\r\n        getActiveXObject() {\r\n            return this._xmldoc;\r\n        }\r\n    }\r\n\r\n    /// <summary>\r\n    /// DomParser Provider\r\n    /// </summary>\r\n    /// <param name=\"xmldoc\">xml string</param>\r\n    /// <param name=\"xmlNamespaces\">namespaces</param>\r\n    /// <accessibility>private</accessibility>\r\n    export class DomParserProvider {\r\n        _defaultNamespace: any;\r\n        _namespaceMapping: any;\r\n        _xmldoc: any;\r\n        constructor(xml, xmlNamespaces) {\r\n            try {\r\n                this._xmldoc = new DOMParser().parseFromString(xml, \"text/xml\");\r\n            }\r\n            catch (ex) {\r\n                Sys.Debug.trace(\"xml doc creating error:\" + ex);\r\n            }\r\n            // handle namespace\r\n            this._namespaceMapping = {};\r\n            this._defaultNamespace = null;\r\n            var namespaces = xmlNamespaces.split(' ');\r\n            var matches;\r\n            for (var i = 0; i < namespaces.length; ++i) {\r\n                matches = /xmlns=\"([^\"]*)\"/g.exec(namespaces[i]);\r\n                if (matches) {\r\n                    this._defaultNamespace = matches[1];\r\n                    continue;\r\n                }\r\n                matches = /xmlns:([^=]*)=\"([^\"]*)\"/g.exec(namespaces[i]);\r\n                if (matches) {\r\n                    this._namespaceMapping[matches[1]] = matches[2];\r\n                    continue;\r\n                }\r\n            }\r\n        }\r\n        addNamespaceMapping(namespacePrefix, namespaceUri) {\r\n            var ns = this._namespaceMapping[namespacePrefix];\r\n            if (ns) {\r\n                return false; // The namespace prefix is already defined\r\n            }\r\n            else {\r\n                this._namespaceMapping[namespacePrefix] = namespaceUri;\r\n                return true;\r\n            }\r\n        }\r\n        getNamespaceMapping(): any {\r\n            return this._namespaceMapping;\r\n        }\r\n        selectSingleNode(name, contextNode) {\r\n            var selectedNode = contextNode || this._xmldoc;\r\n            var nodes = this._selectNodes(name, selectedNode);\r\n            if (nodes.length === 0)\r\n                return null;\r\n            return nodes[0];\r\n        }\r\n        selectNodes(name, contextNode) {\r\n            var selectedNode = contextNode || this._xmldoc;\r\n            return this._selectNodes(name, selectedNode);\r\n        }\r\n        selectNodesByXPath(xpath, contextNode) {\r\n            // Todo(OfficeVSO:81193): Try to support selectNodesByXPath in DomParserProvider.\r\n            return null;\r\n        }\r\n        _selectNodes(name, contextNode) {\r\n            var nodes = [];\r\n            if (!name)\r\n                return nodes;\r\n            var nameInfo = name.split(\":\");\r\n            var ns, nodeName;\r\n            if (nameInfo.length === 1) {\r\n                ns = null;\r\n                nodeName = nameInfo[0];\r\n            }\r\n            else if (nameInfo.length === 2) {\r\n                ns = this._namespaceMapping[nameInfo[0]];\r\n                nodeName = nameInfo[1];\r\n            }\r\n            else {\r\n                throw OsfMsAjaxFactory.msAjaxError.argument(\"name\");\r\n            }\r\n            if (!contextNode.hasChildNodes)\r\n                return nodes;\r\n            var childs = contextNode.childNodes;\r\n            for (var i = 0; i < childs.length; i++) {\r\n                if (nodeName === this._removeNodePrefix(childs[i].nodeName) && (ns === childs[i].namespaceURI)) {\r\n                    nodes.push(childs[i]);\r\n                }\r\n            }\r\n            return nodes;\r\n        }\r\n        _removeNodePrefix(nodeName) {\r\n            var nodeInfo = nodeName.split(':');\r\n            if (nodeInfo.length === 1) {\r\n                return nodeName;\r\n            }\r\n            else {\r\n                return nodeInfo[1];\r\n            }\r\n        }\r\n        getDocumentElement() {\r\n            return this._xmldoc.documentElement;\r\n        }\r\n    }\r\n\r\n    /// <summary>\r\n    /// XmlProcessor, cross browser XML parsing.\r\n    /// </summary>\r\n    /// <param name=\"xml\">xml string</param>\r\n    /// <param name=\"xmlNamespaces\">xml Namespaces string</param>\r\n    /// <accessibility>public</accessibility>\r\n    export class XmlProcessor {\r\n        _provider: any;\r\n        constructor(xml, xmlNamespaces) {\r\n            var e = Function._validateParams(arguments, [\r\n                { name: \"xml\", type: String, mayBeNull: false },\r\n                { name: \"xmlNamespaces\", type: String, mayBeNull: false }\r\n            ]);\r\n            if (e)\r\n                throw e;\r\n            if (document.implementation && document.implementation.hasFeature(\"XPath\", \"3.0\")) {\r\n                this._provider = new OSF.Xpath3Provider(xml, xmlNamespaces);\r\n            }\r\n            else {\r\n                this._provider = new OSF.IEXpathProvider(xml, xmlNamespaces);\r\n                if (!this._provider.getActiveXObject()) {\r\n                    // if we can't use activeXObject, fallback to DomParser\r\n                    this._provider = new OSF.DomParserProvider(xml, xmlNamespaces);\r\n                }\r\n            }\r\n        }\r\n        addNamespaceMapping(namespacePrefix, namespaceUri) {\r\n            var e = Function._validateParams(arguments, [\r\n                { name: \"namespacePrefix\", type: String, mayBeNull: false },\r\n                { name: \"namespaceUri\", type: String, mayBeNull: false }\r\n            ]);\r\n            if (e)\r\n                throw e;\r\n            return this._provider.addNamespaceMapping(namespacePrefix, namespaceUri);\r\n        }\r\n\r\n        /// <summary>\r\n        /// Get the namespace mapping\r\n        /// </summary>\r\n        getNamespaceMapping(): any {\r\n            return this._provider?.getNamespaceMapping();\r\n        }\r\n\r\n        /// <summary>\r\n        /// select a single node\r\n        /// </summary>\r\n        /// <accessibility>public</accessibility>\r\n        /// <param name=\"name\">XML node name</param>\r\n        /// <returns>XML DOM Node object.</returns>\r\n        selectSingleNode(name, contextNode) {\r\n            var e = Function._validateParams(arguments, [\r\n                { name: \"name\", type: String, mayBeNull: false },\r\n                { name: \"contextNode\", mayBeNull: true, optional: true }\r\n            ]);\r\n            if (e)\r\n                throw e;\r\n            return this._provider.selectSingleNode(name, contextNode);\r\n        }\r\n\r\n        /// <summary>\r\n        /// select all child nodes that match node name\r\n        /// </summary>\r\n        /// <accessibility>public</accessibility>\r\n        /// <param name=\"name\">XML node name</param>\r\n        /// <returns>array of XML DOM Node objects.</returns>\r\n        selectNodes(name, contextNode) {\r\n            var e = Function._validateParams(arguments, [\r\n                { name: \"name\", type: String, mayBeNull: false },\r\n                { name: \"contextNode\", mayBeNull: true, optional: true }\r\n            ]);\r\n            if (e)\r\n                throw e;\r\n            return this._provider.selectNodes(name, contextNode);\r\n        }\r\n\r\n        /// <summary>\r\n        /// select nodes that match the xpath query\r\n        /// </summary>\r\n        /// <accessibility>public</accessibility>\r\n        /// <param name=\"xpath\">xpath string</param>\r\n        /// <returns>array of XML DOM Node objects.</returns>\r\n        selectNodesByXPath(xpath, contextNode) {\r\n            var e = Function._validateParams(arguments, [\r\n                { name: \"xpath\", type: String, mayBeNull: false },\r\n                { name: \"contextNode\", mayBeNull: true, optional: true }\r\n            ]);\r\n            if (e)\r\n                throw e;\r\n            contextNode = contextNode || this._provider.getDocumentElement();\r\n            return this._provider.selectNodesByXPath(xpath, contextNode);\r\n        }\r\n\r\n        /// <summary>\r\n        /// get root document element\r\n        /// </summary>\r\n        /// <accessibility>public</accessibility>\r\n        /// <param name=\"node\">DOM root document element</param>\r\n        /// <returns>value of the node as string</returns>\r\n        getDocumentElement() {\r\n            return this._provider.getDocumentElement();\r\n        }\r\n\r\n        /// <summary>\r\n        /// get node value\r\n        /// </summary>\r\n        /// <accessibility>public</accessibility>\r\n        /// <param name=\"node\">DOM element object</param>\r\n        /// <returns>value of the node as string</returns>\r\n        getNodeValue(node) {\r\n            var e = Function._validateParams(arguments, [\r\n                { name: \"node\", type: Object, mayBeNull: false }\r\n            ]);\r\n            if (e)\r\n                throw e;\r\n            var nodeValue;\r\n            if (node.text) { //IE\r\n                nodeValue = node.text;\r\n            }\r\n            else { //others\r\n                nodeValue = node.textContent;\r\n            }\r\n            return nodeValue;\r\n        }\r\n\r\n        /// <summary>\r\n        /// get node text\r\n        /// </summary>\r\n        /// <accessibility>public</accessibility>\r\n        /// <param name=\"node\">DOM element object</param>\r\n        /// <returns>text of the node as string</returns>\r\n        getNodeText(node) {\r\n            var e = Function._validateParams(arguments, [\r\n                { name: \"node\", type: Object, mayBeNull: false }\r\n            ]);\r\n            if (e)\r\n                throw e;\r\n            if (this.getNodeType(node) == 9) { //Handle special case for document node.\r\n                //For document node on Chrome and Edge, the text and textContent of the node are both null.\r\n                //Return the text of the document element here.\r\n                return this.getNodeText(this.getDocumentElement());\r\n            }\r\n            var nodeText;\r\n            if (node.text) { //IE\r\n                nodeText = node.text;\r\n            }\r\n            else { //others\r\n                nodeText = node.textContent;\r\n            }\r\n            return nodeText;\r\n        }\r\n\r\n        /// <summary>\r\n        /// set node text\r\n        /// </summary>\r\n        /// <accessibility>public</accessibility>\r\n        /// <param name=\"node\">DOM element object</param>\r\n        /// <param name=\"text\">text be set to the node</param>\r\n        /// <returns>True if text is set succesfully</returns>\r\n        setNodeText(node, text) {\r\n            var e = Function._validateParams(arguments, [\r\n                { name: \"node\", type: Object, mayBeNull: false },\r\n                { name: \"text\", type: String, mayBeNull: false }\r\n            ]);\r\n            if (e)\r\n                throw e;\r\n            if (this.getNodeType(node) == 9) { //Handle special case for document node.\r\n                //For document node on Chrome and Edge, the text and textContent of the node are both null.\r\n                //As the text for document node cannot be set, return false here.\r\n                return false;\r\n            }\r\n            try {\r\n                if (node.text) { //IE\r\n                    node.text = text;\r\n                }\r\n                else { //others\r\n                    node.textContent = text;\r\n                }\r\n            }\r\n            catch (ex) {\r\n                return false;\r\n            }\r\n            return true;\r\n        }\r\n\r\n        /// <summary>\r\n        /// get node xml\r\n        /// </summary>\r\n        /// <accessibility>public</accessibility>\r\n        /// <param name=\"node\">DOM element object</param>\r\n        /// <returns>xml of the node as string</returns>\r\n        getNodeXml(node) {\r\n            var e = Function._validateParams(arguments, [\r\n                { name: \"node\", type: Object, mayBeNull: false }\r\n            ]);\r\n            if (e)\r\n                throw e;\r\n            var nodeXml;\r\n            if (node.xml) { //IE\r\n                nodeXml = node.xml;\r\n            }\r\n            else { //Others\r\n                nodeXml = new XMLSerializer().serializeToString(node);\r\n                if (this.getNodeType(node) == 2) { // Handle special case for attribute node.\r\n                    nodeXml = this.getNodeBaseName(node) + \"=\\\"\" + nodeXml + \"\\\"\";\r\n                }\r\n            }\r\n            return nodeXml;\r\n        }\r\n\r\n        /// <summary>\r\n        /// set node xml\r\n        /// </summary>\r\n        /// <accessibility>public</accessibility>\r\n        /// <param name=\"node\">DOM element object</param>\r\n        /// <param name=\"xml\">xml be set to the node</param>\r\n        /// <returns>new node after the xml set</returns>\r\n        setNodeXml(node, xml) {\r\n            var e = Function._validateParams(arguments, [\r\n                { name: \"node\", type: Object, mayBeNull: false },\r\n                { name: \"xml\", type: String, mayBeNull: false }\r\n            ]);\r\n            if (e)\r\n                throw e;\r\n            var processor = new OSF.XmlProcessor(xml, \"\");\r\n            if (!processor.isValidXml()) {\r\n                return null;\r\n            }\r\n            var newNode = processor.getDocumentElement();\r\n            try {\r\n                node.parentNode.replaceChild(newNode, node);\r\n            }\r\n            catch (ex) {\r\n                return null;\r\n            }\r\n            return newNode;\r\n        }\r\n\r\n        /// <summary>\r\n        /// get node namespaceURI\r\n        /// </summary>\r\n        /// <accessibility>public</accessibility>\r\n        /// <param name=\"node\">DOM element object</param>\r\n        /// <returns>namespaceURI of the node as string</returns>\r\n        getNodeNamespaceURI(node) {\r\n            var e = Function._validateParams(arguments, [\r\n                { name: \"node\", type: Object, mayBeNull: false }\r\n            ]);\r\n            if (e)\r\n                throw e;\r\n            return node.namespaceURI;\r\n        }\r\n\r\n        /// <summary>\r\n        /// get node prefix\r\n        /// </summary>\r\n        /// <accessibility>public</accessibility>\r\n        /// <param name=\"node\">DOM element object</param>\r\n        /// <returns>prefix of the node as string</returns>\r\n        getNodePrefix(node) {\r\n            var e = Function._validateParams(arguments, [\r\n                { name: \"node\", type: Object, mayBeNull: false }\r\n            ]);\r\n            if (e)\r\n                throw e;\r\n            return node.prefix;\r\n        }\r\n\r\n        /// <summary>\r\n        /// get node baseName\r\n        /// </summary>\r\n        /// <accessibility>public</accessibility>\r\n        /// <param name=\"node\">DOM element object</param>\r\n        /// <returns>baseName of the node as string</returns>\r\n        getNodeBaseName(node) {\r\n            var e = Function._validateParams(arguments, [\r\n                { name: \"node\", type: Object, mayBeNull: false }\r\n            ]);\r\n            if (e)\r\n                throw e;\r\n            var nodeBaseName;\r\n            // localName: http://www.w3schools.com/xml/prop_node_localname.asp\r\n            // nodename: http://www.w3schools.com/xml/prop_node_nodename.asp\r\n            // baseName: https://msdn.microsoft.com/en-us/library/ms767570(v=vs.85).aspx\r\n            if (node.nodeType && (node.nodeType == 1 || node.nodeType == 2)) { // For element node and attribute node, use the baseName (IE) or localName (Others)\r\n                if (node.baseName) { //IE\r\n                    nodeBaseName = node.baseName;\r\n                }\r\n                else { //others\r\n                    nodeBaseName = node.localName;\r\n                }\r\n            }\r\n            else { // For other nodetype, use nodeName as the basename\r\n                nodeBaseName = node.nodeName;\r\n            }\r\n            return nodeBaseName;\r\n        }\r\n\r\n        /// <summary>\r\n        /// get node type\r\n        /// </summary>\r\n        /// <accessibility>public</accessibility>\r\n        /// <param name=\"node\">DOM element object</param>\r\n        /// <returns>type of the node as int</returns>\r\n        getNodeType(node) {\r\n            var e = Function._validateParams(arguments, [\r\n                { name: \"node\", type: Object, mayBeNull: false }\r\n            ]);\r\n            if (e)\r\n                throw e;\r\n            return node.nodeType;\r\n        }\r\n\r\n        /// <summary>\r\n        /// append child node with child xml\r\n        /// </summary>\r\n        /// <accessibility>public</accessibility>\r\n        /// <param name=\"node\">DOM element object</param>\r\n        /// <param name=\"childXml\">child xml be appended to the node</param>\r\n        /// <returns>new child node after the xml appended</returns>\r\n        appendChild(node, childXml) {\r\n            var e = Function._validateParams(arguments, [\r\n                { name: \"node\", type: Object, mayBeNull: false },\r\n                { name: \"childXml\", type: String, mayBeNull: false }\r\n            ]);\r\n            if (e)\r\n                throw e;\r\n            var processor = new OSF.XmlProcessor(childXml, \"\");\r\n            if (!processor.isValidXml()) {\r\n                return null;\r\n            }\r\n            var childNode = processor.getDocumentElement();\r\n            node.appendChild(childNode);\r\n            return childNode;\r\n        }\r\n\r\n        /// <summary>\r\n        /// get node value\r\n        /// </summary>\r\n        /// <accessibility>private</accessibility>\r\n        /// <param name=\"attribute\">DOM attribute object</param>\r\n        /// <returns>value of the node as string</returns>\r\n        _getAttributeLocalName(attribute) {\r\n            var localName;\r\n            if (attribute.localName) { //non IE\r\n                localName = attribute.localName;\r\n            }\r\n            else { //IE\r\n                localName = attribute.baseName;\r\n            }\r\n            return localName;\r\n        }\r\n\r\n        /// <summary>\r\n        /// read attributes to fill the object\r\n        /// </summary>\r\n        /// <accessibility>public</accessibility>\r\n        /// <param name=\"node\">DOM element object</param>\r\n        /// <param name=\"attributesToRead\">attributes to read</param>\r\n        /// <param name=\"objectToFill\">object to fill with attribute values</param>\r\n        readAttributes(node, attributesToRead, objectToFill) {\r\n            var e = Function._validateParams(arguments, [\r\n                { name: \"node\", type: Object, mayBeNull: false },\r\n                { name: \"attributesToRead\", type: Object, mayBeNull: false },\r\n                { name: \"objectToFill\", type: Object, mayBeNull: false }\r\n            ]);\r\n            if (e)\r\n                throw e;\r\n            var attribute;\r\n            var localName;\r\n            for (var i = 0; i < node.attributes.length; i++) {\r\n                attribute = node.attributes[i];\r\n                localName = this._getAttributeLocalName(attribute);\r\n                for (var p in attributesToRead) {\r\n                    if (localName === p) {\r\n                        objectToFill[attributesToRead[p]] = attribute.value;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        /// <summary>\r\n        /// Identify whether the xml string passed to the processor is valid\r\n        /// </summary>\r\n        isValidXml() {\r\n            var documentElement = this.getDocumentElement();\r\n            if (documentElement == null) {\r\n                return false;\r\n            }\r\n            else if (this._provider._xmldoc.getElementsByTagName(\"parsererror\").length > 0) {\r\n                var parser = new DOMParser();\r\n                var errorParse = parser.parseFromString('<', 'text/xml');\r\n                var parseErrorNS = errorParse.getElementsByTagName(\"parsererror\")[0].namespaceURI;\r\n                return this._provider._xmldoc.getElementsByTagNameNS(parseErrorNS, 'parsererror').length <= 0;\r\n            }\r\n            return true;\r\n        }\r\n    }\r\n}","namespace OSF {\r\n    export enum AppName {\r\n        Unsupported = 0,\r\n        Excel = 1,\r\n        Word = 2,\r\n        PowerPoint = 4,\r\n        Outlook = 8,\r\n        ExcelWebApp = 16,\r\n        WordWebApp = 32,\r\n        OutlookWebApp = 64,\r\n        Project = 128,\r\n        AccessWebApp = 256,\r\n        PowerpointWebApp = 512,\r\n        ExcelIOS = 1024,\r\n        Sway = 2048,\r\n        WordIOS = 4096,\r\n        PowerPointIOS = 8192,\r\n        Access = 16384,\r\n        Lync = 32768,\r\n        OutlookIOS = 65536,\r\n        OneNoteWebApp = 131072,\r\n        OneNote = 262144,\r\n        ExcelWinRT = 524288,\r\n        WordWinRT = 1048576,\r\n        PowerpointWinRT = 2097152,\r\n        OutlookAndroid = 4194304,\r\n        OneNoteWinRT = 8388608,\r\n        ExcelAndroid = 8388609,\r\n        VisioWebApp = 8388610,\r\n        OneNoteIOS = 8388611,\r\n        WordAndroid = 8388613,\r\n        PowerpointAndroid = 8388614,\r\n        Visio = 8388615,\r\n        OneNoteAndroid = 4194305\r\n    }\r\n}","var DEBUG = true;","namespace OSF {\r\n    export enum OsfNavigationMode {\r\n        DefaultMode = 0,\r\n        CategoryMode = 1,\r\n        TrustPageMode = 2,\r\n        QueryResultMode = 3\r\n    }\r\n    export let ManifestNamespaces = {\r\n        \"1.0\": 'xmlns=\"http://schemas.microsoft.com/office/appforoffice/1.0\" xmlns:o=\"http://schemas.microsoft.com/office/appforoffice/1.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"',\r\n        \"1.1\": 'xmlns=\"http://schemas.microsoft.com/office/appforoffice/1.1\" xmlns:o=\"http://schemas.microsoft.com/office/appforoffice/1.1\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:bt=\"http://schemas.microsoft.com/office/officeappbasictypes/1.0\" xmlns:ov=\"http://schemas.microsoft.com/office/taskpaneappversionoverrides\" xmlns:c=\"http://schemas.microsoft.com/office/contentappversionoverrides\" xmlns:mailappor=\"http://schemas.microsoft.com/office/mailappversionoverrides\"'\r\n    };\r\n    export let ManifestSchemaVersion = {\r\n        \"1.0\": \"1.0\",\r\n        \"1.1\": \"1.1\"\r\n    };\r\n    export class RequirementsChecker {\r\n        _filteringEnabled: any;\r\n        _supportedCapabilities: any;\r\n        _supportedControlTargets: any;\r\n        _supportedHosts: any;\r\n        _supportedMethods: any;\r\n        _supportedOmexAppVersions: any;\r\n        _supportedSets: any;\r\n        defaultMinMaxVersion: string = \"1.1\";\r\n        constructor(supportedCapabilities, supportedHosts, supportedRequirements, supportedControlTargets, supportedOmexAppVersions) {\r\n            this.setCapabilities(supportedCapabilities);\r\n            this.setHosts(supportedHosts);\r\n            this.setRequirements(supportedRequirements);\r\n            this.setSupportedControlTargets(supportedControlTargets);\r\n            this.setSupportedOmexAppVersions(supportedOmexAppVersions);\r\n            // Filtering is disabled by default\r\n            this.setFilteringEnabled(false);\r\n        }\r\n\r\n        isManifestSupported(manifest) {\r\n            if (!this.isFilteringEnabled()) {\r\n                return true;\r\n            }\r\n            if (!manifest) {\r\n                return false;\r\n            }\r\n            var manifestSchemaVersion = manifest.getManifestSchemaVersion() || OSF.ManifestSchemaVersion[\"1.0\"];\r\n            switch (manifestSchemaVersion) {\r\n                case OSF.ManifestSchemaVersion[\"1.0\"]:\r\n                    return this._checkManifest1_0(manifest);\r\n                case OSF.ManifestSchemaVersion[\"1.1\"]:\r\n                    return this._checkManifest1_1(manifest);\r\n                default:\r\n                    // Unknown manifest version\r\n                    // Shouldn't happen, but for consistency\r\n                    return false;\r\n            }\r\n        }\r\n\r\n        isEntitlementFromOmexSupported(entitlement : OfficeExt.AppDetail) {\r\n            if (!this.isFilteringEnabled()) {\r\n                return true;\r\n            }\r\n            if (!entitlement) {\r\n                return false;\r\n            }\r\n            var targetType;\r\n            switch (entitlement.appSubType) {\r\n                case \"1\":\r\n                    targetType = OSF.OsfControlTarget.TaskPane;\r\n                    break;\r\n                case \"2\":\r\n                    targetType = OSF.OsfControlTarget.InContent;\r\n                    break;\r\n                case \"3\":\r\n                    targetType = OSF.OsfControlTarget.Contextual;\r\n                    break;\r\n                case \"4\":\r\n                    targetType = OSF.OsfControlTarget.TaskPane;\r\n                    break;\r\n                default:\r\n                    // Unknown or unsupported targetType\r\n                    return false;\r\n            }\r\n            if (!this._checkControlTarget(targetType)) {\r\n                return false;\r\n            }\r\n            // Neither requirements nor hosts are mentioned by agave.\r\n            // It could either be a 1.0 agave, or wants to activate everywhere.\r\n            // We'll trust OMEX in this case, and if appvers is in our list, return true.\r\n            if (!entitlement.requirements && !entitlement.hosts) {\r\n                // If there's no appvers list we trust the provider to only have returned relevent apps.\r\n                if (!entitlement.hasOwnProperty(\"appVersions\") || entitlement.appVersions === undefined) {\r\n                    return true;\r\n                }\r\n                return this._checkOmexAppVersions(entitlement.appVersions);\r\n            }\r\n            // Parse requirements and hosts\r\n            // @ts-expect-error TS2554\r\n            var pseudoParser = new OSF.Manifest.Manifest(function () { });\r\n            var requirements, requirementsNode, hosts, hostsNode;\r\n            if (entitlement.requirements) {\r\n                pseudoParser._xmlProcessor = new OSF.XmlProcessor(entitlement.requirements, OSF.ManifestNamespaces[\"1.1\"]);\r\n                requirementsNode = pseudoParser._xmlProcessor.getDocumentElement();\r\n            }\r\n            requirements = pseudoParser._parseRequirements(requirementsNode);\r\n            if (entitlement.hosts) {\r\n                pseudoParser._xmlProcessor = new OSF.XmlProcessor(entitlement.hosts, OSF.ManifestNamespaces[\"1.1\"]);\r\n                hostsNode = pseudoParser._xmlProcessor.getDocumentElement();\r\n            }\r\n            hosts = pseudoParser._parseHosts(hostsNode);\r\n            return this._checkHosts(hosts) &&\r\n                this._checkSets(requirements.sets) &&\r\n                this._checkMethods(requirements.methods);\r\n        }\r\n        isEntitlementFromCorpCatalogSupported(entitlement) {\r\n            if (!this.isFilteringEnabled()) {\r\n                return true;\r\n            }\r\n            if (!entitlement) {\r\n                return false;\r\n            }\r\n            var targetType = OSF.OfficeAppType[entitlement.OEType];\r\n            if (!this._checkControlTarget(targetType)) {\r\n                return false;\r\n            }\r\n            // @ts-expect-error TS2554\r\n            var pseudoParser = new OSF.Manifest.Manifest(function () {\r\n            });\r\n            var hosts, sets, methods;\r\n            if (entitlement.OfficeExtensionCapabilitiesXML) {\r\n                pseudoParser._xmlProcessor = new OSF.XmlProcessor(entitlement.OfficeExtensionCapabilitiesXML, OSF.ManifestNamespaces[\"1.1\"]);\r\n                var xmlNode, requirements;\r\n                xmlNode = pseudoParser._xmlProcessor.getDocumentElement();\r\n                requirements = pseudoParser._parseRequirements(xmlNode);\r\n                sets = requirements.sets;\r\n                methods = requirements.methods;\r\n                hosts = pseudoParser._parseHosts(xmlNode);\r\n            }\r\n            return this._checkHosts(hosts) && this._checkSets(sets) && this._checkMethods(methods);\r\n        }\r\n        setCapabilities(capabilities) {\r\n            this._supportedCapabilities = this._scalarArrayToObject(capabilities);\r\n        }\r\n        setHosts(hosts) {\r\n            this._supportedHosts = this._scalarArrayToObject(hosts);\r\n        }\r\n        setRequirements(requirements) {\r\n            this._supportedSets = requirements && this._arrayToSetsObject(requirements.sets) || {};\r\n            this._supportedMethods = requirements && this._scalarArrayToObject(requirements.methods) || {};\r\n        }\r\n        setSupportedControlTargets(controlTargets) {\r\n            this._supportedControlTargets = this._scalarArrayToObject(controlTargets);\r\n        }\r\n        setSupportedOmexAppVersions(appVersions) {\r\n            this._supportedOmexAppVersions = appVersions && appVersions.slice ? appVersions.slice(0) : [];\r\n        }\r\n        setFilteringEnabled(filteringEnabled) {\r\n            this._filteringEnabled = filteringEnabled ? true : false;\r\n        }\r\n        isFilteringEnabled() {\r\n            return this._filteringEnabled;\r\n        }\r\n        _checkManifest1_0(manifest) {\r\n            return this._checkCapabilities(manifest.getCapabilities());\r\n        }\r\n        _checkCapabilities(askedCapabilities) {\r\n            if (!askedCapabilities || askedCapabilities.length === 0) {\r\n                return true;\r\n            }\r\n            for (var i = 0; i < askedCapabilities.length; i++) {\r\n                if (this._supportedCapabilities[askedCapabilities[i]]) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n        _checkManifest1_1(manifest) {\r\n            var askedRequirements = manifest.getRequirements() || {};\r\n            return this._checkHosts(manifest.getHosts()) &&\r\n                this._checkSets(askedRequirements.sets) &&\r\n                this._checkMethods(askedRequirements.methods);\r\n        }\r\n        _checkHosts(askedHosts) {\r\n            if (!askedHosts || askedHosts.length === 0) {\r\n                return true;\r\n            }\r\n            for (var i = 0; i < askedHosts.length; i++) {\r\n                if (this._supportedHosts[askedHosts[i]]) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n        _checkSets(askedSets) {\r\n            if (!askedSets || askedSets.length === 0) {\r\n                return true;\r\n            }\r\n            for (var i = 0; i < askedSets.length; i++) {\r\n                var askedSet = askedSets[i];\r\n                var supportedSet = this._supportedSets[askedSet.name.toLowerCase()];\r\n                if (!supportedSet) {\r\n                    return false;\r\n                }\r\n                if (askedSet.version) {\r\n                    if (this._compareVersionStrings(supportedSet.minVersion || this.defaultMinMaxVersion, askedSet.version) > 0 ||\r\n                        this._compareVersionStrings(supportedSet.maxVersion || this.defaultMinMaxVersion, askedSet.version) < 0) {\r\n                        return false;\r\n                    }\r\n                }\r\n            }\r\n            return true;\r\n        }\r\n        _checkMethods(askedMethods) {\r\n            if (!askedMethods || askedMethods.length === 0) {\r\n                return true;\r\n            }\r\n            for (var i = 0; i < askedMethods.length; i++) {\r\n                if (!this._supportedMethods[askedMethods[i]]) {\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        }\r\n        _checkControlTarget(askedControlTarget) {\r\n            // If we can't parse app type (askedAppType is null/undefined), we can't allow insertion\r\n            return askedControlTarget != undefined && this._supportedControlTargets[askedControlTarget];\r\n        }\r\n        _checkOmexAppVersions(askedAppVersions) {\r\n            if (!askedAppVersions) {\r\n                return false;\r\n            }\r\n            for (var i = 0; i < this._supportedOmexAppVersions.length; i++) {\r\n                if (askedAppVersions.indexOf(this._supportedOmexAppVersions[i]) >= 0) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n        _scalarArrayToObject(array) {\r\n            var obj = {};\r\n            if (array && array.length) {\r\n                for (var i = 0; i < array.length; i++) {\r\n                    if (array[i] != undefined) {\r\n                        obj[array[i]] = true;\r\n                    }\r\n                }\r\n            }\r\n            return obj;\r\n        }\r\n        _arrayToSetsObject(array) {\r\n            var obj = {};\r\n            if (array && array.length) {\r\n                for (var i = 0; i < array.length; i++) {\r\n                    var set = array[i];\r\n                    if (set && set.name != undefined) {\r\n                        obj[set.name.toLowerCase()] = set; // toLower so we do case insensitive check\r\n                    }\r\n                }\r\n            }\r\n            return obj;\r\n        }\r\n        _getSupportedSet() {\r\n            var obj = {};\r\n            var supportSetNames = Object.getOwnPropertyNames(this._supportedSets);\r\n            for (var i = 0; i < supportSetNames.length; i++) {\r\n                var supportedSet = this._supportedSets[supportSetNames[i]];\r\n                obj[supportedSet.name.toLowerCase()] = supportedSet.maxVersion || this.defaultMinMaxVersion;\r\n            }\r\n            if (typeof (JSON) !== \"undefined\") {\r\n                return JSON.stringify(obj);\r\n            }\r\n            return obj;\r\n        }\r\n        _getSupportedSetAsCapabilities() {\r\n            return Object.getOwnPropertyNames(this._supportedSets).map(name => {\r\n                const supportedSet = this._supportedSets[name];\r\n                return ({ Name: supportedSet.name.toLowerCase(), Version: supportedSet.maxVersion || this.defaultMinMaxVersion });\r\n            });\r\n        }\r\n        _compareVersionStrings(leftVersion, rightVersion) {\r\n            leftVersion = leftVersion.split('.');\r\n            rightVersion = rightVersion.split('.');\r\n            var maxComponentCount = Math.max(leftVersion.length, rightVersion.length);\r\n            for (var i = 0; i < maxComponentCount; i++) {\r\n                var leftInt = parseInt(leftVersion[i], 10) || 0, rightInt = parseInt(rightVersion[i], 10) || 0;\r\n                if (leftInt === rightInt) {\r\n                    continue;\r\n                }\r\n                return leftInt - rightInt;\r\n            }\r\n            return 0;\r\n        }\r\n    }\r\n}","/*************************************************************\r\n  Copyright (c) 2013 Microsoft Corporation\r\n**************************************************************/\r\n// NOTE: For compilation, %target%\\usage\\TypeScriptUsageTypes.ts is needed. Include it before this file.\r\n//       It is generated from otools/osfclient/inc/UsageSchema.xml, and contains the declaration for OSFLog.\r\n// ambient declaration for ULS module\r\ndeclare var Diag;\r\n// ambient declaration\r\nmodule Telemetry {\r\n    \"use strict\";\r\n    export enum ULSTraceLevel {\r\n        unexpected = 10,\r\n        warning = 15,\r\n        info = 50,\r\n        verbose = 100,\r\n        verboseEx = 200\r\n    }\r\n    export enum ULSCat {\r\n        msoulscat_Osf_Latency = 1401,\r\n        msoulscat_Osf_Notification = 1402,\r\n        msoulscat_Osf_Runtime = 1403,\r\n        msoulscat_Osf_AppManagementMenu = 1404,\r\n        msoulscat_Osf_InsertionDialogSession = 1405,\r\n        msoulscat_Osf_UploadFileDevCatelog = 1406,\r\n        msoulscat_Osf_UploadFileDevCatalogUsage = 1411\r\n    }\r\n    /// <summary>\r\n    /// Bit masks for telemetry flags\r\n    /// </summary>\r\n    enum AppManagementMenuFlags {\r\n        ConfirmationDialogCancel = 0x100,\r\n        InsertionDialogClosed = 0x200,\r\n        IsAnonymous = 0x400\r\n    }\r\n    enum InsertionDialogStateFlags {\r\n        Undefined = 0x0,\r\n        Inserted = 0x1,\r\n        Canceled = 0x2,\r\n        Closed = 0x3,\r\n        TrustPageVisited = 0x8\r\n    }\r\n    export class LatencyStopwatch {\r\n        private timeValue: number = 0;\r\n        private finishedMeasurement: boolean;\r\n        constructor() {\r\n        }\r\n        public Start() {\r\n            this.timeValue = -(new Date().getTime());\r\n            this.finishedMeasurement = false;\r\n        }\r\n        public Stop() {\r\n            if (this.timeValue < 0) {\r\n                this.timeValue += (new Date().getTime());\r\n                this.finishedMeasurement = true;\r\n            }\r\n        }\r\n        public get Finished(): boolean {\r\n            return this.finishedMeasurement;\r\n        }\r\n        /// <summary>\r\n        /// This returns the current elapsed time for the stopwatch.  If the timer has completed, this will\r\n        /// be a positive value representing milliseconds that the timer was active.  If the timer has not called Stop()\r\n        /// then a negative value will be returned, representing the time since the timer was started.\r\n        /// </summary>\r\n        public get ElapsedTime(): number {\r\n            var elapsedTime = this.timeValue;\r\n            if (!this.Finished && elapsedTime < 0) {\r\n                // If time measurement has no finished yet, return a negative value indicating elapsed time\r\n                elapsedTime = Math.abs(elapsedTime) - (new Date().getTime());\r\n            }\r\n            return elapsedTime;\r\n        }\r\n    }\r\n    export class Context {\r\n        LoadTime: OSFLog.AppLoadTimeUsageData;\r\n        Timers: {\r\n            [name: string]: LatencyStopwatch;\r\n        };\r\n        AppStatus: string;\r\n        ActivationRuntimeType: number;\r\n    }\r\n    export class Logger {\r\n        private static s_externalLogger: any = null;\r\n        static SetExternalLogger(extLogger: any) {\r\n            Logger.s_externalLogger = extLogger;\r\n        }\r\n\r\n        static SendULSTraceTag(category: number, level: number, data: string, tagId: number) {\r\n            // Check if ULS is enabled or not\r\n            // @ts-ignore TS2339\r\n            if (!Microsoft.Office.WebExtension.FULSSupported) {\r\n                return;\r\n            }\r\n            // Try to use default ULS logger, then use the provided external logger  \r\n            if ((<any>window).Diag && Diag.UULS && Diag.UULS.trace) {\r\n                Diag.UULS.trace(tagId, category, level, data);\r\n            }\r\n            else if (Logger.s_externalLogger && Logger.s_externalLogger.sendTraceTag) {\r\n                Logger.s_externalLogger.sendTraceTag(tagId, category, level, data);\r\n            }\r\n        }\r\n    }\r\n    export class NotificationLogger implements OSFLog.IUsageLogger {\r\n        private static instance: NotificationLogger;\r\n        private static category: number = ULSCat.msoulscat_Osf_Notification;\r\n        private static level: number = ULSTraceLevel.info;\r\n        constructor() {\r\n        }\r\n        public static Instance(): NotificationLogger {\r\n            if (!NotificationLogger.instance) {\r\n                NotificationLogger.instance = new NotificationLogger();\r\n            }\r\n            return NotificationLogger.instance;\r\n        }\r\n        public LogData(data: OSFLog.IUsageData) {\r\n            // Preserve current tag from osfclient, telemetry scripts depend on this tag\r\n            // ASSERTTAG_IGNORE_START\r\n            Logger.SendULSTraceTag(NotificationLogger.category, NotificationLogger.level, data.SerializeRow(), 0x005c815f /* tag_axif5 */);\r\n            // ASSERTTAG_IGNORE_FINISH\r\n        }\r\n    }\r\n    export class AppManagementMenuLogger implements OSFLog.IUsageLogger {\r\n        private static instance: AppManagementMenuLogger;\r\n        private static category: number = ULSCat.msoulscat_Osf_AppManagementMenu;\r\n        private static level: number = ULSTraceLevel.info;\r\n        constructor() {\r\n        }\r\n        public static Instance(): NotificationLogger {\r\n            if (!AppManagementMenuLogger.instance) {\r\n                AppManagementMenuLogger.instance = new AppManagementMenuLogger();\r\n            }\r\n            return AppManagementMenuLogger.instance;\r\n        }\r\n        public LogData(data: OSFLog.IUsageData) {\r\n            Logger.SendULSTraceTag(AppManagementMenuLogger.category, AppManagementMenuLogger.level, data.SerializeRow(), 0x1f31d7e1 /* tag_5m357 */);\r\n        }\r\n    }\r\n    export class UploadFileDevCatelogLogger implements OSFLog.IUsageLogger {\r\n        private static instance: UploadFileDevCatelogLogger;\r\n        private static category: number = ULSCat.msoulscat_Osf_UploadFileDevCatelog;\r\n        private static level: number = ULSTraceLevel.info;\r\n        constructor() {\r\n        }\r\n        public static Instance(): UploadFileDevCatelogLogger {\r\n            if (!UploadFileDevCatelogLogger.instance) {\r\n                UploadFileDevCatelogLogger.instance = new UploadFileDevCatelogLogger();\r\n            }\r\n            return UploadFileDevCatelogLogger.instance;\r\n        }\r\n        public LogData(data: OSFLog.IUsageData) {\r\n            Logger.SendULSTraceTag(UploadFileDevCatelogLogger.category, UploadFileDevCatelogLogger.level, data.SerializeRow(), 0x1f31d7e2 /* tag_5m358 */);\r\n        }\r\n    }\r\n    export class UploadFileDevCatalogUsageLogger implements OSFLog.IUsageLogger {\r\n        private static instance: UploadFileDevCatalogUsageLogger;\r\n        private static category: number = ULSCat.msoulscat_Osf_UploadFileDevCatalogUsage;\r\n        private static level: number = ULSTraceLevel.info;\r\n        constructor() {\r\n        }\r\n        public static Instance(): UploadFileDevCatalogUsageLogger {\r\n            if (!UploadFileDevCatalogUsageLogger.instance) {\r\n                UploadFileDevCatalogUsageLogger.instance = new UploadFileDevCatalogUsageLogger();\r\n            }\r\n            return UploadFileDevCatalogUsageLogger.instance;\r\n        }\r\n        public LogData(data: OSFLog.IUsageData) {\r\n            Logger.SendULSTraceTag(UploadFileDevCatalogUsageLogger.category, UploadFileDevCatalogUsageLogger.level, data.SerializeRow(), 0x1f31d7e3 /* tag_5m359 */);\r\n        }\r\n    }\r\n    export class LatencyLogger implements OSFLog.IUsageLogger {\r\n        private static instance: LatencyLogger;\r\n        private static category: number = ULSCat.msoulscat_Osf_Latency;\r\n        private static level: number = ULSTraceLevel.info;\r\n        constructor() {\r\n        }\r\n        public static Instance(): LatencyLogger {\r\n            if (!LatencyLogger.instance) {\r\n                LatencyLogger.instance = new LatencyLogger();\r\n            }\r\n            return LatencyLogger.instance;\r\n        }\r\n        public LogData(data: OSFLog.IUsageData) {\r\n            // Preserve current tag from osfclient, telemetry scripts depend on this tag\r\n            // ASSERTTAG_IGNORE_START\r\n            Logger.SendULSTraceTag(LatencyLogger.category, LatencyLogger.level, data.SerializeRow(), 0x00487317 /* tag_ashmx */);\r\n            // ASSERTTAG_IGNORE_FINISH\r\n        }\r\n    }\r\n    export class InsertionDialogSessionLogger implements OSFLog.IUsageLogger {\r\n        private static instance: InsertionDialogSessionLogger;\r\n        private static category: number = ULSCat.msoulscat_Osf_InsertionDialogSession;\r\n        private static level: number = ULSTraceLevel.info;\r\n        constructor() {\r\n        }\r\n        public static Instance(): InsertionDialogSessionLogger {\r\n            if (!InsertionDialogSessionLogger.instance) {\r\n                InsertionDialogSessionLogger.instance = new InsertionDialogSessionLogger();\r\n            }\r\n            return InsertionDialogSessionLogger.instance;\r\n        }\r\n        public LogData(data: OSFLog.IUsageData) {\r\n            Logger.SendULSTraceTag(InsertionDialogSessionLogger.category, InsertionDialogSessionLogger.level, data.SerializeRow(), 0x1f31d800 /* tag_5m36a */);\r\n        }\r\n    }\r\n    export class AppNotificationHelper {\r\n        public static LogNotification(correlationId: string, errorResult: number, notificationClickInfo: number) {\r\n            var notificationData = new OSFLog.AppNotificationUsageData();\r\n            notificationData.CorrelationId = correlationId;\r\n            notificationData.ErrorResult = errorResult;\r\n            notificationData.NotificationClickInfo = notificationClickInfo;\r\n            NotificationLogger.Instance().LogData(notificationData);\r\n        }\r\n    }\r\n    export class AppManagementMenuHelper {\r\n        public static LogAppManagementMenuAction(assetId: string, operationMetadata: number, untrustedCount: number, isDialogClosed: boolean, isAnonymous: boolean, hrStatus: number) {\r\n            var appManagementMenuData = new OSFLog.AppManagementMenuUsageData();\r\n            var assetIdNumber = assetId.toLowerCase().indexOf(\"wa\") === 0 ? parseInt(assetId.substring(2), 10) : parseInt(assetId, 10);\r\n            if (isDialogClosed) {\r\n                operationMetadata |= AppManagementMenuFlags.InsertionDialogClosed;\r\n            }\r\n            if (isAnonymous) {\r\n                operationMetadata |= AppManagementMenuFlags.IsAnonymous;\r\n            }\r\n            appManagementMenuData.AssetId = assetIdNumber;\r\n            appManagementMenuData.OperationMetadata = operationMetadata;\r\n            appManagementMenuData.ErrorResult = hrStatus;\r\n            AppManagementMenuLogger.Instance().LogData(appManagementMenuData);\r\n        }\r\n    }\r\n    export class UploadFileDevCatelogHelper {\r\n        public static LogUploadFileDevCatelogAction(correlationId: string, operationMetadata: number, untrustedCount: number, isDialogClosed: boolean, isAnonymous: boolean, hrStatus: number) {\r\n            var uploadFileDevCatelogData = new OSFLog.UploadFileDevCatelogUsageData();\r\n            uploadFileDevCatelogData.CorrelationId = correlationId;\r\n            uploadFileDevCatelogData.OperationMetadata = operationMetadata;\r\n            uploadFileDevCatelogData.ErrorResult = hrStatus;\r\n            UploadFileDevCatelogLogger.Instance().LogData(uploadFileDevCatelogData);\r\n        }\r\n    }\r\n    export class UploadFileDevCatalogUsageHelper {\r\n        public static LogUploadFileDevCatalogUsageAction(correlationId: string, storeType: string, id: string, appVersion: string, appTargetType: number, isAppCommand: string, appSizeWidth: number, appSizeHeight: number) {\r\n            var uploadFileDevCatalogUsageData = new OSFLog.UploadFileDevCatalogUsageUsageData();\r\n            uploadFileDevCatalogUsageData.CorrelationId = correlationId;\r\n            uploadFileDevCatalogUsageData.StoreType = storeType;\r\n            uploadFileDevCatalogUsageData.AppId = id;\r\n            uploadFileDevCatalogUsageData.AppVersion = appVersion;\r\n            uploadFileDevCatalogUsageData.AppTargetType = appTargetType;\r\n            uploadFileDevCatalogUsageData.IsAppCommand = isAppCommand;\r\n            uploadFileDevCatalogUsageData.AppSizeWidth = appSizeWidth;\r\n            uploadFileDevCatalogUsageData.AppSizeHeight = appSizeHeight;\r\n            UploadFileDevCatalogUsageLogger.Instance().LogData(uploadFileDevCatalogUsageData);\r\n        }\r\n    }\r\n    export class AppLoadTimeHelper {\r\n        // Number of apps being activated simultaneously\r\n        private static activatingNumber: number = 0;\r\n        private static GenerateActivationMessage(activationRuntimeType: number, correlationId: string): string {\r\n            var message: string = \"\";\r\n            if (activationRuntimeType != null) {\r\n                message += \"ActivationRuntimeType: \" + activationRuntimeType.toString() + \"|\";\r\n            }\r\n            if (correlationId != null) {\r\n                message += \"CorrelationId: \" + correlationId;\r\n            }\r\n            return message;\r\n        }\r\n        public static ActivationStart(context: Context, appInfo: number, assetId: number, correlationId: string, instanceId: string, runtimeType: number) {\r\n            AppLoadTimeHelper.activatingNumber++;\r\n            context.LoadTime = new OSFLog.AppLoadTimeUsageData();\r\n            context.Timers = {};\r\n            context.LoadTime.CorrelationId = correlationId;\r\n            context.LoadTime.AppInfo = appInfo;\r\n            context.LoadTime.ActivationInfo = 0;\r\n            context.LoadTime.InstanceId = instanceId;\r\n            context.LoadTime.AssetId = assetId;\r\n            context.LoadTime.Stage1Time = 0;\r\n            context.Timers[\"Stage1Time\"] = new LatencyStopwatch();\r\n            context.LoadTime.Stage2Time = 0;\r\n            context.Timers[\"Stage2Time\"] = new LatencyStopwatch();\r\n            // sandbox creatation time isn't logged on WAC\r\n            context.LoadTime.Stage3Time = 0;\r\n            context.LoadTime.Stage4Time = 0;\r\n            context.Timers[\"Stage4Time\"] = new LatencyStopwatch();\r\n            context.LoadTime.Stage5Time = 0;\r\n            context.Timers[\"Stage5Time\"] = new LatencyStopwatch();\r\n            context.LoadTime.Stage6Time = AppLoadTimeHelper.activatingNumber;\r\n            context.LoadTime.Stage7Time = 0;\r\n            context.Timers[\"Stage7Time\"] = new LatencyStopwatch();\r\n            context.LoadTime.Stage8Time = 0;\r\n            context.Timers[\"Stage8Time\"] = new LatencyStopwatch();\r\n            context.LoadTime.Stage9Time = 0;\r\n            context.Timers[\"Stage9Time\"] = new LatencyStopwatch();\r\n            context.LoadTime.Stage10Time = 0;\r\n            context.Timers[\"Stage10Time\"] = new LatencyStopwatch();\r\n            context.LoadTime.Stage11Time = 0;\r\n            context.Timers[\"Stage11Time\"] = new LatencyStopwatch();\r\n            context.LoadTime.ErrorResult = 0;\r\n            context.ActivationRuntimeType = runtimeType;\r\n            AppLoadTimeHelper.StartStopwatch(context, \"Stage1Time\");\r\n            Logger.SendULSTraceTag(ULSCat.msoulscat_Osf_Runtime, ULSTraceLevel.info, AppLoadTimeHelper.GenerateActivationMessage(runtimeType, correlationId), 0x1f31d801 /* tag_5m36b */);\r\n        }\r\n        public static ActivationEnd(context: Context) {\r\n            AppLoadTimeHelper.ActivateEndInternal(context);\r\n        }\r\n        public static PageStart(context: Context) {\r\n            AppLoadTimeHelper.StartStopwatch(context, \"Stage2Time\");\r\n        }\r\n        public static PageLoaded(context: Context) {\r\n            AppLoadTimeHelper.StopStopwatch(context, \"Stage2Time\");\r\n        }\r\n        public static ServerCallStart(context: Context) {\r\n            AppLoadTimeHelper.StartStopwatch(context, \"Stage4Time\");\r\n        }\r\n        public static ServerCallEnd(context: Context) {\r\n            AppLoadTimeHelper.StopStopwatch(context, \"Stage4Time\");\r\n        }\r\n        public static AuthenticationStart(context: Context) {\r\n            AppLoadTimeHelper.StartStopwatch(context, \"Stage5Time\");\r\n        }\r\n        public static AuthenticationEnd(context: Context) {\r\n            AppLoadTimeHelper.StopStopwatch(context, \"Stage5Time\");\r\n        }\r\n        public static EntitlementCheckStart(context: Context) {\r\n            AppLoadTimeHelper.StartStopwatch(context, \"Stage7Time\");\r\n        }\r\n        public static EntitlementCheckEnd(context: Context) {\r\n            AppLoadTimeHelper.StopStopwatch(context, \"Stage7Time\");\r\n        }\r\n        public static KilledAppsCheckStart(context: Context) {\r\n            AppLoadTimeHelper.StartStopwatch(context, \"Stage8Time\");\r\n        }\r\n        public static KilledAppsCheckEnd(context: Context) {\r\n            AppLoadTimeHelper.StopStopwatch(context, \"Stage8Time\");\r\n        }\r\n        public static AppStateCheckStart(context: Context) {\r\n            AppLoadTimeHelper.StartStopwatch(context, \"Stage9Time\");\r\n        }\r\n        public static AppStateCheckEnd(context: Context) {\r\n            AppLoadTimeHelper.StopStopwatch(context, \"Stage9Time\");\r\n        }\r\n        public static ManifestRequestStart(context: Context) {\r\n            AppLoadTimeHelper.StartStopwatch(context, \"Stage10Time\");\r\n        }\r\n        public static ManifestRequestEnd(context: Context) {\r\n            AppLoadTimeHelper.StopStopwatch(context, \"Stage10Time\");\r\n        }\r\n        public static OfficeJSStartToLoad(context: Context) {\r\n            AppLoadTimeHelper.StartStopwatch(context, \"Stage11Time\");\r\n        }\r\n        public static OfficeJSLoaded(context: Context) {\r\n            AppLoadTimeHelper.StopStopwatch(context, \"Stage11Time\");\r\n        }\r\n        public static SetAnonymousFlag(context: Context, anonymousFlag: boolean) {\r\n            AppLoadTimeHelper.SetActivationInfoField(context, AppLoadTimeHelper.ConvertFlagToBit(anonymousFlag), 2, 0);\r\n        }\r\n        public static SetRetryCount(context: Context, retryCount: number) {\r\n            AppLoadTimeHelper.SetActivationInfoField(context, retryCount, 3, 2);\r\n        }\r\n        public static SetManifestTrustCachedFlag(context: Context, manifestTrustCachedFlag: boolean) {\r\n            AppLoadTimeHelper.SetActivationInfoField(context, AppLoadTimeHelper.ConvertFlagToBit(manifestTrustCachedFlag), 2, 5);\r\n        }\r\n        public static SetManifestDataCachedFlag(context: Context, manifestDataCachedFlag: boolean) {\r\n            AppLoadTimeHelper.SetActivationInfoField(context, AppLoadTimeHelper.ConvertFlagToBit(manifestDataCachedFlag), 2, 7);\r\n        }\r\n        public static SetOmexHasEntitlementFlag(context: Context, omexHasEntitlementFlag: boolean) {\r\n            AppLoadTimeHelper.SetActivationInfoField(context, AppLoadTimeHelper.ConvertFlagToBit(omexHasEntitlementFlag), 2, 9);\r\n        }\r\n        public static SetManifestDataInvalidFlag(context: Context, manifestDataInvalidFlag: boolean) {\r\n            AppLoadTimeHelper.SetActivationInfoField(context, AppLoadTimeHelper.ConvertFlagToBit(manifestDataInvalidFlag), 2, 11);\r\n        }\r\n        public static SetAppStateDataCachedFlag(context: Context, appStateDataCachedFlag: boolean) {\r\n            AppLoadTimeHelper.SetActivationInfoField(context, AppLoadTimeHelper.ConvertFlagToBit(appStateDataCachedFlag), 2, 13);\r\n        }\r\n        public static SetAppStateDataInvalidFlag(context: Context, appStateDataInvalidFlag: boolean) {\r\n            AppLoadTimeHelper.SetActivationInfoField(context, AppLoadTimeHelper.ConvertFlagToBit(appStateDataInvalidFlag), 2, 15);\r\n        }\r\n        public static SetActivationRuntimeType(context: Context, activationRuntimeType: number) {\r\n            AppLoadTimeHelper.SetActivationInfoField(context, activationRuntimeType, 2, 17);\r\n        }\r\n        public static SetErrorResult(context: Context, result: number) {\r\n            if (context.LoadTime) {\r\n                context.LoadTime.ErrorResult = result;\r\n                AppLoadTimeHelper.ActivateEndInternal(context);\r\n            }\r\n        }\r\n        public static SetBit(context: Context, value: number, offset: number, length?: number) {\r\n            AppLoadTimeHelper.SetActivationInfoField(context, value, length || 2, offset);\r\n        }\r\n        public static StartStopwatch(context: Context, name: string) {\r\n            if (context.LoadTime && context.Timers && context.Timers[name]) {\r\n                context.Timers[name].Start();\r\n                AppLoadTimeHelper.UpdateActivatingNumber(context);\r\n            }\r\n        }\r\n        public static StopStopwatch(context: Context, name: string) {\r\n            if (context.LoadTime && context.Timers && context.Timers[name]) {\r\n                context.Timers[name].Stop();\r\n                AppLoadTimeHelper.UpdateActivatingNumber(context);\r\n            }\r\n        }\r\n        /// <summary>\r\n        /// Returns 2 if true, or 1 if false.  0 Represents the value where we have not set the field yet.\r\n        /// </summary>\r\n        private static ConvertFlagToBit(flag: boolean): number {\r\n            if (flag) {\r\n                return 2;\r\n            }\r\n            else {\r\n                return 1;\r\n            }\r\n        }\r\n        private static SetActivationInfoField(context: Context, value: number, length: number, offset: number) {\r\n            if (context.LoadTime) {\r\n                AppLoadTimeHelper.UpdateActivatingNumber(context);\r\n                context.LoadTime.ActivationInfo = AppLoadTimeHelper.SetBitField(context.LoadTime.ActivationInfo, value, length, offset);\r\n            }\r\n        }\r\n        private static SetBitField(field: number, value: number, length: number, offset: number): number {\r\n            var mask = (Math.pow(2, length) - 1) << offset;\r\n            // Set the field bits to 0 in case the value was previously set\r\n            var cleanField = field & ~mask;\r\n            return cleanField | (value << offset);\r\n        }\r\n        private static UpdateActivatingNumber(context: Context) {\r\n            if (context.LoadTime) {\r\n                // To simplify the logical, just keep maximum number\r\n                context.LoadTime.Stage6Time = (context.LoadTime.Stage6Time > AppLoadTimeHelper.activatingNumber) ? context.LoadTime.Stage6Time : AppLoadTimeHelper.activatingNumber;\r\n            }\r\n        }\r\n        private static ActivateEndInternal(context: Context) {\r\n            if (context.LoadTime) {\r\n                AppLoadTimeHelper.StopStopwatch(context, \"Stage1Time\");\r\n                // Update the stage times based on the stopwatches elapsed time\r\n                if (context.Timers) {\r\n                    for (var key in context.Timers) {\r\n                        if (context.Timers[key].ElapsedTime != null) {\r\n                            // ElapsedTime is a positive value if the timer scope was successful in reaching the end.\r\n                            // This will be a negative value if Stop() was never called on the timer, letting the data show something went wrong in this scope and the amount of time it took to fail.\r\n                            context.LoadTime[key] = context.Timers[key].ElapsedTime;\r\n                        }\r\n                    }\r\n                }\r\n                Logger.SendULSTraceTag(ULSCat.msoulscat_Osf_Runtime, ULSTraceLevel.info, AppLoadTimeHelper.GenerateActivationMessage(context.ActivationRuntimeType, context.LoadTime.CorrelationId), 0x1f31d802 /* tag_5m36c */);\r\n                LatencyLogger.Instance().LogData(context.LoadTime);\r\n                context.LoadTime = null;\r\n                AppLoadTimeHelper.activatingNumber--;\r\n            }\r\n        }\r\n    }\r\n    export class RuntimeTelemetryHelper {\r\n        private static category: number = ULSCat.msoulscat_Osf_Runtime;\r\n        public static LogProxyFailure(appCorrelationId: string, methodName: string, errorInfo: {\r\n            [id: string]: any;\r\n        }) {\r\n            var constructedMessage: string;\r\n            if (appCorrelationId == null) {\r\n                appCorrelationId = \"\";\r\n            }\r\n            constructedMessage = OSF.OUtil.formatString(\"appCorrelationId:{0}, methodName:{1}\", appCorrelationId, methodName);\r\n            Object.keys(errorInfo).forEach(function (key) {\r\n                var value = errorInfo[key];\r\n                if (value != null) {\r\n                    value = value.toString();\r\n                }\r\n                constructedMessage += \", \" + key + \":\" + value;\r\n            });\r\n            // Preserve current tag from osfclient, telemetry scripts depend on this tag\r\n            // ASSERTTAG_IGNORE_START\r\n            Logger.SendULSTraceTag(RuntimeTelemetryHelper.category, ULSTraceLevel.warning, constructedMessage, 0x005c8160 /* tag_axif6 */);\r\n            // ASSERTTAG_IGNORE_FINISH\r\n        }\r\n        public static LogExceptionTag(message: string, exception: any, appCorrelationId: string, tagId: number) {\r\n            var constructedMessage: string = message;\r\n            if (exception) {\r\n                if (exception.name) {\r\n                    constructedMessage += \" Exception name:\" + exception.name + \".\";\r\n                }\r\n                if (exception.paramName) {\r\n                    constructedMessage += \" Param name:\" + exception.paramName + \".\";\r\n                }\r\n                if (exception.message) {\r\n                    constructedMessage += \" Message:\" + exception.message + \".\";\r\n                }\r\n                if (exception.stack) {\r\n                    constructedMessage += \" [Stack:\" + exception.stack + \"]\";\r\n                }\r\n            }\r\n            if (appCorrelationId != null) {\r\n                constructedMessage += \" AppCorrelationId:\" + appCorrelationId + \".\";\r\n            }\r\n            // ASSERTTAG_IGNORE_START\r\n            Logger.SendULSTraceTag(RuntimeTelemetryHelper.category, ULSTraceLevel.warning, constructedMessage, tagId);\r\n            // ASSERTTAG_IGNORE_FINISH\r\n        }\r\n        public static LogCommonMessageTag(message: string, appCorrelationId: string, tagId: number) {\r\n            if (appCorrelationId != null) {\r\n                message += \" AppCorrelationId:\" + appCorrelationId + \".\";\r\n            }\r\n            // ASSERTTAG_IGNORE_START\r\n            Logger.SendULSTraceTag(RuntimeTelemetryHelper.category, ULSTraceLevel.info, message, tagId);\r\n            // ASSERTTAG_IGNORE_FINISH\r\n        }\r\n    }\r\n    export class InsertionDialogSessionHelper {\r\n        public static LogInsertionDialogSession(assetId: string, totalSessionTime: number, trustPageSessionTime: number, appInserted: boolean, lastActiveTab: number, lastActiveTabCount: number) {\r\n            var insertionDialogSessionData = new OSFLog.InsertionDialogSessionUsageData();\r\n            var assetIdNumber = assetId.toLowerCase().indexOf(\"wa\") === 0 ? parseInt(assetId.substring(2), 10) : parseInt(assetId, 10);\r\n            var dialogState = InsertionDialogStateFlags.Undefined;\r\n            if (appInserted) {\r\n                dialogState |= InsertionDialogStateFlags.Inserted;\r\n            }\r\n            else {\r\n                dialogState |= InsertionDialogStateFlags.Canceled;\r\n            }\r\n            if (trustPageSessionTime > 0) {\r\n                dialogState |= InsertionDialogStateFlags.TrustPageVisited;\r\n            }\r\n            insertionDialogSessionData.AssetId = assetIdNumber;\r\n            insertionDialogSessionData.TotalSessionTime = totalSessionTime;\r\n            insertionDialogSessionData.TrustPageSessionTime = trustPageSessionTime;\r\n            insertionDialogSessionData.DialogState = dialogState;\r\n            insertionDialogSessionData.LastActiveTab = lastActiveTab;\r\n            insertionDialogSessionData.LastActiveTabCount = lastActiveTabCount;\r\n            InsertionDialogSessionLogger.Instance().LogData(insertionDialogSessionData);\r\n        }\r\n    }\r\n    //Telemetry.PrivacyRules\r\n    //Contains rules for logging customer add-in content\r\n    export class PrivacyRules {\r\n        private static readonly privateCompliantId = \"PRIVATE\"; //In the event we cannot log the solutionId we will instead log this string\r\n        /// <summary>\r\n        /// Logic to determine if we should log the add-in's assetId.\r\n       /// </summary>\r\n        public static IsPrivateAddin(storeType: string, assetId: string, exchangeExtensionProviderName?: string, exchangeExtensionType?: string, storeId?: string)\r\n        {\r\n            switch ((storeType || \"\").toLowerCase())\r\n            {\r\n                case OSF.StoreType.OMEX:\r\n                case OSF.StoreType.HardCodedPreinstall:\r\n                case OSF.StoreType.FirstParty:\r\n                case OSF.StoreType.Sdx:\r\n                case OSF.StoreType.WopiCatalog: // WOPICatalog only contains Omex and is safe to be public.\r\n                    return false;\r\n\r\n                case OSF.StoreType.SPCatalog:\r\n                case OSF.StoreType.SPApp:\r\n                case OSF.StoreType.FileSystem:\r\n                case OSF.StoreType.Registry:\r\n                case OSF.StoreType.UploadFileDevCatalog:\r\n                    return true;\r\n\r\n                case OSF.StoreType.PrivateCatalog:\r\n                {\r\n                    // Check if assetId is set and it belongs to Omex\r\n                    if (assetId && assetId.toLowerCase().indexOf(\"wa\") === 0) {\r\n                        return false;\r\n                    }\r\n\r\n                    return true;\r\n                }\r\n\r\n                case OSF.StoreType.Exchange:\r\n                {\r\n                    var extensionTypeLowerCase = exchangeExtensionType != null ? exchangeExtensionType.toLowerCase() : null;\r\n                    if (extensionTypeLowerCase &&\r\n                        extensionTypeLowerCase === \"default\" ||\r\n                        extensionTypeLowerCase === \"marketplace\" ||\r\n                        extensionTypeLowerCase === \"preinstalled\" ||\r\n                        extensionTypeLowerCase === \"marketplaceprivatecatalog\") {\r\n                        return false;\r\n                    }\r\n\r\n                    var providerNameLowercase = exchangeExtensionProviderName != null ? exchangeExtensionProviderName.toLowerCase() : null;\r\n                    if (providerNameLowercase && \r\n                        providerNameLowercase === \"microsoft\" ||\r\n                        providerNameLowercase === \"microsoft corp\" ||\r\n                        providerNameLowercase === \"microsoft corp.\" ||\r\n                        providerNameLowercase === \"microsoft corporation\") {\r\n                        return false;\r\n                    }\r\n                    return true;\r\n                }\r\n\r\n                // InMemory is for AppCommands. Callers should not pass in InMemory but should instead use the OwnerStoreType.\r\n                case OSF.StoreType.InMemory:\r\n                default:\r\n                    Logger.SendULSTraceTag(ULSCat.msoulscat_Osf_Notification, ULSTraceLevel.warning, \"Unknown StoreType: \" + storeType + \" in function IsPrivateAddin.\", 0x1f31d803 /* tag_5m36d */);\r\n                    return true;\r\n            }\r\n        }\r\n\r\n        /// <summary>\r\n        /// A helper function that uses IsPrivateAddin to directly get the string that should be logged.\r\n        ///  If we cannot log the assetId the value of privateCompliantId is logged in its place.\r\n        /// </summary>\r\n        public static GetAssetId(storeType: string, storeId: string, assetId: string, exchangeExtensionProviderName?: string, exchangeExtensionType?: string)\r\n        {\r\n            // Feature 5311421: GetAssetId is deprecated and replaced by GetPrivacyCompliantId\r\n            // 1/1/2023 - OWA has updated to GetPrivacyCompliantId under a flight. After OWAflight is graduated  confirm\r\n            //  no calls made to GetAssetId in WXPO clients and then remove the GetAssetid method.\r\n\r\n            // log any calls to GetAssetId to ensure no callers before removing GetAssetid method. Can check for occurances of tag to ensure no callers.\r\n            Telemetry.RuntimeTelemetryHelper.LogExceptionTag(\"PrivacyRules GetAssetId is deprecated\", null, null, 0x1e60e595 /* tag_4yowv */);\r\n\r\n            return (PrivacyRules.IsPrivateAddin(storeType, assetId, exchangeExtensionProviderName, exchangeExtensionType, storeId) ? PrivacyRules.privateCompliantId : assetId);\r\n        }\r\n\r\n         /// <summary>\r\n        /// A helper function that uses IsPrivateAddin to directly get the string that should be logged.\r\n        ///  If we cannot log the compliantID the value of a privateId is logged in its place.\r\n        /// </summary>\r\n        public static GetPrivacyCompliantId(solutionId : string, storeType : string, assetId : string, exchangeExtensionProviderName?: string, exchangeExtensionType?: string, storeId? : string): string\r\n        {\r\n            return (PrivacyRules.IsPrivateAddin(storeType, assetId, exchangeExtensionProviderName, exchangeExtensionType, storeId) \r\n                    ? PrivacyRules.privateCompliantId : solutionId);\r\n        }\r\n\r\n    }\r\n}","// --------------------------------------------------------------------------------------------------\r\n// <autogenerated>\r\n// <copyright file=\"TypeScriptUsageTypes.ts\" company=\"Microsoft\">\r\n//   Copyright (c) Microsoft Corporation.  All rights reserved.\r\n// </copyright>\r\n// <summary>\r\n//   This file was generated by the UsageGen tool\r\n// </summary>\r\n// </autogenerated>\r\n// --------------------------------------------------------------------------------------------------\r\nmodule OSFLog {\r\n    export interface IUsageData {\r\n        SerializeRow(): string;\r\n        Fields: {\r\n            [key: string]: any;\r\n        };\r\n    }\r\n    export interface IUsageLogger {\r\n        LogData(data: IUsageData): void;\r\n    }\r\n    export class BaseUsageData implements IUsageData {\r\n        private _table: string;\r\n        private _fields: {\r\n            [key: string]: any;\r\n        };\r\n        private _serializedFields: {\r\n            [key: string]: string;\r\n        };\r\n        constructor(table: string) {\r\n            this._table = table;\r\n            this._fields = {};\r\n        }\r\n        public get Fields(): {\r\n            [key: string]: any;\r\n        } {\r\n            return this._fields;\r\n        }\r\n        public get Table(): string {\r\n            return this._table;\r\n        }\r\n        public SerializeFields(): void {\r\n        }\r\n        public SetSerializedField(key: string, value: any) {\r\n            if (typeof (value) !== \"undefined\" && value !== null) {\r\n                this._serializedFields[key] = value.toString();\r\n            }\r\n        }\r\n        public SerializeRow(): string {\r\n            this._serializedFields = {};\r\n            this.SetSerializedField(\"Table\", this._table);\r\n            this.SerializeFields();\r\n            return JSON.stringify(this._serializedFields);\r\n        }\r\n    }\r\n    export class AppLoadTimeUsageData extends BaseUsageData {\r\n        constructor() { super(\"AppLoadTime\"); }\r\n        public get CorrelationId(): string { return this.Fields[\"CorrelationId\"]; }\r\n        public set CorrelationId(value: string) { this.Fields[\"CorrelationId\"] = value; }\r\n        public get AppInfo(): number { return this.Fields[\"AppInfo\"]; }\r\n        public set AppInfo(value: number) { this.Fields[\"AppInfo\"] = value; }\r\n        public get ActivationInfo(): number { return this.Fields[\"ActivationInfo\"]; }\r\n        public set ActivationInfo(value: number) { this.Fields[\"ActivationInfo\"] = value; }\r\n        public get InstanceId(): string { return this.Fields[\"InstanceId\"]; }\r\n        public set InstanceId(value: string) { this.Fields[\"InstanceId\"] = value; }\r\n        public get AssetId(): number { return this.Fields[\"AssetId\"]; }\r\n        public set AssetId(value: number) { this.Fields[\"AssetId\"] = value; }\r\n        public get Stage1Time(): number { return this.Fields[\"Stage1Time\"]; }\r\n        public set Stage1Time(value: number) { this.Fields[\"Stage1Time\"] = value; }\r\n        public get Stage2Time(): number { return this.Fields[\"Stage2Time\"]; }\r\n        public set Stage2Time(value: number) { this.Fields[\"Stage2Time\"] = value; }\r\n        public get Stage3Time(): number { return this.Fields[\"Stage3Time\"]; }\r\n        public set Stage3Time(value: number) { this.Fields[\"Stage3Time\"] = value; }\r\n        public get Stage4Time(): number { return this.Fields[\"Stage4Time\"]; }\r\n        public set Stage4Time(value: number) { this.Fields[\"Stage4Time\"] = value; }\r\n        public get Stage5Time(): number { return this.Fields[\"Stage5Time\"]; }\r\n        public set Stage5Time(value: number) { this.Fields[\"Stage5Time\"] = value; }\r\n        public get Stage6Time(): number { return this.Fields[\"Stage6Time\"]; }\r\n        public set Stage6Time(value: number) { this.Fields[\"Stage6Time\"] = value; }\r\n        public get Stage7Time(): number { return this.Fields[\"Stage7Time\"]; }\r\n        public set Stage7Time(value: number) { this.Fields[\"Stage7Time\"] = value; }\r\n        public get Stage8Time(): number { return this.Fields[\"Stage8Time\"]; }\r\n        public set Stage8Time(value: number) { this.Fields[\"Stage8Time\"] = value; }\r\n        public get Stage9Time(): number { return this.Fields[\"Stage9Time\"]; }\r\n        public set Stage9Time(value: number) { this.Fields[\"Stage9Time\"] = value; }\r\n        public get Stage10Time(): number { return this.Fields[\"Stage10Time\"]; }\r\n        public set Stage10Time(value: number) { this.Fields[\"Stage10Time\"] = value; }\r\n        public get Stage11Time(): number { return this.Fields[\"Stage11Time\"]; }\r\n        public set Stage11Time(value: number) { this.Fields[\"Stage11Time\"] = value; }\r\n        public get ErrorResult(): number { return this.Fields[\"ErrorResult\"]; }\r\n        public set ErrorResult(value: number) { this.Fields[\"ErrorResult\"] = value; }\r\n        public SerializeFields(): void {\r\n            this.SetSerializedField(\"CorrelationId\", this.CorrelationId);\r\n            this.SetSerializedField(\"AppInfo\", this.AppInfo);\r\n            this.SetSerializedField(\"ActivationInfo\", this.ActivationInfo);\r\n            this.SetSerializedField(\"InstanceId\", this.InstanceId);\r\n            this.SetSerializedField(\"AssetId\", this.AssetId);\r\n            this.SetSerializedField(\"Stage1Time\", this.Stage1Time);\r\n            this.SetSerializedField(\"Stage2Time\", this.Stage2Time);\r\n            this.SetSerializedField(\"Stage3Time\", this.Stage3Time);\r\n            this.SetSerializedField(\"Stage4Time\", this.Stage4Time);\r\n            this.SetSerializedField(\"Stage5Time\", this.Stage5Time);\r\n            this.SetSerializedField(\"Stage6Time\", this.Stage6Time);\r\n            this.SetSerializedField(\"Stage7Time\", this.Stage7Time);\r\n            this.SetSerializedField(\"Stage8Time\", this.Stage8Time);\r\n            this.SetSerializedField(\"Stage9Time\", this.Stage9Time);\r\n            this.SetSerializedField(\"Stage10Time\", this.Stage10Time);\r\n            this.SetSerializedField(\"Stage11Time\", this.Stage11Time);\r\n            this.SetSerializedField(\"ErrorResult\", this.ErrorResult);\r\n        }\r\n    }\r\n    export class AppNotificationUsageData extends BaseUsageData {\r\n        constructor() { super(\"AppNotification\"); }\r\n        public get CorrelationId(): string { return this.Fields[\"CorrelationId\"]; }\r\n        public set CorrelationId(value: string) { this.Fields[\"CorrelationId\"] = value; }\r\n        public get ErrorResult(): number { return this.Fields[\"ErrorResult\"]; }\r\n        public set ErrorResult(value: number) { this.Fields[\"ErrorResult\"] = value; }\r\n        public get NotificationClickInfo(): number { return this.Fields[\"NotificationClickInfo\"]; }\r\n        public set NotificationClickInfo(value: number) { this.Fields[\"NotificationClickInfo\"] = value; }\r\n        public SerializeFields(): void {\r\n            this.SetSerializedField(\"CorrelationId\", this.CorrelationId);\r\n            this.SetSerializedField(\"ErrorResult\", this.ErrorResult);\r\n            this.SetSerializedField(\"NotificationClickInfo\", this.NotificationClickInfo);\r\n        }\r\n    }\r\n    export class AppManagementMenuUsageData extends BaseUsageData {\r\n        constructor() { super(\"AppManagementMenu\"); }\r\n        public get AssetId(): number { return this.Fields[\"AssetId\"]; }\r\n        public set AssetId(value: number) { this.Fields[\"AssetId\"] = value; }\r\n        public get OperationMetadata(): number { return this.Fields[\"OperationMetadata\"]; }\r\n        public set OperationMetadata(value: number) { this.Fields[\"OperationMetadata\"] = value; }\r\n        public get ErrorResult(): number { return this.Fields[\"ErrorResult\"]; }\r\n        public set ErrorResult(value: number) { this.Fields[\"ErrorResult\"] = value; }\r\n        public SerializeFields(): void {\r\n            this.SetSerializedField(\"AssetId\", this.AssetId);\r\n            this.SetSerializedField(\"OperationMetadata\", this.OperationMetadata);\r\n            this.SetSerializedField(\"ErrorResult\", this.ErrorResult);\r\n        }\r\n    }\r\n    export class InsertionDialogSessionUsageData extends BaseUsageData {\r\n        constructor() { super(\"InsertionDialogSession\"); }\r\n        public get AssetId(): number { return this.Fields[\"AssetId\"]; }\r\n        public set AssetId(value: number) { this.Fields[\"AssetId\"] = value; }\r\n        public get TotalSessionTime(): number { return this.Fields[\"TotalSessionTime\"]; }\r\n        public set TotalSessionTime(value: number) { this.Fields[\"TotalSessionTime\"] = value; }\r\n        public get TrustPageSessionTime(): number { return this.Fields[\"TrustPageSessionTime\"]; }\r\n        public set TrustPageSessionTime(value: number) { this.Fields[\"TrustPageSessionTime\"] = value; }\r\n        public get DialogState(): number { return this.Fields[\"DialogState\"]; }\r\n        public set DialogState(value: number) { this.Fields[\"DialogState\"] = value; }\r\n        public get LastActiveTab(): number { return this.Fields[\"LastActiveTab\"]; }\r\n        public set LastActiveTab(value: number) { this.Fields[\"LastActiveTab\"] = value; }\r\n        public get LastActiveTabCount(): number { return this.Fields[\"LastActiveTabCount\"]; }\r\n        public set LastActiveTabCount(value: number) { this.Fields[\"LastActiveTabCount\"] = value; }\r\n        public SerializeFields(): void {\r\n            this.SetSerializedField(\"AssetId\", this.AssetId);\r\n            this.SetSerializedField(\"TotalSessionTime\", this.TotalSessionTime);\r\n            this.SetSerializedField(\"TrustPageSessionTime\", this.TrustPageSessionTime);\r\n            this.SetSerializedField(\"DialogState\", this.DialogState);\r\n            this.SetSerializedField(\"LastActiveTab\", this.LastActiveTab);\r\n            this.SetSerializedField(\"LastActiveTabCount\", this.LastActiveTabCount);\r\n        }\r\n    }\r\n    export class UploadFileDevCatelogUsageData extends BaseUsageData {\r\n        constructor() { super(\"UploadFileDevCatelog\"); }\r\n        public get CorrelationId(): string { return this.Fields[\"CorrelationId\"]; }\r\n        public set CorrelationId(value: string) { this.Fields[\"CorrelationId\"] = value; }\r\n        public get OperationMetadata(): number { return this.Fields[\"OperationMetadata\"]; }\r\n        public set OperationMetadata(value: number) { this.Fields[\"OperationMetadata\"] = value; }\r\n        public get ErrorResult(): number { return this.Fields[\"ErrorResult\"]; }\r\n        public set ErrorResult(value: number) { this.Fields[\"ErrorResult\"] = value; }\r\n        public SerializeFields(): void {\r\n            this.SetSerializedField(\"CorrelationId\", this.CorrelationId);\r\n            this.SetSerializedField(\"OperationMetadata\", this.OperationMetadata);\r\n            this.SetSerializedField(\"ErrorResult\", this.ErrorResult);\r\n        }\r\n    }\r\n    export class UploadFileDevCatalogUsageUsageData extends BaseUsageData {\r\n        constructor() { super(\"UploadFileDevCatalogUsage\"); }\r\n        public get CorrelationId(): string { return this.Fields[\"CorrelationId\"]; }\r\n        public set CorrelationId(value: string) { this.Fields[\"CorrelationId\"] = value; }\r\n        public get StoreType(): string { return this.Fields[\"StoreType\"]; }\r\n        public set StoreType(value: string) { this.Fields[\"StoreType\"] = value; }\r\n        public get AppId(): string { return this.Fields[\"AppId\"]; }\r\n        public set AppId(value: string) { this.Fields[\"AppId\"] = value; }\r\n        public get AppVersion(): string { return this.Fields[\"AppVersion\"]; }\r\n        public set AppVersion(value: string) { this.Fields[\"AppVersion\"] = value; }\r\n        public get AppTargetType(): number { return this.Fields[\"AppTargetType\"]; }\r\n        public set AppTargetType(value: number) { this.Fields[\"AppTargetType\"] = value; }\r\n        public get IsAppCommand(): string { return this.Fields[\"IsAppCommand\"]; }\r\n        public set IsAppCommand(value: string) { this.Fields[\"IsAppCommand\"] = value; }\r\n        public get AppSizeWidth(): number { return this.Fields[\"AppSizeWidth\"]; }\r\n        public set AppSizeWidth(value: number) { this.Fields[\"AppSizeWidth\"] = value; }\r\n        public get AppSizeHeight(): number { return this.Fields[\"AppSizeHeight\"]; }\r\n        public set AppSizeHeight(value: number) { this.Fields[\"AppSizeHeight\"] = value; }\r\n        public SerializeFields(): void {\r\n            this.SetSerializedField(\"CorrelationId\", this.CorrelationId);\r\n            this.SetSerializedField(\"StoreType\", this.StoreType);\r\n            this.SetSerializedField(\"AppId\", this.AppId);\r\n            this.SetSerializedField(\"AppVersion\", this.AppVersion);\r\n            this.SetSerializedField(\"AppTargetType\", this.AppTargetType);\r\n            this.SetSerializedField(\"IsAppCommand\", this.IsAppCommand);\r\n            this.SetSerializedField(\"AppSizeWidth\", this.AppSizeWidth);\r\n            this.SetSerializedField(\"AppSizeHeight\", this.AppSizeHeight);\r\n        }\r\n    }\r\n}","/// <reference path=\"../jscript/tsdeclarations/addinprovider.d.ts\" />\r\nmodule OfficeExt {\r\n    export enum DataServiceResultCode {\r\n        Succeeded = 1,\r\n        Failed = 0,\r\n        ProxyNotReady = -1,\r\n        PrxoyUrlEmpty = -2,\r\n        ProxyUrlNotTrusted = -3,\r\n        UnknownUserType = 2,\r\n        Unauthenticated = 3,\r\n        UserResolutionNoMailbox = 4\r\n    }\r\n}","var _omexXmlNamespaces = 'xmlns=\"urn:schemas-microsoft-com:office:office\" xmlns:o=\"urn:schemas-microsoft-com:office:office\"';\r\nfunction _getAppSubType(officeExtentionTarget) {\r\n    var appSubType;\r\n    if (officeExtentionTarget === 0) {\r\n        //in content MOE\r\n        appSubType = OSF.AppSubType.Content;\r\n    }\r\n    else if (officeExtentionTarget === 1) {\r\n        //Taskpane MOE\r\n        appSubType = OSF.AppSubType.Taskpane;\r\n    }\r\n    else {\r\n        throw OsfMsAjaxFactory.msAjaxError.argument(\"officeExtentionTarget\");\r\n    }\r\n    return appSubType;\r\n}\r\n;\r\nfunction _getAppVersion(applicationName) {\r\n    var appVersion = OSF.AppVersion[applicationName.toLowerCase()];\r\n    if (typeof appVersion == \"undefined\") {\r\n        throw OsfMsAjaxFactory.msAjaxError.argument(\"applicationName\");\r\n    }\r\n    return appVersion;\r\n}\r\n;\r\nfunction _invokeCallbackTag(callback, status, result, errorMessage, executor, tagId) {\r\n    var constructedMessage = errorMessage;\r\n    if (callback) {\r\n        try {\r\n            var response = { \"status\": status, \"result\": result, \"failureInfo\": null };\r\n            var setFailureInfoProperty = function _invokeCallbackTag$setFailureInfoProperty(response, name, value) {\r\n                if (response.failureInfo === null) {\r\n                    response.failureInfo = {};\r\n                }\r\n                response.failureInfo[name] = value;\r\n            };\r\n            if (executor) {\r\n                var httpStatusCode = -1;\r\n                if (executor.get_statusCode) {\r\n                    httpStatusCode = executor.get_statusCode();\r\n                }\r\n                // Do not override message if it already exists\r\n                if (!constructedMessage) {\r\n                    if (executor.get_timedOut && executor.get_timedOut()) {\r\n                        constructedMessage = \"Request timed out.\";\r\n                    }\r\n                    else if (executor.get_aborted && executor.get_aborted()) {\r\n                        constructedMessage = \"Request aborted.\";\r\n                    }\r\n                }\r\n                // Only record detailed info if there is an error or message already being recorded\r\n                if (httpStatusCode >= 400 || status === statusCode.Failed || constructedMessage) {\r\n                    setFailureInfoProperty(response, \"statusCode\", httpStatusCode);\r\n                    setFailureInfoProperty(response, \"tagId\", tagId);\r\n                    var webRequest = executor.get_webRequest();\r\n                    if (webRequest) {\r\n                        if (webRequest.getResolvedUrl) {\r\n                            setFailureInfoProperty(response, \"url\", webRequest.getResolvedUrl());\r\n                        }\r\n                        // Only record the correlation id if we did not set it in the request\r\n                        if (executor.getResponseHeader && webRequest.get_userContext && webRequest.get_userContext() && !webRequest.get_userContext().correlationId) {\r\n                            // Get the correlation id from OMEX request for better diagnosis\r\n                            var correlationId = executor.getResponseHeader(\"X-CorrelationId\");\r\n                            setFailureInfoProperty(response, \"correlationId\", correlationId);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            // Add on built error string information if it exists\r\n            if (constructedMessage) {\r\n                setFailureInfoProperty(response, \"message\", constructedMessage);\r\n                OsfMsAjaxFactory.msAjaxDebug.trace(constructedMessage);\r\n            }\r\n        }\r\n        catch (ex) {\r\n            OsfMsAjaxFactory.msAjaxDebug.trace(\"Encountered exception with logging: \" + ex);\r\n        }\r\n        callback(response);\r\n    }\r\n}\r\n;\r\nnamespace OSF {\r\n    export enum AppSubType {\r\n        Taskpane = 1,\r\n        Content = 2,\r\n        Contextual = 3,\r\n        Dictionary = 4\r\n    }\r\n    export enum AppVersion {\r\n        access = \"ZAC150\",\r\n        excel = \"ZXL150\",\r\n        excelwebapp = \"WAE160\",\r\n        outlook = \"ZOL150\",\r\n        outlookwebapp = \"MOW150\",\r\n        powerpoint = \"ZPP151\",\r\n        powerpointwebapp = \"WAP160\",\r\n        project = \"ZPJ150\",\r\n        word = \"ZWD150\",\r\n        wordwebapp = \"WAW160\",\r\n        onenotewebapp = \"WAO160\",\r\n        visio = \"ZVO161\",\r\n        visiowebapp = \"WAV161\"\r\n    }\r\n}","module OfficeExt {\r\n    export class MicrosoftAjaxFactory {\r\n        private _msAjaxError: IMsAjaxError;\r\n        private _msAjaxString: IMsAjaxString;\r\n        private _msAjaxDebug: IMsAjaxDebug;\r\n        public isMsAjaxLoaded(): boolean {\r\n            if (typeof (Sys) !== 'undefined' && typeof (Type) !== 'undefined' &&\r\n                Sys.StringBuilder && typeof (Sys.StringBuilder) === \"function\" &&\r\n                Type.registerNamespace && typeof (Type.registerNamespace) === \"function\" &&\r\n                Type.registerClass && typeof (Type.registerClass) === \"function\" &&\r\n                typeof (Function._validateParams) === \"function\" &&\r\n                Sys.Serialization && Sys.Serialization.JavaScriptSerializer && typeof (Sys.Serialization.JavaScriptSerializer.serialize) === \"function\") {\r\n                return true;\r\n            }\r\n            else {\r\n                return false;\r\n            }\r\n        }\r\n        public loadMsAjaxFull(callback: Function): void {\r\n            var msAjaxCDNPath = (window.location.protocol.toLowerCase() === 'https:' ? 'https:' : 'http:') + '//ajax.aspnetcdn.com/ajax/3.5/MicrosoftAjax.js';\r\n            OSF.OUtil.loadScript(msAjaxCDNPath, callback);\r\n        }\r\n        public get msAjaxError(): IMsAjaxError {\r\n            if (this._msAjaxError == null && this.isMsAjaxLoaded()) {\r\n                this._msAjaxError = Error as any;\r\n            }\r\n            return this._msAjaxError;\r\n        }\r\n        public set msAjaxError(errorClass: IMsAjaxError) {\r\n            this._msAjaxError = errorClass;\r\n        }\r\n        public get msAjaxString(): IMsAjaxString {\r\n            if (this._msAjaxString == null && this.isMsAjaxLoaded()) {\r\n                this._msAjaxString = String as any;\r\n            }\r\n            return this._msAjaxString;\r\n        }\r\n        public set msAjaxString(stringClass: IMsAjaxString) {\r\n            this._msAjaxString = stringClass;\r\n        }\r\n        public get msAjaxDebug(): IMsAjaxDebug {\r\n            if (this._msAjaxDebug == null && this.isMsAjaxLoaded()) {\r\n                this._msAjaxDebug = Sys.Debug as any;\r\n            }\r\n            return this._msAjaxDebug;\r\n        }\r\n        public set msAjaxDebug(debugClass: IMsAjaxDebug) {\r\n            this._msAjaxDebug = debugClass;\r\n        }\r\n    }\r\n}\r\nvar OsfMsAjaxFactory = new OfficeExt.MicrosoftAjaxFactory();","module OfficeExt {\r\n    export class MsAjaxTypeHelper {\r\n        public static isInstanceOfType(type: any, instance: any): boolean {\r\n            if (typeof (instance) === \"undefined\" || instance === null)\r\n                return false;\r\n            if (instance instanceof type)\r\n                return true;\r\n            var instanceType = instance.constructor;\r\n            if (!instanceType || (typeof (instanceType) !== \"function\") || !instanceType.__typeName || instanceType.__typeName === 'Object') {\r\n                instanceType = Object;\r\n            }\r\n            return !!(instanceType === type) ||\r\n                (instanceType.__typeName && type.__typeName && instanceType.__typeName === type.__typeName);\r\n        }\r\n    }\r\n    export class MsAjaxError {\r\n        public static create(message: string, errorInfo?: any): Error {\r\n            var err = new Error(message);\r\n            err.message = message;\r\n            if (errorInfo) {\r\n                for (var v in errorInfo) {\r\n                    err[v] = errorInfo[v];\r\n                }\r\n            }\r\n            err.popStackFrame();\r\n            return err;\r\n        }\r\n        public static parameterCount(message?: string): Error {\r\n            var displayMessage = \"Sys.ParameterCountException: \" + (message ? message : \"Parameter count mismatch.\");\r\n            var err = MsAjaxError.create(displayMessage, { name: 'Sys.ParameterCountException' });\r\n            err.popStackFrame();\r\n            return err;\r\n        }\r\n        public static argument(paramName?: string, message?: string): Error {\r\n            var displayMessage = \"Sys.ArgumentException: \" + (message ? message : \"Value does not fall within the expected range.\");\r\n            if (paramName) {\r\n                displayMessage += \"\\n\" + MsAjaxString.format(\"Parameter name: {0}\", paramName);\r\n            }\r\n            var err = MsAjaxError.create(displayMessage, { name: \"Sys.ArgumentException\", paramName: paramName });\r\n            err.popStackFrame();\r\n            return err;\r\n        }\r\n        public static argumentNull(paramName?: string, message?: string): Error {\r\n            var displayMessage = \"Sys.ArgumentNullException: \" + (message ? message : \"Value cannot be null.\");\r\n            if (paramName) {\r\n                displayMessage += \"\\n\" + MsAjaxString.format(\"Parameter name: {0}\", paramName);\r\n            }\r\n            var err = MsAjaxError.create(displayMessage, { name: \"Sys.ArgumentNullException\", paramName: paramName });\r\n            err.popStackFrame();\r\n            return err;\r\n        }\r\n        public static argumentOutOfRange(paramName?: string, actualValue?: any, message?: string): Error {\r\n            var displayMessage = \"Sys.ArgumentOutOfRangeException: \" + (message ? message : \"Specified argument was out of the range of valid values.\");\r\n            if (paramName) {\r\n                displayMessage += \"\\n\" + MsAjaxString.format(\"Parameter name: {0}\", paramName);\r\n            }\r\n            if (typeof (actualValue) !== \"undefined\" && actualValue !== null) {\r\n                displayMessage += \"\\n\" + MsAjaxString.format(\"Actual value was {0}.\", actualValue);\r\n            }\r\n            var err = MsAjaxError.create(displayMessage, {\r\n                name: \"Sys.ArgumentOutOfRangeException\",\r\n                paramName: paramName,\r\n                actualValue: actualValue\r\n            });\r\n            err.popStackFrame();\r\n            return err;\r\n        }\r\n        public static argumentType(paramName?: string, actualType?: any, expectedType?: any, message?: string): Error {\r\n            var displayMessage = \"Sys.ArgumentTypeException: \";\r\n            if (message) {\r\n                displayMessage += message;\r\n            }\r\n            else if (actualType && expectedType) {\r\n                displayMessage +=\r\n                    MsAjaxString.format(\"Object of type '{0}' cannot be converted to type '{1}'.\", actualType.getName ? actualType.getName() : actualType, expectedType.getName ? expectedType.getName() : expectedType);\r\n            }\r\n            else {\r\n                displayMessage += \"Object cannot be converted to the required type.\";\r\n            }\r\n            if (paramName) {\r\n                displayMessage += \"\\n\" + MsAjaxString.format(\"Parameter name: {0}\", paramName);\r\n            }\r\n            var err = MsAjaxError.create(displayMessage, {\r\n                name: \"Sys.ArgumentTypeException\",\r\n                paramName: paramName,\r\n                actualType: actualType,\r\n                expectedType: expectedType\r\n            });\r\n            err.popStackFrame();\r\n            return err;\r\n        }\r\n        public static argumentUndefined(paramName?: string, message?: string): Error {\r\n            var displayMessage = \"Sys.ArgumentUndefinedException: \" + (message ? message : \"Value cannot be undefined.\");\r\n            if (paramName) {\r\n                displayMessage += \"\\n\" + MsAjaxString.format(\"Parameter name: {0}\", paramName);\r\n            }\r\n            var err = MsAjaxError.create(displayMessage, { name: \"Sys.ArgumentUndefinedException\", paramName: paramName });\r\n            err.popStackFrame();\r\n            return err;\r\n        }\r\n        public static invalidOperation(message: string): Error {\r\n            var displayMessage = \"Sys.InvalidOperationException: \" + (message ? message : \"Operation is not valid due to the current state of the object.\");\r\n            var err = MsAjaxError.create(displayMessage, { name: 'Sys.InvalidOperationException' });\r\n            err.popStackFrame();\r\n            return err;\r\n        }\r\n    }\r\n    export class MsAjaxString {\r\n        public static format(format: string, ...args: any[]): string {\r\n            var source = format;\r\n            return source.replace(/{(\\d+)}/gm, function (match, number) {\r\n                var index = parseInt(number, 10);\r\n                return args[index] === undefined ? '{' + number + '}' : args[index];\r\n            });\r\n        }\r\n        public static startsWith(str: string, prefix: string): boolean {\r\n            return (str.substr(0, prefix.length) === prefix);\r\n        }\r\n    }\r\n    export class MsAjaxDebug {\r\n        public static trace(text: string): void {\r\n            // OSFJS: Need pre-processor alternative\r\n            // #ifdef OSFSCRIPT_DEBUG\r\n            // From MsAjax AppendConsole\r\n            if (DEBUG) {\r\n                if (typeof Debug !== \"undefined\" && Debug.writeln)\r\n                    Debug.writeln(text);\r\n                if (window.console && window.console.log)\r\n                    window.console.log(text);\r\n                if (window.opera && window.opera.postError)\r\n                    window.opera.postError(text);\r\n                if (window.debugService && window.debugService.trace)\r\n                    window.debugService.trace(text);\r\n                // From MsAjax AppendTrace\r\n                var a = document.getElementById(\"TraceConsole\");\r\n                if (a && a.tagName.toUpperCase() === \"TEXTAREA\") {\r\n                    a.appendChild(document.createTextNode(text + \"\\n\"));\r\n                }\r\n            }\r\n            // #endif // OSFSCRIPT_DEBUG\r\n        }\r\n    }\r\n    if (!OsfMsAjaxFactory.isMsAjaxLoaded()) {\r\n        var registerTypeInternal = function registerTypeInternal(type, name, isClass) {\r\n            if (type.__typeName === undefined || type.__typeName === null) {\r\n                type.__typeName = name;\r\n            }\r\n            if (type.__class === undefined || type.__class === null) {\r\n                type.__class = isClass;\r\n            }\r\n        };\r\n        registerTypeInternal(Function, \"Function\", true);\r\n        registerTypeInternal(Error, \"Error\", true);\r\n        registerTypeInternal(Object, \"Object\", true);\r\n        registerTypeInternal(String, \"String\", true);\r\n        registerTypeInternal(Boolean, \"Boolean\", true);\r\n        registerTypeInternal(Date, \"Date\", true);\r\n        registerTypeInternal(Number, \"Number\", true);\r\n        registerTypeInternal(RegExp, \"RegExp\", true);\r\n        registerTypeInternal(Array, \"Array\", true);\r\n        if (!Function.createCallback) {\r\n            Function.createCallback = function Function$createCallback(method, context) {\r\n                /// <summary locid=\"M:J#Function.createCallback\" />\r\n                /// <param name=\"method\" type=\"Function\"></param>\r\n                /// <param name=\"context\" mayBeNull=\"true\"></param>\r\n                /// <returns type=\"Function\"></returns>\r\n                var e = Function._validateParams(arguments, [\r\n                    { name: \"method\", type: Function },\r\n                    { name: \"context\", mayBeNull: true }\r\n                ]);\r\n                if (e)\r\n                    throw e;\r\n                return function () {\r\n                    var l = arguments.length;\r\n                    if (l > 0) {\r\n                        var args = [];\r\n                        for (var i = 0; i < l; i++) {\r\n                            args[i] = arguments[i];\r\n                        }\r\n                        args[l] = context;\r\n                        return method.apply(this, args);\r\n                    }\r\n                    return method.call(this, context);\r\n                };\r\n            };\r\n        }\r\n        if (!Function.createDelegate) {\r\n            Function.createDelegate = function Function$createDelegate(instance, method) {\r\n                /// <summary locid=\"M:J#Function.createDelegate\" />\r\n                /// <param name=\"instance\" mayBeNull=\"true\"></param>\r\n                /// <param name=\"method\" type=\"Function\"></param>\r\n                /// <returns type=\"Function\"></returns>\r\n                var e = Function._validateParams(arguments, [\r\n                    { name: \"instance\", mayBeNull: true },\r\n                    { name: \"method\", type: Function }\r\n                ]);\r\n                if (e)\r\n                    throw e;\r\n                return function () {\r\n                    return method.apply(instance, arguments);\r\n                };\r\n            };\r\n        }\r\n        if (!Function._validateParams) {\r\n            // Required methods from MicrosoftAjax - since Excel has switched to aacorlib.js\r\n            Function._validateParams = function (params, expectedParams, validateParameterCount) {\r\n                var e, expectedLength = expectedParams.length;\r\n                validateParameterCount = validateParameterCount || (typeof (validateParameterCount) === \"undefined\");\r\n                e = Function._validateParameterCount(params, expectedParams, validateParameterCount);\r\n                if (e) {\r\n                    e.popStackFrame();\r\n                    return e;\r\n                }\r\n                for (var i = 0, l = params.length; i < l; i++) {\r\n                    var expectedParam = expectedParams[Math.min(i, expectedLength - 1)], paramName = expectedParam.name;\r\n                    if (expectedParam.parameterArray) {\r\n                        paramName += \"[\" + (i - expectedLength + 1) + \"]\";\r\n                    }\r\n                    else if (!validateParameterCount && (i >= expectedLength)) {\r\n                        break;\r\n                    }\r\n                    e = Function._validateParameter(params[i], expectedParam, paramName);\r\n                    if (e) {\r\n                        e.popStackFrame();\r\n                        return e;\r\n                    }\r\n                }\r\n                return null;\r\n            };\r\n        }\r\n        if (!Function._validateParameterCount) {\r\n            Function._validateParameterCount = function (params, expectedParams, validateParameterCount) {\r\n                var i, error, expectedLen = expectedParams.length, actualLen = params.length;\r\n                if (actualLen < expectedLen) {\r\n                    var minParams = expectedLen;\r\n                    for (i = 0; i < expectedLen; i++) {\r\n                        var param = expectedParams[i];\r\n                        if (param.optional || param.parameterArray) {\r\n                            minParams--;\r\n                        }\r\n                    }\r\n                    if (actualLen < minParams) {\r\n                        error = true;\r\n                    }\r\n                }\r\n                else if (validateParameterCount && (actualLen > expectedLen)) {\r\n                    error = true;\r\n                    for (i = 0; i < expectedLen; i++) {\r\n                        if (expectedParams[i].parameterArray) {\r\n                            error = false;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                if (error) {\r\n                    var e = MsAjaxError.parameterCount();\r\n                    e.popStackFrame();\r\n                    return e;\r\n                }\r\n                return null;\r\n            };\r\n        }\r\n        if (!Function._validateParameter) {\r\n            Function._validateParameter = function (param, expectedParam, paramName) {\r\n                var e, expectedType = expectedParam.type, expectedInteger = !!expectedParam.integer, expectedDomElement = !!expectedParam.domElement, mayBeNull = !!expectedParam.mayBeNull;\r\n                e = Function._validateParameterType(param, expectedType, expectedInteger, expectedDomElement, mayBeNull, paramName);\r\n                if (e) {\r\n                    e.popStackFrame();\r\n                    return e;\r\n                }\r\n                var expectedElementType = expectedParam.elementType, elementMayBeNull = !!expectedParam.elementMayBeNull;\r\n                if (expectedType === Array && typeof (param) !== \"undefined\" && param !== null &&\r\n                    (expectedElementType || !elementMayBeNull)) {\r\n                    var expectedElementInteger = !!expectedParam.elementInteger, expectedElementDomElement = !!expectedParam.elementDomElement;\r\n                    for (var i = 0; i < param.length; i++) {\r\n                        var elem = param[i];\r\n                        e = Function._validateParameterType(elem, expectedElementType, expectedElementInteger, expectedElementDomElement, elementMayBeNull, paramName + \"[\" + i + \"]\");\r\n                        if (e) {\r\n                            e.popStackFrame();\r\n                            return e;\r\n                        }\r\n                    }\r\n                }\r\n                return null;\r\n            };\r\n        }\r\n        if (!Function._validateParameterType) {\r\n            Function._validateParameterType = function (param, expectedType, expectedInteger, expectedDomElement, mayBeNull, paramName) {\r\n                var e, i;\r\n                if (typeof (param) === \"undefined\") {\r\n                    if (mayBeNull) {\r\n                        return null;\r\n                    }\r\n                    else {\r\n                        e = OfficeExt.MsAjaxError.argumentUndefined(paramName);\r\n                        e.popStackFrame();\r\n                        return e;\r\n                    }\r\n                }\r\n                if (param === null) {\r\n                    if (mayBeNull) {\r\n                        return null;\r\n                    }\r\n                    else {\r\n                        e = OfficeExt.MsAjaxError.argumentNull(paramName);\r\n                        e.popStackFrame();\r\n                        return e;\r\n                    }\r\n                }\r\n                if (expectedType && !OfficeExt.MsAjaxTypeHelper.isInstanceOfType(expectedType, param)) {\r\n                    e = OfficeExt.MsAjaxError.argumentType(paramName, typeof (param), expectedType);\r\n                    e.popStackFrame();\r\n                    return e;\r\n                }\r\n                return null;\r\n            };\r\n        }\r\n        if (typeof (window) !== \"undefined\" && !(window as any).Type) {\r\n            (window as any).Type = Function;\r\n        }\r\n        if (typeof (Type) !== \"undefined\" && !Type.registerNamespace) {\r\n            Type.registerNamespace = function (ns) {\r\n                var namespaceParts = ns.split('.');\r\n                var currentNamespace: any = window;\r\n                for (var i = 0; i < namespaceParts.length; i++) {\r\n                    currentNamespace[namespaceParts[i]] = currentNamespace[namespaceParts[i]] || {};\r\n                    currentNamespace = currentNamespace[namespaceParts[i]];\r\n                }\r\n            };\r\n        }\r\n        if (typeof (Type) !== \"undefined\" && !Type.prototype.registerClass) {\r\n            Type.prototype.registerClass = function (cls) { cls = {}; };\r\n        }\r\n        if (typeof (Sys) === \"undefined\" && typeof (Type) !== \"undefined\") {\r\n            Type.registerNamespace('Sys');\r\n        }\r\n        if (!Error.prototype.popStackFrame) {\r\n            Error.prototype.popStackFrame = function () {\r\n                if (arguments.length !== 0)\r\n                    throw MsAjaxError.parameterCount();\r\n                if (typeof (this.stack) === \"undefined\" || this.stack === null ||\r\n                    typeof (this.fileName) === \"undefined\" || this.fileName === null ||\r\n                    typeof (this.lineNumber) === \"undefined\" || this.lineNumber === null) {\r\n                    return;\r\n                }\r\n                var stackFrames = this.stack.split(\"\\n\");\r\n                var currentFrame = stackFrames[0];\r\n                var pattern = this.fileName + \":\" + this.lineNumber;\r\n                while (typeof (currentFrame) !== \"undefined\" &&\r\n                    currentFrame !== null &&\r\n                    currentFrame.indexOf(pattern) === -1) {\r\n                    stackFrames.shift();\r\n                    currentFrame = stackFrames[0];\r\n                }\r\n                var nextFrame = stackFrames[1];\r\n                if (typeof (nextFrame) === \"undefined\" || nextFrame === null) {\r\n                    return;\r\n                }\r\n                var nextFrameParts = nextFrame.match(/@(.*):(\\d+)$/);\r\n                if (typeof (nextFrameParts) === \"undefined\" || nextFrameParts === null) {\r\n                    return;\r\n                }\r\n                this.fileName = nextFrameParts[1];\r\n                this.lineNumber = parseInt(nextFrameParts[2]);\r\n                stackFrames.shift();\r\n                this.stack = stackFrames.join(\"\\n\");\r\n            };\r\n        }\r\n        // Set the custom implementation MS Ajax objects used by OsfMsAjaxFactory\r\n        OsfMsAjaxFactory.msAjaxError = MsAjaxError as IMsAjaxError;\r\n        OsfMsAjaxFactory.msAjaxString = MsAjaxString as IMsAjaxString;\r\n        OsfMsAjaxFactory.msAjaxDebug = MsAjaxDebug as IMsAjaxDebug;\r\n    }\r\n}","// OSFJS: Replace XDM_DEBUG(x)\r\n// #if DEBUG   //add file name and line number to debugg message\r\n// #define XDM_DEBUG(x) // OsfMsAjaxFactory.msAjaxDebug.trace(__FILE__+\":\"+__LINE__+\"|\"+(x))  //if needed, uncomment this line.\r\n// #else       //ignore in ship\r\n// #define XDM_DEBUG(x)\r\n// #endif\r\nfunction XDM_DEBUG(x) {\r\n    OsfMsAjaxFactory.msAjaxDebug.trace(x);\r\n}\r\n//create namespaces\r\n","/// <reference path=\"../tsdeclarations/osf.d.ts\" />\r\n/// <reference path=\"../tsdeclarations/msajax.d.ts\" />\r\n// Utilities for providing methods that can be reused for general purpose\r\nconst URL_DELIM = \"$\"; // OM1422116: use macro to make this compile time replacement, no code size impact. It was \"|\" before bugfix\r\n\r\ndeclare var otel: any;\r\n\r\nmodule OfficeExt {\r\n    export interface IBasicStorage {\r\n        getItem(key: string): any;\r\n        setItem(key: string, data: string): void;\r\n        clear(): void;\r\n        removeItem(key: string): void;\r\n        getKeysWithPrefix(keyPrefix: string): Array<string>;\r\n        isLocalStorageAvailable(): boolean;\r\n    }\r\n    /**\r\n     * Wraps localStorage/sessionStorage methods to prevent unexpected behavior (see OM: 1472382)\r\n     * and to simplify consumer code.\r\n     */\r\n    export class SafeStorage implements IBasicStorage {\r\n        constructor(private _internalStorage: Storage) { }\r\n        public getItem(key: string): any {\r\n            try {\r\n                return this._internalStorage && this._internalStorage.getItem(key);\r\n            }\r\n            catch (e) {\r\n                return null;\r\n            }\r\n        }\r\n        public setItem(key: string, data: string): void {\r\n            try {\r\n                this._internalStorage && this._internalStorage.setItem(key, data);\r\n            }\r\n            catch (e) {\r\n                // No action needed\r\n            }\r\n        }\r\n        public clear(): void {\r\n            try {\r\n                this._internalStorage && this._internalStorage.clear();\r\n            }\r\n            catch (e) {\r\n                // No action needed\r\n            }\r\n        }\r\n        public removeItem(key: string): void {\r\n            try {\r\n                this._internalStorage && this._internalStorage.removeItem(key);\r\n            }\r\n            catch (e) {\r\n                // No action needed\r\n            }\r\n        }\r\n        public getKeysWithPrefix(keyPrefix: string): Array<string> {\r\n            var keyList = [];\r\n            try {\r\n                var len = this._internalStorage && this._internalStorage.length || 0;\r\n                for (var i = 0; i < len; i++) {\r\n                    var key = this._internalStorage.key(i);\r\n                    if (key.indexOf(keyPrefix) === 0) {\r\n                        keyList.push(key);\r\n                    }\r\n                }\r\n            }\r\n            catch (e) {\r\n                // No action needed\r\n            }\r\n            return keyList;\r\n        }\r\n        public isLocalStorageAvailable(): boolean {\r\n            return (this._internalStorage != null);\r\n        }\r\n    }\r\n}\r\ntry {\r\n    (function () {\r\n        OSF.Flights = OSF.OUtil.parseFlights(true);\r\n        OSF.DisabledChangeGates = OSF.OUtil.parseDisabledChangeGates(true);\r\n    })();\r\n}\r\ncatch (ex) { }\r\nnamespace OSF {\r\n    export enum WindowNameItemKeys {\r\n        BaseFrameName = \"baseFrameName\",\r\n        HostInfo = \"hostInfo\",\r\n        XdmInfo = \"xdmInfo\",\r\n        SerializerVersion = \"serializerVersion\",\r\n        AppContext = \"appContext\",\r\n        Flights = \"flights\",\r\n        DisabledChangeGates = \"disabledChangeGates\",\r\n        OfficeJsUrl = \"officeJsUrl\",\r\n    }\r\n    export enum XdmFieldName {\r\n        ConversationUrl = \"ConversationUrl\",\r\n        AppId = \"AppId\"\r\n    }\r\n    export enum Settings {\r\n    }\r\n\r\n    // Deprecated: The FlightNames enum is deprecated. Use the FlightTreatmentNames enum for all new flights.\r\n    export enum FlightNames {\r\n        UseOriginNotUrl = 0,\r\n        // 1,\r\n        AddinEnforceHttps = 2,\r\n        // 3,\r\n        // 4,\r\n        // 5,\r\n        FirstPartyAnonymousProxyReadyCheckTimeout = 6,\r\n        // 7,\r\n        // 8,\r\n        AddinRibbonIdAllowUnknown = 9,\r\n        ManifestParserDevConsoleLog = 15,\r\n        // 16,\r\n        // 17,\r\n        AddinActionDefinitionHybridMode = 18,\r\n        UseActionIdForUILessCommand = 20,\r\n        // 21,\r\n        SetFocusToTaskpaneIsEnabled = 22,\r\n        ShortcutInfoArrayInUserPreferenceData = 23,\r\n\r\n        OSFTestFlight1000 = OSF.TestFlightStart,\r\n        OSFTestFlight1001 = OSF.TestFlightStart + 1,\r\n        OSFTestFlight1002 = OSF.TestFlightStart + 2,\r\n        OSFTestFlight1003 = OSF.TestFlightStart + 3,\r\n        OSFTestFlight1004 = OSF.TestFlightStart + 4,\r\n        OSFTestFlight1005 = OSF.TestFlightStart + 5,\r\n        OSFTestFlight1006 = OSF.TestFlightStart + 6,\r\n        OSFTestFlight1007 = OSF.TestFlightStart + 7,\r\n        OSFTestFlight1008 = OSF.TestFlightStart + 8,\r\n        OSFTestFlight1009 = OSF.TestFlightEnd\r\n    }\r\n\r\n    export enum TrustUXFlightValues {\r\n        TrustUXExperimentA = 0,\r\n        TrustUXExperimentB = 1,\r\n        TrustUXExperimentC = 2\r\n    }\r\n\r\n    // List of flight treatments can to be added and queryalbe from the OSF.Flights dictionary.\r\n    export enum FlightTreatmentNames {\r\n        CheckProxyIsReadyRetry = \"Microsoft.Office.SharedOnline.OEP.CheckProxyIsReadyRetry\",\r\n        InsertionDialogFixesEnabled = \"Microsoft.Office.SharedOnline.InsertionDialogFixesEnabled\",\r\n        WopiPreinstalledAddInsEnabled = \"Microsoft.Office.SharedOnline.WopiPreinstalledAddInsEnabled\",\r\n        WopiUseNewActivate = \"Microsoft.Office.SharedOnline.WopiUseNewActivate\",\r\n        EnsureStringsBeforeTrustErrorKill = \"Microsoft.Office.SharedOnline.EnsureStringsBeforeTrustErrorKill\", //ssnyder\r\n        MosManifestEnabled = \"Microsoft.Office.SharedOnline.OEP.MosManifest\", // owner: maagr\r\n        MosForOmexEnabled = \"Microsoft.Office.SharedOnline.MosForOmexEnabled\", //owner: phtai\r\n        MosForPrivateCatalogEnabled = \"Microsoft.Office.SharedOnline.MosForPrivateCatalogEnabled\", //owner: mayurandhare\r\n        ContextSlideShowEnvironmentEnabled = \"Microsoft.Office.SharedOnline.ContextSlideShowEnvironmentEnabled\", // owner: qichen\r\n        CheckRequiredGroupIconsEnabled = \"Microsoft.Office.SharedOnline.OEP.CheckRequiredGroupIconsEnabled\", // owner: myu\r\n        OSFJSEUDB = \"Microsoft.Office.SharedOnline.OSFJS.EUDB\", //owner:vipinzar\r\n        HostTrustDialog = \"Microsoft.Office.SharedOnline.HostTrustDialog\", //owner: junlai\r\n        RequirementSetRibbonApiOnePointThreePrime = \"Microsoft.Office.SharedOnline.RequirementSetRibbonApiOnePointThreePrime\", // owner: ssnyder\r\n        AddinDetailsServiceSupportEnabled = \"Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled\", // owner: ddguo\r\n        GetAddinFlyoutEnabled = \"Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled\", // owner: gingjia\r\n        BackstageEnabled = \"Microsoft.Office.SharedOnline.NewBackstageEnabled\", // owner: hermanwen\r\n        ProcessMultipleCommandsInDequeInvoker = \"Microsoft.Office.SharedOnline.ProcessMultipleCommandsInDequeInvoker\", // owner: rampathak\r\n        EnablingWindowOpenUsageLogging = \"Microsoft.Office.SharedOnline.EnablingWindowOpenUsageLogging\" // owner: anjtp\r\n        // This is intended for non-killswitch feature gate only (feature is default off)\r\n        // For kill switch scenario - Use OSF.OUtil.isChangeGateEnabled('OfficeVSO:123456_MyFeatureName') instead\r\n        // Please create a change gate removal tracking bug manually in VSO and reference it as part of change gate name\r\n    }\r\n\r\n    export let TestFlightEnd = 1009;\r\n    export let TestFlightStart = 1000;\r\n    export let Flights = [];\r\n    export let DisabledChangeGates = [];\r\n    export let IntFlights: { [key: string]: number } = {};\r\n    export class OUtilClass {\r\n        _uniqueId: number;\r\n        _xdmInfoKey: string;\r\n        _serializerVersionKey: string;\r\n        _flightsKey: string;\r\n        _disabledChangeGatesKey: string;\r\n        _disabledChangeGatesKeyPrefix: string;\r\n        _xdmSessionKeyPrefix: string;\r\n        _serializerVersionKeyPrefix: string;\r\n        _flightsKeyPrefix: string;\r\n        _fragmentSeparator: string;\r\n        _fragmentInfoDelimiter: string;\r\n        _classN: string;\r\n        _loadedScripts: any;\r\n        _defaultScriptLoadingTimeout: number;\r\n        _safeSessionStorage: OfficeExt.IBasicStorage;\r\n        _safeLocalStorage: OfficeExt.IBasicStorage;\r\n        _rndentropy: number;\r\n        Guid: { generateNewGuid: () => string };\r\n        _getSessionStorage: () => OfficeExt.IBasicStorage;\r\n        _random: () => string;\r\n        _reOrderTabbableElements: <T extends {tabIndex: number}>(arr: T[]) => T[];\r\n\r\n        constructor() {\r\n            this._uniqueId = -1;\r\n            this._xdmInfoKey = \"&_xdm_Info=\";\r\n            this._serializerVersionKey = \"&_serializer_version=\";\r\n            this._flightsKey = \"&_flights=\";\r\n            this._disabledChangeGatesKey = \"&_disabledChangeGates=\";\r\n            this._xdmSessionKeyPrefix = \"_xdm_\";\r\n            this._serializerVersionKeyPrefix = \"_serializer_version=\";\r\n            this._flightsKeyPrefix = \"_flights=\";\r\n            this._disabledChangeGatesKeyPrefix = \"_disabledChangeGates=\";\r\n            this._fragmentSeparator = \"#\";\r\n            this._fragmentInfoDelimiter = \"&\";\r\n            this._classN = \"class\";\r\n            this._loadedScripts = {};\r\n            this._defaultScriptLoadingTimeout = 30000;\r\n            // @ts-expect-error TS2339\r\n            this._safeSessionStorage = OfficeExt.IBasicStorage = null;\r\n            // @ts-expect-error TS2339\r\n            this._safeLocalStorage = OfficeExt.IBasicStorage = null;\r\n            // use this._rndentropy to introduce the timer entropy to the random number make it more unpredictable than Math.randrom()\r\n            this._rndentropy = new Date().getTime();\r\n            this._random = function() {\r\n                var nextrand = 0x7fffffff * Math.random();\r\n                nextrand ^= this._rndentropy ^ (new Date().getMilliseconds() << Math.floor(Math.random() * (31 - 10)));\r\n                // milliseconds range is 0-999 or 10 bits, max is 31 bits, so randomly shift 0 to 21 bits\r\n                return nextrand.toString(16);\r\n            }\r\n            this._getSessionStorage = function(): OfficeExt.IBasicStorage {\r\n                if (!this._safeSessionStorage) {\r\n                    try {\r\n                        var sessionStorage = window.sessionStorage;\r\n                    } catch (ex) {\r\n                        sessionStorage = null;\r\n                    }\r\n                    this._safeSessionStorage = new OfficeExt.SafeStorage(sessionStorage);\r\n                }\r\n                return this._safeSessionStorage;\r\n            }\r\n            this._reOrderTabbableElements = function<T extends {tabIndex: number}>(elements: T[]): T[] {\r\n                var bucket0: T[] = [];\r\n                var bucketPositive: T[] = [];\r\n                var i;\r\n                var len = elements.length;\r\n                var ele;\r\n                for (i = 0; i < len; i++) {\r\n                    ele = elements[i];\r\n                    if (ele.tabIndex) {\r\n                        if (ele.tabIndex > 0) {\r\n                            bucketPositive.push(ele);\r\n                        } else if (ele.tabIndex === 0) {\r\n                            bucket0.push(ele);\r\n                        }\r\n                    } else {\r\n                        bucket0.push(ele);\r\n                    }\r\n                }\r\n                // In javascript, the sort method is a unstable sorting, in order to make the result stable\r\n                // if in case their tabIndex is same, we will use the order in array to decide their position\r\n                bucketPositive = bucketPositive.sort(function(left, right) {\r\n                    var diff = left.tabIndex - right.tabIndex;\r\n                    if (diff === 0) {\r\n                        diff = bucketPositive.indexOf(left) - bucketPositive.indexOf(right);\r\n                    }\r\n                    return diff;\r\n                });\r\n                return [].concat(bucketPositive, bucket0);\r\n            }\r\n            this.Guid = (function() {\r\n                var hexCode = [\"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"a\", \"b\", \"c\", \"d\", \"e\", \"f\"];\r\n                return {\r\n                    /**\r\n                     * Generates a new v4 GUID string\r\n                     * @return {string} The newly generated GUID string\r\n                     */\r\n                    generateNewGuid: function OSF_Outil_Guid$generateNewGuid() {\r\n                        var result = \"\";\r\n                        var tick = new Date().getTime();\r\n                        var index = 0;\r\n                        // add time tick to guid\r\n                        for (; index < 32 && tick > 0; index++) {\r\n                            if (index == 8 || index == 12 || index == 16 || index == 20) {\r\n                                result += \"-\";\r\n                            }\r\n                            result += hexCode[tick % 16];\r\n                            tick = Math.floor(tick / 16);\r\n                        }\r\n                        // add random number to guid\r\n                        for (; index < 32; index++) {\r\n                            if (index == 8 || index == 12 || index == 16 || index == 20) {\r\n                                result += \"-\";\r\n                            }\r\n                            result += hexCode[Math.floor(Math.random() * 16)];\r\n                        }\r\n                        return result;\r\n                    },\r\n                };\r\n            })();\r\n        }\r\n        isChangeGateEnabled(name: string): boolean {\r\n            // New convention of change gate name: OfficeVSO:123456_FeatureName\r\n            // Legacy feature-gate-based kill switch: Microsoft.Office.SharedOnline.FeatureNameKillSwitch\r\n            const strippedPrefixName = name.slice(name.indexOf('_') + 1);\r\n            const legacyKillSwitchName = `Microsoft.Office.SharedOnline.${strippedPrefixName}KillSwitch`;\r\n            return OSF.DisabledChangeGates.indexOf(name) === -1 && !this.checkFlight(legacyKillSwitchName);\r\n        }\r\n        set_entropy(entropy) {\r\n            if (typeof entropy == \"string\") {\r\n                for (var i = 0; i < entropy.length; i += 4) {\r\n                    var temp = 0;\r\n                    for (var j = 0; j < 4 && i + j < entropy.length; j++) {\r\n                        temp = (temp << 8) + entropy.charCodeAt(i + j);\r\n                    }\r\n                    this._rndentropy ^= temp;\r\n                }\r\n            } else if (typeof entropy == \"number\") {\r\n                this._rndentropy ^= entropy;\r\n            } else {\r\n                this._rndentropy ^= 0x7fffffff * Math.random();\r\n            }\r\n            this._rndentropy &= 0x7fffffff;\r\n        }\r\n        extend(child, parent) {\r\n            var F = function() {};\r\n            F.prototype = parent.prototype;\r\n            child.prototype = new F();\r\n            child.prototype.constructor = child;\r\n            child.uber = parent.prototype;\r\n            if (parent.prototype.constructor === (Object.prototype as any).constructor) {\r\n                parent.prototype.constructor = parent;\r\n            }\r\n        }\r\n        setNamespace(name, /*@dynamic*/ parent) {\r\n            if (parent && name && !parent[name]) {\r\n                parent[name] = {};\r\n            }\r\n        }\r\n        unsetNamespace(name, parent) {\r\n            if (parent && name && parent[name]) {\r\n                delete parent[name];\r\n            }\r\n        }\r\n        serializeSettings(settingsCollection) {\r\n            var ret = {};\r\n            for (var key in settingsCollection) {\r\n                var value = settingsCollection[key];\r\n                try {\r\n                    if (JSON) {\r\n                        //use replacer to serialize date into Date(number) format\r\n                        //where number is the number of milliseconds since 01.01.1970\r\n                        value = JSON.stringify(value, function dateReplacer(k, v) {\r\n                            return OSF.OUtil.isDate(this[k])\r\n                            // @ts-expect-error TS2339\r\n                                ? OSF.DDA.SettingsManager.DateJSONPrefix +\r\n                                      this[k].getTime() +\r\n                                      // @ts-expect-error TS2339\r\n                                      OSF.DDA.SettingsManager.DataJSONSuffix\r\n                                : v;\r\n                        });\r\n                    } else {\r\n                        value = Sys.Serialization.JavaScriptSerializer.serialize(value);\r\n                    }\r\n                    ret[key] = value;\r\n                } catch (ex) {\r\n                    // Ignore invalid characters and proceed\r\n                }\r\n            }\r\n            return ret;\r\n        }\r\n        deserializeSettings(serializedSettings) {\r\n            var ret = {};\r\n            serializedSettings = serializedSettings || {};\r\n            for (var key in serializedSettings) {\r\n                var value = serializedSettings[key];\r\n                try {\r\n                    if (JSON) {\r\n                        //use reviver to deserialize date from Date(number) format\r\n                        //where number is the number of milliseconds since 01.01.1970\r\n                        value = JSON.parse(value, function dateReviver(k, v) {\r\n                            var d;\r\n                            if (\r\n                                typeof v === \"string\" &&\r\n                                v &&\r\n                                v.length > 6 &&\r\n                                // @ts-expect-error TS2339\r\n                                v.slice(0, 5) === OSF.DDA.SettingsManager.DateJSONPrefix &&\r\n                                // @ts-expect-error TS2339\r\n                                v.slice(-1) === OSF.DDA.SettingsManager.DataJSONSuffix\r\n                            ) {\r\n                                d = new Date(parseInt(v.slice(5, -1)));\r\n                                if (d) {\r\n                                    return d;\r\n                                }\r\n                            }\r\n                            return v;\r\n                        });\r\n                    } else {\r\n                        //pass true as 2nd optional parameter(secure) to allow JavaScriptSerializer sanitize against JSON security using regular expression\r\n                        value = Sys.Serialization.JavaScriptSerializer.deserialize(value, true);\r\n                    }\r\n                    ret[key] = value;\r\n                } catch (ex) {\r\n                    // Ignore invalid characters and proceed\r\n                }\r\n            }\r\n            return ret;\r\n        }\r\n        loadScript(url, callback, timeoutInMs?) {\r\n            if (url && callback) {\r\n                var doc = window.document;\r\n                var _loadedScriptEntry = this._loadedScripts[url];\r\n                if (!_loadedScriptEntry) {\r\n                    var script = doc.createElement(\"script\");\r\n                    script.type = \"text/javascript\";\r\n                    _loadedScriptEntry = { loaded: false, pendingCallbacks: [callback], timer: null };\r\n                    this._loadedScripts[url] = _loadedScriptEntry;\r\n                    var onLoadCallback = function OSF_OUtil_loadScript$onLoadCallback() {\r\n                        // if timer exists, clear timer\r\n                        if (_loadedScriptEntry.timer != null) {\r\n                            clearTimeout(_loadedScriptEntry.timer);\r\n                            delete _loadedScriptEntry.timer;\r\n                        }\r\n                        _loadedScriptEntry.loaded = true;\r\n                        var pendingCallbackCount = _loadedScriptEntry.pendingCallbacks.length;\r\n                        for (var i = 0; i < pendingCallbackCount; i++) {\r\n                            var currentCallback = _loadedScriptEntry.pendingCallbacks.shift();\r\n                            currentCallback();\r\n                        }\r\n                    };\r\n                    var onLoadTimeOut = function OSF_OUtil_loadScript$onLoadTimeOut(oUtil : OUtilClass) {\r\n                        if (window.navigator.userAgent.indexOf(\"Trident\") > 0) {\r\n                            // IE does not support the Event constructor.\r\n                            onLoadError(oUtil, null);\r\n                        }\r\n                        else {\r\n                            onLoadError(oUtil, new Event(\"Script load timed out\"));\r\n                        }\r\n                    };\r\n                    var onLoadError = function OSF_OUtil_loadScript$onLoadError(oUtil : OUtilClass, errorEvent : Event) {\r\n                        delete oUtil._loadedScripts[url];\r\n                        if (_loadedScriptEntry.timer != null) {\r\n                            clearTimeout(_loadedScriptEntry.timer);\r\n                            delete _loadedScriptEntry.timer;\r\n                        }\r\n                        var pendingCallbackCount = _loadedScriptEntry.pendingCallbacks.length;\r\n                        for (var i = 0; i < pendingCallbackCount; i++) {\r\n                            var currentCallback = _loadedScriptEntry.pendingCallbacks.shift();\r\n                            currentCallback();\r\n                        }\r\n                    };\r\n                    if ((script as any).readyState) {\r\n                        //IE\r\n                        (script as any).onreadystatechange = function() {\r\n                            if ((script as any).readyState == \"loaded\" || (script as any).readyState == \"complete\") {\r\n                                (script as any).onreadystatechange = null;\r\n                                onLoadCallback();\r\n                            }\r\n                        };\r\n                    } else {\r\n                        //Other browsers\r\n                        script.onload = onLoadCallback;\r\n                    }\r\n                    script.onerror = () => { onLoadError(this, new Event(\"Script load timed out\")); }\r\n                    // onerror doesn't work for Firefox when src is nonexisting UNC path\r\n                    // see active bug https://bugzilla.mozilla.org/show_bug.cgi?id=621276\r\n                    // use timer to work around that issue\r\n                    timeoutInMs = timeoutInMs || this._defaultScriptLoadingTimeout;\r\n                    _loadedScriptEntry.timer = setTimeout(() => { onLoadTimeOut(this); } , timeoutInMs);\r\n                    script.setAttribute(\"crossOrigin\", \"anonymous\");\r\n                    script.src = url;\r\n                    doc.getElementsByTagName(\"head\")[0].appendChild(script);\r\n                } else if (_loadedScriptEntry.loaded) {\r\n                    // loaded, just invoke callback directly\r\n                    callback();\r\n                } else {\r\n                    // still loading, add callback to the pending callbacks\r\n                    _loadedScriptEntry.pendingCallbacks.push(callback);\r\n                }\r\n            }\r\n        }\r\n        loadCSS(url) {\r\n            if (url) {\r\n                var doc = window.document;\r\n                var link = doc.createElement(\"link\");\r\n                link.type = \"text/css\";\r\n                link.rel = \"stylesheet\";\r\n                link.href = url;\r\n                doc.getElementsByTagName(\"head\")[0].appendChild(link);\r\n            }\r\n        }\r\n        parseEnum(str, enumObject) {\r\n            var parsed = enumObject[str.trim()];\r\n            if (typeof parsed == \"undefined\") {\r\n                OsfMsAjaxFactory.msAjaxDebug.trace(\"invalid enumeration string:\" + str);\r\n                throw OsfMsAjaxFactory.msAjaxError.argument(\"str\");\r\n            }\r\n            return parsed;\r\n        }\r\n\t// return a function which will delay execution of a function passed to this function and cache the result for future calls\r\n        // argument should be a function defined to take parameters required for first call to this function's return function\r\n        delayExecutionAndCache() {\r\n            var obj: any = { calc: arguments[0] };\r\n            return function() {\r\n                if (obj.calc) {\r\n                    obj.val = obj.calc.apply(this, arguments);\r\n                    delete obj.calc;\r\n                }\r\n                return obj.val;\r\n            };\r\n        }\r\n\t// return an unique Id (This is a simple integer. It only unique in its only window or iframe.\r\n        getUniqueId() {\r\n            this._uniqueId = this._uniqueId + 1;\r\n            return this._uniqueId.toString();\r\n        }\r\n        formatString(...args: any[]) {\r\n            // TODO: OSFJSREFACTOR: review function signature change.\r\n            var source = args[0];\r\n            return source.replace(/{(\\d+)}/gm, function(match, number) {\r\n                var index = parseInt(number, 10) + 1;\r\n                return args[index] === undefined ? \"{\" + number + \"}\" : args[index];\r\n            });\r\n        }\r\n        generateConversationId() {\r\n            return [this._random(), this._random(), new Date().getTime().toString()].join(\"_\");\r\n        }\r\n        getFrameName(cacheKey) {\r\n            return this._xdmSessionKeyPrefix + cacheKey + this.generateConversationId();\r\n        }\r\n        addXdmInfoAsHash(url, xdmInfoValue) {\r\n            // xdmInfo cannot be encoded due to compatibility with office.js and must be added to end of fragment due to this\r\n            return OSF.OUtil.addInfoAsHash(url, this._xdmInfoKey, xdmInfoValue, false /*encodeInfo*/);\r\n        }\r\n        addSerializerVersionAsHash(url, serializerVersion) {\r\n            return OSF.OUtil.addInfoAsHash(url, this._serializerVersionKey, serializerVersion, true /*encodeInfo*/);\r\n        }\r\n        addFlightsAsHash(url, flights) {\r\n            return OSF.OUtil.addInfoAsHash(url, this._flightsKey, flights, true /*encodeInfo*/);\r\n        }\r\n        addDisabledChangeGatesAsHash(url, disabledChangeGates) {\r\n            return OSF.OUtil.addInfoAsHash(url, this._disabledChangeGatesKey, disabledChangeGates, true /*encodeInfo*/);\r\n        }\r\n        addInfoAsHash(url, keyName, infoValue, encodeInfo) {\r\n            url = url.trim() || \"\";\r\n            var urlParts = url.split(this._fragmentSeparator);\r\n            var urlWithoutFragment = urlParts.shift();\r\n            var fragment = urlParts.join(this._fragmentSeparator); //handle case where multiple # exist\r\n            // If info can be encoded, then placement does not matter because & can be used to seperate multiple parameters\r\n            var newFragment;\r\n            if (encodeInfo) {\r\n                newFragment = [keyName, encodeURIComponent(infoValue), fragment].join(\"\");\r\n            } else {\r\n                // Placement matters as we cannot use any delimiter when parsing info\r\n                newFragment = [fragment, keyName, infoValue].join(\"\");\r\n            }\r\n            return [urlWithoutFragment, this._fragmentSeparator, newFragment].join(\"\");\r\n        }\r\n        // Parse and return the host information from window name, return null if it doesn't exist.\r\n        parseHostInfoFromWindowName(skipSessionStorage, windowName) {\r\n            return OSF.OUtil.parseInfoFromWindowName(skipSessionStorage, windowName, OSF.WindowNameItemKeys.HostInfo);\r\n        }\r\n        // Call parseXdmInfoWithGivenFragment() with window.location.hash, the default hash string.\r\n        // if the info from window url is null, then call parseXdmInfoFromWindowName() to get info from window name\r\n        // OM 1882058: Don't use this function for office.js because window.location.hash may be overwritten by 3rd party JS library.\r\n        parseXdmInfo(skipSessionStorage) {\r\n            var xdmInfoValue = OSF.OUtil.parseXdmInfoWithGivenFragment(skipSessionStorage, window.location.hash);\r\n            if (!xdmInfoValue) {\r\n                xdmInfoValue = OSF.OUtil.parseXdmInfoFromWindowName(skipSessionStorage, window.name);\r\n            }\r\n            return xdmInfoValue;\r\n        }\r\n\r\n\t    parseXdmInfoFromWindowName(skipSessionStorage, windowName) {\r\n            return OSF.OUtil.parseInfoFromWindowName(skipSessionStorage, windowName, OSF.WindowNameItemKeys.XdmInfo);\r\n        }\r\n        parseXdmInfoWithGivenFragment(skipSessionStorage, fragment) {\r\n            return OSF.OUtil.parseInfoWithGivenFragment(\r\n                this._xdmInfoKey,\r\n                this._xdmSessionKeyPrefix,\r\n                false /*decodeInfo*/,\r\n                skipSessionStorage,\r\n                fragment\r\n            );\r\n        }\r\n        parseSerializerVersion(skipSessionStorage) {\r\n            var serializerVersion = OSF.OUtil.parseSerializerVersionWithGivenFragment(\r\n                skipSessionStorage,\r\n                window.location.hash\r\n            );\r\n            if (isNaN(serializerVersion)) {\r\n                serializerVersion = OSF.OUtil.parseSerializerVersionFromWindowName(skipSessionStorage, window.name);\r\n            }\r\n            return serializerVersion;\r\n        }\r\n        parseSerializerVersionFromWindowName(skipSessionStorage, windowName) {\r\n            return parseInt(\r\n                OSF.OUtil.parseInfoFromWindowName(skipSessionStorage, windowName, OSF.WindowNameItemKeys.SerializerVersion)\r\n            );\r\n        }\r\n        parseSerializerVersionWithGivenFragment(skipSessionStorage, fragment) {\r\n            return parseInt(\r\n                OSF.OUtil.parseInfoWithGivenFragment(\r\n                    this._serializerVersionKey,\r\n                    this._serializerVersionKeyPrefix,\r\n                    true /*decodeInfo*/,\r\n                    skipSessionStorage,\r\n                    fragment\r\n                )\r\n            );\r\n        }\r\n        parseFlights(skipSessionStorage) {\r\n            var flights = OSF.OUtil.parseFlightsWithGivenFragment(skipSessionStorage, window.location.hash);\r\n            if (flights.length == 0) {\r\n                flights = OSF.OUtil.parseFlightsFromWindowName(skipSessionStorage, window.name);\r\n            }\r\n            return flights;\r\n        }\r\n        parseDisabledChangeGates(skipSessionStorage) {\r\n            var disabledChangeGates = OSF.OUtil.parseDisabledChangeGatesWithGivenFragment(skipSessionStorage, window.location.hash);\r\n            if (disabledChangeGates.length == 0) {\r\n                disabledChangeGates = OSF.OUtil.parseDisabledChangeGatesFromWindowName(skipSessionStorage, window.name);\r\n            }\r\n            return disabledChangeGates;\r\n        }\r\n        checkFlight(flight) {\r\n            return OSF.Flights && OSF.Flights.indexOf(flight) >= 0;\r\n        }\r\n        pushFlight(flight) {\r\n            if (OSF.Flights.indexOf(flight) < 0) {\r\n                OSF.Flights.push(flight);\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        getBooleanSetting(settingName) {\r\n            return OSF.OUtil.getBooleanFromDictionary(OSF.Settings, settingName);\r\n        }\r\n        getBooleanFromDictionary(settings: any, settingName: string) {\r\n            var result: boolean =\r\n                settings &&\r\n                settingName &&\r\n                settings[settingName] !== undefined &&\r\n                settings[settingName] &&\r\n                ((typeof settings[settingName] === \"string\" && settings[settingName].toUpperCase() === \"TRUE\") ||\r\n                    (typeof settings[settingName] === \"boolean\" && settings[settingName]));\r\n            return result !== undefined ? result : false;\r\n        }\r\n\r\n        getIntFromDictionary(settings: any, settingName: string) {\r\n            if (settings && settingName && settings[settingName] !== undefined && (typeof settings[settingName] === \"string\")) {\r\n                return parseInt(settings[settingName]);\r\n            } else {\r\n                // Default NaN\r\n                return NaN;\r\n            }\r\n        }\r\n        pushIntFlight(flight: string, flightValue: number) {\r\n            if (!(flight in OSF.IntFlights)) {\r\n                OSF.IntFlights[flight] = flightValue;\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        getIntFlight(flight) {\r\n            if (OSF.IntFlights && (flight in OSF.IntFlights)) {\r\n                return OSF.IntFlights[flight];\r\n            } else {\r\n                return NaN;\r\n            }\r\n        }\r\n\r\n        parseFlightsFromWindowName(skipSessionStorage, windowName) {\r\n            return OSF.OUtil.parseArrayWithDefault(\r\n                OSF.OUtil.parseInfoFromWindowName(skipSessionStorage, windowName, OSF.WindowNameItemKeys.Flights)\r\n            );\r\n        }\r\n        parseFlightsWithGivenFragment(skipSessionStorage, fragment) {\r\n            return OSF.OUtil.parseArrayWithDefault(\r\n                OSF.OUtil.parseInfoWithGivenFragment(\r\n                    this._flightsKey,\r\n                    this._flightsKeyPrefix,\r\n                    true /*decodeInfo*/,\r\n                    skipSessionStorage,\r\n                    fragment\r\n                )\r\n            );\r\n        }\r\n        parseDisabledChangeGatesFromWindowName(skipSessionStorage, windowName) {\r\n            return OSF.OUtil.parseArrayWithDefault(\r\n                OSF.OUtil.parseInfoFromWindowName(skipSessionStorage, windowName, OSF.WindowNameItemKeys.DisabledChangeGates)\r\n            );\r\n        }\r\n        parseDisabledChangeGatesWithGivenFragment(skipSessionStorage, fragment) {\r\n            return OSF.OUtil.parseArrayWithDefault(\r\n                OSF.OUtil.parseInfoWithGivenFragment(\r\n                    this._disabledChangeGatesKey,\r\n                    this._disabledChangeGatesKeyPrefix,\r\n                    true /*decodeInfo*/,\r\n                    skipSessionStorage,\r\n                    fragment\r\n                )\r\n            );\r\n        }\r\n        parseArrayWithDefault(jsonString) {\r\n            var array = [];\r\n            try {\r\n                array = JSON.parse(jsonString);\r\n            } catch (ex) {}\r\n            if (!Array.isArray(array)) {\r\n                array = [];\r\n            }\r\n            return array;\r\n        }\r\n        parseInfoFromWindowName(skipSessionStorage, windowName, infoKey) {\r\n            try {\r\n                var windowNameObj = JSON.parse(windowName);\r\n                var infoValue = windowNameObj != null ? windowNameObj[infoKey] : null;\r\n                var osfSessionStorage = this._getSessionStorage();\r\n                if (!skipSessionStorage && osfSessionStorage && windowNameObj != null) {\r\n                    var sessionKey = windowNameObj[OSF.WindowNameItemKeys.BaseFrameName] + infoKey;\r\n                    if (infoValue) {\r\n                        osfSessionStorage.setItem(sessionKey, infoValue);\r\n                    } else {\r\n                        //try reading from session if not available from windowName\r\n                        infoValue = osfSessionStorage.getItem(sessionKey);\r\n                    }\r\n                }\r\n                return infoValue;\r\n            } catch (Exception) {\r\n                return null;\r\n            }\r\n        }\r\n        parseInfoWithGivenFragment(infoKey, infoKeyPrefix, decodeInfo, skipSessionStorage, fragment) {\r\n            var fragmentParts = fragment.split(infoKey);\r\n            var infoValue = fragmentParts.length > 1 ? fragmentParts[fragmentParts.length - 1] : null;\r\n            if (decodeInfo && infoValue != null) {\r\n                if (infoValue.indexOf(this._fragmentInfoDelimiter) >= 0) {\r\n                    infoValue = infoValue.split(this._fragmentInfoDelimiter)[0];\r\n                }\r\n                infoValue = decodeURIComponent(infoValue);\r\n            }\r\n            var osfSessionStorage = this._getSessionStorage();\r\n            if (!skipSessionStorage && osfSessionStorage) {\r\n                var sessionKeyStart = window.name.indexOf(infoKeyPrefix);\r\n                if (sessionKeyStart > -1) {\r\n                    var sessionKeyEnd = window.name.indexOf(\";\", sessionKeyStart);\r\n                    if (sessionKeyEnd == -1) {\r\n                        sessionKeyEnd = window.name.length;\r\n                    }\r\n                    var sessionKey = window.name.substring(sessionKeyStart, sessionKeyEnd);\r\n                    if (infoValue) {\r\n                        osfSessionStorage.setItem(sessionKey, infoValue);\r\n                    } else {\r\n                        //try reading from session if not available from hash\r\n                        infoValue = osfSessionStorage.getItem(sessionKey);\r\n                    }\r\n                }\r\n            }\r\n            return infoValue;\r\n        }\r\n\t// get xdm conversation id from search string\r\n        getConversationId() {\r\n            var searchString = window.location.search;\r\n            var conversationId = null;\r\n            if (searchString) {\r\n                var index = searchString.indexOf(\"&\");\r\n                // search string always start with ?, so get content at index 1\r\n                conversationId = index > 0 ? searchString.substring(1, index) : searchString.substr(1);\r\n                if (conversationId && conversationId.charAt(conversationId.length - 1) === \"=\") {\r\n                    conversationId = conversationId.substring(0, conversationId.length - 1);\r\n                    if (conversationId) {\r\n                        conversationId = decodeURIComponent(conversationId);\r\n                    }\r\n                }\r\n            }\r\n            return conversationId;\r\n        }\r\n        // split a xdminfo or hostvalue info, if doesn't contain new delimiter, using \"|\" and try to split again\r\n\tgetInfoItems(strInfo) {\r\n            var items = strInfo.split(URL_DELIM); //Try new delimiter first\r\n            if (typeof items[1] == \"undefined\") {\r\n                //check if it contains the new delimiter.\r\n                items = strInfo.split(\"|\"); //fallback to old delimiter\r\n            }\r\n            if (typeof items[1] == \"undefined\") {\r\n                //check if it contains the pipe delimiter\r\n                items = strInfo.split(\"%7C\"); //safari replaces | with %7C on a server redirect\r\n            }\r\n            return items;\r\n        }\r\n        // get xdm field value from xdm info, skipSessionStorage: whether we need to get the xdm info from session storage if it is null in the window url string\r\n\tgetXdmFieldValue(xdmFieldName, skipSessionStorage) {\r\n            var fieldValue = \"\";\r\n            var xdmInfoValue = OSF.OUtil.parseXdmInfo(skipSessionStorage);\r\n            if (xdmInfoValue) {\r\n                var items = OSF.OUtil.getInfoItems(xdmInfoValue);\r\n                if (items != undefined && items.length >= 3) {\r\n                    switch (xdmFieldName) {\r\n                        case OSF.XdmFieldName.ConversationUrl:\r\n                            fieldValue = items[2];\r\n                            break;\r\n                        case OSF.XdmFieldName.AppId:\r\n                            fieldValue = items[1];\r\n                            break;\r\n                    }\r\n                }\r\n            }\r\n            return fieldValue;\r\n        }\r\n        validateParamObject(params, expectedProperties, callback) {\r\n            var e = Function._validateParams(arguments, [\r\n                { name: \"params\", type: Object, mayBeNull: false },\r\n                { name: \"expectedProperties\", type: Object, mayBeNull: false },\r\n                { name: \"callback\", type: Function, mayBeNull: true },\r\n            ]);\r\n            if (e) throw e;\r\n            for (var p in expectedProperties) {\r\n                e = Function._validateParameter(params[p], expectedProperties[p], p);\r\n                if (e) throw e;\r\n            }\r\n        }\r\n        writeProfilerMark(text) {\r\n            if (window.msWriteProfilerMark) {\r\n                window.msWriteProfilerMark(text);\r\n                OsfMsAjaxFactory.msAjaxDebug.trace(text);\r\n            }\r\n        }\r\n        outputDebug(text) {\r\n            if (\r\n                typeof OsfMsAjaxFactory !== \"undefined\" &&\r\n                OsfMsAjaxFactory.msAjaxDebug &&\r\n                OsfMsAjaxFactory.msAjaxDebug.trace\r\n            ) {\r\n                OsfMsAjaxFactory.msAjaxDebug.trace(text);\r\n            }\r\n        }\r\n        // will set attributes not specified in descriptor to true, but will respect descriptor otherwise\r\n\tdefineNondefaultProperty(obj, prop, descriptor, attributes) {\r\n            descriptor = descriptor || {};\r\n            for (var nd in attributes) {\r\n                var attribute = attributes[nd];\r\n                if (descriptor[attribute] == undefined) {\r\n                    descriptor[attribute] = true;\r\n                }\r\n            }\r\n            Object.defineProperty(obj, prop, descriptor);\r\n            return obj;\r\n        }\r\n        defineNondefaultProperties(obj, descriptors, attributes) {\r\n            descriptors = descriptors || {};\r\n            for (var prop in descriptors) {\r\n                OSF.OUtil.defineNondefaultProperty(obj, prop, descriptors[prop], attributes);\r\n            }\r\n            return obj;\r\n        }\r\n        defineEnumerableProperty(obj, prop, descriptor) {\r\n            return OSF.OUtil.defineNondefaultProperty(obj, prop, descriptor, [\"enumerable\"]);\r\n        }\r\n        defineEnumerableProperties(obj, descriptors) {\r\n            return OSF.OUtil.defineNondefaultProperties(obj, descriptors, [\"enumerable\"]);\r\n        }\r\n        defineMutableProperty(obj, prop, descriptor) {\r\n            return OSF.OUtil.defineNondefaultProperty(obj, prop, descriptor, [\"writable\", \"enumerable\", \"configurable\"]);\r\n        }\r\n        defineMutableProperties(obj, descriptors) {\r\n            return OSF.OUtil.defineNondefaultProperties(obj, descriptors, [\"writable\", \"enumerable\", \"configurable\"]);\r\n        }\r\n        finalizeProperties(obj, descriptor) {\r\n            descriptor = descriptor || {};\r\n            var props = Object.getOwnPropertyNames(obj);\r\n            var propsLength = props.length;\r\n            for (var i = 0; i < propsLength; i++) {\r\n                var prop = props[i];\r\n                var desc = Object.getOwnPropertyDescriptor(obj, prop);\r\n                if (!desc.get && !desc.set) {\r\n                    desc.writable = descriptor.writable || false;\r\n                }\r\n                desc.configurable = descriptor.configurable || false;\r\n                desc.enumerable = descriptor.enumerable || true;\r\n                Object.defineProperty(obj, prop, desc);\r\n            }\r\n            return obj;\r\n        }\r\n        mapList(list, mapFunction) {\r\n            var ret = [];\r\n            if (list) {\r\n                for (var item in list) {\r\n                    ret.push(mapFunction(list[item]));\r\n                }\r\n            }\r\n            return ret;\r\n        }\r\n        listContainsKey(list, key) {\r\n            for (var item in list) {\r\n                if (key == item) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n        listContainsValue(list, value) {\r\n            for (var item in list) {\r\n                if (value == list[item]) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n        augmentList(list, addenda) {\r\n            var add = list.push\r\n                ? function(key, value) {\r\n                      list.push(value);\r\n                  }\r\n                : function(key, value) {\r\n                      list[key] = value;\r\n                  };\r\n            for (var key in addenda) {\r\n                add(key, addenda[key]);\r\n            }\r\n        }\r\n        redefineList(oldList, newList) {\r\n            for (var key1 in oldList) {\r\n                delete oldList[key1];\r\n            }\r\n            for (var key2 in newList) {\r\n                oldList[key2] = newList[key2];\r\n            }\r\n        }\r\n        isArray(obj) {\r\n            return Object.prototype.toString.apply(obj) === \"[object Array]\";\r\n        }\r\n        isFunction(obj) {\r\n            return Object.prototype.toString.apply(obj) === \"[object Function]\";\r\n        }\r\n        isDate(obj) {\r\n            return Object.prototype.toString.apply(obj) === \"[object Date]\";\r\n        }\r\n        addEventListener(element, eventName, listener) {\r\n            if (element.addEventListener) {\r\n                element.addEventListener(eventName, listener, false);\r\n            } else if (Sys.Browser.agent === Sys.Browser.InternetExplorer && element.attachEvent) {\r\n                element.attachEvent(\"on\" + eventName, listener);\r\n            } else {\r\n                element[\"on\" + eventName] = listener;\r\n            }\r\n        }\r\n        removeEventListener(element, eventName, listener) {\r\n            if (element.removeEventListener) {\r\n                element.removeEventListener(eventName, listener, false);\r\n            } else if (Sys.Browser.agent === Sys.Browser.InternetExplorer && element.detachEvent) {\r\n                element.detachEvent(\"on\" + eventName, listener);\r\n            } else {\r\n                element[\"on\" + eventName] = null;\r\n            }\r\n        }\r\n        xhrGet(url, onSuccess, onError) {\r\n            var xmlhttp;\r\n            try {\r\n                xmlhttp = new XMLHttpRequest();\r\n                xmlhttp.onreadystatechange = function() {\r\n                    if (xmlhttp.readyState == 4) {\r\n                        if (xmlhttp.status == 200) {\r\n                            onSuccess(xmlhttp.responseText);\r\n                        } else {\r\n                            onError(xmlhttp.status);\r\n                        }\r\n                    }\r\n                };\r\n                xmlhttp.open(\"GET\", url, true);\r\n                xmlhttp.send();\r\n            } catch (ex) {\r\n                onError(ex);\r\n            }\r\n        }\r\n\t// UTF-16 string encoding to base64 string\r\n        encodeBase64(input) {\r\n            if (!input) return input;\r\n            var codex = \"ABCDEFGHIJKLMNOP\" + \"QRSTUVWXYZabcdef\" + \"ghijklmnopqrstuv\" + \"wxyz0123456789+/=\";\r\n            var output = [];\r\n            var temp = [];\r\n            var index = 0;\r\n            var c1, c2, c3, a, b, c;\r\n            var i;\r\n            var length = input.length;\r\n            do {\r\n                // Divide each charcode into 2 bytes. So for each 3 charcodes, there will be 6 bytes.\r\n                // So there will be 2 groups of 3 bytes. Each group will be encoded into 4 codepoints that maps to 4 letters\r\n                // Finally all 8 letters will be pushed into output.\r\n                c1 = input.charCodeAt(index++);\r\n                c2 = input.charCodeAt(index++);\r\n                c3 = input.charCodeAt(index++);\r\n                i = 0;\r\n                a = c1 & 255;\r\n                b = c1 >> 8;\r\n                c = c2 & 255;\r\n                temp[i++] = a >> 2;\r\n                temp[i++] = ((a & 3) << 4) | (b >> 4);\r\n                temp[i++] = ((b & 15) << 2) | (c >> 6);\r\n                temp[i++] = c & 63;\r\n                if (!isNaN(c2)) {\r\n                    a = c2 >> 8;\r\n                    b = c3 & 255;\r\n                    c = c3 >> 8;\r\n                    temp[i++] = a >> 2;\r\n                    temp[i++] = ((a & 3) << 4) | (b >> 4);\r\n                    temp[i++] = ((b & 15) << 2) | (c >> 6);\r\n                    temp[i++] = c & 63;\r\n                }\r\n                if (isNaN(c2)) {\r\n                    temp[i - 1] = 64;\r\n                } else if (isNaN(c3)) {\r\n                    temp[i - 2] = 64;\r\n                    temp[i - 1] = 64;\r\n                }\r\n                for (var t = 0; t < i; t++) {\r\n                    output.push(codex.charAt(temp[t]));\r\n                }\r\n            } while (index < length);\r\n            return output.join(\"\");\r\n        }\r\n        getSessionStorage() {\r\n            return this._getSessionStorage();\r\n        }\r\n        getLocalStorage() {\r\n            if (!this._safeLocalStorage) {\r\n                try {\r\n                    var localStorage = window.localStorage;\r\n                } catch (ex) {\r\n                    localStorage = null;\r\n                }\r\n                this._safeLocalStorage = new OfficeExt.SafeStorage(localStorage);\r\n            }\r\n            return this._safeLocalStorage;\r\n        }\r\n        convertIntToCssHexColor(val) {\r\n            var hex = \"#\" + (Number(val) + 0x1000000).toString(16).slice(-6);\r\n            return hex;\r\n        }\r\n        attachClickHandler(element, handler) {\r\n            element.onclick = function(e) {\r\n                handler();\r\n            };\r\n            element.ontouchend = function(e) {\r\n                handler();\r\n                e.preventDefault();\r\n            };\r\n        }\r\n        getQueryStringParamValue(queryString, paramName) {\r\n            var e = Function._validateParams(arguments, [\r\n                { name: \"queryString\", type: String, mayBeNull: false },\r\n                { name: \"paramName\", type: String, mayBeNull: false },\r\n            ]);\r\n            if (e) {\r\n                OsfMsAjaxFactory.msAjaxDebug.trace(\"OSF_Outil_getQueryStringParamValue: Parameters cannot be null.\");\r\n                return \"\";\r\n            }\r\n            var queryExp = new RegExp(\"[\\\\?&]\" + paramName + \"=([^&#]*)\", \"i\");\r\n            if (!queryExp.test(queryString)) {\r\n                OsfMsAjaxFactory.msAjaxDebug.trace(\"OSF_Outil_getQueryStringParamValue: The parameter is not found.\");\r\n                return \"\";\r\n            }\r\n            return queryExp.exec(queryString)[1];\r\n        }\r\n        /**\r\n         * Get part of the hostname allowed for logging\r\n         * Ex: Url: https://a.b.c.d.e/some/path  ---parseUrl(Url).hostname--> a.b.c.d.e --> Only d.e is allowed for logging\r\n         */\r\n        getHostnamePortionForLogging(hostname) {\r\n            var e = Function._validateParams(arguments, [{ name: \"hostname\", type: String, mayBeNull: false }]);\r\n            if (e) {\r\n                return \"\";\r\n            }\r\n            var hostnameSubstrings = hostname.split(\".\");\r\n            var len = hostnameSubstrings.length;\r\n            if (len >= 2) {\r\n                return hostnameSubstrings[len - 2] + \".\" + hostnameSubstrings[len - 1];\r\n            } else if (len == 1) {\r\n                return hostnameSubstrings[0];\r\n            }\r\n        }\r\n        isiOS() {\r\n            return window.navigator.userAgent.match(/(iPad|iPhone|iPod)/g) ? true : false;\r\n        }\r\n        isChrome() {\r\n            return window.navigator.userAgent.indexOf(\"Chrome\") > 0 && !OSF.OUtil.isEdge();\r\n        }\r\n        isEdge() {\r\n            return window.navigator.userAgent.indexOf(\"Edge\") > 0;\r\n        }\r\n        isIE() {\r\n            var isTrident = false;\r\n            // When this code is run inside of the xml to json converter (converter.ts)\r\n            // then this throws because window is undefined.  It throws even if wrapped in\r\n            // OSF.OUtil.isNullOrUndefined().  Therefore we need to have a try/catch here.\r\n            try {\r\n                isTrident = window.navigator.userAgent.indexOf(\"Trident\") > 0;\r\n            }\r\n            catch (e) {\r\n            }\r\n            return isTrident;\r\n        }\r\n        isFirefox() {\r\n            return window.navigator.userAgent.indexOf(\"Firefox\") > 0;\r\n        }\r\n        doesUrlHaveSupportedProtocol(url: string): boolean {\r\n            var isValid = false;\r\n            if (url) {\r\n                try {\r\n                    var parsedUrl = OSF.OUtil.parseUrl(url, /*enforceHttps*/ false);\r\n                    isValid = parsedUrl.protocol === 'https:' || parsedUrl.protocol === 'http:';\r\n                }\r\n                catch (ex) {\r\n                    this.sendTelemetryEvent(\"Office.Extensibility.UrlParsingForProtocolCheck\",\r\n                    [{ name: \"errorMessage\", string: \"Fix for bug 7142881 exception hit in officeutils.ts function doesUrlHaveSupportedProtocol.\" },\r\n                        { name: \"tag\", string: '0x1e88019a' /* tag_48ag0 */ }\r\n                    ]);\r\n                    var decodedUrl = decodeURIComponent(url);\r\n                    var matches = decodedUrl.match(/^https?:\\/\\/.+$/ig);\r\n                    isValid = (matches != null);\r\n                }\r\n            }\r\n            return isValid;\r\n        }\r\n        startsWith(originalString, patternToCheck, browserIsIE) {\r\n            if (browserIsIE) {\r\n                return originalString.substr(0, patternToCheck.length) === patternToCheck;\r\n            } else {\r\n                return originalString.startsWith(patternToCheck);\r\n            }\r\n        }\r\n        containsPort(url, protocol, hostname, portNumber) {\r\n            return (\r\n                this.startsWith(url, protocol + \"//\" + hostname + \":\" + portNumber, /* browserIsIE */ true) ||\r\n                this.startsWith(url, hostname + \":\" + portNumber, /* browserIsIE */ true)\r\n            );\r\n        }\r\n        getRedundandPortString(url, parser) {\r\n            if (!url || !parser) return \"\";\r\n            if (parser.protocol == \"https:\" && this.containsPort(url, \"https:\", parser.hostname, \"443\")) return \":443\";\r\n            else if (parser.protocol == \"http:\" && this.containsPort(url, \"http:\", parser.hostname, \"80\")) return \":80\";\r\n            return \"\";\r\n        }\r\n        removeChar(url, indexOfCharToRemove) {\r\n            if (indexOfCharToRemove < url.length - 1)\r\n                return url.substring(0, indexOfCharToRemove) + url.substring(indexOfCharToRemove + 1);\r\n            else if (indexOfCharToRemove == url.length - 1) return url.substring(0, url.length - 1);\r\n            else return url;\r\n        }\r\n        cleanUrlOfChar(url, charToClean) {\r\n            let i;\r\n            for (i = 0; i < url.length; i++) {\r\n                if (url.charAt(i) === charToClean) {\r\n                    if (i + 1 >= url.length) {\r\n                        return this.removeChar(url, i);\r\n                    } else if (charToClean === \"/\") {\r\n                        if (url.charAt(i + 1) === \"?\" || url.charAt(i + 1) === \"#\") {\r\n                            return this.removeChar(url, i);\r\n                        }\r\n                    } else if (charToClean === \"?\") {\r\n                        if (url.charAt(i + 1) === \"#\") {\r\n                            return this.removeChar(url, i);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            return url;\r\n        }\r\n        cleanUrl(url) {\r\n            url = this.cleanUrlOfChar(url, \"/\");\r\n            url = this.cleanUrlOfChar(url, \"?\");\r\n            url = this.cleanUrlOfChar(url, \"#\");\r\n            //remove redundand ports\r\n            if (url.substr(0, 8) == \"https://\") {\r\n                let portIndex = url.indexOf(\":443\");\r\n                if (portIndex != -1) {\r\n                    if (\r\n                        portIndex == url.length - 4 ||\r\n                        url.charAt(portIndex + 4) == \"/\" ||\r\n                        url.charAt(portIndex + 4) == \"?\" ||\r\n                        url.charAt(portIndex + 4) == \"#\"\r\n                    ) {\r\n                        url = url.substring(0, portIndex) + url.substring(portIndex + 4);\r\n                    }\r\n                }\r\n            } else if (url.substr(0, 7) == \"http://\") {\r\n                let portIndex = url.indexOf(\":80\");\r\n                if (portIndex != -1) {\r\n                    if (\r\n                        portIndex == url.length - 3 ||\r\n                        url.charAt(portIndex + 3) == \"/\" ||\r\n                        url.charAt(portIndex + 3) == \"?\" ||\r\n                        url.charAt(portIndex + 3) == \"#\"\r\n                    ) {\r\n                        url = url.substring(0, portIndex) + url.substring(portIndex + 3);\r\n                    }\r\n                }\r\n            }\r\n            return url;\r\n        }\r\n        /**\r\n         * Parse url into an object similar to the new URL library (enforceHttps decideds if SSL is enforced).\r\n         * Caviat: as per the new URL library, redundant port numbers in the url such as ':443' when using 'https:' will be ignored/not returned\r\n         */\r\n\tparseUrl(url, enforceHttps = false) {\r\n            if (typeof url === \"undefined\" || !url) {\r\n                return undefined;\r\n            }\r\n            const notHttpsErrorMessage = \"NotHttps\";\r\n            const invalidUrlErrorMessage = \"InvalidUrl\";\r\n            const isIEBoolean = this.isIE();\r\n            //See https://developer.mozilla.org/en-US/docs/Web/API/URL\r\n            let parsedUrlObj = {\r\n                protocol: undefined,\r\n                hostname: undefined,\r\n                host: undefined,\r\n                port: undefined,\r\n                pathname: undefined,\r\n                search: undefined,\r\n                hash: undefined,\r\n                isPortPartOfUrl: undefined,\r\n            };\r\n            try {\r\n                if (isIEBoolean) {\r\n                    let parser = document.createElement(\"a\");\r\n                    parser.href = url;\r\n                    if (\r\n                        !parser ||\r\n                        !parser.protocol ||\r\n                        !parser.host ||\r\n                        !parser.hostname ||\r\n                        !parser.href ||\r\n                        this.cleanUrl(parser.href).toLowerCase() !== this.cleanUrl(url).toLowerCase()\r\n                    ) {\r\n                        throw invalidUrlErrorMessage;\r\n                    }\r\n                    if (OSF.OUtil.checkFlight(OSF.FlightNames.AddinEnforceHttps)) {\r\n                        if (enforceHttps && parser.protocol != \"https:\") throw new Error(notHttpsErrorMessage);\r\n                    }\r\n                    //return :443 if https: is used and the port is part of the url and\r\n                    //return :80 if http: is used and the port is part of the url\r\n                    //otherwise returns \"\"\r\n                    let redundandPortString = this.getRedundandPortString(url, parser);\r\n                    parsedUrlObj.protocol = parser.protocol;\r\n                    parsedUrlObj.hostname = parser.hostname;\r\n                    //make this consistent on IE with the new URL behavior above\r\n                    parsedUrlObj.port = redundandPortString == \"\" ? parser.port : \"\";\r\n                    //make this consistent on IE with the new URL behavior above\r\n                    parsedUrlObj.host = redundandPortString != \"\" ? parser.hostname : parser.host;\r\n                    parsedUrlObj.pathname = (isIEBoolean ? \"/\" : \"\") + parser.pathname;\r\n                    parsedUrlObj.search = parser.search;\r\n                    parsedUrlObj.hash = parser.hash;\r\n                    // Check if the url actually contains the port in the string.\r\n                    parsedUrlObj.isPortPartOfUrl = this.containsPort(url, parser.protocol, parser.hostname, parser.port);\r\n                } else {\r\n                    let urlObj = new URL(url);\r\n                    if (urlObj && urlObj.protocol && urlObj.host && urlObj.hostname) {\r\n                        if (OSF.OUtil.checkFlight(OSF.FlightNames.AddinEnforceHttps)) {\r\n                            if (enforceHttps && urlObj.protocol != \"https:\") throw new Error(notHttpsErrorMessage);\r\n                        }\r\n                        parsedUrlObj.protocol = urlObj.protocol;\r\n                        parsedUrlObj.hostname = urlObj.hostname;\r\n                        parsedUrlObj.port = urlObj.port;\r\n                        parsedUrlObj.host = urlObj.host;\r\n                        parsedUrlObj.pathname = urlObj.pathname;\r\n                        parsedUrlObj.search = urlObj.search;\r\n                        parsedUrlObj.hash = urlObj.hash;\r\n                        // Check if the url actually contains the port in the string. It should be at the end of urlObj.host.\r\n                        parsedUrlObj.isPortPartOfUrl =\r\n                            urlObj.host.lastIndexOf(\":\" + urlObj.port) == urlObj.host.length - urlObj.port.length - 1;\r\n                    }\r\n                }\r\n            } catch (err) {\r\n                if (err.message === notHttpsErrorMessage) throw err;\r\n            }\r\n            return parsedUrlObj;\r\n        }\r\n        // Copies all properties of one object to a new object that is returned.  Note, this does not do recursive reference copying.\r\n        // This is currently used by WAC OSF runtime in getOmexAppDetailsAsync, because user can have apps in multiple markets we need to shallow\r\n        // copy the context or else the callback will consider all apps belonging to the same market.  For example, Japanese app could be shown in English locale.\r\n\tshallowCopy(sourceObj) {\r\n            if (sourceObj == null) {\r\n                return null;\r\n            } else if (!(sourceObj instanceof Object)) {\r\n                return sourceObj;\r\n            } else if (Array.isArray(sourceObj)) {\r\n                var copyArr = [];\r\n                for (var i = 0; i < sourceObj.length; i++) {\r\n                    copyArr.push(sourceObj[i]);\r\n                }\r\n                return copyArr;\r\n            } else {\r\n                var copyObj = sourceObj.constructor();\r\n                for (var property in sourceObj) {\r\n                    if (sourceObj.hasOwnProperty(property)) {\r\n                        copyObj[property] = sourceObj[property];\r\n                    }\r\n                }\r\n                return copyObj;\r\n            }\r\n        }\r\n        createObject(properties) {\r\n            var obj = null;\r\n            if (properties) {\r\n                obj = {};\r\n                var len = properties.length;\r\n                for (var i = 0; i < len; i++) {\r\n                    obj[properties[i].name] = properties[i].value;\r\n                }\r\n            }\r\n            return obj;\r\n        }\r\n        addClass(elmt: HTMLElement, val: string) {\r\n            if (!OSF.OUtil.hasClass(elmt, val)) {\r\n                var className = elmt.getAttribute(this._classN);\r\n                if (className) {\r\n                    elmt.setAttribute(this._classN, className + \" \" + val);\r\n                } else {\r\n                    elmt.setAttribute(this._classN, val);\r\n                }\r\n            }\r\n        }\r\n        removeClass(elmt: HTMLElement, val: string) {\r\n            if (OSF.OUtil.hasClass(elmt, val)) {\r\n                let className = elmt.getAttribute(this._classN);\r\n                let reg = new RegExp(\"(\\\\s|^)\" + val + \"(\\\\s|$)\");\r\n                className = className.replace(reg, \"\");\r\n                elmt.setAttribute(this._classN, className);\r\n            }\r\n        }\r\n        hasClass(elmt: HTMLElement, clsName: string) {\r\n            var className = elmt.getAttribute(this._classN);\r\n            return className && className.match(new RegExp(\"(\\\\s|^)\" + clsName + \"(\\\\s|$)\"));\r\n        }\r\n        focusToFirstTabbable(all, backward) {\r\n            var next;\r\n            var focused = false;\r\n            var candidate;\r\n            var setFlag = function(e) {\r\n                focused = true;\r\n            };\r\n            var findNextPos = function(allLen, currPos, backward) {\r\n                if (currPos < 0 || currPos > allLen) {\r\n                    return -1;\r\n                } else if (currPos === 0 && backward) {\r\n                    return -1;\r\n                } else if (currPos === allLen - 1 && !backward) {\r\n                    return -1;\r\n                }\r\n                if (backward) {\r\n                    return currPos - 1;\r\n                } else {\r\n                    return currPos + 1;\r\n                }\r\n            };\r\n            all = this._reOrderTabbableElements(all);\r\n            next = backward ? all.length - 1 : 0;\r\n            if (all.length === 0) {\r\n                return null;\r\n            }\r\n            while (!focused && next >= 0 && next < all.length) {\r\n                candidate = all[next];\r\n                // Force a focus move to window in order to fix weird behavior on latest chrome (50.0.2661.102)\r\n                // that it refuse to set focus on an element it think was focused (actually the focus already moved away)\r\n                window.focus();\r\n                candidate.addEventListener(\"focus\", setFlag);\r\n                candidate.focus();\r\n                candidate.removeEventListener(\"focus\", setFlag);\r\n                next = findNextPos(all.length, next, backward);\r\n                // Treat for browsers who's setFlag callback won't be trigger immediately\r\n                if (!focused && candidate === document.activeElement) {\r\n                    focused = true;\r\n                }\r\n            }\r\n            if (focused) {\r\n                return candidate;\r\n            } else {\r\n                return null;\r\n            }\r\n        }\r\n        focusToNextTabbable(all, curr, shift) {\r\n            var currPos;\r\n            var next;\r\n            var focused = false;\r\n            var candidate;\r\n            var setFlag = function(e) {\r\n                focused = true;\r\n            };\r\n            var findCurrPos = function(all, curr) {\r\n                var i = 0;\r\n                for (; i < all.length; i++) {\r\n                    if (all[i] === curr) {\r\n                        return i;\r\n                    }\r\n                }\r\n                return -1;\r\n            };\r\n            var findNextPos = function(allLen, currPos, shift) {\r\n                if (currPos < 0 || currPos > allLen) {\r\n                    return -1;\r\n                } else if (currPos === 0 && shift) {\r\n                    return -1;\r\n                } else if (currPos === allLen - 1 && !shift) {\r\n                    return -1;\r\n                }\r\n                if (shift) {\r\n                    return currPos - 1;\r\n                } else {\r\n                    return currPos + 1;\r\n                }\r\n            };\r\n            all = this._reOrderTabbableElements(all);\r\n            currPos = findCurrPos(all, curr);\r\n            next = findNextPos(all.length, currPos, shift);\r\n            if (next < 0) {\r\n                return null;\r\n            }\r\n            while (!focused && next >= 0 && next < all.length) {\r\n                candidate = all[next];\r\n                candidate.addEventListener(\"focus\", setFlag);\r\n                candidate.focus();\r\n                candidate.removeEventListener(\"focus\", setFlag);\r\n                next = findNextPos(all.length, next, shift);\r\n                // Treat for browsers who's setFlag callback won't be trigger immediately\r\n                if (!focused && candidate === document.activeElement) {\r\n                    focused = true;\r\n                }\r\n            }\r\n            if (focused) {\r\n                return candidate;\r\n            } else {\r\n                return null;\r\n            }\r\n        }\r\n        isNullOrUndefined(value: any) {\r\n            if (typeof value === \"undefined\") {\r\n                return true;\r\n            }\r\n            if (value === null) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        isArrayNullOrUndefinedOrEmpty(value: Array<any>): boolean {\r\n            return OSF.OUtil.isNullOrUndefined(value) || value.length === 0;\r\n        }\r\n        stringEndsWith(value: string, subString: string) {\r\n            if (!OSF.OUtil.isNullOrUndefined(value) && !OSF.OUtil.isNullOrUndefined(subString)) {\r\n                if (subString.length > value.length) {\r\n                    return false;\r\n                }\r\n                if (value.substr(value.length - subString.length) === subString) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n        hashCode(str: string) {\r\n            let hash = 0;\r\n            if (!OSF.OUtil.isNullOrUndefined(str)) {\r\n                let i = 0;\r\n                const len = str.length;\r\n                while (i < len) {\r\n                    hash = ((hash << 5) - hash + str.charCodeAt(i++)) | 0;\r\n                }\r\n            }\r\n            return hash;\r\n        }\r\n        getValue(value: any, defaultValue: any) {\r\n            if (OSF.OUtil.isNullOrUndefined(value)) {\r\n                return defaultValue;\r\n            }\r\n            return value;\r\n        }\r\n        getBOMCodepointLength(data : string): number {\r\n            // Javascript supports only three types of escaping sequence\r\n            // Hexadecimal escape sequence, Unicode escape sequence and Code point escape sequence\r\n            // For Code Point escape sequence the value of BOM is same as FFEF\r\n            // utf-16 escaped \\uFFEF\r\n            if (data.charCodeAt(0) === 0xFEFF ) {\r\n                return 1;\r\n            }\r\n            // utf-8 escaped \\xEF\\xBB\\xBF\r\n            else if (data.length >= 3 &&\r\n                 (data.charCodeAt(0) === 0xEF &&\r\n                 data.charCodeAt(1) === 0xBB &&\r\n                 data.charCodeAt(2) === 0xBF)) {\r\n\r\n                return 3;\r\n            }\r\n\r\n            return 0;\r\n        }\r\n        /**\r\n         * Whether a function exposed by the native COM object exists\r\n         *\r\n         * We use typeof(func) !== 'undefined' to check whether a native COM function exists. But when the code is\r\n         * minimized by terser, it becomes\r\n         *      void 0 !== func\r\n         * As the typeof(func) is actually 'unknown', the testing (void 0 !== func) will fail.\r\n         *\r\n         * This is to workaround so that the it was not minimized to \"void 0 !== func\"\r\n         *\r\n         * @param func external function\r\n         */\r\n\texternalNativeFunctionExists(type: string) {\r\n            // Please do not remove 'unknown' check as the terser will try to inline the code and then change the code to \"void 0 !== func\"\r\n            return type === \"unknown\" || type !== \"undefined\";\r\n        }\r\n\r\n        sendTelemetryEvent(eventName: string, dataFieldsValue: any) : boolean {\r\n                if (typeof(otel) !== 'undefined' && typeof(otel.sendTelemetryEvent) !== 'undefined') {\r\n                    otel.sendTelemetryEvent({\r\n                        name: eventName,\r\n                        dataFields: dataFieldsValue\r\n                    });\r\n                    return true;\r\n                }\r\n            return false;\r\n        }\r\n        sendActivityEvent(eventName: string, eventDuration: any, eventSucceeded: any, dataFieldsValue: any) : boolean {\r\n                if (typeof(otel) !== 'undefined' && typeof(otel.sendActivityEvent) !== 'undefined') {\r\n                    otel.sendActivityEvent({\r\n                        name: eventName,\r\n                        durationMs: eventDuration,\r\n                        succeeded : eventSucceeded,\r\n                        dataFields: dataFieldsValue\r\n                    });\r\n                    return true;\r\n                }\r\n            return false;\r\n        }\r\n    }\r\n    export let OUtil = new OUtilClass();\r\n}\r\n","module OfficeExt {\r\n    function appSpecificCheckOriginFunction(allowed_domains: string[], eventObj: any, origin: string, checkOriginFunction: (allowed_domains: string[], origin: string) => boolean) {\r\n        //This should fail by default, unless overridden.\r\n        return false;\r\n    }\r\n    ;\r\n    export var appSpecificCheckOrigin: (allowed_domains: string[], eventObj: any, origin: string, checkOriginFunction: (allowed_domains: string[], origin: string) => boolean) => boolean = appSpecificCheckOriginFunction;\r\n}\r\nnamespace OSF {\r\n    export enum SerializerVersion {\r\n        MsAjax = 0,\r\n        Browser = 1\r\n    }\r\n}\r\nnamespace Microsoft {\r\n    export namespace Office {\r\n        export namespace Common {\r\n            /// <summary>\r\n            /// ResponseSender  base class for InvokeCompleteCallback and EventHandlerProxy. It contains the information\r\n            ///                  of the requester.This is the object who knows how to send data back to the requester.\r\n            /// </summary>\r\n            /// <accessibility>private</accessibility>\r\n            /// <param name=\"requesterWindow\">window object of the requester who registered for an event</param>\r\n            /// <param name=\"requesterUrl\">url string of the requester who registered for an event</param>\r\n            /// <param name=\"actionName\">method name to which the response is</param>\r\n            /// <param name=\"conversationId\">Id of the sender who sends the response</param>\r\n            /// <param name=\"correlationId\">Id of orginal calling request</param>\r\n            /// <param name=\"responseType\">the type of response</param>\r\n            export class ResponseSender {\r\n                _actionName: any;\r\n                _conversationId: any;\r\n                _correlationId: any;\r\n                _invokeResultCode: any;\r\n                _requesterUrl: any;\r\n                _requesterWindow: any;\r\n                _responseType: any;\r\n                _send: any;\r\n                constructor(requesterWindow, requesterUrl, actionName, conversationId, correlationId, responseType, serializerVersion) {\r\n                    //check parameters\r\n                    var e = Function._validateParams(arguments, [\r\n                        { name: \"requesterWindow\", mayBeNull: false },\r\n                        { name: \"requesterUrl\", type: String, mayBeNull: false },\r\n                        { name: \"actionName\", type: String, mayBeNull: false },\r\n                        { name: \"conversationId\", type: String, mayBeNull: false },\r\n                        { name: \"correlationId\", mayBeNull: false },\r\n                        { name: \"responsetype\", type: Number, maybeNull: false },\r\n                        { name: \"serializerVersion\", type: Number, maybeNull: true, optional: true }\r\n                    ]);\r\n                    if (e)\r\n                        throw e;\r\n                    //window object of the requester\r\n                    this._requesterWindow = requesterWindow;\r\n                    //url of the requester\r\n                    this._requesterUrl = requesterUrl;\r\n                    //method name\r\n                    this._actionName = actionName;\r\n                    //sender Id\r\n                    this._conversationId = conversationId;\r\n                    //correlation Id\r\n                    this._correlationId = correlationId;\r\n                    //invoke result code\r\n                    this._invokeResultCode = Microsoft.Office.Common.InvokeResultCode.noError;\r\n                    //response type\r\n                    this._responseType = responseType;\r\n                    var me = this;\r\n                    //send back the response to the requester\r\n                    this._send = function (result) {\r\n                        var validateTargetMatchesRequester = function (targetOrigin, requesterUrl) {\r\n                            var parsedTargetOrigin = OSF.OUtil.parseUrl(targetOrigin);\r\n                            var parsedRequesterUrl = OSF.OUtil.parseUrl(requesterUrl);\r\n                            if (!parsedTargetOrigin || !parsedTargetOrigin.hostname || !parsedRequesterUrl || !parsedRequesterUrl.hostname) {\r\n                                var errorMessage = \"Failed to execute 'postMessage' on 'DOMWindow': The target origin provided or the recipient window's origin are undefined.\";\r\n                                // let 3rd party dev know they need to provide a targetOrigin when messaging cross-origin\r\n                                XDM_DEBUG(errorMessage);\r\n                                return false;\r\n                            } else if (!Microsoft.Office.Common.XdmCommunicationManager.urlCompare(parsedTargetOrigin, parsedRequesterUrl)) {\r\n                                var targetOriginToConsoleLog = parsedTargetOrigin ? (parsedTargetOrigin.protocol + \"//\" + parsedTargetOrigin.hostname + (parsedTargetOrigin.port ? (\":\" + parsedTargetOrigin.port) : \"\")) : 'undefined';\r\n                                var requesterUrlToConsoleLog = parsedRequesterUrl ? (parsedRequesterUrl.protocol + \"//\" + parsedRequesterUrl.hostname + (parsedRequesterUrl.port ? (\":\" + parsedRequesterUrl.port) : \"\")) : 'undefined';\r\n                                var errorMessage = \"Failed to execute 'postMessage' on 'DOMWindow': The target origin provided ('\" + targetOriginToConsoleLog + \"') does not match the recipient window's origin ('\" + requesterUrlToConsoleLog + \"').\";\r\n                                // mimic browser console error when sending a 'postMessage' cross-origin and the receiver's origin doesn't match the sender's intended target origin\r\n                                XDM_DEBUG(errorMessage);\r\n                                return false;\r\n                            }\r\n                            return true;\r\n                         };\r\n                \r\n                        try {\r\n                            //run validation for the inline dialog to ensure the taskpane receiving the message matches the intended targetOrigin and vice-versa\r\n                            if (me._actionName === \"dialogMessageReceived\" && result.targetOrigin !== \"*\") {\r\n                                if (result.targetOrigin) { //TODO: remove once we are ready to break cross-origin inline without targetOrigin provided BUT also pass * as the targetOrigin for dialog closed events\r\n                                    if (!validateTargetMatchesRequester(result.targetOrigin, me._requesterUrl)) {\r\n                                        return;\r\n                                    }\r\n                                }\r\n                            } else if (me._actionName === \"dialogParentMessageReceived\" && result.targetOrigin && result.targetOrigin !== \"*\") {\r\n                            //not having a targetOrigin for messageChild is perfectly fine as there may be a need to send the message to everyone in AppDomains due to child redirects\r\n                                if (!validateTargetMatchesRequester(result.targetOrigin, me._requesterUrl)) {\r\n                                    return;\r\n                                }\r\n                            }\r\n\r\n                            var response = new Microsoft.Office.Common.Response(me._actionName, me._conversationId, me._correlationId, me._invokeResultCode, me._responseType, result);\r\n                            //envelope result\r\n                            var envelopedResult = Microsoft.Office.Common.MessagePackager.envelope(response, serializerVersion);\r\n                            //send result back to the caller\r\n                            me._requesterWindow.postMessage(envelopedResult, me._requesterUrl);\r\n                        }\r\n                        catch (ex) {\r\n                            //Log errors when it fails to _send\r\n                            OsfMsAjaxFactory.msAjaxDebug.trace(\"ResponseSender._send error:\" + ex.message);\r\n                        }\r\n                    };\r\n                }\r\n                getRequesterWindow() {\r\n                    return this._requesterWindow;\r\n                }\r\n                getRequesterUrl() {\r\n                    return this._requesterUrl;\r\n                }\r\n                getActionName() {\r\n                    return this._actionName;\r\n                }\r\n                getConversationId() {\r\n                    return this._conversationId;\r\n                }\r\n                getCorrelationId() {\r\n                    return this._correlationId;\r\n                }\r\n                getSend() {\r\n                    return this._send;\r\n                }\r\n                setResultCode(resultCode) {\r\n                    this._invokeResultCode = resultCode;\r\n                }\r\n            }\r\n\r\n            /// <summary>\r\n            /// InvokeCompleteCallback - is a object which contains invocation complete callback method as well as the context of\r\n            //  current invocation instance; This is the class who knows how to send invocation result back to the sender/requester.\r\n            /// </summary>\r\n            /// <accessibility>private</accessibility>\r\n            /// <param name=\"requesterWindow\">window object of the requester who registered for an event</param>\r\n            /// <param name=\"requesterUrl\">url string of the requester who registered for an event</param>\r\n            /// <param name=\"actionName\">method name to which the response is</param>\r\n            /// <param name=\"conversationId\">Id of the sender who sends the response</param>\r\n            /// <param name=\"correlationId\">Id of orginal calling request</param>\r\n            /// <param name=\"postCallbackHandler\">optional, contains the callback method to be called once the invocation callback\r\n            ///                                   has done its part of work</param>\r\n            export class InvokeCompleteCallback extends ResponseSender {\r\n                static uber: any;\r\n                _postCallbackHandler: any;\r\n                _send: any;\r\n                _invokeResultCode: any;\r\n                _requesterWindow: any;\r\n                _actionName: any;\r\n                _conversationId: any;\r\n                _correlationId: any;\r\n                _responseType: any;\r\n                _requesterUrl: any;\r\n                constructor(requesterWindow, requesterUrl, actionName, conversationId, correlationId, postCallbackHandler, serializerVersion) {\r\n                    super(requesterWindow, requesterUrl, actionName, conversationId, correlationId, Microsoft.Office.Common.ResponseType.forCalling, serializerVersion);\r\n                    // callback method to be called after the memeber method invokeComplete is done.\r\n                    this._postCallbackHandler = postCallbackHandler;\r\n                    var me = this;\r\n                    // callback method to be called when invocation is completed.\r\n                    this._send = function (result, responseCode?) {\r\n                        // assign response code only if it's passed in the function call\r\n                        if (responseCode != undefined) {\r\n                            me._invokeResultCode = responseCode;\r\n                        }\r\n                        try {\r\n                            //Microsoft.Office.Common.InvokeCompleteCallback.uber.getSend().call(this, result);\r\n                            var response = new Microsoft.Office.Common.Response(me._actionName, me._conversationId, me._correlationId, me._invokeResultCode, me._responseType, result);\r\n                            //envelope result\r\n                            var envelopedResult = Microsoft.Office.Common.MessagePackager.envelope(response, serializerVersion);\r\n                            //send result back to the caller\r\n                            me._requesterWindow.postMessage(envelopedResult, me._requesterUrl);\r\n                            //give handler a chance to handle callee' side cleanup\r\n                            me._postCallbackHandler();\r\n                        }\r\n                        catch (ex) {\r\n                            //Log errors when it fails to _send\r\n                            OsfMsAjaxFactory.msAjaxDebug.trace(\"InvokeCompleteCallback._send error:\" + ex.message);\r\n                        }\r\n                    };\r\n                }\r\n            }\r\n\r\n            /// <summary>\r\n            /// MessagePackager  is an utility object, contains methods for envoloping/unenvolping messages\r\n            /// </summary>\r\n            /// <accessibility>private</accessibility>\r\n            export class MessagePackager {\r\n                //serialize a Request or Response Object into a string message\r\n                static envelope(messageObject, serializerVersion) {\r\n                    if (typeof (messageObject) === \"object\") {\r\n                        // Do not support MS Ajax serializer anymore, they should be compatible for unpatched clients in most cases.\r\n                        messageObject._serializerVersion = OSF.SerializerVersion.Browser;\r\n                    }\r\n                    return JSON.stringify(messageObject);\r\n                };\r\n                //deserialize a Request or Response Object into a string message\r\n                static unenvelope(messageObject, serializerVersion) {\r\n                    return JSON.parse(messageObject);\r\n                }\r\n            }\r\n\r\n            /// <summary>\r\n            /// HostTrustStatus  specifies check status of host trustworthy.\r\n            /// </summary>\r\n            /// <accessibility>private</accessibility>\r\n            export enum HostTrustStatus {\r\n                \"unknown\" = 0,\r\n                \"untrusted\" = 1,\r\n                \"nothttps\" = 2,\r\n                \"trusted\" = 3\r\n            }\r\n\r\n            /// <summary>\r\n            /// MessageType  specifies different type of message.\r\n            /// </summary>\r\n            /// <accessibility>private</accessibility>\r\n            export enum ResponseType {\r\n                \"forCalling\" = 0,\r\n                \"forEventing\" = 1\r\n            }\r\n\r\n            /// <summary>\r\n            /// ActionType  specifies different type of action to be performed on method or event\r\n            /// </summary>\r\n            /// <accessibility>public</accessibility>\r\n            export enum ActionType {\r\n                \"invoke\" = 0,\r\n                \"registerEvent\" = 1,\r\n                \"unregisterEvent\" = 2\r\n            }\r\n\r\n            /// <summary>\r\n            /// MessageType  specifies different type of message.\r\n            /// </summary>\r\n            /// <accessibility>private</accessibility>\r\n            export enum MessageType {\r\n                \"request\" = 0,\r\n                \"response\" = 1\r\n            }\r\n\r\n            /// <summary>\r\n            /// InvokeResultCode  specifies result code of method invocation\r\n            /// </summary>\r\n            /// <accessibility>public</accessibility>\r\n            export enum InvokeResultCode {\r\n                //no error\r\n                \"noError\" = 0,\r\n                //error in constructing or sending request on sender side\r\n                \"errorInRequest\" = -1,\r\n                //error in handling request on receiver side\r\n                \"errorHandlingRequest\" = -2,\r\n                //the requested method returns an error or error in sending\r\n                //response on receiver side\r\n                \"errorInResponse\" = -3,\r\n                //error in handling response on sender side\r\n                \"errorHandlingResponse\" = -4,\r\n                //error in handling request on receiver side, policy check failed, access denied\r\n                \"errorHandlingRequestAccessDenied\" = -5,\r\n                //error in method call, timeout happened\r\n                \"errorHandlingMethodCallTimedout\" = -6\r\n            }\r\n\r\n            /// <summary>\r\n            /// InvokeType  specifies different type of method invocation\r\n            /// </summary>\r\n            /// <accessibility>public</accessibility>\r\n            export enum InvokeType {\r\n                \"async\" = 0,\r\n                \"sync\" = 1,\r\n                \"asyncRegisterEvent\" = 2,\r\n                \"asyncUnregisterEvent\" = 3,\r\n                \"syncRegisterEvent\" = 4,\r\n                \"syncUnregisterEvent\" = 5\r\n            }\r\n\r\n            /// <summary>\r\n            /// XdmCommunicationManager  is a Singleton object, a facade object contains all the public methods used\r\n            ///                           by caller and callee\r\n            /// </summary>\r\n            /// <accessibility>public</accessibility>\r\n            export let XdmCommunicationManager = (function () {\r\n                //array, contains a queue of Invokers\r\n                var _invokerQueue = [];\r\n                //the time the last message was processed\r\n                var _lastMessageProcessTime = null;\r\n                //the timer handler\r\n                var _messageProcessingTimer = null;\r\n                //the time interval, default to 10ms\r\n                var _processInterval = 10;\r\n                //boolean flag to block processing any queued invoker\r\n                var _blockingFlag = false;\r\n                //timer for method call\r\n                var _methodTimeoutTimer = null;\r\n                //the processing interval for method timeout\r\n                var _methodTimeoutProcessInterval = 2000;\r\n                //method timeout in ms, this value should be larger than OMEX service extension timeout to get reliable failure telemetry\r\n                var _methodTimeoutDefault = 65000;\r\n                var _methodTimeout = _methodTimeoutDefault;\r\n                var _serviceEndPoints = {};\r\n                var _clientEndPoints = {};\r\n                var _initialized = false;\r\n\r\n                //private method to parse the messageObject received and find the controlId\r\n                function _getControlIdFromMessageObject(messageObject) {\r\n                    if (!messageObject) return null;\r\n                    //get actionName for the message\r\n                    const actionName = messageObject._actionName;\r\n                    try {\r\n                        if (!actionName) throw new Error('actionName not found in messageObject');\r\n\r\n                        let controlId;\r\n                        switch (actionName) {\r\n                            case 'executeMethod':\r\n                                controlId = messageObject._data.DdaMethod.ControlId;\r\n                                break;\r\n                            default:\r\n                                //avoid logging since we didn't parse the actionName\r\n                                return null;\r\n                        }\r\n\r\n                        if (typeof controlId !== \"string\") {\r\n                            throw new Error('Failed to extract controlId from messageObject');\r\n                        }\r\n                        return controlId;\r\n                    } catch (ex) {\r\n                        OsfMsAjaxFactory.msAjaxDebug.trace(`XdmCommunicationManager._getControlIdFromMessageObject (actionName: ${actionName}) error: ${ex.message}`);\r\n                        return null;\r\n                    }\r\n                }\r\n                //private method to lookup service endpoint for the given conversation Id\r\n                function _lookupServiceEndPoint(conversationId) {\r\n                    for (var id in _serviceEndPoints) {\r\n                        if (_serviceEndPoints[id]._conversations[conversationId]) {\r\n                            return _serviceEndPoints[id];\r\n                        }\r\n                    }\r\n                    OsfMsAjaxFactory.msAjaxDebug.trace(\"Unknown conversation Id.\");\r\n                    throw OsfMsAjaxFactory.msAjaxError.argument(\"conversationId\");\r\n                }\r\n                ;\r\n                //private method to lookup client endpoint for the given conversation Id\r\n                function _lookupClientEndPoint(conversationId) {\r\n                    var clientEndPoint = _clientEndPoints[conversationId];\r\n                    if (!clientEndPoint) {\r\n                        OsfMsAjaxFactory.msAjaxDebug.trace(\"Unknown conversation Id.\");\r\n                    }\r\n                    return clientEndPoint;\r\n                }\r\n                ;\r\n                //private method to lookup method object given the serviceEndpoint and message\r\n                function _lookupMethodObject(serviceEndPoint, messageObject) {\r\n                    var methodOrEventMethodObject = serviceEndPoint._methodObjectList[messageObject._actionName];\r\n                    if (!methodOrEventMethodObject) {\r\n                        //the specified methodName is not a registered method\r\n                        OsfMsAjaxFactory.msAjaxDebug.trace(\"The specified method is not registered on service endpoint:\" + messageObject._actionName);\r\n                        throw OsfMsAjaxFactory.msAjaxError.argument(\"messageObject\");\r\n                    }\r\n                    var methodObject = null;\r\n                    if (messageObject._actionType === Microsoft.Office.Common.ActionType.invoke) {\r\n                        methodObject = methodOrEventMethodObject;\r\n                    }\r\n                    else if (messageObject._actionType === Microsoft.Office.Common.ActionType.registerEvent) {\r\n                        methodObject = methodOrEventMethodObject.getRegisterMethodObject();\r\n                    }\r\n                    else {\r\n                        methodObject = methodOrEventMethodObject.getUnregisterMethodObject();\r\n                    }\r\n                    return methodObject;\r\n                }\r\n                ;\r\n                //private method to queue an invoker object into the invokerQueue\r\n                function _enqueInvoker(invoker) {\r\n                    _invokerQueue.push(invoker);\r\n                }\r\n                ;\r\n                // private method to deque and process invokerQueue\r\n                // this method is a callback registered with setInterval. It runs in setInterval's\r\n                // object(i.e. current window) context, therefore use closure to make accessible\r\n                // Channel's properties and methods by this method.\r\n                function _dequeInvoker() {\r\n                    if (_messageProcessingTimer !== null) {\r\n                        //process the invokerQueue\r\n                        //check the blockingflag before deque\r\n                        //TODO: what we do if the method called behaviour badly, never come back?\r\n                        if (OSF.OUtil.checkFlight(OSF.FlightTreatmentNames.ProcessMultipleCommandsInDequeInvoker)) {\r\n                            while (!_blockingFlag && _invokerQueue.length > 0) {\r\n                                //deque from invokerQueue\r\n                                var invoker = _invokerQueue.shift();\r\n                                _executeCommand(invoker);\r\n                            }\r\n\r\n                            if (_invokerQueue.length == 0) {\r\n                                clearInterval(_messageProcessingTimer);\r\n                                _messageProcessingTimer = null;\r\n                            }\r\n                        } else {\r\n                            if (!_blockingFlag) {\r\n                                //deque from invokerQueue\r\n                                if (_invokerQueue.length > 0) {\r\n                                    var invoker = _invokerQueue.shift();\r\n                                    _executeCommand(invoker);\r\n                                }\r\n                                else {\r\n                                    clearInterval(_messageProcessingTimer);\r\n                                    _messageProcessingTimer = null;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    else {\r\n                        OsfMsAjaxFactory.msAjaxDebug.trace(\"channel is not ready.\");\r\n                    }\r\n                }\r\n                ;\r\n                function _executeCommand(invoker) {\r\n                    //set the blockingFlag\r\n                    _blockingFlag = invoker.getInvokeBlockingFlag();\r\n                    //invoke the method. catch any invoking exception\r\n                    //inside of invoke, and send back to caller\r\n                    invoker.invoke();\r\n                    _lastMessageProcessTime = (new Date()).getTime();\r\n                }\r\n                ;\r\n                // private method to check method call timeout\r\n                function _checkMethodTimeout() {\r\n                    if (_methodTimeoutTimer) {\r\n                        var clientEndPoint;\r\n                        var methodCallsNotTimedout = 0;\r\n                        var now = new Date();\r\n                        var timeoutValue;\r\n                        for (var conversationId in _clientEndPoints) {\r\n                            clientEndPoint = _clientEndPoints[conversationId];\r\n                            for (var correlationId in clientEndPoint._callbackList) {\r\n                                var callbackEntry = clientEndPoint._callbackList[correlationId];\r\n                                //if timeout happens\r\n                                timeoutValue = callbackEntry.timeout ? callbackEntry.timeout : _methodTimeout;\r\n                                if (timeoutValue >= 0 && Math.abs(now.getTime() - callbackEntry.createdOn) >= timeoutValue) {\r\n                                    try {\r\n                                        if (callbackEntry.callback) {\r\n                                            callbackEntry.callback(Microsoft.Office.Common.InvokeResultCode.errorHandlingMethodCallTimedout, null);\r\n                                        }\r\n                                    }\r\n                                    finally {\r\n                                        delete clientEndPoint._callbackList[correlationId];\r\n                                    }\r\n                                }\r\n                                else {\r\n                                    methodCallsNotTimedout++;\r\n                                }\r\n                                ;\r\n                            }\r\n                        }\r\n                        if (methodCallsNotTimedout === 0) {\r\n                            clearInterval(_methodTimeoutTimer);\r\n                            _methodTimeoutTimer = null;\r\n                        }\r\n                    }\r\n                    else {\r\n                        OsfMsAjaxFactory.msAjaxDebug.trace(\"channel is not ready.\");\r\n                    }\r\n                }\r\n                ;\r\n                //private method to clean up after calling invokeCompleteCallback is finished\r\n                function _postCallbackHandler() {\r\n                    //unblock processing invokerQueue\r\n                    _blockingFlag = false;\r\n                }\r\n                ;\r\n                //private method to register listener\r\n                function _registerListener(listener) {\r\n                    if (window.addEventListener) {\r\n                        // IE version >= 11 and Other browsers\r\n                        window.addEventListener(\"message\", listener, false);\r\n                    }\r\n                    else if ((navigator.userAgent.indexOf(\"MSIE\") > -1) && (window as any).attachEvent) {\r\n                        // IE version < 11\r\n                        (window as any).attachEvent(\"onmessage\", listener);\r\n                    }\r\n                    else {\r\n                        OsfMsAjaxFactory.msAjaxDebug.trace(\"Browser doesn't support the required API.\");\r\n                        throw OsfMsAjaxFactory.msAjaxError.argument(\"Browser\");\r\n                    }\r\n                }\r\n                ;\r\n                // this is to check if a url start with the same origin.\r\n                // origin should be the leading part of url (indexOf result 0).\r\n                function _checkOrigin(url, origin) {\r\n                    var res = false;\r\n                    if (!url || !origin || url === \"null\" || origin === \"null\" || !url.length || !origin.length) {\r\n                        return res;\r\n                    }\r\n                    if (OSF.OUtil.checkFlight(OSF.FlightNames.AddinEnforceHttps)) {\r\n                        res = _urlCompareUsingUrlStrings(url, origin);\r\n                    }\r\n                    else {\r\n                        var url_parser, org_parser;\r\n                        url_parser = document.createElement('a'); //create an \"a\" element to get parts of the url.\r\n                        org_parser = document.createElement('a');\r\n                        url_parser.href = url;\r\n                        org_parser.href = origin;\r\n                        res = _urlCompare(url_parser, org_parser);\r\n                    }\r\n                    return res;\r\n                }\r\n                // this is to check if origin is within the allowed domain list.\r\n                // origin should be the leading part of url (indexOf result 0).\r\n                function _checkOriginWithAppDomains(allowed_domains, origin) {\r\n                    var res = false;\r\n                    if (!origin || origin === \"null\" || !origin.length || !(allowed_domains) || !(allowed_domains instanceof Array) || !allowed_domains.length) {\r\n                        return res;\r\n                    }\r\n                    var org_parser = document.createElement('a'); //create an \"a\" element to get parts of the url.\r\n                    var app_domain_parser = document.createElement('a');\r\n                    org_parser.href = origin;\r\n                    for (var i = 0; i < allowed_domains.length && !res; i++) {\r\n                        if (allowed_domains[i].indexOf(\"://\") !== -1) {\r\n                            if (OSF.OUtil.checkFlight(OSF.FlightNames.AddinEnforceHttps)) {\r\n                                res = _urlCompareUsingUrlStrings(origin, allowed_domains[i]);\r\n                            }\r\n                            else {\r\n                                app_domain_parser.href = allowed_domains[i];\r\n                                res = _urlCompare(org_parser, app_domain_parser);\r\n                            }\r\n                        }\r\n                    }\r\n                    return res;\r\n                }\r\n                /**\r\n                  * _isHostNameValidWacDomain checks if the provided string is a valid WAC host domain.\r\n                  * Each valid domain must match one of the regular expressions in the regexHostNameStringArray array.\r\n                  * These regular expressions are then joined into one string as individual valid cases.\r\n                  * Any new WAC domains needs to be added to this list for support.\r\n                  * This function is needed since Excel Online downloads JS and other documents from different location to page\r\n                  * @param hostName The string containing the host name to be validated\r\n                  */\r\n                function _isHostNameValidWacDomain(hostName: string): boolean {\r\n                    if (!hostName || hostName === \"null\") {\r\n                        return false;\r\n                    }\r\n                    var regexHostNameStringArray = new Array(\"^office-int\\\\.com$\", \"^officeapps\\\\.live-int\\\\.com$\", \"^.*\\\\.dod\\\\.online\\\\.office365\\\\.us$\", \"^.*\\\\.gov\\\\.online\\\\.office365\\\\.us$\", \"^.*\\\\.officeapps\\\\.live\\\\.com$\", \"^.*\\\\.officeapps\\\\.live-int\\\\.com$\", \"^.*\\\\.officeapps-df\\\\.live\\\\.com$\", \"^.*\\\\.online\\\\.office\\\\.de$\", \"^.*\\\\.partner\\\\.officewebapps\\\\.cn$\", \"^.*\\\\.office\\\\.net$\", \"^\" + document.domain.replace(new RegExp(\"\\\\.\", \"g\"), \"\\\\.\") + \"$\");\r\n                    var regexHostName = new RegExp(regexHostNameStringArray.join(\"|\"));\r\n                    return regexHostName.test(hostName);\r\n                }\r\n                /**\r\n                 * Checks the if the origin of the postMessage is a subdomain of the sourceLocation. If an add-in specifies\r\n                 * https://domain.com as the sourceLocation, we allow the add-in to re-direct to https://subdomain.domain.com.\r\n                 * If the add-in specifies https://subdomain.domain.com, we will not allow redirection to https://domain.com.\r\n                 * @param sourceLocation specified by the manifes.\r\n                 * @param messageOrigin Origin which sent the post message to the host.\r\n                 * @returns True if the origin of the message has the same port, protocol, and has either the same hostname or is a subdomain of the sourceLocation.\r\n                 */\r\n                function _isTargetSubdomainOfSourceLocation(sourceLocation: string, messageOrigin: string): boolean {\r\n                    if (!sourceLocation || !messageOrigin || sourceLocation === \"null\" || messageOrigin === \"null\") {\r\n                        return false;\r\n                    }\r\n                    let sourceLocationParser;\r\n                    let messageOriginParser;\r\n                    if (OSF.OUtil.checkFlight(OSF.FlightNames.AddinEnforceHttps)) {\r\n                        sourceLocationParser = OSF.OUtil.parseUrl(sourceLocation, /*enforceHttps*/ true);\r\n                        messageOriginParser = OSF.OUtil.parseUrl(messageOrigin, /*enforceHttps*/ true);\r\n                    }\r\n                    else {\r\n                        // Anchor tags must be used as Url objects aren't supported in IE.\r\n                        sourceLocationParser = document.createElement('a');\r\n                        sourceLocationParser.href = sourceLocation;\r\n                        messageOriginParser = document.createElement('a');\r\n                        messageOriginParser.href = messageOrigin;\r\n                    }\r\n                    let isSameProtocol = sourceLocationParser.protocol === messageOriginParser.protocol;\r\n                    let isSamePort = sourceLocationParser.port === messageOriginParser.port;\r\n                    let originHostName = messageOriginParser.hostname;\r\n                    let sourceLocationHostName = sourceLocationParser.hostname;\r\n                    // Checking if host name is exactly equal.\r\n                    let isSameDomain = originHostName === sourceLocationHostName;\r\n                    let isSubDomain = false;\r\n                    if (!isSameDomain && originHostName.length > sourceLocationHostName.length + 1) {\r\n                        /*\r\n                         * If origin is a subdomain, it must have a '.' before the original url part.\r\n                         * For example, 'testsubdomain.domain.com' is not a subdomain of 'subdomain.domain.com', but 'test.subdomain.domain.com' is.\r\n                         * As string.endswith is not supported in all browsers, a negative begining index for slice will be used.\r\n                         * The negative begining index means the slice from the end of the string will be used: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/slice.\r\n                         */\r\n                        isSubDomain = originHostName.slice(-(sourceLocationHostName.length + 1)) === '.' + sourceLocationHostName;\r\n                    }\r\n                    let isSameDomainOrSubdomain = isSameDomain || isSubDomain;\r\n                    return isSamePort && isSameProtocol && isSameDomainOrSubdomain;\r\n                }\r\n                // compare hostname, protocol and port of 2 urls\r\n                function _urlCompareUsingUrlStrings(url_str1, url_str2) {\r\n                    var parsedUrl1 = OSF.OUtil.parseUrl(url_str1, /*enforceHttps*/ true);\r\n                    var parsedUrl2 = OSF.OUtil.parseUrl(url_str2, /*enforceHttps*/ true);\r\n                    return _urlCompare(parsedUrl1, parsedUrl2);\r\n                }\r\n                // compare hostname, protocol and port of 2 urls\r\n                function _urlCompare(url_parser1, url_parser2) {\r\n                    if (!url_parser1 || !url_parser2 || !url_parser1.protocol || !url_parser2.protocol || !url_parser1.hostname || !url_parser2.hostname) {\r\n                        return false;\r\n                    }\r\n                    return ((url_parser1.hostname == url_parser2.hostname) &&\r\n                        (url_parser1.protocol == url_parser2.protocol) &&\r\n                        _hasSamePort(url_parser1, url_parser2));\r\n                }\r\n                // check if given parsed urls have the same ports (explicitly or implicitly given the protocol)\r\n                function _hasSamePort(url_parser1, url_parser2) {\r\n                    var httpPort = \"80\";\r\n                    var httpsPort = \"443\";\r\n                    return ((url_parser1.port == url_parser2.port) ||\r\n                        (url_parser1.port == \"\" && url_parser1.protocol == \"http:\" && url_parser2.port == httpPort) ||\r\n                        (url_parser1.port == \"\" && url_parser1.protocol == \"https:\" && url_parser2.port == httpsPort) ||\r\n                        (url_parser2.port == \"\" && url_parser2.protocol == \"http:\" && url_parser1.port == httpPort) ||\r\n                        (url_parser2.port == \"\" && url_parser2.protocol == \"https:\" && url_parser1.port == httpsPort));\r\n                }\r\n                // private method to receive method call request message and response message\r\n                // this method is a event handler registered with onmessage event. It runs in window's\r\n                // context, so use closure to make Channel context available to the method, in another\r\n                // word, to make accessible Channel's properties and methods by this method.\r\n                function _receive(e) {\r\n                    if (!OSF) {\r\n                        // In Edge, when trying to close an agave, window.blur event will be triggered after osfcontrol, serviceendpoint and conversationid has been removed, then there are will be a Sys.ArgumentException return here,\r\n                        // But since the iframe has been closed, the context here has been lost, so just return to avoid scripterror since OSF is null; For now only close inline dialog will trigger.\r\n                        return;\r\n                    }\r\n                    if (e.data != '') {\r\n                        var messageObject;\r\n                        var serializerVersion = OSF.SerializerVersion.Browser;\r\n                        var serializedMessage = e.data;\r\n                        // See if message was serialized with Browser\r\n                        try {\r\n                            messageObject = Microsoft.Office.Common.MessagePackager.unenvelope(serializedMessage, OSF.SerializerVersion.Browser);\r\n                            serializerVersion = messageObject._serializerVersion != null ? messageObject._serializerVersion : serializerVersion;\r\n                        }\r\n                        catch (ex) {\r\n                            return; //this is the message we cannot handle, just return to let other handler to handle it\r\n                        }\r\n                        //after deserialization, methods won't be available, so use properties directly\r\n                        if (messageObject._messageType === Microsoft.Office.Common.MessageType.request) {\r\n                            //this is a request, callee side call the method\r\n                            var requesterUrl = (e.origin == null || e.origin === \"null\") ? messageObject._origin : e.origin; //work around, when html5 sandbox is enabled for chrome, e.origin returns \"null\"\r\n                            try {\r\n                                var serviceEndPoint = _lookupServiceEndPoint(messageObject._conversationId);\r\n                                var conversation = serviceEndPoint._conversations[messageObject._conversationId];\r\n                                serializerVersion = conversation.serializerVersion != null ? conversation.serializerVersion : serializerVersion;\r\n                                var allowedDomains = [conversation.url].concat(serviceEndPoint._appDomains[messageObject._conversationId]);\r\n                                if (!_checkOriginWithAppDomains(allowedDomains, e.origin)) {\r\n                                    if (!OfficeExt.appSpecificCheckOrigin(allowedDomains, e, messageObject._origin, _checkOriginWithAppDomains)) {\r\n                                        let isOriginSubdomain = _isTargetSubdomainOfSourceLocation(conversation.url, e.origin);\r\n                                        if (!isOriginSubdomain) {\r\n                                            throw \"Failed origin check\";\r\n                                        }\r\n                                    }\r\n                                }\r\n                                // This is needed for GetAccessToken API to match the domain making the request with the resource\r\n                                var dataWithOrigin = (messageObject._data != null) ? messageObject._data : {};\r\n                                dataWithOrigin.SecurityOrigin = e.origin;\r\n                                var trustedParams = {\r\n                                    controlId: conversation.controlId,\r\n                                    securityOrigin: e.origin,\r\n                                }\r\n                                var policyManager = serviceEndPoint.getPolicyManager();\r\n                                if (policyManager && !policyManager.checkPermission(messageObject._conversationId, messageObject._actionName, dataWithOrigin)) {\r\n                                    throw \"Access Denied\";\r\n                                }\r\n                                var controlIdTrusted = conversation.controlId;\r\n                                if (controlIdTrusted) {\r\n                                    //depending on each actionName/API, we need to parse messageObject to find the controlId\r\n                                    var controlIdToVerify = _getControlIdFromMessageObject(messageObject);\r\n                                    if (controlIdToVerify && controlIdToVerify !== controlIdTrusted) {\r\n                                        throw \"Access Denied\";\r\n                                    }\r\n                                }\r\n\r\n                                var methodObject = _lookupMethodObject(serviceEndPoint, messageObject);\r\n                                //create invokeCompleteCallback object\r\n                                var invokeCompleteCallback = new Microsoft.Office.Common.InvokeCompleteCallback(e.source, requesterUrl, messageObject._actionName, messageObject._conversationId, messageObject._correlationId, _postCallbackHandler, serializerVersion);\r\n                                //create invoker\r\n                                var invoker = new Microsoft.Office.Common.Invoker(methodObject, dataWithOrigin, invokeCompleteCallback, serviceEndPoint._eventHandlerProxyList, messageObject._conversationId, messageObject._actionName, serializerVersion, trustedParams);\r\n                                var shouldEnque = true;\r\n                                //start the timer if needed\r\n                                if (_messageProcessingTimer == null) {\r\n                                    if ((_lastMessageProcessTime == null || (new Date()).getTime() - _lastMessageProcessTime > _processInterval) && !_blockingFlag) {\r\n                                        _executeCommand(invoker);\r\n                                        shouldEnque = false;\r\n                                    }\r\n                                    else {\r\n                                        _messageProcessingTimer = setInterval(_dequeInvoker, _processInterval);\r\n                                    }\r\n                                }\r\n                                if (shouldEnque) {\r\n                                    //queue invoker\r\n                                    _enqueInvoker(invoker);\r\n                                }\r\n                            }\r\n                            catch (ex) {\r\n                                if (serviceEndPoint && serviceEndPoint._onHandleRequestError) {\r\n                                    serviceEndPoint._onHandleRequestError(messageObject, ex);\r\n                                }\r\n                                //TODO, what to do if exception is thrown here by envelope()\r\n                                //construct a response object\r\n                                var errorCode = Microsoft.Office.Common.InvokeResultCode.errorHandlingRequest;\r\n                                if (ex == \"Access Denied\") {\r\n                                    errorCode = Microsoft.Office.Common.InvokeResultCode.errorHandlingRequestAccessDenied;\r\n                                }\r\n                                var callResponse = new Microsoft.Office.Common.Response(messageObject._actionName, messageObject._conversationId, messageObject._correlationId, errorCode, Microsoft.Office.Common.ResponseType.forCalling, ex);\r\n                                var envelopedResult = Microsoft.Office.Common.MessagePackager.envelope(callResponse, serializerVersion);\r\n                                // trying to get e.source.postMessage can throw rather than just returning null/undefined in Edge\r\n                                var canPostMessage = false;\r\n                                try {\r\n                                    canPostMessage = !!(e.source && e.source.postMessage);\r\n                                }\r\n                                catch (ex) {\r\n                                }\r\n                                // Enforce \"Same-origin\" policy for postMessage. See security vulnerability in MSRC Case: 51258\r\n                                var isOriginValid = false;\r\n                                if (window.location.href && e.origin && e.origin !== \"null\" && _isTargetSubdomainOfSourceLocation(window.location.href, e.origin)) {\r\n                                    isOriginValid = true;\r\n                                }\r\n                                else {\r\n                                    if (e.origin && e.origin !== \"null\") {\r\n                                        // Need this because Excel Online is on different hostname to iFramed content\r\n                                        if (OSF.OUtil.checkFlight(OSF.FlightNames.AddinEnforceHttps)) {\r\n                                            let hostname = OSF.OUtil.parseUrl(e.origin, /*enforceHttps*/ true).hostname;\r\n                                            isOriginValid = _isHostNameValidWacDomain(hostname);\r\n                                        }\r\n                                        else {\r\n                                            let parser = document.createElement(\"a\");\r\n                                            parser.href = e.origin;\r\n                                            isOriginValid = _isHostNameValidWacDomain(parser.hostname);\r\n                                        }\r\n                                    }\r\n                                }\r\n                                if (canPostMessage && isOriginValid) {\r\n                                    e.source.postMessage(envelopedResult, requesterUrl);\r\n                                }\r\n                            }\r\n                        }\r\n                        else if (messageObject._messageType === Microsoft.Office.Common.MessageType.response) {\r\n                            //this is a response\r\n                            var clientEndPoint = _lookupClientEndPoint(messageObject._conversationId);\r\n                            if (!clientEndPoint) {\r\n                                return;\r\n                            }\r\n                            clientEndPoint._serializerVersion = serializerVersion;\r\n                            if (!_checkOrigin(clientEndPoint._targetUrl, e.origin)) {\r\n                                throw \"Failed orgin check\";\r\n                            }\r\n                            if (messageObject._responseType === Microsoft.Office.Common.ResponseType.forCalling) {\r\n                                // this is a response for a calling\r\n                                //The caller side calls caller's callback\r\n                                var callbackEntry = clientEndPoint._callbackList[messageObject._correlationId];\r\n                                if (callbackEntry) {\r\n                                    try {\r\n                                        if (callbackEntry.callback)\r\n                                            callbackEntry.callback(messageObject._errorCode, messageObject._data);\r\n                                    }\r\n                                    finally {\r\n                                        delete clientEndPoint._callbackList[messageObject._correlationId];\r\n                                    }\r\n                                }\r\n                            }\r\n                            else {\r\n                                //This is a response for an eventing (event raised)\r\n                                //The caller side invokes caller's eventHandler\r\n                                var eventhandler = clientEndPoint._eventHandlerList[messageObject._actionName];\r\n                                if (eventhandler !== undefined && eventhandler !== null) {\r\n                                    eventhandler(messageObject._data);\r\n                                }\r\n                            }\r\n                        }\r\n                        else { // this is not a valid message\r\n                            return;\r\n                        }\r\n                    }\r\n                }\r\n                ;\r\n                //private method to initialize listener\r\n                function _initialize() {\r\n                    if (!_initialized) {\r\n                        //register listener\r\n                        _registerListener(_receive);\r\n                        _initialized = true;\r\n                    }\r\n                }\r\n                ;\r\n                // all public methods\r\n                // Explanation: use closure to hide the private members and methods;\r\n                // use an anonymous function to return an object which has all\r\n                // the public methods; this makes the Singleton implementation.\r\n                return {\r\n                    /// <summary>\r\n                    /// connect  start a new clientEndPoint.\r\n                    /// </summary>\r\n                    /// <param name=\"conversationId\">The conversation Id. Must be provided</param>\r\n                    /// <param name=\"targetWindow\">The window object of callee. Must be provided </param>\r\n                    /// <param name=\"targetUrl\">The url of callee window. Must be provided </param>\r\n                    /// <accessibility>public</accessibility>\r\n                    connect: function Microsoft_Office_Common_XdmCommunicationManager$connect(conversationId, targetWindow, targetUrl, serializerVersion) {\r\n                        var clientEndPoint = _clientEndPoints[conversationId];\r\n                        if (!clientEndPoint) {\r\n                            _initialize();\r\n                            clientEndPoint = new Microsoft.Office.Common.ClientEndPoint(conversationId, targetWindow, targetUrl, serializerVersion);\r\n                            _clientEndPoints[conversationId] = clientEndPoint;\r\n                        }\r\n                        return clientEndPoint;\r\n                    },\r\n                    /// <summary>\r\n                    /// return the client endpoint for a given conversation Id\r\n                    /// </summary>\r\n                    /// <param name=\"conversationId\">The conversation Id. Must be provided</param>\r\n                    /// <accessibility>public</accessibility>\r\n                    getClientEndPoint: function Microsoft_Office_Common_XdmCommunicationManager$getClientEndPoint(conversationId) {\r\n                        var e = Function._validateParams(arguments, [\r\n                            { name: \"conversationId\", type: String, mayBeNull: false }\r\n                        ]);\r\n                        if (e)\r\n                            throw e;\r\n                        return _clientEndPoints[conversationId];\r\n                    },\r\n                    /// <summary>\r\n                    /// create a service endpoint for others to consume (exposing methods and events)\r\n                    /// </summary>\r\n                    /// <param name=\"serviceEndPointId\">An Id that uniquely identities this service endpoint. Must be provided</param>\r\n                    /// <accessibility>public</accessibility>\r\n                    createServiceEndPoint: function Microsoft_Office_Common_XdmCommunicationManager$createServiceEndPoint(serviceEndPointId) {\r\n                        _initialize();\r\n                        var serviceEndPoint = new Microsoft.Office.Common.ServiceEndPoint(serviceEndPointId);\r\n                        _serviceEndPoints[serviceEndPointId] = serviceEndPoint;\r\n                        return serviceEndPoint;\r\n                    },\r\n                    /// <summary>\r\n                    /// return the service endpoint for a given service endpoint Id.\r\n                    /// </summary>\r\n                    /// <param name=\"serviceEndPointId\">The service endpoint Id. Must be provided</param>\r\n                    /// <accessibility>public</accessibility>\r\n                    getServiceEndPoint: function Microsoft_Office_Common_XdmCommunicationManager$getServiceEndPoint(serviceEndPointId) {\r\n                        var e = Function._validateParams(arguments, [\r\n                            { name: \"serviceEndPointId\", type: String, mayBeNull: false }\r\n                        ]);\r\n                        if (e)\r\n                            throw e;\r\n                        return _serviceEndPoints[serviceEndPointId];\r\n                    },\r\n                    /// <summary>\r\n                    /// delete the client endpoint for a given conversation Id\r\n                    /// </summary>\r\n                    /// <param name=\"conversationId\">The conversation Id. Must be provided</param>\r\n                    /// <accessibility>public</accessibility>\r\n                    deleteClientEndPoint: function Microsoft_Office_Common_XdmCommunicationManager$deleteClientEndPoint(conversationId) {\r\n                        var e = Function._validateParams(arguments, [\r\n                            { name: \"conversationId\", type: String, mayBeNull: false }\r\n                        ]);\r\n                        if (e)\r\n                            throw e;\r\n                        delete _clientEndPoints[conversationId];\r\n                    },\r\n                    /// <summary>\r\n                    /// delete the service endpoint for a given serviceEndPointId\r\n                    /// </summary>\r\n                    /// <param name=\"serviceEndPointId\">The serviceEndPointId. Must be provided</param>\r\n                    /// <accessibility>public</accessibility>\r\n                    deleteServiceEndPoint: function Microsoft_Office_Common_XdmCommunicationManager$deleteServiceEndPoint(serviceEndPointId) {\r\n                        var e = Function._validateParams(arguments, [\r\n                            { name: \"serviceEndPointId\", type: String, mayBeNull: false }\r\n                        ]);\r\n                        if (e)\r\n                            throw e;\r\n                        delete _serviceEndPoints[serviceEndPointId];\r\n                    },\r\n                    /// <summary>\r\n                    /// check whether a url is in app domains list.\r\n                    /// </summary>\r\n                    /// <accessibility>public</accessibility>\r\n                    urlCompare: function Microsoft_Office_Common_XdmCommunicationManager$_urlCompare(url_parser1, url_parser2) {\r\n                        return _urlCompare(url_parser1, url_parser2);\r\n                    },\r\n                    /// <summary>\r\n                    /// check whether a url is in app domains list.\r\n                    /// </summary>\r\n                    /// <accessibility>public</accessibility>\r\n                    checkUrlWithAppDomains: function Microsoft_Office_Common_XdmCommunicationManager$_checkUrlWithAppDomains(appDomains, origin) {\r\n                        return _checkOriginWithAppDomains(appDomains, origin);\r\n                    },\r\n                    /// <summary>\r\n                    /// check whether a url is subdomain of source location\r\n                    /// </summary>\r\n                    /// <accessibility>public</accessibility>\r\n                    isTargetSubdomainOfSourceLocation: function Microsoft_Office_Common_XdmCommunicationManager$_isTargetSubdomainOfSourceLocation(sourceLocation, messageOrigin) {\r\n                        return _isTargetSubdomainOfSourceLocation(sourceLocation, messageOrigin);\r\n                    },\r\n                    /// <summary>\r\n                    /// set method timeout (in ms).\r\n                    /// </summary>\r\n                    /// <param name=\"methodTimeout\">method timeout in ms. Must be provided</param>\r\n                    /// <accessibility>private</accessibility>\r\n                    _setMethodTimeout: function Microsoft_Office_Common_XdmCommunicationManager$_setMethodTimeout(methodTimeout) {\r\n                        var e = Function._validateParams(arguments, [\r\n                            { name: \"methodTimeout\", type: Number, mayBeNull: false }\r\n                        ]);\r\n                        if (e)\r\n                            throw e;\r\n                        _methodTimeout = (methodTimeout <= 0) ? _methodTimeoutDefault : methodTimeout;\r\n                    },\r\n                    /// <summary>\r\n                    /// start method call timer for timeout check if needed.\r\n                    /// </summary>\r\n                    /// <accessibility>private</accessibility>\r\n                    _startMethodTimeoutTimer: function Microsoft_Office_Common_XdmCommunicationManager$_startMethodTimeoutTimer() {\r\n                        //start the timer if needed\r\n                        if (!_methodTimeoutTimer) {\r\n                            _methodTimeoutTimer = setInterval(_checkMethodTimeout, _methodTimeoutProcessInterval);\r\n                        }\r\n                    },\r\n                    /// <summary>\r\n                    /// check whether hostName is a valid WAC domain\r\n                    /// </summary>\r\n                    /// <accessibility>public</accessibility>\r\n                    isHostNameValidWacDomain: function Microsoft_Office_Common_XdmCommunicationManager$_isHostNameValidWacDomain(hostName: string): boolean {\r\n                        return _isHostNameValidWacDomain(hostName);\r\n                    },\r\n                    /// <summary>\r\n                    /// check whether two urls that have been parsed have the same ports (directly or indirectly via using the same protocol and the port field is empty)\r\n                    /// </summary>\r\n                    /// <accessibility>private</accessibility>\r\n                    _hasSamePort: function Microsoft_Office_Common_XdmCommunicationManager$_hasSamePort(url_parser1, url_parser2): boolean {\r\n                        return _hasSamePort(url_parser1, url_parser2);\r\n                    }\r\n                };\r\n            })();\r\n\r\n            /// <summary>\r\n            /// MethodObject  contains information about a method to be invoked\r\n            /// </summary>\r\n            /// <accessibility>private</accessibility>\r\n            export class MethodObject {\r\n                _blockingOthers: any;\r\n                _invokeType: any;\r\n                _method: any;\r\n                constructor(method, invokeType, blockingOthers) {\r\n                    //function object for the method to be invoked\r\n                    this._method = method;\r\n                    //method invocation type\r\n                    this._invokeType = invokeType;\r\n                    //the flag specifying if invocation of this method should block others\r\n                    //until this invocation is finished\r\n                    this._blockingOthers = blockingOthers;\r\n                }\r\n                getMethod() {\r\n                    return this._method;\r\n                }\r\n                getInvokeType() {\r\n                    return this._invokeType;\r\n                }\r\n                getBlockingFlag() {\r\n                    return this._blockingOthers;\r\n                }\r\n            }\r\n\r\n            /// <summary>\r\n            /// EventMethodObject  contains information about register and unregister methods for an event\r\n            /// </summary>\r\n            /// <accessibility>private</accessibility>\r\n            export class EventMethodObject {\r\n                _registerMethodObject: any;\r\n                _unregisterMethodObject: any;\r\n                constructor(registerMethodObject, unregisterMethodObject) {\r\n                    //register event method object\r\n                    this._registerMethodObject = registerMethodObject;\r\n                    //unregister event method object\r\n                    this._unregisterMethodObject = unregisterMethodObject;\r\n                }\r\n                getRegisterMethodObject() {\r\n                    return this._registerMethodObject;\r\n                }\r\n                getUnregisterMethodObject() {\r\n                    return this._unregisterMethodObject;\r\n                }\r\n            }\r\n\r\n            /// <summary>\r\n            /// ServiceEndPoint  expose methods and events\r\n            /// </summary>\r\n            /// <param name=\"serviceEndPointId\">An Id that uniquely identities this service endpoint. Must be provided</param>\r\n            /// <accessibility>public</accessibility>\r\n            export class ServiceEndPoint {\r\n                _Id: any;\r\n                _appDomains: any;\r\n                _conversations: any;\r\n                _eventHandlerProxyList: any;\r\n                _methodObjectList: any;\r\n                _onHandleRequestError: any;\r\n                _policyManager: any;\r\n                constructor(serviceEndPointId) {\r\n                    var e = Function._validateParams(arguments, [\r\n                        { name: \"serviceEndPointId\", type: String, mayBeNull: false }\r\n                    ]);\r\n                    if (e)\r\n                        throw e;\r\n                    //object, contains a list of MethodObject or EventMethodObject; The key is method Name\r\n                    //or event Name\r\n                    this._methodObjectList = {};\r\n                    //object, contains references to the event handler function, registered with the event.\r\n                    //The key is conversationId + event Name\r\n                    this._eventHandlerProxyList = {};\r\n                    //service endpoint ID, which uniquely identitfies a service endpoint\r\n                    this._Id = serviceEndPointId;\r\n                    //all conversation IDs registered on this service endpoint\r\n                    this._conversations = {};\r\n                    //policy manager\r\n                    this._policyManager = null;\r\n                    //allowed domains for access\r\n                    this._appDomains = {};\r\n                    //handle request onError function\r\n                    this._onHandleRequestError = null;\r\n                }\r\n\r\n                /// <summary>\r\n                /// registerMethod  add a method to callee which can been called by a caller.\r\n                /// </summary>\r\n                /// <accessibility>public</accessibility>\r\n                /// <param name=\"methodName\">string, method name</param>\r\n                /// <param name=\"method\">function, method itself</param>\r\n                /// <param name=\"invokeType\">InvokeType, type of invocation for the method to be invoked</param>\r\n                /// <param name=\"blockingOthers\">boolean, flag to indicate if this method invocation is to be sequnetial,\r\n                ///                              in another word, if this method is going to blocking others until itself\r\n                ///                              is finished</param>\r\n                registerMethod(methodName, method, invokeType, blockingOthers) {\r\n                    //check parameters\r\n                    var e = Function._validateParams(arguments, [\r\n                        { name: \"methodName\", type: String, mayBeNull: false },\r\n                        { name: \"method\", type: Function, mayBeNull: false },\r\n                        { name: \"invokeType\", type: Number, mayBeNull: false },\r\n                        { name: \"blockingOthers\", type: Boolean, mayBeNull: false }\r\n                    ]);\r\n                    if (e)\r\n                        throw e;\r\n                    if (invokeType !== Microsoft.Office.Common.InvokeType.async\r\n                        && invokeType !== Microsoft.Office.Common.InvokeType.sync) {\r\n                        throw OsfMsAjaxFactory.msAjaxError.argument(\"invokeType\");\r\n                    }\r\n                    var methodObject = new Microsoft.Office.Common.MethodObject(method, invokeType, blockingOthers);\r\n                    this._methodObjectList[methodName] = methodObject;\r\n                }\r\n\r\n                /// <summary>\r\n                /// unregisterMethod  remove a method from callee.\r\n                /// </summary>\r\n                /// <accessibility>public</accessibility>\r\n                /// <param name=\"methodName\">the method name for the method to be removed</param>\r\n                unregisterMethod(methodName) {\r\n                    //check parameters\r\n                    var e = Function._validateParams(arguments, [\r\n                        { name: \"methodName\", type: String, mayBeNull: false }\r\n                    ]);\r\n                    if (e)\r\n                        throw e;\r\n                    delete this._methodObjectList[methodName];\r\n                }\r\n\r\n                /// <summary>\r\n                /// registerEvent  add event name, register and unregister methods to callee which can been registered or\r\n                ///                 unregistered for an event by a caller.\r\n                //                  Note, regiser/registerMethod will be sync-invoked with this function.\r\n                /// </summary>\r\n                /// <accessibility>public</accessibility>\r\n                /// <param name=\"eventName\">string, event name</param>\r\n                /// <param name=\"registerMethod\">function, method to register for the specified event</param>\r\n                /// <param name=\"unregisterMethod\">function, method to unregister for the specified event</param>\r\n                registerEvent(eventName, registerMethod, unregisterMethod) {\r\n                    //check parameters\r\n                    var e = Function._validateParams(arguments, [\r\n                        { name: \"eventName\", type: String, mayBeNull: false },\r\n                        { name: \"registerMethod\", type: Function, mayBeNull: false },\r\n                        { name: \"unregisterMethod\", type: Function, mayBeNull: false }\r\n                    ]);\r\n                    if (e)\r\n                        throw e;\r\n                    var methodObject = new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(registerMethod, Microsoft.Office.Common.InvokeType.syncRegisterEvent, false), new Microsoft.Office.Common.MethodObject(unregisterMethod, Microsoft.Office.Common.InvokeType.syncUnregisterEvent, false));\r\n                    this._methodObjectList[eventName] = methodObject;\r\n                }\r\n\r\n                /// <summary>\r\n                /// registerEventEx  add event name, register and unregister methods to callee which can been registered or\r\n                ///                 unregistered for an event by a caller.\r\n                //                  Note, regisermethod/unregisterMethod will be invoked with the specifed invokeType in this function.\r\n                /// </summary>\r\n                /// <accessibility>public</accessibility>\r\n                /// <param name=\"eventName\">string, event name</param>\r\n                /// <param name=\"registerMethod\">function, method to register for the specified event</param>\r\n                /// <param name=\"registerMethodInvokeType\">the invokeType for the registerMethod</param>\r\n                /// <param name=\"unregisterMethod\">function, method to unregister for the specified event</param>\r\n                /// <param name=\"unregisterMethodInvokeType\">the invokeType for the unregisterMethod</param>\r\n                registerEventEx(eventName, registerMethod, registerMethodInvokeType, unregisterMethod, unregisterMethodInvokeType) {\r\n                    //check parameters\r\n                    var e = Function._validateParams(arguments, [\r\n                        { name: \"eventName\", type: String, mayBeNull: false },\r\n                        { name: \"registerMethod\", type: Function, mayBeNull: false },\r\n                        { name: \"registerMethodInvokeType\", type: Number, mayBeNull: false },\r\n                        { name: \"unregisterMethod\", type: Function, mayBeNull: false },\r\n                        { name: \"unregisterMethodInvokeType\", type: Number, mayBeNull: false }\r\n                    ]);\r\n                    if (e)\r\n                        throw e;\r\n                    var methodObject = new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(registerMethod, registerMethodInvokeType, false), new Microsoft.Office.Common.MethodObject(unregisterMethod, unregisterMethodInvokeType, false));\r\n                    this._methodObjectList[eventName] = methodObject;\r\n                }\r\n\r\n                //public method to unregister an event and event methods with the receiver\r\n                unregisterEvent(eventName) {\r\n                    //check parameters\r\n                    var e = Function._validateParams(arguments, [\r\n                        { name: \"eventName\", type: String, mayBeNull: false }\r\n                    ]);\r\n                    if (e)\r\n                        throw e;\r\n                    this.unregisterMethod(eventName);\r\n                }\r\n\r\n                /// <summary>\r\n                /// register conversation Id on this service endpoint before client can connect using this conversation Id.\r\n                /// </summary>\r\n                /// <accessibility>public</accessibility>\r\n                /// <param name=\"conversationId\">conversation Id</param>\r\n                /// <param name=\"conversationUrl\">conversation frame URL for keeping track of origin check</param>\r\n                /// <param name=\"appDomains\">allowed domains for access</param>\r\n                /// <param name=\"controlId\">trusted control Id</param>\r\n                registerConversation(conversationId, conversationUrl, appDomains?, controlId?) {\r\n                    //check parameters\r\n                    var e = Function._validateParams(arguments, [\r\n                        { name: \"conversationId\", type: String, mayBeNull: false },\r\n                        { name: \"conversationUrl\", type: String, mayBeNull: false, optional: true },\r\n                        { name: \"appDomains\", type: Object, mayBeNull: true, optional: true },\r\n                        { name: \"controlId\", type: String, mayBeNull: true, optional: true },\r\n                    ]);\r\n                    if (e)\r\n                        throw e;\r\n                    if (appDomains) {\r\n                        //check appDomains is a valid Array\r\n                        if (!(appDomains instanceof Array)) {\r\n                            throw OsfMsAjaxFactory.msAjaxError.argument(\"appDomains\");\r\n                        }\r\n                        this._appDomains[conversationId] = appDomains;\r\n                    }\r\n                    this._conversations[conversationId] = { url: conversationUrl, controlId: controlId };\r\n                }\r\n\r\n                /// <summary>\r\n                /// unregister conversation Id on this service endpoint.\r\n                /// </summary>\r\n                /// <accessibility>public</accessibility>\r\n                /// <param name=\"conversationId\">conversation Id</param>\r\n                unregisterConversation(conversationId) {\r\n                    //check parameters\r\n                    var e = Function._validateParams(arguments, [\r\n                        { name: \"conversationId\", type: String, mayBeNull: false }\r\n                    ]);\r\n                    if (e)\r\n                        throw e;\r\n                    delete this._conversations[conversationId];\r\n                }\r\n\r\n                /// <summary>\r\n                /// set the policy manager for this service endpoint.\r\n                /// </summary>\r\n                /// <accessibility>public</accessibility>\r\n                /// <param name=\"policyManager\">policy Manager</param>\r\n                setPolicyManager(policyManager) {\r\n                    //check parameters\r\n                    var e = Function._validateParams(arguments, [\r\n                        { name: \"policyManager\", type: Object, mayBeNull: false }\r\n                    ]);\r\n                    if (e)\r\n                        throw e;\r\n                    //check targetWindow is valid\r\n                    if (!policyManager.checkPermission) {\r\n                        throw OsfMsAjaxFactory.msAjaxError.argument(\"policyManager\");\r\n                    }\r\n                    this._policyManager = policyManager;\r\n                }\r\n\r\n                /// <summary>\r\n                /// return the policy mananger for this service endpoint.\r\n                /// </summary>\r\n                /// <accessibility>public</accessibility>\r\n                getPolicyManager() {\r\n                    return this._policyManager;\r\n                }\r\n\r\n                //public method to release the objects references that ServiceEndPoint holds\r\n                dispose() {\r\n                    this._methodObjectList = null;\r\n                    this._eventHandlerProxyList = null;\r\n                    this._Id = null;\r\n                    this._conversations = null;\r\n                    this._policyManager = null;\r\n                    this._appDomains = null;\r\n                    this._onHandleRequestError = null;\r\n                }\r\n            }\r\n\r\n            /// <summary>\r\n            /// ClientEndPoint contains sender's data structures and logoics\r\n            /// </summary>\r\n            /// <accessibility>public</accessibility>\r\n            /// <param name=\"conversationId\">The conversation Id. Must be provided</param>\r\n            /// <param name=\"targetWindow\">The window object of callee. Must be provided </param>\r\n            /// <param name=\"targetUrl\">The url of callee window. Must be provided </param>\r\n            export class ClientEndPoint {\r\n                _callbackList: any;\r\n                _callingIndex: any;\r\n                _checkReceiverOriginAndRun: any;\r\n                _checkStatusLogged: any;\r\n                _conversationId: any;\r\n                _eventHandlerList: any;\r\n                _hostTrustCheckStatus: any;\r\n                _serializerVersion: any;\r\n                _targetUrl: any;\r\n                _targetWindow: any;\r\n                constructor(conversationId, targetWindow, targetUrl, serializerVersion) {\r\n                    var e = Function._validateParams(arguments, [\r\n                        { name: \"conversationId\", type: String, mayBeNull: false },\r\n                        { name: \"targetWindow\", mayBeNull: false },\r\n                        { name: \"targetUrl\", type: String, mayBeNull: false },\r\n                        { name: \"serializerVersion\", type: Number, mayBeNull: true, optional: true }\r\n                    ]);\r\n                    if (e)\r\n                        throw e;\r\n                    //check targetWindow is valid\r\n                    try {\r\n                        // when targetWindow is window.opener, then edge will throw 'argument not optional' exception, so add specific handle for edge in catch\r\n                        if (!targetWindow.postMessage) {\r\n                            throw OsfMsAjaxFactory.msAjaxError.argument(\"targetWindow\");\r\n                        }\r\n                    }\r\n                    catch (ex) {\r\n                        // check whether targetWindow has postMessage property\r\n                        if (!Object.prototype.hasOwnProperty.call(targetWindow, \"postMessage\")) {\r\n                            throw OsfMsAjaxFactory.msAjaxError.argument(\"targetWindow\");\r\n                        }\r\n                    }\r\n                    //conversation Id\r\n                    this._conversationId = conversationId;\r\n                    //target window\r\n                    this._targetWindow = targetWindow;\r\n                    //target window url\r\n                    this._targetUrl = targetUrl;\r\n                    //calling index used by caller\r\n                    this._callingIndex = 0;\r\n                    //object, contains references to calller's callback function, each ref will be removed\r\n                    //after each invocation. The key is callingIndex/correlationId\r\n                    this._callbackList = {};\r\n                    //object, contains references to caller's event handler function, each ref won't be\r\n                    //removed until unregisterEvent is called. The key is event name\r\n                    this._eventHandlerList = {};\r\n                    if (serializerVersion != null) {\r\n                        this._serializerVersion = serializerVersion;\r\n                    }\r\n                    else {\r\n                        this._serializerVersion = OSF.SerializerVersion.Browser;\r\n                    }\r\n                    //function to check if receiver(WAC) origin is not trusted AND then runs passed in delegate\r\n                    this._checkReceiverOriginAndRun = null;\r\n                    //flag indicate the receiver(WAC) origin is not trusted\r\n                    this._hostTrustCheckStatus = Microsoft.Office.Common.HostTrustStatus.unknown;\r\n                    //flag indicate if the trust check status is logged\r\n                    this._checkStatusLogged = false;\r\n                }\r\n\r\n                /// <summary>\r\n                /// invoke  invoke a method on the specified targeted callee from caller.\r\n                /// </summary>\r\n                /// <accessibility>public</accessibility>\r\n                /// <param name=\"targetMethodName\">The method name for the method to be called</param>\r\n                /// <param name=\"callback\">The callback fuction to be called when invocation is finished. This is where caller\r\n                ///                        can expect and handle the result. First param is the call status; Second param\r\n                ///                        value is the result</param>\r\n                /// <param name=\"params\">The parameter values for the call. Pass in null if no params. Special property __timeout__ can be used for per method call timeout (ms) setting.</param>\r\n                /// <param name=\"trustedParams\">The trusted parameetrs for this call.</param>\r\n                /// <remarks>All the paremters must be provided. use null for the value if it is not needed. For example,\r\n                ///          if there is no need to know call result and handle the result, use null for callback</remarks>\r\n                invoke(targetMethodName, callback, param, trustedParams = null) {\r\n                    //check parameters\r\n                    var e = Function._validateParams(arguments, [\r\n                        { name: \"targetMethodName\", type: String, mayBeNull: false },\r\n                        { name: \"callback\", type: Function, mayBeNull: true },\r\n                        { name: \"param\", mayBeNull: true },\r\n                        { name: \"trustedParams\", mayBeNull: true, optional: true }\r\n                    ]);\r\n                    if (e)\r\n                        throw e;\r\n                    var me = this;\r\n                    var funcToRun = function () {\r\n                        //create a correlationId for this calling instance\r\n                        var correlationId = me._callingIndex++;\r\n                        //add callback to callbackList\r\n                        var now = new Date();\r\n                        var callbackEntry: any = { \"callback\": callback, \"createdOn\": now.getTime() };\r\n                        //allow each invoke to set its own timeout through __timeout__ property\r\n                        if (param && typeof param === \"object\" && typeof param.__timeout__ === \"number\") {\r\n                            callbackEntry.timeout = param.__timeout__;\r\n                            delete param.__timeout__;\r\n                        }\r\n                        me._callbackList[correlationId] = callbackEntry;\r\n                        try {\r\n                            if (me._hostTrustCheckStatus !== Microsoft.Office.Common.HostTrustStatus.trusted) {\r\n                                if (targetMethodName !== \"ContextActivationManager_getAppContextAsync\") {\r\n                                    throw \"Access Denied\";\r\n                                }\r\n                            }\r\n                            //construct a request object\r\n                            var callRequest = new Microsoft.Office.Common.Request(targetMethodName, Microsoft.Office.Common.ActionType.invoke, me._conversationId, correlationId, param);\r\n                            //serialize the request object\r\n                            var msg = Microsoft.Office.Common.MessagePackager.envelope(callRequest, me._serializerVersion);\r\n                            me._targetWindow.postMessage(msg, me._targetUrl);\r\n                            Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer();\r\n                        }\r\n                        catch (ex) {\r\n                            try {\r\n                                if (callback !== null)\r\n                                    //send the exception back to the caller\r\n                                    callback(Microsoft.Office.Common.InvokeResultCode.errorInRequest, ex);\r\n                            }\r\n                            finally {\r\n                                delete me._callbackList[correlationId];\r\n                            }\r\n                        }\r\n                    };\r\n                    if (me._checkReceiverOriginAndRun) {\r\n                        me._checkReceiverOriginAndRun(funcToRun);\r\n                    }\r\n                    else {\r\n                        me._hostTrustCheckStatus = Microsoft.Office.Common.HostTrustStatus.trusted; // default to trusted when the method is not defined\r\n                        funcToRun();\r\n                    }\r\n                }\r\n\r\n                /// <summary>\r\n                /// registerForEvent  registers for an event method on the specified targeted callee from caller.The event method\r\n                ///                    must have been added to the callee by using registerEvent.\r\n                /// </summary>\r\n                /// <accessibility>public</accessibility>\r\n                /// <param name=\"targetEventName\">The event name for the event to be registered</param>\r\n                /// <param name=\"eventHandler\">The callback fuction to be called when the specified event is finished. This is\r\n                ///                        where caller can expect and handle the result of eventing operation. First param is\r\n                ///                        the event data passing status; Second param value is the event data</param>\r\n                /// <param name=\"callback\">The callback fuction to be called when registering event is finished. This is where\r\n                ///                        caller can expect and handle the result of registering operation, to know if the\r\n                ///                        registration is sucessful or not, First param is the call status; Second param value\r\n                ///                        is the result</param>\r\n                /// <param name=\"data\">The paremeters for register event method on the caller.</param>\r\n                /// <remarks>All the paremters must be provided, except for the parameter \"params\". use null for the value if\r\n                ///          it is not needed. For example, if there is no need to know call result and handle the result, use\r\n                ///          null for callback</remarks>\r\n                registerForEvent(targetEventName, eventHandler, callback, data) {\r\n                    //check parameters\r\n                    var e = Function._validateParams(arguments, [\r\n                        { name: \"targetEventName\", type: String, mayBeNull: false },\r\n                        { name: \"eventHandler\", type: Function, mayBeNull: false },\r\n                        { name: \"callback\", type: Function, mayBeNull: true },\r\n                        { name: \"data\", mayBeNull: true, optional: true }\r\n                    ]);\r\n                    if (e)\r\n                        throw e;\r\n                    //create a correlationId for this calling instance\r\n                    var correlationId = this._callingIndex++;\r\n                    //add callback to callbackList\r\n                    var now = new Date();\r\n                    this._callbackList[correlationId] = { \"callback\": callback, \"createdOn\": now.getTime() };\r\n                    try {\r\n                        //construct a request object\r\n                        var callRequest = new Microsoft.Office.Common.Request(targetEventName, Microsoft.Office.Common.ActionType.registerEvent, this._conversationId, correlationId, data);\r\n                        //serialize the request object\r\n                        var msg = Microsoft.Office.Common.MessagePackager.envelope(callRequest, this._serializerVersion);\r\n                        this._targetWindow.postMessage(msg, this._targetUrl);\r\n                        Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer();\r\n                        //add eventHanlder to eventCallbackList if it succeeds until here\r\n                        this._eventHandlerList[targetEventName] = eventHandler;\r\n                    }\r\n                    catch (ex) {\r\n                        try {\r\n                            if (callback !== null) {\r\n                                //send the exception back to the caller\r\n                                callback(Microsoft.Office.Common.InvokeResultCode.errorInRequest, ex);\r\n                            }\r\n                        }\r\n                        finally {\r\n                            delete this._callbackList[correlationId];\r\n                        }\r\n                    }\r\n                }\r\n\r\n                /// <summary>\r\n                /// unregisterForEvent  unregisters for an event on the specified targeted callee from caller.The event methods\r\n                ///                      must have been added to the callee by using registerEvent.\r\n                /// </summary>\r\n                /// <accessibility>public</accessibility>\r\n                /// <param name=\"targetEventName\">The event name of the event to be unregistered</param>\r\n                /// <param name=\"callback\">The callback fuction to be called when unregistering event is finished. This is where\r\n                ///                        caller can expect and handle the result of unregistering operation, to know if the\r\n                ///                        unregistration is sucessful or not, First param is the call status; Second param value\r\n                ///                        is the result</param>\r\n                /// <param name=\"data\">The paremeters for register event method on the caller.</param>\r\n                /// <remarks>All the paremters must be provided, except for the parameter \"params\". use null for the value if it is\r\n                ///          not needed. For example, if there is no need to know call result and handle the result, use null for\r\n                ///          callback</remarks>\r\n                unregisterForEvent(targetEventName, callback, data) {\r\n                    //check parameters\r\n                    var e = Function._validateParams(arguments, [\r\n                        { name: \"targetEventName\", type: String, mayBeNull: false },\r\n                        { name: \"callback\", type: Function, mayBeNull: true },\r\n                        { name: \"data\", mayBeNull: true, optional: true }\r\n                    ]);\r\n                    if (e)\r\n                        throw e;\r\n                    //create a correlationId for this calling instance\r\n                    var correlationId = this._callingIndex++;\r\n                    //add callback to callbackList\r\n                    var now = new Date();\r\n                    this._callbackList[correlationId] = { \"callback\": callback, \"createdOn\": now.getTime() };\r\n                    try {\r\n                        //construct a request object\r\n                        var callRequest = new Microsoft.Office.Common.Request(targetEventName, Microsoft.Office.Common.ActionType.unregisterEvent, this._conversationId, correlationId, data);\r\n                        //serialize the request object\r\n                        var msg = Microsoft.Office.Common.MessagePackager.envelope(callRequest, this._serializerVersion);\r\n                        this._targetWindow.postMessage(msg, this._targetUrl);\r\n                        Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer();\r\n                    }\r\n                    catch (ex) {\r\n                        try {\r\n                            if (callback !== null) {\r\n                                //send the exception back to the caller\r\n                                callback(Microsoft.Office.Common.InvokeResultCode.errorInRequest, ex);\r\n                            }\r\n                        }\r\n                        finally {\r\n                            delete this._callbackList[correlationId];\r\n                        }\r\n                    }\r\n                    finally {\r\n                        //try to unregister as much as we can even if it fails on callee side\r\n                        delete this._eventHandlerList[targetEventName];\r\n                    }\r\n                }\r\n            }\r\n\r\n            /// <summary>\r\n            /// Message  the base class of Request and Response message, contains request/response's envelope and data infomration.\r\n            /// </summary>\r\n            /// <accessibility>private</accessibility>\r\n            /// <param name=\"messageType\">contains message type value</param>\r\n            /// <param name=\"actionName\">contains method name to be called or event name to be registered/unregistered</param>\r\n            /// <param name=\"conversationId\">unique id to identify the message sender</param>\r\n            /// <param name=\"correlationId\">unique id to identify current calling instance</param>\r\n            /// <param name=\"data\">optional, parameter values or result value for current calling instance</param>\r\n            export class Message {\r\n                _actionName: any;\r\n                _conversationId: any;\r\n                _correlationId: any;\r\n                _data: any;\r\n                _messageType: any;\r\n                _origin: any;\r\n                constructor(messageType, actionName, conversationId, correlationId, data) {\r\n                    //check parameters\r\n                    var e = Function._validateParams(arguments, [\r\n                        { name: \"messageType\", type: Number, mayBeNull: false },\r\n                        { name: \"actionName\", type: String, mayBeNull: false },\r\n                        { name: \"conversationId\", type: String, mayBeNull: false },\r\n                        { name: \"correlationId\", mayBeNull: false },\r\n                        { name: \"data\", mayBeNull: true, optional: true }\r\n                    ]);\r\n                    if (e)\r\n                        throw e;\r\n                    //message type\r\n                    this._messageType = messageType;\r\n                    //method name to be called or event name to be registered/unregistered\r\n                    this._actionName = actionName;\r\n                    //unique id to identify caller\r\n                    this._conversationId = conversationId;\r\n                    //unique id to identify current calling instance\r\n                    this._correlationId = correlationId;\r\n                    //origin Url. When HTML5 sandbox attribute is enabled for Chrome IFrame, e.origin has \"null\" value, so pass along the origin\r\n                    //in message for callback and events.\r\n                    this._origin = window.location.origin;\r\n                    //parameter values or result for current calling instance\r\n                    if (typeof data == \"undefined\") {\r\n                        this._data = null;\r\n                    }\r\n                    else {\r\n                        this._data = data;\r\n                    }\r\n                }\r\n                getActionName() {\r\n                    return this._actionName;\r\n                }\r\n                getConversationId() {\r\n                    return this._conversationId;\r\n                }\r\n                getCorrelationId() {\r\n                    return this._correlationId;\r\n                }\r\n                getOrigin() {\r\n                    return this._origin;\r\n                }\r\n                getData() {\r\n                    return this._data;\r\n                }\r\n                getMessageType() {\r\n                    return this._messageType;\r\n                }\r\n            }\r\n\r\n            /// <summary>\r\n            /// Request  contains calling request's envelope and data infomration.\r\n            /// </summary>\r\n            /// <accessibility>private</accessibility>\r\n            /// <param name=\"actionName\">contains method or event name to be called</param>\r\n            /// <param name=\"actionType\">type of action to be perfomred on the specified action</param>\r\n            /// <param name=\"conversationId\">unique id to identify caller</param>\r\n            /// <param name=\"correlationId\">unique id to identify current calling instance</param>\r\n            /// <param name=\"data\">optional, parameter values for current calling instance</param>\r\n            export class Request extends Message {\r\n                static uber: any;\r\n                _actionType: any;\r\n                constructor(actionName, actionType, conversationId, correlationId, data) {\r\n                    super(Microsoft.Office.Common.MessageType.request, actionName, conversationId, correlationId, data);\r\n                    this._actionType = actionType;\r\n                }\r\n                getActionType() {\r\n                    return this._actionType;\r\n                }\r\n            }\r\n\r\n            /// <summary>\r\n            /// Response  contains calling response's envelope and data infomration.\r\n            /// </summary>\r\n            /// <accessibility>private</accessibility>\r\n            /// <param name=\"actionName\">contains method name to be called</param>\r\n            /// <param name=\"conversationId\">unique id to identify caller</param>\r\n            /// <param name=\"correlationId\">unique id to identify current calling instance</param>\r\n            /// <param name=\"errorCode\">error code to indicate if there is and what is the error of current call;\r\n            ///                         0 indicates ok, a negative number indicates an error</param>\r\n            /// <param name=\"responseType\">response type value for the response</param>\r\n            /// <param name=\"data\">optional, parameter values for current calling instance</param>\r\n            export class Response extends Message {\r\n                static uber: any;\r\n                _errorCode: any;\r\n                _responseType: any;\r\n                constructor(actionName, conversationId, correlationId, errorCode, responseType, data) {\r\n                    super(Microsoft.Office.Common.MessageType.response, actionName, conversationId, correlationId, data);\r\n                    this._errorCode = errorCode;\r\n                    this._responseType = responseType;\r\n                }\r\n                getErrorCode() {\r\n                    return this._errorCode;\r\n                }\r\n                getResponseType() {\r\n                    return this._responseType;\r\n                }\r\n            }\r\n\r\n            /// <summary>\r\n            /// Invoker  contains information and a method of invoking per invocation instance. This is the class who\r\n            ///           knows how to invoke the targeted method, and to invoke any post inovation operations.\r\n            /// </summary>\r\n            /// <accessibility>private</accessibility>\r\n            /// <param name=\"methodObject\">contains the information about the method </param>\r\n            /// <param name=\"paramValues\">parameter values for the invocation instance</param>\r\n            /// <param name=\"invokeCompleteCallback\">contains the callback method once invocation is finished. This function has\r\n            ///                                      the context information of sender/requester</param>\r\n            /// <param name=\"eventHandlerProxyList\">contains the list of eventHandlerProxy object on the callee's channel</param>\r\n            /// <param name=\"conversationId\">contains the conversationId</param>\r\n            /// <param name=\"actionName\">contains the actionName (eventName) for register/unregister event method invocation</param>\r\n            export class Invoker {\r\n                _callerId: any;\r\n                _conversationId: any;\r\n                _eventHandlerProxyList: any;\r\n                _eventName: any;\r\n                _invokeCompleteCallback: any;\r\n                _methodObject: any;\r\n                _param: any;\r\n                _trustedParams: any;\r\n                _serializerVersion: any;\r\n                constructor(methodObject, paramValue, invokeCompleteCallback, eventHandlerProxyList, conversationId, eventName, serializerVersion, trustedParams = null) {\r\n                    //TODO: move eventHandlerProxyList can be null, should move it to the end\r\n                    //check parameters\r\n                    var e = Function._validateParams(arguments, [\r\n                        { name: \"methodObject\", mayBeNull: false },\r\n                        { name: \"paramValue\", mayBeNull: true },\r\n                        { name: \"invokeCompleteCallback\", mayBeNull: false },\r\n                        { name: \"eventHandlerProxyList\", mayBeNull: true },\r\n                        { name: \"conversationId\", type: String, mayBeNull: false },\r\n                        { name: \"eventName\", type: String, mayBeNull: false },\r\n                        { name: \"serializerVersion\", type: Number, mayBeNull: true, optional: true },\r\n                        { name: \"trustedParams\", type: Object, mayBeNull: true, optional: true }\r\n                    ]);\r\n                    if (e)\r\n                        throw e;\r\n                    //contains informatin about the method to be invoked\r\n                    this._methodObject = methodObject;\r\n                    //parameter values for the invocation instance\r\n                    this._param = paramValue;\r\n                    //parameter values for the invocation instance which are trusted\r\n                    this._trustedParams = trustedParams;\r\n                    //contains the caller context and callback method after the invocation is finished\r\n                    this._invokeCompleteCallback = invokeCompleteCallback;\r\n                    //contains the calle's eventHandlerProxyList object\r\n                    this._eventHandlerProxyList = eventHandlerProxyList;\r\n                    //contains the conversationId\r\n                    this._conversationId = conversationId;\r\n                    //contains the eventName for register/unregister event method\r\n                    this._eventName = eventName;\r\n                    this._serializerVersion = serializerVersion;\r\n                }\r\n                invoke() {\r\n                    try {\r\n                        //check the Invoke type, handle each kind of invocation\r\n                        //make sure all exception caught here, and don't bubble up to abort\r\n                        //the timer. The exceptions will be packed and sent to caller\r\n                        var result;\r\n                        switch (this._methodObject.getInvokeType()) {\r\n                            case Microsoft.Office.Common.InvokeType.async:\r\n                                //the called method will send back the result\r\n                                this._methodObject.getMethod()(this._param, this._invokeCompleteCallback.getSend(), this._trustedParams);\r\n                                break;\r\n                            case Microsoft.Office.Common.InvokeType.sync:\r\n                                result = this._methodObject.getMethod()(this._param, this._trustedParams);\r\n                                //send back the method call result\r\n                                this._invokeCompleteCallback.getSend()(result);\r\n                                break;\r\n                            case Microsoft.Office.Common.InvokeType.syncRegisterEvent:\r\n                                //create an eventHanderObject\r\n                                var eventHandlerProxy = this._createEventHandlerProxyObject(this._invokeCompleteCallback);\r\n                                //register eventHandlerProxy's send method with event registration method\r\n                                //this._param is optional\r\n                                result = this._methodObject.getMethod()(eventHandlerProxy.getSend(), this._param, this._trustedParams);\r\n                                //add the eventHandlerProxy's send method into eventhandlerProxyList, to be used later by unregister\r\n                                this._eventHandlerProxyList[this._conversationId + this._eventName] = eventHandlerProxy.getSend();\r\n                                //send back the registeration result\r\n                                this._invokeCompleteCallback.getSend()(result);\r\n                                break;\r\n                            case Microsoft.Office.Common.InvokeType.syncUnregisterEvent:\r\n                                //get an eventHander method\r\n                                var eventHandler = this._eventHandlerProxyList[this._conversationId + this._eventName];\r\n                                //unregister the eventHandler with event unregistration method\r\n                                //this._param is optional\r\n                                result = this._methodObject.getMethod()(eventHandler, this._param, this._trustedParams);\r\n                                //remove from eventHandlerProxyList\r\n                                delete this._eventHandlerProxyList[this._conversationId + this._eventName];\r\n                                //send back the registeration result\r\n                                this._invokeCompleteCallback.getSend()(result);\r\n                                break;\r\n                            case Microsoft.Office.Common.InvokeType.asyncRegisterEvent:\r\n                                //create an eventHanderObject\r\n                                var eventHandlerProxyAsync = this._createEventHandlerProxyObject(this._invokeCompleteCallback);\r\n                                //register eventHandlerProxyAsync's send method with event registration async method\r\n                                //this._param is optional\r\n                                this._methodObject.getMethod()(eventHandlerProxyAsync.getSend(), //eventhandler - the proxy\r\n                                this._invokeCompleteCallback.getSend(), //eventRegistractionCallback - the proxy\r\n                                this._param, //param for registerEventMethod\r\n                                this._trustedParams\r\n                                );\r\n                                //add the eventHandlerProxyAsync's send method into eventhandlerProxyList, to be used later by unregister\r\n                                this._eventHandlerProxyList[this._callerId + this._eventName] = eventHandlerProxyAsync.getSend();\r\n                                //the registeration result will be sent back in eventRegistractionCallback\r\n                                break;\r\n                            case Microsoft.Office.Common.InvokeType.asyncUnregisterEvent:\r\n                                //get an eventHander method\r\n                                var eventHandlerAsync = this._eventHandlerProxyList[this._callerId + this._eventName];\r\n                                //unregister the eventHandlerAsync with event unregistration method\r\n                                //this._param is optional\r\n                                this._methodObject.getMethod()(eventHandlerAsync, //eventhandler - on the proxy side\r\n                                this._invokeCompleteCallback.getSend(), //eventUnregistristrationCallback - on the proxy side\r\n                                this._param, //param for unregisterEventMethod\r\n                                this._trustedParams\r\n                                );\r\n                                //remove from eventHandlerProxyList\r\n                                delete this._eventHandlerProxyList[this._callerId + this._eventName];\r\n                                //the result will be sent back via eventUnregistrationCallback, the listener gets removed\r\n                                //the from XDM because of the line above\r\n                                break;\r\n                            default:\r\n                                break;\r\n                        }\r\n                    }\r\n                    catch (ex) {\r\n                        //construct a response object with error, send it back to caller\r\n                        //just set error code, pass in ex as a result, let getSend() construct and send the response.\r\n                        this._invokeCompleteCallback.setResultCode(Microsoft.Office.Common.InvokeResultCode.errorInResponse);\r\n                        this._invokeCompleteCallback.getSend()(ex);\r\n                    }\r\n                }\r\n                getInvokeBlockingFlag() {\r\n                    return this._methodObject.getBlockingFlag();\r\n                }\r\n                _createEventHandlerProxyObject(invokeCompleteObject) {\r\n                    return new Microsoft.Office.Common.ResponseSender(invokeCompleteObject.getRequesterWindow(), invokeCompleteObject.getRequesterUrl(), invokeCompleteObject.getActionName(), invokeCompleteObject.getConversationId(), invokeCompleteObject.getCorrelationId(), Microsoft.Office.Common.ResponseType.forEventing, this._serializerVersion);\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n","/// <reference path='../officexdm.ts' />\r\n\r\nmodule OfficeExt.WACUtils {\r\n    var _trustedDomain = \"^https:\\/\\/[a-z0-9-]+\\.(officeapps\\.live|officeapps-df\\.live|partner\\.officewebapps)\\.com\\/\";\r\n    // Parse and return the app context information from window name, return null if it doesn't exist.\r\n    export function parseAppContextFromWindowName(skipSessionStorage, windowName): any {\r\n        return OSF.OUtil.parseInfoFromWindowName(skipSessionStorage, windowName, OSF.WindowNameItemKeys.AppContext);\r\n    }\r\n    export function serializeObjectToString(obj): string {\r\n        if (typeof (JSON) !== \"undefined\") {\r\n            try {\r\n                return JSON.stringify(obj);\r\n            }\r\n            catch (ex) {\r\n            }\r\n        }\r\n        return \"\";\r\n    }\r\n    export function isHostTrusted(): boolean {\r\n        return (new RegExp(_trustedDomain)).test((OSF as any).getClientEndPoint()._targetUrl.toLowerCase());\r\n    }\r\n    export function addHostInfoAsQueryParam(url, hostInfoValue): string {\r\n        if (!url) {\r\n            return null;\r\n        }\r\n        url = url.trim() || '';\r\n        var questionMark = \"?\";\r\n        var hostInfo = \"_host_Info=\";\r\n        var ampHostInfo = \"&_host_Info=\";\r\n        var fragmentSeparator = \"#\";\r\n        var urlParts = url.split(fragmentSeparator);\r\n        var urlWithoutFragment = urlParts.shift();\r\n        var fragment = urlParts.join(fragmentSeparator);\r\n        var querySplits = urlWithoutFragment.split(questionMark);\r\n        var urlWithoutFragmentWithHostInfo;\r\n        if (querySplits.length > 1) {\r\n            urlWithoutFragmentWithHostInfo = urlWithoutFragment + ampHostInfo + hostInfoValue;\r\n        }\r\n        else if (querySplits.length > 0) {\r\n            urlWithoutFragmentWithHostInfo = urlWithoutFragment + questionMark + hostInfo + hostInfoValue;\r\n        }\r\n        if (fragment) {\r\n            return [urlWithoutFragmentWithHostInfo, fragmentSeparator, fragment].join('');\r\n        }\r\n        else {\r\n            return urlWithoutFragmentWithHostInfo;\r\n        }\r\n    }\r\n    export function getDomainForUrl(url): string {\r\n        if (!url) {\r\n            return null;\r\n        }\r\n        var url_parser = OSF.OUtil.parseUrl(url, /*enforceHttps*/ true);\r\n        return url_parser.protocol + \"//\" + url_parser.host;\r\n    }\r\n    export function shouldUseLocalStorageToPassMessage(): boolean {\r\n        try {\r\n            var osList = [\r\n                \"Windows NT 6.1\",\r\n                \"Windows NT 6.2\",\r\n                \"Windows NT 6.3\",\r\n                \"Windows NT 10.0\"\r\n            ];\r\n            var userAgent = window.navigator.userAgent;\r\n            for (var i = 0, len = osList.length; i < len; i++) {\r\n                if (userAgent.indexOf(osList[i]) > -1) {\r\n                    return isInternetExplorer();\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n        catch (e) {\r\n            logExceptionToBrowserConsole(\"Error happens in shouldUseLocalStorageToPassMessage.\", e);\r\n            return false;\r\n        }\r\n    }\r\n    export function isInternetExplorer(): boolean {\r\n        try {\r\n            var userAgent = window.navigator.userAgent;\r\n            return userAgent.indexOf(\"MSIE \") > -1 || userAgent.indexOf(\"Trident/\") > -1 || userAgent.indexOf(\"Edge/\") > -1;\r\n        }\r\n        catch (e) {\r\n            logExceptionToBrowserConsole(\"Error happens in isInternetExplorer.\", e);\r\n            return false;\r\n        }\r\n    }\r\n    export function removeMatchesFromLocalStorage(regexPatterns: Array<RegExp>): void {\r\n        // Remove multiple cache items that match a set of regex patterns\r\n        var _localStorage = OSF.OUtil.getLocalStorage();\r\n        var keys = _localStorage.getKeysWithPrefix(\"\");\r\n        for (var i = 0, len = keys.length; i < len; i++) {\r\n            var key = keys[i];\r\n            for (var j = 0, lenRegex = regexPatterns.length; j < lenRegex; j++) {\r\n                if (regexPatterns[j].test(key)) {\r\n                    _localStorage.removeItem(key);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    // A helper function to log exception to the browser console\r\n    export function logExceptionToBrowserConsole(message: string, exception: any): void {\r\n        OsfMsAjaxFactory.msAjaxDebug.trace(message + \" Exception details: \" + serializeObjectToString(exception));\r\n    }\r\n    export function isTeamsWebView(): boolean {\r\n        const ua: string = navigator.userAgent;\r\n        /* Electron WebView (scoped to Microsoft Teams for now) */\r\n        return /Teams\\/((?:(\\d+)\\.)?(?:(\\d+)\\.)?(?:(\\d+)\\.\\d+)).* Electron\\/((?:(\\d+)\\.)?(?:(\\d+)\\.)?(?:(\\d+)\\.\\d+))/.test(ua);\r\n    }\r\n    // Do not rename or modify this function without testing SSO for WAC\r\n    // //depot/devmain/msoserviceplatform/src/Browser/App/Packages/AppsForOffice/script/AppsForOfficeSingleSignOnManager.cs\r\n    export function getHostSecure(url: string): string {\r\n        if (typeof url === \"undefined\" || !url) {\r\n            return undefined;\r\n        }\r\n        let host = undefined;\r\n        const httpsProtocol = \"https:\";\r\n        try {\r\n            // Note: URL class decodes Unicode escapes\r\n            let urlObj = new URL(url);\r\n            if (urlObj) {\r\n                host = urlObj.host;\r\n            }\r\n            if (!urlObj.protocol) {\r\n                throw \"fallback\";\r\n            }\r\n            else if (urlObj.protocol !== httpsProtocol) {\r\n                return undefined;\r\n            }\r\n        }\r\n        catch (ex) {\r\n            try {\r\n                let parser = document.createElement(\"a\");\r\n                parser.href = url;\r\n                if (parser.protocol !== httpsProtocol) {\r\n                    return undefined;\r\n                }\r\n                let match = url.match(new RegExp(\"^https://[^/?#]+\", \"i\"));\r\n                let naiveMatch = (match && match.length == 1) ? match[0].toLowerCase() : \"\";\r\n                //IE will show parser.host with the port regardless on whether url originally had a port or not\r\n                //For validation, we need to consider both cases\r\n                let parsedUrlWithoutPort = (parser.protocol + \"//\" + parser.hostname).toLowerCase();\r\n                let parsedUrlWithPort = (parser.protocol + \"//\" + parser.host).toLowerCase();\r\n                /* This verification is very important for security to avoid having garbage urls passed malliciously and\r\n                document.createElement(\"a\") remaining the current document URL which might be whitlisted. */\r\n                if (parsedUrlWithPort === naiveMatch || parsedUrlWithoutPort == naiveMatch) {\r\n                    host = parser.port == \"443\" ? parser.hostname : parser.host;\r\n                }\r\n            }\r\n            catch (ex) {\r\n                return undefined;\r\n            }\r\n        }\r\n        return host ? host.toLowerCase() : undefined;\r\n    }\r\n    export class CacheConstants {\r\n        static GatedCacheKeyPrefix = \"__OSF_GATED_OMEX.\";\r\n        static AnonymousCacheKeyPrefix = \"__OSF_ANONYMOUS_OMEX.\";\r\n        static UngatedCacheKeyPrefix = \"__OSF_OMEX.\";\r\n        static ActivatedCacheKeyPrefix = \"__OSF_RUNTIME_.Activated.\";\r\n        static AppinstallAuthenticated = \"appinstall_authenticated.\";\r\n        static Entitlement = \"entitle.\";\r\n        static AppState = \"appState.\";\r\n        static AppDetails = \"appDetails.\";\r\n        static AppInstallInfo = \"appInstallInfo.\";\r\n        static AuthenticatedAppInstallInfoCacheKey = CacheConstants.GatedCacheKeyPrefix + CacheConstants.AppinstallAuthenticated + \"{0}.{1}.{2}.{3}\";\r\n        static EntitlementsKey = CacheConstants.Entitlement + \"{0}.{1}\";\r\n        static AppStateCacheKey = \"{0}\" + CacheConstants.AppState + \"{1}.{2}\";\r\n        static AppDetailKey = \"{0}\" + CacheConstants.AppDetails + OSF.OUtil.isChangeGateEnabled('OfficeVSO:7799078_CultureAwareAppDetailKey') ? \"{1}.{2}\" : \"{1}\";\r\n        static AppInstallInfoKey = \"{0}\" + CacheConstants.AppInstallInfo + \"{1}.{2}\";\r\n        static ActivatedCacheKey = CacheConstants.ActivatedCacheKeyPrefix + \"{0}.{1}.{2}\";\r\n    }\r\n}\r\nnamespace OSF {\r\n    export enum OmexRemoveAddinResultCode {\r\n        Success = 0,\r\n        ClientError = 400,\r\n        ServerError = 500,\r\n        UnknownError = 600\r\n    }\r\n    export enum OmexRemoveAddinMessageKeys {\r\n        RemoveAddinResultCode = \"resultCode\",\r\n        RemoveAddinResultValue = \"resultValue\"\r\n    }\r\n    // Keys for json message from omex iframe notification\r\n    export enum OmexMessageKeys {\r\n        MessageType = \"messageType\",\r\n        MessageValue = \"messageValue\"\r\n    }\r\n    export enum AuthType {\r\n        Anonymous = 0,\r\n        MSA = 1,\r\n        OrgId = 2,\r\n        ADAL = 3\r\n    }\r\n    // This is used to construct the omex iframe notification url params\r\n    export enum OmexPageParameterKeys {\r\n        AppName = \"client\",\r\n        AppVersion = \"cv\",\r\n        AppUILocale = \"ui\",\r\n        AppDomain = \"appDomain\",\r\n        StoreLocator = \"rs\",\r\n        AssetId = \"assetid\",\r\n        NotificationType = \"notificationType\",\r\n        AppCorrelationId = \"corr\",\r\n        AuthType = \"authType\",\r\n        AppId = \"appid\",\r\n        Scopes = \"scopes\"\r\n    }\r\n    export enum HostThemeButtonStyleKeys {\r\n        ButtonBorderColor = \"buttonBorderColor\",\r\n        ButtonBackgroundColor = \"buttonBackgroundColor\"\r\n    }\r\n    // This is used in DialogActions.ts and wac host\r\n    export enum ShowWindowDialogParameterKeys {\r\n        Url = \"url\",\r\n        Width = \"width\",\r\n        Height = \"height\",\r\n        DisplayInIframe = \"displayInIframe\",\r\n        HideTitle = \"hideTitle\",\r\n        UseDeviceIndependentPixels = \"useDeviceIndependentPixels\",\r\n        PromptBeforeOpen = \"promptBeforeOpen\",\r\n        EnforceAppDomain = \"enforceAppDomain\",\r\n        UrlNoHostInfo = \"urlNoHostInfo\"\r\n    }\r\n}","/// <reference path=\"tsdeclarations/osf.d.ts\" />\r\n/// <reference path=\"tsdeclarations/msajax.d.ts\" />\r\n// OSFJS: Need alternative for FILE_VERSION_STRING THREE_PARTS_FILE_VERSION_STRING\r\nlet stringResourceFileValue = 'osfruntime_strings.js';\r\nif (DEBUG) {\r\n    stringResourceFileValue = 'osfruntime_strings.debug.js';\r\n}\r\nnamespace OSF {\r\n    export let Constants = {\r\n        FileVersion: '0.0.0.0',\r\n        ThreePartsFileVersion: '0.0.0',\r\n        OmexAnonymousServiceName: \"__omexExtensionAnonymousProxy\",\r\n        OmexAnonymousServiceExtension: \"/anonymousserviceextension.aspx\",\r\n        OmexGatedServiceName: \"__omexExtensionGatedProxy\",\r\n        OmexGatedServiceExtension: \"/gatedserviceextension.aspx\",\r\n        OmexUnGatedServiceName: \"__omexExtensionProxy\",\r\n        OmexUnGatedServiceExtension: \"/ungatedserviceextension.aspx\",\r\n        OmexConsentNotificationPage: \"/client/consentnotification.aspx\",\r\n        Http: \"http\",\r\n        Https: \"https\",\r\n        ProtocolSeparator: \"://\",\r\n        SignInRedirectUrl: \"/logontoliveforwac.aspx?returnurl=\",\r\n        ETokenParameterName: \"et\",\r\n        ActivatedCacheKey: \"__OSF_RUNTIME_.Activated.{0}.{1}.{2}\",\r\n        ConsentedCacheKey: \"__OSF_RUNTIME_.Consented.{0}.{1}.{2}\",\r\n        AuthenticatedConnectMaxTries: 3,\r\n        IgnoreSandBoxSupport: \"Ignore_SandBox_Support\",\r\n        IEUpgradeUrl: \"https://office.microsoft.com/redir/HA102789344.aspx\",\r\n        OmexForceAnonymousParamName: \"SKAV\",\r\n        OmexForceAnonymousParamValue: \"274AE4CD-E50B-4342-970E-1E7F36C70037\",\r\n        EndPointInternalSuffix: \"_internal\",\r\n        // CacheKey name for storing SharePoint Catalog trusted locations.\r\n        SPCatalogTrustedLocationsCacheKey: \"__OSF_RUNTIME_.SPCatalog_TrustedLocations\",\r\n        // OSFJS: Need alternative for pre-processor.\r\n        // #ifdef OSFSCRIPT_DEBUG\r\n        // StringResourceFile: \"osfruntime_strings.debug.js\"\r\n        // #else\r\n        StringResourceFile: stringResourceFileValue\r\n        // #endif\r\n    };\r\n}","namespace OSF {\r\n    export enum ClientMode {\r\n        ReadOnly = 0,\r\n        ReadWrite = 1\r\n    }\r\n    export enum OsfControlType {\r\n        DocumentLevel = 0,\r\n        ContainerLevel = 1\r\n    }\r\n\r\n    /// <summary>\r\n    /// OfficeAppContext is the class for host app to provide information for MOE to intialize.\r\n    /// </summary>\r\n    /// <accessibility>public</accessibility>\r\n    /// <param name=\"id\">The solutionId for the MOE (SharePoint app) (Type: String)</param>\r\n    /// <param name=\"appName\">The name of the host application (Type: OSF.AppName) </param>\r\n    /// <param name=\"appVersion\">The version of the host application. For example: \"15\"(Type: String) </param>\r\n    /// <param name=\"appUILocale\">UILocale of the host application. For example: \"en-us\"(Type: String) </param>\r\n    /// <param name=\"dataLocale\">Data locale of the host application document. For example: \"zh-cn\"(Type: String) </param>\r\n    /// <param name=\"docUrl\">Url of the host application document. (Type: String) </param>\r\n    /// <param name=\"clientMode\">The mode of the host application document. (Type: OSF.ClientMode) </param>\r\n    /// <param name=\"settings\">The settings of the MOE. (Type: Object) </param>\r\n    /// <param name=\"reason\">The reason for the MOE intialization.  (Type: Microsoft.Office.WebExtension.InitializationReason) </param>\r\n    /// <param name=\"osfControlType\">The Agave Type.  (Type: OSF.OsfControlType) </param>\r\n    /// <param name=\"eToken\">The token for current user.  (Type: String) </param>\r\n    /// <param name=\"correlationId\">The correlation id.  (Type: String) </param>\r\n    /// <param name=\"appInstanceId\">An unique Id for this App instance.  (Type: String) </param>\r\n    /// <param name=\"touchEnabled\">Is the host using touch input. (Type: Boolean)</param>\r\n    /// <param name=\"commerceAllowed\">Is the app allowed to show commerce UI at this endpoint. (Type: Boolean)</param>\r\n    /// <param name=\"appMinorVersion\">The minor version of the app. (Type: String)</param>\r\n    /// <param name=\"requirementMatrix\">JSON serialized string containing supported API. (Type: String)</param>\r\n    /// <param name=\"hostCustomMessage\">Allows the host to pass a custom message to office.js telemetry. (Type: String)</param>\r\n    /// <param name=\"hostFullVersion\">The major/minor/revision/sequence version of the host. (Type: String)</param>\r\n    /// <param name=\"clientWindowHeight\">The height of the host window. (Type: Integer)</param>\r\n    /// <param name=\"clientWindowWidth\">The width of the host window. (Type: Integer)</param>\r\n    /// <param name=\"addinName\">The name of current addin (Type: String)</param>\r\n    /// <param name=\"appDomains\">The app domain list of the agave (Type: Array)</param>\r\n    /// <param name=\"dialogRequirementMatrix\">JSON serialized string containing dialog requirements. (Type: String)</param>\r\n    /// <param name=\"featureGates\">Map of all feature gate and their values for this solution (Type: Object)\"</param>\r\n    /// <param name=\"officeTheme\">Current OfficeThemeInfo used by the host (Type: Object)</param>\r\n    /// <param name=\"initialDisplayMode\">Runtime's initial display mode (Type: Integer)</param>\r\n    export let OfficeAppContext = function OSF_OfficeAppContext(id, appName, appVersion, appUILocale, dataLocale, docUrl, clientMode, settings, reason, osfControlType, eToken, correlationId, appInstanceId, touchEnabled, commerceAllowed, appMinorVersion, requirementMatrix, hostCustomMessage, hostFullVersion, clientWindowHeight, clientWindowWidth, addinName, appDomains, dialogRequirementMatrix, featureGates, officeTheme, initialDisplayMode, hostSettings) {\r\n        this._id = id;\r\n        this._appName = appName;\r\n        this._appVersion = appVersion;\r\n        this._appUILocale = appUILocale;\r\n        this._dataLocale = dataLocale;\r\n        this._docUrl = docUrl;\r\n        this._clientMode = clientMode;\r\n        this._settings = settings;\r\n        this._reason = reason;\r\n        this._osfControlType = osfControlType;\r\n        this._eToken = eToken;\r\n        this._correlationId = correlationId;\r\n        this._appInstanceId = appInstanceId;\r\n        this._touchEnabled = touchEnabled;\r\n        this._commerceAllowed = commerceAllowed;\r\n        this._appMinorVersion = appMinorVersion;\r\n        this._requirementMatrix = requirementMatrix;\r\n        this._hostCustomMessage = hostCustomMessage;\r\n        this._hostFullVersion = hostFullVersion;\r\n        this._isDialog = false;\r\n        this._clientWindowHeight = clientWindowHeight;\r\n        this._clientWindowWidth = clientWindowWidth;\r\n        this._addinName = addinName;\r\n        this._appDomains = appDomains;\r\n        this._dialogRequirementMatrix = dialogRequirementMatrix;\r\n        this._featureGates = featureGates;\r\n        this._officeTheme = officeTheme;\r\n        this._initialDisplayMode = initialDisplayMode;\r\n        this._hostSettings = hostSettings;\r\n        this.get_id = function get_id() { return this._id; };\r\n        this.get_appName = function get_appName() { return this._appName; };\r\n        this.get_appVersion = function get_appVersion() { return this._appVersion; };\r\n        this.get_appUILocale = function get_appUILocale() { return this._appUILocale; };\r\n        this.get_dataLocale = function get_dataLocale() { return this._dataLocale; };\r\n        this.get_docUrl = function get_docUrl() { return this._docUrl; };\r\n        this.get_clientMode = function get_clientMode() { return this._clientMode; };\r\n        this.get_bindings = function get_bindings() { return this._bindings; };\r\n        this.get_settings = function get_settings() { return this._settings; };\r\n        this.get_reason = function get_reason() { return this._reason; };\r\n        this.get_osfControlType = function get_osfControlType() { return this._osfControlType; };\r\n        this.get_eToken = function get_eToken() { return this._eToken; };\r\n        this.get_correlationId = function get_correlationId() { return this._correlationId; };\r\n        this.get_appInstanceId = function get_appInstanceId() { return this._appInstanceId; };\r\n        this.get_touchEnabled = function get_touchEnabled() { return this._touchEnabled; };\r\n        this.get_commerceAllowed = function get_commerceAllowed() { return this._commerceAllowed; };\r\n        this.get_appMinorVersion = function get_appMinorVersion() { return this._appMinorVersion; };\r\n        this.get_requirementMatrix = function get_requirementMatrix() { return this._requirementMatrix; };\r\n        this.get_dialogRequirementMatrix = function get_dialogRequirementMatrix() { return this._dialogRequirementMatrix; };\r\n        this.get_hostCustomMessage = function get_hostCustomMessage() { return this._hostCustomMessage; };\r\n        this.get_hostFullVersion = function get_hostFullVersion() { return this._hostFullVersion; };\r\n        this.get_isDialog = function get_isDialog() { return this._isDialog; };\r\n        this.get_clientWindowHeight = function get_clientWindowHeight() { return this._clientWindowHeight; };\r\n        this.get_clientWindowWidth = function get_clientWindowWidth() { return this._clientWindowWidth; };\r\n        this.get_addinName = function get_addinName() { return this._addinName; };\r\n        this.get_appDomains = function get_appDomains() { return this._appDomains; };\r\n        this.get_featureGates = function get_featureGates() { return this._featureGates; };\r\n        this.get_officeTheme = function get_officeTheme() { return this._officeTheme; };\r\n        this.get_initialDisplayMode = function get_initialDisplayMode() { return this._initialDisplayMode ? this._initialDisplayMode : 0; };\r\n        this.get_hostSettings = function get_hostSettings() { return this._hostSettings; };\r\n    };\r\n    export enum DialogMessageType {\r\n        DialogMessageReceived = 0,\r\n        DialogParentMessageReceived = 1,\r\n        DialogClosed = 12006 // errorCodes.ooeWebDialogClosed\r\n    }\r\n\r\n    // Constants that are shared by OsfRuntime.ts and Office.ts\r\n    export enum SharedConstants {\r\n        \"NotificationConversationIdSuffix\" = '_ntf'\r\n    }\r\n\r\n    // ActionId for notification between Agave and Host\r\n    export enum AgaveHostAction {\r\n        \"Select\" = 0,\r\n        \"UnSelect\" = 1,\r\n        \"CancelDialog\" = 2,\r\n        \"InsertAgave\" = 3,\r\n        \"CtrlF6In\" = 4,\r\n        \"CtrlF6Exit\" = 5,\r\n        \"CtrlF6ExitShift\" = 6,\r\n        \"SelectWithError\" = 7,\r\n        \"NotifyHostError\" = 8,\r\n        \"RefreshAddinCommands\" = 9,\r\n        \"PageIsReady\" = 10,\r\n        \"TabIn\" = 11,\r\n        \"TabInShift\" = 12,\r\n        \"TabExit\" = 13,\r\n        \"TabExitShift\" = 14,\r\n        \"EscExit\" = 15,\r\n        \"F2Exit\" = 16,\r\n        \"ExitNoFocusable\" = 17,\r\n        \"ExitNoFocusableShift\" = 18,\r\n        \"MouseEnter\" = 19,\r\n        \"MouseLeave\" = 20,\r\n        \"UpdateTargetUrl\" = 21,\r\n        \"InstallCustomFunctions\" = 22,\r\n        \"SendTelemetryEvent\" = 23,\r\n        \"UninstallCustomFunctions\" = 24,\r\n        \"SendMessage\" = 25,\r\n        \"LaunchExtensionComponent\" = 26,\r\n        \"StopExtensionComponent\" = 27,\r\n        \"RestartExtensionComponent\" = 28,\r\n        \"EnableTaskPaneHeaderButton\" = 29,\r\n        \"DisableTaskPaneHeaderButton\" = 30,\r\n        \"TaskPaneHeaderButtonClicked\" = 31,\r\n        \"RemoveAppCommandsAddin\" = 32,\r\n        \"RefreshRibbonGallery\" = 33,\r\n        \"GetOriginalControlId\" = 34,\r\n        \"OfficeJsReady\" = 35,\r\n        \"InsertDevManifest\" = 36,\r\n        \"InsertDevManifestError\" = 37,\r\n        \"SendCustomerContent\" = 38,\r\n        \"KeyboardShortcuts\" = 39,\r\n        \"OsfControlLoad\" = 40,\r\n        \"ClickTrust\" = 41,\r\n        \"CloseSDXDialog\" = 42\r\n    }\r\n    export enum HostCallPerfMarker {\r\n        IssueCall = \"Agave.HostCall.IssueCall\",\r\n        ReceiveResponse = \"Agave.HostCall.ReceiveResponse\",\r\n        RuntimeExceptionRaised = \"Agave.HostCall.RuntimeExecptionRaised\"\r\n    }\r\n    export enum InternalPerfMarker {\r\n        DataCoercionBegin = \"Agave.HostCall.CoerceDataStart\",\r\n        DataCoercionEnd = \"Agave.HostCall.CoerceDataEnd\" // \"Agave.Internal.DataCoercionEnd\"\r\n    }\r\n    export namespace DDA {\r\n        export enum EventDispId {\r\n            dispidEventMin = 0,\r\n            // DDA\r\n            dispidInitializeEvent = 0,\r\n            dispidSettingsChangedEvent = 1,\r\n            dispidDocumentSelectionChangedEvent = 2,\r\n            dispidBindingSelectionChangedEvent = 3,\r\n            dispidBindingDataChangedEvent = 4,\r\n            dispidDocumentOpenEvent = 5,\r\n            dispidDocumentCloseEvent = 6,\r\n            dispidActiveViewChangedEvent = 7,\r\n            dispidDocumentThemeChangedEvent = 8,\r\n            dispidOfficeThemeChangedEvent = 9,\r\n            dispidDialogMessageReceivedEvent = 10,\r\n            dispidDialogNotificationShownInAddinEvent = 11,\r\n            dispidDialogParentMessageReceivedEvent = 12,\r\n            dispidObjectDeletedEvent = 13,\r\n            dispidObjectSelectionChangedEvent = 14,\r\n            dispidObjectDataChangedEvent = 15,\r\n            dispidContentControlAddedEvent = 16,\r\n            dispidLiveShareStateChangedEvent = 17,\r\n            // Internal events:\r\n            dispidActivationStatusChangedEvent = 32,\r\n            dispidRichApiMessageEvent = 33,\r\n            dispidAppCommandInvokedEvent = 39,\r\n            // Outlook - make sure that these are not already in use by Outlook for other APIs.\r\n            dispidOlkItemSelectedChangedEvent = 46,\r\n            dispidOlkRecipientsChangedEvent = 47,\r\n            dispidOlkAppointmentTimeChangedEvent = 48,\r\n            dispidOlkRecurrenceChangedEvent = 49,\r\n            dispidOlkAttachmentsChangedEvent = 50,\r\n            dispidOlkEnhancedLocationsChangedEvent = 51,\r\n            dispidOlkInfobarClickedEvent = 52,\r\n            // PROJECT SPECIFIC - 56-59 reserved\r\n            dispidTaskSelectionChangedEvent = 56,\r\n            dispidResourceSelectionChangedEvent = 57,\r\n            dispidViewSelectionChangedEvent = 58,\r\n            // CustomXmlPart\r\n            dispidDataNodeAddedEvent = 60,\r\n            dispidDataNodeReplacedEvent = 61,\r\n            dispidDataNodeDeletedEvent = 62,\r\n            dispidEventMax = 63\r\n        }\r\n        export enum MethodDispId {\r\n            dispidMethodMin = 64,\r\n            // DDA\r\n            dispidGetSelectedDataMethod = 64,\r\n            dispidSetSelectedDataMethod = 65,\r\n            dispidAddBindingFromSelectionMethod = 66,\r\n            dispidAddBindingFromPromptMethod = 67,\r\n            dispidGetBindingMethod = 68,\r\n            dispidReleaseBindingMethod = 69,\r\n            dispidGetBindingDataMethod = 70,\r\n            dispidSetBindingDataMethod = 71,\r\n            dispidAddRowsMethod = 72,\r\n            dispidClearAllRowsMethod = 73,\r\n            dispidGetAllBindingsMethod = 74,\r\n            dispidLoadSettingsMethod = 75,\r\n            dispidSaveSettingsMethod = 76,\r\n            dispidGetDocumentCopyMethod = 77,\r\n            dispidAddBindingFromNamedItemMethod = 78,\r\n            dispidAddColumnsMethod = 79,\r\n            dispidGetDocumentCopyChunkMethod = 80,\r\n            dispidReleaseDocumentCopyMethod = 81,\r\n            dispidNavigateToMethod = 82,\r\n            dispidGetActiveViewMethod = 83,\r\n            dispidGetDocumentThemeMethod = 84,\r\n            dispidGetOfficeThemeMethod = 85,\r\n            dispidGetFilePropertiesMethod = 86,\r\n            dispidClearFormatsMethod = 87,\r\n            dispidSetTableOptionsMethod = 88,\r\n            dispidSetFormatsMethod = 89,\r\n            // OSFJS: Need pre-processor alternative.\r\n            // #ifdef ENABLE_OSFCLIENT_USERIDENTITY\r\n            dispidGetUserIdentityInfoMethod = 92,\r\n            // #endif\r\n            dispidExecuteRichApiRequestMethod = 93,\r\n            dispidAppCommandInvocationCompletedMethod = 94,\r\n            dispidCloseContainerMethod = 97,\r\n            dispidGetAccessTokenMethod = 98,\r\n            dispidGetAuthContextMethod = 99,\r\n            dispidGetLiveShareStateMethod = 100,\r\n            dispidSetLiveShareStateMethod = 101,\r\n            dispidOpenBrowserWindow = 102,\r\n            dispidCreateDocumentMethod = 105,\r\n            dispidInsertFormMethod = 106,\r\n            dispidDisplayRibbonCalloutAsyncMethod = 109,\r\n            // PROJECT SPECIFIC\r\n            //Project method range: 110-127\r\n            dispidGetSelectedTaskMethod = 110,\r\n            dispidGetSelectedResourceMethod = 111,\r\n            dispidGetTaskMethod = 112,\r\n            dispidGetResourceFieldMethod = 113,\r\n            dispidGetWSSUrlMethod = 114,\r\n            dispidGetTaskFieldMethod = 115,\r\n            dispidGetProjectFieldMethod = 116,\r\n            dispidGetSelectedViewMethod = 117,\r\n            dispidGetTaskByIndexMethod = 118,\r\n            dispidGetResourceByIndexMethod = 119,\r\n            dispidSetTaskFieldMethod = 120,\r\n            dispidSetResourceFieldMethod = 121,\r\n            dispidGetMaxTaskIndexMethod = 122,\r\n            dispidGetMaxResourceIndexMethod = 123,\r\n            dispidCreateTaskMethod = 124,\r\n            // CustomXmlPart\r\n            dispidAddDataPartMethod = 128,\r\n            dispidGetDataPartByIdMethod = 129,\r\n            dispidGetDataPartsByNamespaceMethod = 130,\r\n            dispidGetDataPartXmlMethod = 131,\r\n            dispidGetDataPartNodesMethod = 132,\r\n            dispidDeleteDataPartMethod = 133,\r\n            dispidGetDataNodeValueMethod = 134,\r\n            dispidGetDataNodeXmlMethod = 135,\r\n            dispidGetDataNodesMethod = 136,\r\n            dispidSetDataNodeValueMethod = 137,\r\n            dispidSetDataNodeXmlMethod = 138,\r\n            dispidAddDataNamespaceMethod = 139,\r\n            dispidGetDataUriByPrefixMethod = 140,\r\n            dispidGetDataPrefixByUriMethod = 141,\r\n            dispidGetDataNodeTextMethod = 142,\r\n            dispidSetDataNodeTextMethod = 143,\r\n            // New General API\r\n            dispidMessageParentMethod = 144,\r\n            dispidSendMessageMethod = 145,\r\n            dispidExecuteFeature = 146,\r\n            dispidQueryFeature = 147,\r\n            dispidMethodMax = 147,\r\n            dispidGetNestedAppAuthContextMethod = 205\r\n        }\r\n\r\n        // The XDM requires server-side hookups for all events, but bindings and data nodes for custom xml are dynamically created and so they need specific event names for XDM registration\r\n        export let getXdmEventName = function OSF_DDA$GetXdmEventName(id, eventType) {\r\n            // @ts-ignore TS2339\r\n            if (eventType == Microsoft.Office.WebExtension.EventType.BindingSelectionChanged ||\r\n                // @ts-ignore TS2339\r\n                eventType == Microsoft.Office.WebExtension.EventType.BindingDataChanged ||\r\n                // @ts-ignore TS2339\r\n                eventType == Microsoft.Office.WebExtension.EventType.DataNodeDeleted ||\r\n                // @ts-ignore TS2339\r\n                eventType == Microsoft.Office.WebExtension.EventType.DataNodeInserted ||\r\n                // @ts-ignore TS2339\r\n                eventType == Microsoft.Office.WebExtension.EventType.DataNodeReplaced) {\r\n                return id + \"_\" + eventType;\r\n            }\r\n            else {\r\n                return eventType;\r\n            }\r\n        };\r\n        export enum UI {\r\n        }\r\n        export enum ListDescriptors {\r\n        }\r\n        export enum EventDescriptors {\r\n        }\r\n        export enum PropertyDescriptors {\r\n            AsyncResultStatus = \"AsyncResultStatus\"\r\n        }\r\n        export enum DocumentMode {\r\n            ReadOnly = 1,\r\n            ReadWrite = 0\r\n        }\r\n    }\r\n}\r\n\r\nnamespace Microsoft {\r\n    export namespace Office {\r\n        export namespace WebExtension {\r\n            export enum Parameters {\r\n                BindingType = \"bindingType\",\r\n                CoercionType = \"coercionType\",\r\n                ValueFormat = \"valueFormat\",\r\n                FilterType = \"filterType\",\r\n                Columns = \"columns\",\r\n                SampleData = \"sampleData\",\r\n                GoToType = \"goToType\",\r\n                SelectionMode = \"selectionMode\",\r\n                Id = \"id\",\r\n                PromptText = \"promptText\",\r\n                ItemName = \"itemName\",\r\n                FailOnCollision = \"failOnCollision\",\r\n                StartRow = \"startRow\",\r\n                StartColumn = \"startColumn\",\r\n                RowCount = \"rowCount\",\r\n                ColumnCount = \"columnCount\",\r\n                Callback = \"callback\",\r\n                AsyncContext = \"asyncContext\",\r\n                Data = \"data\",\r\n                Rows = \"rows\",\r\n                OverwriteIfStale = \"overwriteIfStale\",\r\n                FileType = \"fileType\",\r\n                EventType = \"eventType\",\r\n                Handler = \"handler\",\r\n                SliceSize = \"sliceSize\",\r\n                SliceIndex = \"sliceIndex\",\r\n                ActiveView = \"activeView\",\r\n                Status = \"status\",\r\n                PlatformType = \"platformType\",\r\n                HostType = \"hostType\",\r\n                // OSFJS: Need alternative to pre-processors\r\n                // #ifdef ENABLE_OSFCLIENT_USERIDENTITY\r\n                Email = \"email\",\r\n                // #endif\r\n                // Add-in SSO\r\n                ForceConsent = \"forceConsent\",\r\n                ForceAddAccount = \"forceAddAccount\",\r\n                AuthChallenge = \"authChallenge\",\r\n                AllowConsentPrompt = \"allowConsentPrompt\",\r\n                ForMSGraphAccess = \"forMSGraphAccess\",\r\n                AllowSignInPrompt = \"allowSignInPrompt\",\r\n                JsonPayload = \"jsonPayload\",\r\n                EnableNewHosts = \"enableNewHosts\",\r\n                AccountTypeFilter = \"accountTypeFilter\",\r\n                AddinTrustId = \"addinTrustId\",\r\n                Reserved = \"reserved\",\r\n                Tcid = \"tcid\",\r\n                // Custom XML Parts\r\n                Xml = \"xml\",\r\n                Namespace = \"namespace\",\r\n                Prefix = \"prefix\",\r\n                XPath = \"xPath\",\r\n                Text = \"text\",\r\n                // Image properties\r\n                ImageLeft = \"imageLeft\",\r\n                ImageTop = \"imageTop\",\r\n                ImageWidth = \"imageWidth\",\r\n                ImageHeight = \"imageHeight\",\r\n                // Project Specific\r\n                TaskId = \"taskId\",\r\n                FieldId = \"fieldId\",\r\n                FieldValue = \"fieldValue\",\r\n                ServerUrl = \"serverUrl\",\r\n                ListName = \"listName\",\r\n                ResourceId = \"resourceId\",\r\n                ViewType = \"viewType\",\r\n                ViewName = \"viewName\",\r\n                GetRawValue = \"getRawValue\",\r\n                CellFormat = \"cellFormat\",\r\n                TableOptions = \"tableOptions\",\r\n                TaskIndex = \"taskIndex\",\r\n                ResourceIndex = \"resourceIndex\",\r\n                CustomFieldId = \"customFieldId\",\r\n                // Auth Dialog\r\n                Url = \"url\",\r\n                MessageHandler = \"messageHandler\",\r\n                Width = \"width\",\r\n                Height = \"height\",\r\n                RequireHTTPs = \"requireHTTPS\",\r\n                MessageToParent = \"messageToParent\",\r\n                DisplayInIframe = \"displayInIframe\",\r\n                MessageContent = \"messageContent\",\r\n                TargetOrigin = \"targetOrigin\",\r\n                HideTitle = \"hideTitle\",\r\n                UseDeviceIndependentPixels = \"useDeviceIndependentPixels\",\r\n                PromptBeforeOpen = \"promptBeforeOpen\",\r\n                EnforceAppDomain = \"enforceAppDomain\",\r\n                UrlNoHostInfo = \"urlNoHostInfo\",\r\n                Targetorigin = \"targetOrigin\",\r\n                // AddinCommands\r\n                AppCommandInvocationCompletedData = \"appCommandInvocationCompletedData\",\r\n                // CreateDocument\r\n                Base64 = \"base64\",\r\n                // InsertForm\r\n                FormId = \"formId\"\r\n            }\r\n            export enum FilterType {\r\n                All = \"all\"\r\n            }\r\n\r\n            // ValueFormat represents the formattedness (localized, currency formatted, etc) of an office data value\r\n            export enum ValueFormat {\r\n                Unformatted = \"unformatted\",\r\n                Formatted = \"formatted\"\r\n            }\r\n\r\n            /// <summary>\r\n            /// Enum that indicates the reason for MOE intialization.\r\n            /// </summary>\r\n            export enum InitializationReason {\r\n                Inserted = \"inserted\",\r\n                DocumentOpened = \"documentOpened\",\r\n                ControlActivation = \"controlActivation\"\r\n            }\r\n        }\r\n    }\r\n}","var _serviceEndPoint = null;\r\nvar _defaultRefreshRate = 3; //default refresh rate: 3 days\r\n\r\nvar _msPerDay = 86400000; //24*60*60*1000ms\r\n\r\nvar _defaultTimeout = 60000; //set timeout to be 60 seconds\r\n\r\nvar _officeVersionHeader = \"X-Office-Version\"; //office version HTTP header\r\n\r\nvar _hourToDayConversionFactor = 24; //hours to days conversion factor \r\n\r\nvar _buildParameter = \"&build=\";\r\nvar _expectedVersionParameter = \"&expver=\";\r\nvar _queryStringParameters = {\r\n    clientName: \"client\",\r\n    clientVersion: \"cv\"\r\n};\r\nvar statusCode = {\r\n    Succeeded: 1,\r\n    Failed: 0\r\n};\r\nvar _spUpn = null;\r\nfunction _sendWebRequest(url, verb, headers, onCompleted, context, body?) {\r\n    context = context || {};\r\n    var webRequest = new Sys.Net.WebRequest();\r\n    for (var p in headers) {\r\n        webRequest.get_headers()[p] = headers[p];\r\n    }\r\n    if (context) {\r\n        if (context.officeVersion) {\r\n            webRequest.get_headers()[_officeVersionHeader] = context.officeVersion;\r\n        }\r\n        if (context.correlationId && url.indexOf('?') > -1) {\r\n            url += \"&corr=\" + context.correlationId;\r\n        }\r\n    }\r\n    if (body) {\r\n        webRequest.set_body(body);\r\n    }\r\n    webRequest.set_url(url);\r\n    webRequest.set_httpVerb(verb);\r\n    webRequest.set_timeout(_defaultTimeout);\r\n    webRequest.set_userContext(context);\r\n    webRequest.add_completed(onCompleted);\r\n    webRequest.invoke();\r\n}\r\n;\r\nfunction _onCompleted(executor, eventArgs) {\r\n    var context = executor.get_webRequest().get_userContext();\r\n    var url = executor.get_webRequest().get_url();\r\n    if (executor.get_timedOut()) {\r\n        //timeout, just invoke callback with status as failed (0) \r\n        OsfMsAjaxFactory.msAjaxDebug.trace(\"Request timed out: \" + url);\r\n        _invokeCallbackTag(context.callback, statusCode.Failed, null, null, executor, 0x0085a2c3 /* tag_a70ld */);\r\n    }\r\n    else if (executor.get_aborted()) {\r\n        //aborted, just invoke callback with status as failed (0) \r\n        OsfMsAjaxFactory.msAjaxDebug.trace(\"Request aborted: \" + url);\r\n        _invokeCallbackTag(context.callback, statusCode.Failed, null, null, executor, 0x0085a2c4 /* tag_a70le */);\r\n    }\r\n    else if (executor.get_responseAvailable()) {\r\n        if (executor.get_statusCode() == 200) {\r\n            try {\r\n                context._onCompleteHandler(executor, eventArgs);\r\n            }\r\n            catch (ex) {\r\n                //failed, just invoke callback with status as failed (0) \r\n                OsfMsAjaxFactory.msAjaxDebug.trace(\"Request failed with exception \" + ex + \": \" + url);\r\n                _invokeCallbackTag(context.callback, statusCode.Failed, ex, null, executor, 0x0085a2c5 /* tag_a70lf */);\r\n            }\r\n        }\r\n        else {\r\n            //status code is not OK (200), just invoke callback with status as failed (0) \r\n            var statusText = executor.get_statusText();\r\n            OsfMsAjaxFactory.msAjaxDebug.trace(\"Request failed with status code \" + statusText + \": \" + url);\r\n            _invokeCallbackTag(context.callback, statusCode.Failed, statusText, null, executor, 0x0085a2c6 /* tag_a70lg */);\r\n        }\r\n    }\r\n    else {\r\n        //failed, just invoke callback with status as failed (0) \r\n        OsfMsAjaxFactory.msAjaxDebug.trace(\"Request failed: \" + url);\r\n        _invokeCallbackTag(context.callback, statusCode.Failed, statusText, null, executor, 0x0085a2c7 /* tag_a70lh */);\r\n    }\r\n}\r\n;\r\nfunction _isProxyReady(params, callback) {\r\n    if (callback) {\r\n        callback({ \"status\": statusCode.Succeeded, \"result\": true });\r\n    }\r\n}\r\n;\r\nfunction _createQueryStringFragment(paramDictionary) {\r\n    var queryString = \"\";\r\n    for (var param in paramDictionary) {\r\n        var value = paramDictionary[param];\r\n        if (value === null || value === undefined || value === \"\") {\r\n            continue;\r\n        }\r\n        queryString += '&' + encodeURIComponent(param) + '=' + encodeURIComponent(value);\r\n    }\r\n    return queryString;\r\n}\r\n;","namespace Mos { \r\n    export class AcquisitionList implements IAcquisitionList {\r\n        acquisitions!: Acquisition[];\r\n        syncKey!: string;\r\n        nextInterval!: number;\r\n\r\n        constructor(data?: IAcquisitionList) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n            if (!data) {\r\n                this.acquisitions = [];\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                if (Array.isArray(_data[\"acquisitions\"])) {\r\n                    this.acquisitions = [] as any;\r\n                    for (let item of _data[\"acquisitions\"])\r\n                        this.acquisitions!.push(Acquisition.fromJS(item));\r\n                }\r\n                this.syncKey = _data[\"syncKey\"];\r\n                this.nextInterval = _data[\"nextInterval\"];\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): AcquisitionList {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new AcquisitionList();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        push(data: AcquisitionList): void {\r\n            this.acquisitions.push(...data.acquisitions);\r\n            this.syncKey = data.syncKey;\r\n            this.nextInterval = data.nextInterval;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            if (Array.isArray(this.acquisitions)) {\r\n                data[\"acquisitions\"] = [];\r\n                for (let item of this.acquisitions)\r\n                    data[\"acquisitions\"].push(item.toJSON());\r\n            }\r\n            data[\"syncKey\"] = this.syncKey;\r\n            data[\"nextInterval\"] = this.nextInterval;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IAcquisitionList {\r\n        acquisitions: Acquisition[];\r\n        syncKey: string;\r\n        nextInterval: number;\r\n    }\r\n\r\n    export class Acquisition implements IAcquisition {\r\n        titleId!: string;\r\n        assetId: string;\r\n        manifestId: string;\r\n        titleDefinition!: TitleDefinition;\r\n        acquisitionState!: string;\r\n        acquisitionContext!: string;\r\n        canBeUnacquired: boolean;\r\n\r\n        constructor(data?: IAcquisition) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n            if (!data) {\r\n                this.titleDefinition = new TitleDefinition();\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.titleId = _data[\"titleId\"];\r\n                this.assetId = _data[\"assetId\"];\r\n                this.manifestId = _data[\"manifestId\"];\r\n                this.titleDefinition = _data[\"titleDefinition\"] ? TitleDefinition.fromJS(_data[\"titleDefinition\"]) : new TitleDefinition();\r\n                this.acquisitionState = _data[\"acquisitionState\"];\r\n                this.acquisitionContext = _data[\"acquisitionContext\"];\r\n                this.canBeUnacquired = _data[\"canBeUnacquired\"];\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Acquisition {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Acquisition();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"titleId\"] = this.titleId;\r\n            data[\"assetId\"] = this.assetId;\r\n            data[\"manifestId\"] = this.manifestId;\r\n            data[\"titleDefinition\"] = this.titleDefinition ? this.titleDefinition.toJSON() : <any>undefined;\r\n            data[\"acquisitionState\"] = this.acquisitionState;\r\n            data[\"acquisitionContext\"] = this.acquisitionContext;\r\n            data[\"canBeUnacquired\"] = this.canBeUnacquired;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IAcquisition {\r\n        titleId: string;\r\n        assetId: string;\r\n        manifestId: string;\r\n        titleDefinition: TitleDefinition;\r\n        acquisitionState: string;\r\n        acquisitionContext: string;\r\n        canBeUnacquired?: boolean;\r\n    }\r\n\r\n    export class TitleDefinition implements ITitleDefinition {\r\n        name!: string;\r\n        iconSmall!: IconSmall;\r\n        version!: string;\r\n        elementDefinitions!: ElementDefinitions;\r\n        ingestionSource!: string;\r\n        scope!: string;\r\n        developerName!: string;\r\n        shortDescription!: string;\r\n        /** A list of valid domains from which the tabs expect to load any content. Domain listings can include wildcards, for example `*.example.com`. If your tab configuration or content UI needs to navigate to any other domain besides the one use for tab configuration, that domain must be specified here. */\r\n        validDomains!: string[];\r\n        /** Specify your AAD App ID and Graph information to help users seamlessly sign into your AAD app. */\r\n        webApplicationInfo!: WebApplicationInfo;\r\n        /** Specify and consolidates authorization related information for the App. */\r\n        authorization!: Authorization;\r\n\r\n        constructor(data?: ITitleDefinition) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n            if (!data) {\r\n                this.iconSmall = new IconSmall();\r\n                this.elementDefinitions = new ElementDefinitions();\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.name = _data[\"name\"];\r\n                this.iconSmall = _data[\"iconSmall\"] ? IconSmall.fromJS(_data[\"iconSmall\"]) : new IconSmall();\r\n                this.version = _data[\"version\"];\r\n                this.elementDefinitions = _data[\"elementDefinitions\"] ? ElementDefinitions.fromJS(_data[\"elementDefinitions\"]) : new ElementDefinitions();\r\n                this.ingestionSource = _data[\"ingestionSource\"];\r\n                this.scope = _data[\"scope\"];\r\n                this.developerName = _data[\"developerName\"];\r\n                this.shortDescription = _data[\"shortDescription\"];\r\n                if (Array.isArray(_data[\"validDomains\"])) {\r\n                    this.validDomains = [] as any;\r\n                    for (let item of _data[\"validDomains\"])\r\n                        this.validDomains!.push(item);\r\n                }\r\n                this.webApplicationInfo = _data[\"webApplicationInfo\"] ? WebApplicationInfo.fromJS(_data[\"webApplicationInfo\"]) : <any>undefined;\r\n                this.authorization = _data[\"authorization\"] ? Authorization.fromJS(_data[\"authorization\"]) : <any>undefined;\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): TitleDefinition {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new TitleDefinition();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"name\"] = this.name;\r\n            data[\"iconSmall\"] = this.iconSmall ? this.iconSmall.toJSON() : <any>undefined;\r\n            data[\"version\"] = this.version;\r\n            data[\"elementDefinitions\"] = this.elementDefinitions ? this.elementDefinitions.toJSON() : <any>undefined;\r\n            data[\"ingestionSource\"] = this.ingestionSource;\r\n            data[\"scope\"] = this.scope;\r\n            data[\"developerName\"] = this.developerName;\r\n            data[\"shortDescription\"] = this.shortDescription;\r\n            if (Array.isArray(this.validDomains)) {\r\n                data[\"validDomains\"] = [];\r\n                for (let item of this.validDomains)\r\n                    data[\"validDomains\"].push(item);\r\n            }\r\n            data[\"webApplicationInfo\"] = this.webApplicationInfo ? this.webApplicationInfo.toJSON() : <any>undefined;\r\n            data[\"authorization\"] = this.authorization ? this.authorization.toJSON() : <any>undefined;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface ITitleDefinition {\r\n        name: string;\r\n        iconSmall: IconSmall;\r\n        version: string;\r\n        elementDefinitions: ElementDefinitions;\r\n        ingestionSource: string;\r\n        scope: string;\r\n        developerName: string;\r\n        shortDescription: string;\r\n        /** A list of valid domains from which the tabs expect to load any content. Domain listings can include wildcards, for example `*.example.com`. If your tab configuration or content UI needs to navigate to any other domain besides the one use for tab configuration, that domain must be specified here. */\r\n        validDomains: string[];\r\n        /** Specify your AAD App ID and Graph information to help users seamlessly sign into your AAD app. */\r\n        webApplicationInfo: WebApplicationInfo;\r\n        /** Specify and consolidates authorization related information for the App. */\r\n        authorization: Authorization;\r\n    }\r\n\r\n    export class IconSmall implements IIconSmall {\r\n        uri!: string;\r\n    \r\n        constructor(data?: IIconSmall) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n    \r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.uri = _data[\"uri\"];\r\n            }\r\n        }\r\n    \r\n        static fromJS(data: any): IconSmall {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new IconSmall();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n    \r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"uri\"] = this.uri;\r\n            return data;\r\n        }\r\n    }\r\n    \r\n    export interface IIconSmall {\r\n        uri: string;\r\n    }\r\n\r\n    export class ElementDefinitions implements IElementDefinitions {\r\n        officeAddIns!: OfficeAddIn[];\r\n        extensions!: Extension[];\r\n        firstPartyPages!: FirstPartyPages[];\r\n\r\n        constructor(data?: IElementDefinitions) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                if (Array.isArray(_data[\"officeAddIns\"])) {\r\n                    this.officeAddIns = [] as any;\r\n                    for (let item of _data[\"officeAddIns\"])\r\n                        this.officeAddIns!.push(OfficeAddIn.fromJS(item));\r\n                }\r\n                if (Array.isArray(_data[\"extensions\"])) {\r\n                    this.extensions = [] as any;\r\n                    for (let item of _data[\"extensions\"])\r\n                        this.extensions!.push(Extension.fromJS(item));\r\n                }\r\n                if (Array.isArray(_data[\"firstPartyPages\"])) {\r\n                    this.firstPartyPages = [] as any;\r\n                    for (let item of _data[\"firstPartyPages\"])\r\n                        this.firstPartyPages!.push(FirstPartyPages.fromJS(item));\r\n                }\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): ElementDefinitions {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new ElementDefinitions();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            if (Array.isArray(this.officeAddIns)) {\r\n                data[\"officeAddIns\"] = [];\r\n                for (let item of this.officeAddIns)\r\n                    data[\"officeAddIns\"].push(item.toJSON());\r\n            }\r\n            if (Array.isArray(this.extensions)) {\r\n                data[\"extensions\"] = [];\r\n                for (let item of this.extensions)\r\n                    data[\"extensions\"].push(item.toJSON());\r\n            }\r\n            if (Array.isArray(this.firstPartyPages)) {\r\n                data[\"firstPartyPages\"] = [];\r\n                for (let item of this.firstPartyPages)\r\n                    data[\"firstPartyPages\"].push(item.toJSON());\r\n            }\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IElementDefinitions {\r\n        officeAddIns: OfficeAddIn[];\r\n        extensions: Extension[];\r\n        firstPartyPages: FirstPartyPages[];\r\n    }\r\n\r\n    export class WebApplicationInfo implements IWebApplicationInfo {\r\n        /** AAD application id of the app. This id must be a GUID. */\r\n        id!: string;\r\n        /** Resource url of app for acquiring auth token for SSO. */\r\n        resource!: string;\r\n\r\n        constructor(data?: IWebApplicationInfo) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.id = _data[\"id\"];\r\n                this.resource = _data[\"resource\"];\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): WebApplicationInfo {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new WebApplicationInfo();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"id\"] = this.id;\r\n            data[\"resource\"] = this.resource;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IWebApplicationInfo {\r\n        /** AAD application id of the app. This id must be a GUID. */\r\n        id: string;\r\n        /** Resource url of app for acquiring auth token for SSO. */\r\n        resource: string;\r\n    }\r\n\r\n    export class Authorization implements IAuthorization {\r\n        /** Specify Permissions which App lists for accessing Resource. */\r\n        permissions!: Permissions;\r\n\r\n        constructor(data?: IAuthorization) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.permissions = _data[\"permissions\"] ? Permissions.fromJS(_data[\"permissions\"]) : <any>undefined;\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Authorization {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Authorization();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"permissions\"] = this.permissions ? this.permissions.toJSON() : <any>undefined;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IAuthorization {\r\n        /** Specify Permissions which App lists for accessing Resource. */\r\n        permissions: Permissions;\r\n    }\r\n\r\n    export class OfficeAddIn implements IOfficeAddIn {\r\n        xmlDefinition!: string;\r\n        name!: string;\r\n\r\n        constructor(data?: IOfficeAddIn) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.xmlDefinition = _data[\"xmlDefinition\"];\r\n                this.name = _data[\"name\"];\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): OfficeAddIn {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new OfficeAddIn();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"xmlDefinition\"] = this.xmlDefinition;\r\n            data[\"name\"] = this.name;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IOfficeAddIn {\r\n        xmlDefinition: string;\r\n        name: string;\r\n    }\r\n\r\n    export class Extension implements IExtension {\r\n        requirements!: Requirements;\r\n        getStartedMessages!: GetStartedMessages[];\r\n        runtimes!: Runtimes[];\r\n        ribbons!: Ribbons[];\r\n        shortcuts!: Shortcuts[];\r\n        autoRunEvents!: AutoRunEvents[];\r\n        contextMenus!: ContextMenus[];\r\n        alternatives!: Alternatives[];\r\n\r\n        constructor(data?: IExtension) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n            if (!data) {\r\n                this.getStartedMessages = [];\r\n                this.runtimes = [];\r\n                this.shortcuts = [];\r\n                this.autoRunEvents = [];\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.requirements = _data[\"requirements\"] ? Requirements.fromJS(_data[\"requirements\"]) : <any>undefined;\r\n                if (Array.isArray(_data[\"getStartedMessages\"])) {\r\n                    this.getStartedMessages = [] as any;\r\n                    for (let item of _data[\"getStartedMessages\"])\r\n                        this.getStartedMessages!.push(GetStartedMessages.fromJS(item));\r\n                }\r\n                if (Array.isArray(_data[\"runtimes\"])) {\r\n                    this.runtimes = [] as any;\r\n                    for (let item of _data[\"runtimes\"])\r\n                        this.runtimes!.push(Runtimes.fromJS(item));\r\n                }\r\n                if (Array.isArray(_data[\"ribbons\"])) {\r\n                    this.ribbons = [] as any;\r\n                    for (let item of _data[\"ribbons\"])\r\n                        this.ribbons!.push(Ribbons.fromJS(item));\r\n                }\r\n                if (Array.isArray(_data[\"shortcuts\"])) {\r\n                    this.shortcuts = [] as any;\r\n                    for (let item of _data[\"shortcuts\"])\r\n                        this.shortcuts!.push(Shortcuts.fromJS(item));\r\n                }\r\n                if (Array.isArray(_data[\"autoRunEvents\"])) {\r\n                    this.autoRunEvents = [] as any;\r\n                    for (let item of _data[\"autoRunEvents\"])\r\n                        this.autoRunEvents!.push(AutoRunEvents.fromJS(item));\r\n                }\r\n                if (Array.isArray(_data[\"contextMenus\"])) {\r\n                    this.contextMenus = [] as any;\r\n                    for (let item of _data[\"contextMenus\"])\r\n                        this.contextMenus!.push(ContextMenus.fromJS(item));\r\n                }\r\n                if (Array.isArray(_data[\"alternatives\"])) {\r\n                    this.alternatives = [] as any;\r\n                    for (let item of _data[\"alternatives\"])\r\n                        this.alternatives!.push(Alternatives.fromJS(item));\r\n                }\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Extension {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Extension();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"requirements\"] = this.requirements ? this.requirements.toJSON() : <any>undefined;\r\n            if (Array.isArray(this.getStartedMessages)) {\r\n                data[\"getStartedMessages\"] = [];\r\n                for (let item of this.getStartedMessages)\r\n                    data[\"getStartedMessages\"].push(item.toJSON());\r\n            }\r\n            if (Array.isArray(this.runtimes)) {\r\n                data[\"runtimes\"] = [];\r\n                for (let item of this.runtimes)\r\n                    data[\"runtimes\"].push(item.toJSON());\r\n            }\r\n            if (Array.isArray(this.ribbons)) {\r\n                data[\"ribbons\"] = [];\r\n                for (let item of this.ribbons)\r\n                    data[\"ribbons\"].push(item.toJSON());\r\n            }\r\n            if (Array.isArray(this.shortcuts)) {\r\n                data[\"shortcuts\"] = [];\r\n                for (let item of this.shortcuts)\r\n                    data[\"shortcuts\"].push(item.toJSON());\r\n            }\r\n            if (Array.isArray(this.autoRunEvents)) {\r\n                data[\"autoRunEvents\"] = [];\r\n                for (let item of this.autoRunEvents)\r\n                    data[\"autoRunEvents\"].push(item.toJSON());\r\n            }\r\n            if (Array.isArray(this.contextMenus)) {\r\n                data[\"contextMenus\"] = [];\r\n                for (let item of this.contextMenus)\r\n                    data[\"contextMenus\"].push(item.toJSON());\r\n            }\r\n            if (Array.isArray(this.alternatives)) {\r\n                data[\"alternatives\"] = [];\r\n                for (let item of this.alternatives)\r\n                    data[\"alternatives\"].push(item.toJSON());\r\n            }\r\n            return data;\r\n        }\r\n    }\r\n    \r\n    export interface IExtension {\r\n        requirements: Requirements;\r\n        getStartedMessages: GetStartedMessages[];\r\n        runtimes: Runtimes[];\r\n        ribbons: Ribbons[];\r\n        shortcuts: Shortcuts[];\r\n        autoRunEvents: AutoRunEvents[];\r\n        contextMenus: ContextMenus[];\r\n        alternatives: Alternatives[];\r\n    }\r\n\r\n    export class FirstPartyPages implements IFirstPartyPages {\r\n        id!: string;\r\n        title!: string;\r\n        subtitle!: Subtitle | undefined;\r\n        alternateNames!: AlternateNames | undefined;\r\n        brandBarText!: BrandBarText | undefined;\r\n        ariaLabel!: string;\r\n        publisher!: string;\r\n        iconAnonymousUrl!: string;\r\n        targetWindow!: TargetWindow | undefined;\r\n        backgroundColor!: string;\r\n        launchFullUrl!: string;\r\n        name!: string;\r\n\r\n        constructor(data?: IFirstPartyPages) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.id = _data[\"Id\"];\r\n                this.title = _data[\"Title\"];\r\n                this.subtitle = _data[\"Subtitle\"];\r\n                this.alternateNames = _data[\"AlternateNames\"];\r\n                this.brandBarText = _data[\"BrandBarText\"];\r\n                this.ariaLabel = _data[\"AriaLabel\"];\r\n                this.publisher = _data[\"Publisher\"];\r\n                this.iconAnonymousUrl = _data[\"IconAnonymousUrl\"];\r\n                this.targetWindow = _data[\"TargetWindow\"];\r\n                this.backgroundColor = _data[\"BackgroundColor\"];\r\n                this.launchFullUrl = _data[\"LaunchFullUrl\"];\r\n                this.name = _data[\"name\"];\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): FirstPartyPages {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new FirstPartyPages();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"Id\"] = this.id;\r\n            data[\"Title\"] = this.title;\r\n            data[\"Subtitle\"] = this.subtitle;\r\n            data[\"AlternateNames\"] = this.alternateNames;\r\n            data[\"BrandBarText\"] = this.brandBarText;\r\n            data[\"AriaLabel\"] = this.ariaLabel;\r\n            data[\"Publisher\"] = this.publisher;\r\n            data[\"IconAnonymousUrl\"] = this.iconAnonymousUrl;\r\n            data[\"TargetWindow\"] = this.targetWindow;\r\n            data[\"BackgroundColor\"] = this.backgroundColor;\r\n            data[\"LaunchFullUrl\"] = this.launchFullUrl;\r\n            data[\"name\"] = this.name;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IFirstPartyPages {\r\n        id: string;\r\n        title: string;\r\n        subtitle: Subtitle | undefined;\r\n        alternateNames: AlternateNames | undefined;\r\n        brandBarText: BrandBarText | undefined;\r\n        ariaLabel: string;\r\n        publisher: string;\r\n        iconAnonymousUrl: string;\r\n        targetWindow: TargetWindow | undefined;\r\n        backgroundColor: string;\r\n        launchFullUrl: string;\r\n        name: string;\r\n    }\r\n\r\n    export class Permissions implements IPermissions {\r\n        /** App's organization wide classic permissions provided by user. */\r\n        orgWide!: OrgWide[];\r\n        /** App's resource specific permissions provided by user. */\r\n        resourceSpecific!: ResourceSpecific[];\r\n\r\n        constructor(data?: IPermissions) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                if (Array.isArray(_data[\"orgWide\"])) {\r\n                    this.orgWide = [] as any;\r\n                    for (let item of _data[\"orgWide\"])\r\n                        this.orgWide!.push(OrgWide.fromJS(item));\r\n                }\r\n                if (Array.isArray(_data[\"resourceSpecific\"])) {\r\n                    this.resourceSpecific = [] as any;\r\n                    for (let item of _data[\"resourceSpecific\"])\r\n                        this.resourceSpecific!.push(ResourceSpecific.fromJS(item));\r\n                }\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Permissions {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Permissions();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            if (Array.isArray(this.orgWide)) {\r\n                data[\"orgWide\"] = [];\r\n                for (let item of this.orgWide)\r\n                    data[\"orgWide\"].push(item.toJSON());\r\n            }\r\n            if (Array.isArray(this.resourceSpecific)) {\r\n                data[\"resourceSpecific\"] = [];\r\n                for (let item of this.resourceSpecific)\r\n                    data[\"resourceSpecific\"].push(item.toJSON());\r\n            }\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IPermissions {\r\n        /** App's organization wide classic permissions provided by user. */\r\n        orgWide: OrgWide[];\r\n        /** App's resource specific permissions provided by user. */\r\n        resourceSpecific: ResourceSpecific[];\r\n    }\r\n\r\n    export class Requirements implements IRequirements {\r\n        scopes!: Scopes[];\r\n        capabilities!: Capabilities[];\r\n        platforms!: Platforms[];\r\n        formFactors!: FormFactors[];\r\n    \r\n        constructor(data?: IRequirements) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n    \r\n        init(_data?: any) {\r\n            if (_data) {\r\n                if (Array.isArray(_data[\"scopes\"])) {\r\n                    this.scopes = [] as any;\r\n                    for (let item of _data[\"scopes\"])\r\n                        this.scopes!.push(item);\r\n                }\r\n                if (Array.isArray(_data[\"capabilities\"])) {\r\n                    this.capabilities = [] as any;\r\n                    for (let item of _data[\"capabilities\"])\r\n                        this.capabilities!.push(Capabilities.fromJS(item));\r\n                }\r\n                if (Array.isArray(_data[\"platforms\"])) {\r\n                    this.platforms = [] as any;\r\n                    for (let item of _data[\"platforms\"])\r\n                        this.platforms!.push(item);\r\n                }\r\n                if (Array.isArray(_data[\"formFactors\"])) {\r\n                    this.formFactors = [] as any;\r\n                    for (let item of _data[\"formFactors\"])\r\n                        this.formFactors!.push(item);\r\n                }\r\n            }\r\n        }\r\n    \r\n        static fromJS(data: any): Requirements {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Requirements();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n    \r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            if (Array.isArray(this.scopes)) {\r\n                data[\"scopes\"] = [];\r\n                for (let item of this.scopes)\r\n                    data[\"scopes\"].push(item);\r\n            }\r\n            if (Array.isArray(this.capabilities)) {\r\n                data[\"capabilities\"] = [];\r\n                for (let item of this.capabilities)\r\n                    data[\"capabilities\"].push(item.toJSON());\r\n            }\r\n            if (Array.isArray(this.platforms)) {\r\n                data[\"platforms\"] = [];\r\n                for (let item of this.platforms)\r\n                    data[\"platforms\"].push(item);\r\n            }\r\n            if (Array.isArray(this.formFactors)) {\r\n                data[\"formFactors\"] = [];\r\n                for (let item of this.formFactors)\r\n                    data[\"formFactors\"].push(item);\r\n            }\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IRequirements {\r\n        scopes: Scopes[];\r\n        capabilities: Capabilities[];\r\n        platforms: Platforms[];\r\n        formFactors: FormFactors[];\r\n    }\r\n\r\n    export class GetStartedMessages implements IGetStartedMessages {\r\n        requirements!: Requirements;\r\n        title!: string;\r\n        description!: string;\r\n        learnMoreUrl!: string;\r\n    \r\n        constructor(data?: IGetStartedMessages) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n    \r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.requirements = _data[\"requirements\"] ? Requirements.fromJS(_data[\"requirements\"]) : <any>undefined;\r\n                this.title = _data[\"title\"];\r\n                this.description = _data[\"description\"];\r\n                this.learnMoreUrl = _data[\"learnMoreUrl\"];\r\n            }\r\n        }\r\n    \r\n        static fromJS(data: any): GetStartedMessages {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new GetStartedMessages();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n    \r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"requirements\"] = this.requirements ? this.requirements.toJSON() : <any>undefined;\r\n            data[\"title\"] = this.title;\r\n            data[\"description\"] = this.description;\r\n            data[\"learnMoreUrl\"] = this.learnMoreUrl;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IGetStartedMessages {\r\n        requirements: Requirements;\r\n        title: string;\r\n        description: string;\r\n        learnMoreUrl: string;\r\n    }\r\n\r\n    export class Runtimes implements IRuntimes {\r\n        requirements!: Requirements;\r\n        id!: string;\r\n        type!: string;\r\n        code!: Code;\r\n        lifetime!: string;\r\n        actions!: Actions[];\r\n        functions!: Functions[];\r\n        functionSettings!: FunctionSettings;\r\n    \r\n        constructor(data?: IRuntimes) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n            if (!data) {\r\n                this.code = new Code();\r\n                this.actions = [];\r\n                this.functions = [];\r\n                this.functionSettings = new FunctionSettings();\r\n            }\r\n        }\r\n    \r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.requirements = _data[\"requirements\"] ? Requirements.fromJS(_data[\"requirements\"]) : <any>undefined;\r\n                this.id = _data[\"id\"];\r\n                this.type = _data[\"type\"];\r\n                this.code = _data[\"code\"] ? Code.fromJS(_data[\"code\"]) : new Code();\r\n                this.lifetime = _data[\"lifetime\"];\r\n                if (Array.isArray(_data[\"actions\"])) {\r\n                    this.actions = [] as any;\r\n                    for (let action of _data[\"actions\"])\r\n                        this.actions!.push(Actions.fromJS(action));\r\n                }\r\n                if (Array.isArray(_data[\"functions\"])) {\r\n                    this.functions = [] as any;\r\n                    for (let item of _data[\"functions\"])\r\n                        this.functions!.push(item);\r\n                }\r\n                this.functionSettings = _data[\"functionSettings\"] ? FunctionSettings.fromJS(_data[\"functionSettings\"]): new FunctionSettings();\r\n            }\r\n        }\r\n    \r\n        static fromJS(data: any): Runtimes {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Runtimes();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n    \r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"requirements\"] = this.requirements ? this.requirements.toJSON() : <any>undefined;\r\n            data[\"id\"] = this.id;\r\n            data[\"type\"] = this.type;\r\n            data[\"code\"] = this.code ? this.code.toJSON() : <any>undefined;\r\n            data[\"lifetime\"] = this.lifetime;\r\n            if (Array.isArray(this.actions)) {\r\n                data[\"actions\"] = [];\r\n                for (let action of this.actions)\r\n                    data[\"actions\"].push(action.toJSON());\r\n            }\r\n            if (Array.isArray(this.functions)) {\r\n                data[\"functions\"] = [];\r\n                for (let item of this.functions)\r\n                    data[\"functions\"].push(item.toJSON());\r\n            }\r\n            data[\"functionSettings\"] = this.functionSettings? this.functionSettings.toJSON() : <any>undefined;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IRuntimes {\r\n        requirements: Requirements;\r\n        id: string;\r\n        type: string;\r\n        code: Code;\r\n        lifetime: string;\r\n        actions: Actions[];\r\n        functions: Functions[];\r\n        functionSettings: FunctionSettings;\r\n    }\r\n\r\n    export class Ribbons implements IRibbons {\r\n        requirements!: Requirements;\r\n        contexts!: Contexts[];\r\n        tabs!: Tabs[];\r\n\r\n        constructor(data?: IRibbons) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n            if (!data) {\r\n                this.tabs = [];\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.requirements = _data[\"requirements\"] ? Requirements.fromJS(_data[\"requirements\"]) : <any>undefined;\r\n                if (Array.isArray(_data[\"contexts\"])) {\r\n                    this.contexts = [] as any;\r\n                    for (let item of _data[\"contexts\"])\r\n                        this.contexts!.push(item);\r\n                }\r\n                if (Array.isArray(_data[\"tabs\"])) {\r\n                    this.tabs = [] as any;\r\n                    for (let item of _data[\"tabs\"])\r\n                        this.tabs!.push(Tabs.fromJS(item));\r\n                }\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Ribbons {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Ribbons();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"requirements\"] = this.requirements ? this.requirements.toJSON() : <any>undefined;\r\n            if (Array.isArray(this.contexts)) {\r\n                data[\"contexts\"] = [];\r\n                for (let item of this.contexts)\r\n                    data[\"contexts\"].push(item);\r\n            }\r\n            if (Array.isArray(this.tabs)) {\r\n                data[\"tabs\"] = [];\r\n                for (let item of this.tabs)\r\n                    data[\"tabs\"].push(item.toJSON());\r\n            }\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IRibbons {\r\n        requirements: Requirements;\r\n        contexts: Contexts[];\r\n        tabs: Tabs[];\r\n    }\r\n\r\n    export class Shortcuts implements IShortcuts {\r\n        requirements!: Requirements;\r\n        keys!: Keys[];\r\n\r\n        constructor(data?: IShortcuts) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n            if (!data) {\r\n                this.keys = [];\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.requirements = _data[\"requirements\"] ? Requirements.fromJS(_data[\"requirements\"]) : <any>undefined;\r\n                if (Array.isArray(_data[\"keys\"])) {\r\n                    this.keys = [] as any;\r\n                    for (let item of _data[\"keys\"])\r\n                        this.keys!.push(Keys.fromJS(item));\r\n                }\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Shortcuts {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Shortcuts();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"requirements\"] = this.requirements ? this.requirements.toJSON() : <any>undefined;\r\n            if (Array.isArray(this.keys)) {\r\n                data[\"shortcuts\"] = [];\r\n                for (let item of this.keys)\r\n                    data[\"shortcuts\"].push(item.toJSON());\r\n            }\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IShortcuts {\r\n        requirements: Requirements;\r\n        keys: Keys[];\r\n    }\r\n\r\n    export class AutoRunEvents implements IAutoRunEvents {\r\n        requirements!: Requirements;\r\n        events!: Events[];\r\n\r\n        constructor(data?: IAutoRunEvents) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n            if (!data) {\r\n                this.events = [];\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.requirements = _data[\"requirements\"] ? Requirements.fromJS(_data[\"requirements\"]) : <any>undefined;\r\n                if (Array.isArray(_data[\"events\"])) {\r\n                    this.events = [] as any;\r\n                    for (let item of _data[\"events\"])\r\n                        this.events!.push(Events.fromJS(item));\r\n                }\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): AutoRunEvents {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new AutoRunEvents();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"requirements\"] = this.requirements ? this.requirements.toJSON() : <any>undefined;\r\n            if (Array.isArray(this.events)) {\r\n                data[\"events\"] = [];\r\n                for (let item of this.events)\r\n                    data[\"events\"].push(item.toJSON());\r\n            }\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IAutoRunEvents {\r\n        requirements: Requirements;\r\n        events: Events[];\r\n    }\r\n\r\n    export class ContextMenus implements IContextMenus {\r\n        requirements!: Requirements;\r\n        menus!: Menus[];\r\n\r\n        constructor(data?: IContextMenus) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n            if (!data) {\r\n                this.menus = [];\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.requirements = _data[\"requirements\"] ? Requirements.fromJS(_data[\"requirements\"]) : <any>undefined;\r\n                if (Array.isArray(_data[\"menus\"])) {\r\n                    this.menus = [] as any;\r\n                    for (let item of _data[\"menus\"])\r\n                        this.menus!.push(Menus.fromJS(item));\r\n                }\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): ContextMenus {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new ContextMenus();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"requirements\"] = this.requirements ? this.requirements.toJSON() : <any>undefined;\r\n            if (Array.isArray(this.menus)) {\r\n                data[\"menus\"] = [];\r\n                for (let item of this.menus)\r\n                    data[\"menus\"].push(item.toJSON());\r\n            }\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IContextMenus {\r\n        requirements: Requirements;\r\n        menus: Menus[];\r\n    }\r\n\r\n    export class Alternatives implements IAlternatives {\r\n        requirements!: Requirements;\r\n        prefer!: any;\r\n        hide!: any;\r\n\r\n        constructor(data?: IAlternatives) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.requirements = _data[\"requirements\"] ? Requirements.fromJS(_data[\"requirements\"]) : <any>undefined;\r\n                this.prefer = _data[\"prefer\"];\r\n                this.hide = _data[\"hide\"];\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Alternatives {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Alternatives();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"requirements\"] = this.requirements ? this.requirements.toJSON() : <any>undefined;\r\n            data[\"prefer\"] = this.prefer;\r\n            data[\"hide\"] = this.hide;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IAlternatives {\r\n        requirements: Requirements;\r\n        prefer: any;\r\n        hide: any;\r\n    }\r\n\r\n    export class Subtitle implements ISubtitle {\r\n\r\n        constructor(data?: ISubtitle) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n        }\r\n\r\n        static fromJS(data: any): Subtitle {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Subtitle();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface ISubtitle {\r\n    }\r\n    \r\n    export class AlternateNames implements IAlternateNames {\r\n\r\n        constructor(data?: IAlternateNames) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n        }\r\n\r\n        static fromJS(data: any): AlternateNames {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new AlternateNames();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IAlternateNames {\r\n    }\r\n\r\n    export class BrandBarText implements IBrandBarText {\r\n\r\n        constructor(data?: IBrandBarText) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n        }\r\n\r\n        static fromJS(data: any): BrandBarText {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new BrandBarText();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IBrandBarText {\r\n    }\r\n    \r\n    export class TargetWindow implements ITargetWindow {\r\n\r\n        constructor(data?: ITargetWindow) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n        }\r\n\r\n        static fromJS(data: any): TargetWindow {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new TargetWindow();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface ITargetWindow {\r\n    }\r\n\r\n    export class OrgWide implements IOrgWide {\r\n        /** The Permission name of app's permission node. */\r\n        name!: string;\r\n        /** The Permission type of app's permission node. */\r\n        type!: OrgWideType;\r\n\r\n        constructor(data?: IOrgWide) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.name = _data[\"name\"];\r\n                this.type = _data[\"type\"];\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): OrgWide {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new OrgWide();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"name\"] = this.name;\r\n            data[\"type\"] = this.type;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IOrgWide {\r\n        /** The Permission name of app's permission node. */\r\n        name: string;\r\n        /** The Permission type of app's permission node. */\r\n        type: OrgWideType;\r\n    }\r\n\r\n    export class ResourceSpecific implements IResourceSpecific {\r\n        /** The Permission name of app's permission node. */\r\n        name!: string;\r\n        /** The Permission type of app's permission node. */\r\n        type!: ResourceSpecificType;\r\n\r\n        constructor(data?: IResourceSpecific) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.name = _data[\"name\"];\r\n                this.type = _data[\"type\"];\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): ResourceSpecific {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new ResourceSpecific();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"name\"] = this.name;\r\n            data[\"type\"] = this.type;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IResourceSpecific {\r\n        /** The Permission name of app's permission node. */\r\n        name: string;\r\n        /** The Permission type of app's permission node. */\r\n        type: ResourceSpecificType;\r\n    }\r\n\r\n    export enum Scopes {\r\n        Mail = \"mail\",\r\n        Workbook = \"workbook\",\r\n        Document = \"document\",\r\n        Presentation = \"presentation\",\r\n    }\r\n\r\n    export class Capabilities implements ICapabilities {\r\n        name!: string;\r\n        minVersion!: string;\r\n        maxVersion!: string;\r\n\r\n        constructor(data?: ICapabilities) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.name = _data[\"name\"];\r\n                this.minVersion = _data[\"minVersion\"];\r\n                this.maxVersion = _data[\"maxVersion\"];\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Capabilities {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Capabilities();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"name\"] = this.name;\r\n            data[\"minVersion\"] = this.minVersion;\r\n            data[\"maxVersion\"] = this.maxVersion;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface ICapabilities {\r\n        name: string;\r\n        minVersion: string;\r\n        maxVersion: string;\r\n    }\r\n\r\n    export enum Platforms {\r\n        Windows = \"windows\",\r\n        Mac = \"mac\",\r\n        Web = \"web\",\r\n        Ios = \"ios\",\r\n        Android = \"android\",\r\n    }\r\n\r\n    export enum FormFactors {\r\n        Desktop = \"desktop\",\r\n        Tablet = \"tablet\",\r\n        Phone = \"phone\",\r\n    }\r\n\r\n    export class Code implements ICode {\r\n        page!: string;\r\n        script!: string;\r\n\r\n        constructor(data?: ICode) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.page = _data[\"page\"];\r\n                this.script = _data[\"script\"];\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Code {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Code();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"page\"] = this.page;\r\n            data[\"script\"] = this.script;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface ICode {\r\n        page: string;\r\n        script: string;\r\n    }\r\n\r\n    export class Actions implements IActions {\r\n        id!: string;\r\n        type!: string;\r\n        displayName!: string;\r\n        view!: string;\r\n\r\n        constructor(data?: IActions) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.id = _data[\"id\"];\r\n                this.type = _data[\"type\"];\r\n                this.displayName = _data[\"displayName\"];\r\n                this.view = _data[\"view\"];\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Actions {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Actions();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"id\"] = this.id;\r\n            data[\"type\"] = this.type;\r\n            data[\"displayName\"] = this.displayName;\r\n            data[\"view\"] = this.view;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IActions {\r\n        id: string;\r\n        type: string;\r\n        displayName: string;\r\n        view: string;\r\n    }\r\n\r\n    export class Functions implements IFunctions {\r\n        id!: string;\r\n        name!: string;\r\n        description!: string;\r\n        parameters!: Parameters[];\r\n        result!: Result;\r\n        stream!: boolean;\r\n        volatile!: boolean;\r\n        cancelable!: boolean;\r\n        requiresAddress!: boolean;\r\n        requiresParameterAddress!: boolean;\r\n\r\n        constructor(data?: IFunctions) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n            if (!data) {\r\n                this.result = new Result();\r\n                this.parameters = [];\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.id = _data[\"id\"];\r\n                this.name = _data[\"name\"];\r\n                this.description = _data[\"description\"];\r\n                if (Array.isArray(_data[\"parameters\"])) {\r\n                    this.parameters = [] as any;\r\n                    for (let item of _data[\"parameters\"])\r\n                        this.parameters!.push(Parameters.fromJS(item));\r\n                }\r\n                this.result = _data[\"result\"] ? Result.fromJS(_data[\"result\"]) : new Result();\r\n                this.stream = _data[\"stream\"];\r\n                this.volatile = _data[\"volatile\"];\r\n                this.cancelable = _data[\"cancelable\"];\r\n                this.requiresAddress = _data[\"requiresAddress\"];\r\n                this.requiresParameterAddress = _data[\"requiresParameterAddress\"];\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Functions {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Functions();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"id\"] = this.id;\r\n            data[\"name\"] = this.name;\r\n            data[\"description\"] = this.description;\r\n            if (Array.isArray(this.parameters)) {\r\n                data[\"parameters\"] = [];\r\n                for (let item of this.parameters)\r\n                    data[\"parameters\"].push(item.toJSON());\r\n            }\r\n            data[\"result\"] = this.result ? this.result.toJSON() : <any>undefined;\r\n            data[\"stream\"] = this.stream;\r\n            data[\"volatile\"] = this.volatile;\r\n            data[\"cancelable\"] = this.cancelable;\r\n            data[\"requiresAddress\"] = this.requiresAddress;\r\n            data[\"requiresParameterAddress\"] = this.requiresParameterAddress;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IFunctions {\r\n        id: string;\r\n        name: string;\r\n        description: string;\r\n        parameters: IParameters[];\r\n        result: IResult;\r\n        stream: boolean;\r\n        volatile: boolean;\r\n        cancelable: boolean;\r\n        requiresAddress: boolean;\r\n        requiresParameterAddress: boolean;\r\n    }\r\n\r\n    export class FunctionSettings implements IFunctionSettings {\r\n        namespace!: Namespace;\r\n        allowErrorForDataTypeAny!: boolean;\r\n        allowRichDataForDataTypeAny!: boolean;\r\n\r\n        constructor(data?: IFunctionSettings) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n            if (!data) {\r\n                this.namespace = new Namespace();\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.namespace = _data[\"namespace\"] ? Namespace.fromJS(_data[\"namespace\"]) : new Namespace();\r\n                this.allowErrorForDataTypeAny = _data[\"allowErrorForDataTypeAny\"];\r\n                this.allowRichDataForDataTypeAny = _data[\"allowRichDataForDataTypeAny\"];\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): FunctionSettings {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new FunctionSettings();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"namespace\"] = this.namespace ? this.namespace.toJSON() : <any>undefined;\r\n            data[\"allowErrorForDataTypeAny\"] = this.allowErrorForDataTypeAny;\r\n            data[\"allowRichDataForDataTypeAny\"] = this.allowRichDataForDataTypeAny;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IFunctionSettings {\r\n        namespace: INamespace;\r\n        allowErrorForDataTypeAny: boolean;\r\n        allowRichDataForDataTypeAny: boolean;\r\n    }\r\n\r\n    export enum Contexts {\r\n        Default = \"default\",\r\n        ReadMail = \"readMail\",\r\n        ComposeMail = \"composeMail\",\r\n        AppointmentOrganizer = \"appointmentOrganizer\",\r\n        AppointmentAttendee = \"appointmentAttendee\",\r\n    }\r\n\r\n    export class Tabs implements ITabs {\r\n        /** Built in tab id of built in tab. Maximum length is 64 characters. */\r\n        builtInTabId!: string;\r\n        /** App-wide unique ID. Maximum length is 64 characters. */\r\n        id!: string;\r\n        /** Short label of the tab. Maximum length is 64 characters. */\r\n        label!: string;\r\n        position!: Position;\r\n        groups!: Groups[];\r\n\r\n        constructor(data?: ITabs) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n            if (!data) {\r\n                this.groups = [];\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.builtInTabId = _data[\"builtInTabId\"];\r\n                this.id = _data[\"id\"];\r\n                this.label = _data[\"label\"];\r\n                this.position = _data[\"position\"] ? Position.fromJS(_data[\"position\"]) : <any>undefined;\r\n                if (Array.isArray(_data[\"groups\"])) {\r\n                    this.groups = [] as any;\r\n                    for (let item of _data[\"groups\"])\r\n                        this.groups!.push(Groups.fromJS(item));\r\n                }\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Tabs {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Tabs();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"builtInTabId\"] = this.builtInTabId;\r\n            data[\"id\"] = this.id;\r\n            data[\"label\"] = this.label;\r\n            data[\"position\"] = this.position ? this.position.toJSON() : <any>undefined;\r\n            if (Array.isArray(this.groups)) {\r\n                data[\"groups\"] = [];\r\n                for (let item of this.groups)\r\n                    data[\"groups\"].push(item.toJSON());\r\n            }\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface ITabs {\r\n        /** Built in tab id of built in tab. Maximum length is 64 characters. */\r\n        builtInTabId: string;\r\n        /** App-wide unique ID. Maximum length is 64 characters. */\r\n        id: string;\r\n        /** Short label of the tab. Maximum length is 64 characters. */\r\n        label: string;\r\n        position: Position;\r\n        groups: Groups[];\r\n    }\r\n\r\n    export class Keys implements IKeys {\r\n        requirements!: Requirements;\r\n        key!: Key;\r\n        actionId!: string;\r\n\r\n        constructor(data?: IKeys) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.requirements = _data[\"requirements\"] ? Requirements.fromJS(_data[\"requirements\"]) : <any>undefined;\r\n                this.key = _data[\"key\"] ? Key.fromJS(_data[\"key\"]) : <any>undefined;\r\n                this.actionId = _data[\"actionId\"];\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Keys {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Keys();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"requirements\"] = this.requirements ? this.requirements.toJSON() : <any>undefined;\r\n            data[\"key\"] = this.key ? this.key.toJSON() : <any>undefined;\r\n            data[\"actionId\"] = this.actionId;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IKeys {\r\n        requirements: Requirements;\r\n        key: Key;\r\n        actionId: string;\r\n    }\r\n\r\n    export class Key implements IKey {\r\n        defaultKey!: string;\r\n        windows!: string;\r\n        mac!: string;\r\n        web!: string;\r\n\r\n        constructor(data?: IKey) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.defaultKey = _data[\"default\"];\r\n                this.windows = _data[\"windows\"];\r\n                this.mac = _data[\"mac\"];\r\n                this.web = _data[\"web\"];\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Key {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Key();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"default\"] = this.defaultKey;\r\n            data[\"windows\"] = this.windows;\r\n            data[\"mac\"] = this.mac;\r\n            data[\"web\"] = this.web;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IKey {\r\n        defaultKey: string;\r\n        windows: string;\r\n        mac: string;\r\n        web: string;\r\n    }\r\n\r\n    export class Events implements IEvents {\r\n        requirements!: Requirements;\r\n        id!: string;\r\n        actionId!: string;\r\n        options!: Options;\r\n\r\n        constructor(data?: IEvents) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n            if (!data) {\r\n                this.options = new Options();\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.requirements = _data[\"requirements\"] ? Requirements.fromJS(_data[\"requirements\"]) : <any>undefined;\r\n                this.id = _data[\"id\"];\r\n                this.actionId = _data[\"actionId\"];\r\n                this.options = _data[\"options\"] ? Options.fromJS(_data[\"options\"]) : new Options();\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Events {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Events();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"requirements\"] = this.requirements ? this.requirements.toJSON() : <any>undefined;\r\n            data[\"id\"] = this.id;\r\n            data[\"actionId\"] = this.actionId;\r\n            data[\"options\"] = this.options ? this.options.toJSON() : <any>undefined;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IEvents {\r\n        requirements: Requirements;\r\n        id: string;\r\n        actionId: string;\r\n        options: Options;\r\n    }\r\n\r\n    export class Menus implements IMenus {\r\n        /** Use cell/text here for Office native context menu ContextMenuCell/ContextMenuText. */\r\n        type!: MenusType;\r\n        controls!: any[];\r\n\r\n        constructor(data?: IMenus) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n            if (!data) {\r\n                this.controls = [];\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.type = _data[\"type\"];\r\n                if (Array.isArray(_data[\"controls\"])) {\r\n                    this.controls = [] as any;\r\n                    for (let item of _data[\"controls\"])\r\n                        this.controls!.push(item);\r\n                }\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Menus {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Menus();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"type\"] = this.type;\r\n            if (Array.isArray(this.controls)) {\r\n                data[\"controls\"] = [];\r\n                for (let item of this.controls)\r\n                    data[\"controls\"].push(item);\r\n            }\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IMenus {\r\n        /** Use cell/text here for Office native context menu ContextMenuCell/ContextMenuText. */\r\n        type: MenusType;\r\n        controls: any[];\r\n    }\r\n\r\n    export enum OrgWideType {\r\n        Application = \"Application\",\r\n        Delegated = \"Delegated\",\r\n    }\r\n\r\n    export enum ResourceSpecificType {\r\n        Application = \"Application\",\r\n        Delegated = \"Delegated\",\r\n    }\r\n\r\n    export class Namespace implements INamespace {\r\n        id!: string;\r\n        name!: string;\r\n\r\n        constructor(data?: INamespace) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.id = _data[\"id\"];\r\n                this.name = _data[\"name\"];\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Namespace {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Namespace();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"id\"] = this.id;\r\n            data[\"name\"] = this.name;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface INamespace {\r\n        id: string;\r\n        name: string;\r\n    }\r\n\r\n    export class Position implements IPosition {\r\n        /** Built in tab id of built in tab. Maximum length is 64 characters. */\r\n        builtInTabId!: string;\r\n        /** Define alignment of this custom tab with reference to the BuiltIn tab. */\r\n        align!: PositionAlign;\r\n\r\n        constructor(data?: IPosition) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.builtInTabId = _data[\"builtInTabId\"];\r\n                this.align = _data[\"align\"];\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Position {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Position();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"builtInTabId\"] = this.builtInTabId;\r\n            data[\"align\"] = this.align;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IPosition {\r\n        /** Built in tab id of built in tab. Maximum length is 64 characters. */\r\n        builtInTabId: string;\r\n        /** Define alignment of this custom tab with reference to the BuiltIn tab. */\r\n        align: PositionAlign;\r\n    }\r\n\r\n    export class Groups implements IGroups {\r\n        overriddenByRibbonApi!: boolean;\r\n        /** Built in group id of built in group. Maximum length is 64 characters. */\r\n        builtInGroupId!: string;\r\n        /** App-wide unique ID. Maximum length is 64 characters. */\r\n        id!: string;\r\n        /** Short label of the group. Maximum length is 64 characters. */\r\n        label!: string;\r\n        icons!: Icons[];\r\n        controls!: Controls[];\r\n\r\n        constructor(data?: IGroups) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n            if (!data) {\r\n                this.overriddenByRibbonApi = false;\r\n                this.controls = [];\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.overriddenByRibbonApi = _data[\"overriddenByRibbonApi\"] !== undefined ? _data[\"overriddenByRibbonApi\"] : false;\r\n                this.builtInGroupId = _data[\"builtInGroupId\"];\r\n                this.id = _data[\"id\"];\r\n                this.label = _data[\"label\"];\r\n                if (Array.isArray(_data[\"icons\"])) {\r\n                    this.icons = [] as any;\r\n                    for (let item of _data[\"icons\"])\r\n                        this.icons!.push(Icons.fromJS(item));\r\n                }\r\n                if (Array.isArray(_data[\"controls\"])) {\r\n                    this.controls = [] as any;\r\n                    for (let item of _data[\"controls\"])\r\n                        this.controls!.push(Controls.fromJS(item));\r\n                }\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Groups {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Groups();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"overriddenByRibbonApi\"] = this.overriddenByRibbonApi;\r\n            data[\"builtInGroupId\"] = this.builtInGroupId;\r\n            data[\"id\"] = this.id;\r\n            data[\"label\"] = this.label;\r\n            if (Array.isArray(this.icons)) {\r\n                data[\"icons\"] = [];\r\n                for (let item of this.icons)\r\n                    data[\"icons\"].push(item.toJSON());\r\n            }\r\n            if (Array.isArray(this.controls)) {\r\n                data[\"controls\"] = [];\r\n                for (let item of this.controls)\r\n                    data[\"controls\"].push(item.toJSON());\r\n            }\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IGroups {\r\n        overriddenByRibbonApi: boolean;\r\n        /** Built in group id of built in group. Maximum length is 64 characters. */\r\n        builtInGroupId: string;\r\n        /** App-wide unique ID. Maximum length is 64 characters. */\r\n        id: string;\r\n        /** Short label of the group. Maximum length is 64 characters. */\r\n        label: string;\r\n        icons: Icons[];\r\n        controls: Controls[];\r\n    }\r\n\r\n    export class Options implements IOptions {\r\n        sendMode!: string;\r\n\r\n        constructor(data?: IOptions) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.sendMode = _data[\"sendMode\"];\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Options {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Options();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"sendMode\"] = this.sendMode;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IOptions {\r\n        sendMode: string;\r\n    }\r\n\r\n    export enum MenusType {\r\n        Cell = \"cell\",\r\n        Text = \"text\",\r\n    }\r\n\r\n    export class Parameters implements IParameters {\r\n        name!: string;\r\n        description!: string;\r\n        type!: string;\r\n        dimensionality!: string;\r\n\r\n        constructor(data?: IParameters) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.name = _data[\"name\"];\r\n                this.description = _data[\"description\"];\r\n                this.type = _data[\"type\"];\r\n                this.dimensionality = _data[\"dimensionality\"];\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Parameters {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Parameters();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"name\"] = this.name;\r\n            data[\"description\"] = this.description;\r\n            data[\"type\"] = this.type;\r\n            data[\"dimensionality\"] = this.dimensionality;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IParameters {\r\n        name: string;\r\n        description: string;\r\n        type: string;\r\n        dimensionality: string;\r\n    }\r\n\r\n    export class Result implements IResult {\r\n        dimensionality!: string;\r\n\r\n        constructor(data?: IResult) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.dimensionality = _data[\"dimensionality\"];\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Result {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Result();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"dimensionality\"] = this.dimensionality;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IResult {\r\n        dimensionality: string;\r\n    }\r\n\r\n    export enum PositionAlign {\r\n        After = \"after\",\r\n        Before = \"before\",\r\n    }\r\n\r\n    export class Icons implements IIcons {\r\n        /** Size in pixels of the side of the icon, e.g. 32, 64, 128. */\r\n        size!: number;\r\n        /** Relative path to the file that contains the icon. */\r\n        file!: string;\r\n\r\n        constructor(data?: IIcons) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.size = _data[\"size\"];\r\n                this.file = _data[\"file\"];\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Icons {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Icons();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"size\"] = this.size;\r\n            data[\"file\"] = this.file;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IIcons {\r\n        /** Size in pixels of the side of the icon, e.g. 32, 64, 128. */\r\n        size: number;\r\n        /** Relative path to the file that contains the icon. */\r\n        file: string;\r\n    }\r\n\r\n    export class Controls implements IControls {\r\n        overriddenByRibbonApi!: boolean;\r\n        /** Built in control id of built in control. Maximum length is 64 characters. */\r\n        builtInControlId!: string;\r\n        /** App-wide unique ID. Maximum length is 64 characters. */\r\n        id!: string;\r\n        type!: ControlsType;\r\n        /** Short label of the control. Maximum length is 64 characters. */\r\n        label!: string;\r\n        /** Whether the control is initially enabled. */\r\n        enabled!: boolean;\r\n        icons!: Icons[];\r\n        supertip!: Supertip;\r\n        /** The ID of an execution-type action that handles this key combination. Maximum length is 64 characters. */\r\n        actionId!: string;\r\n        items!: Controls[];\r\n\r\n        constructor(data?: IControls) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n            if (!data) {\r\n                this.overriddenByRibbonApi = false;\r\n                this.enabled = true;\r\n                this.icons = [];\r\n                this.supertip = new Supertip();\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.overriddenByRibbonApi = _data[\"overriddenByRibbonApi\"] !== undefined ? _data[\"overriddenByRibbonApi\"] : false;\r\n                this.builtInControlId = _data[\"builtInControlId\"];\r\n                this.id = _data[\"id\"];\r\n                this.type = _data[\"type\"];\r\n                this.label = _data[\"label\"];\r\n                this.enabled = _data[\"enabled\"] !== undefined ? _data[\"enabled\"] : true;\r\n                if (Array.isArray(_data[\"icons\"])) {\r\n                    this.icons = [] as any;\r\n                    for (let item of _data[\"icons\"])\r\n                        this.icons!.push(Icons.fromJS(item));\r\n                }\r\n                this.supertip = _data[\"supertip\"] ? Supertip.fromJS(_data[\"supertip\"]) : new Supertip();\r\n                this.actionId = _data[\"actionId\"];\r\n                if (Array.isArray(_data[\"items\"])) {\r\n                    this.items = [] as any;\r\n                    for (let item of _data[\"items\"])\r\n                        this.items!.push(Controls.fromJS((item)));\r\n                }\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Controls {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Controls();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"overriddenByRibbonApi\"] = this.overriddenByRibbonApi;\r\n            data[\"builtInControlId\"] = this.builtInControlId;\r\n            data[\"id\"] = this.id;\r\n            data[\"type\"] = this.type;\r\n            data[\"label\"] = this.label;\r\n            data[\"enabled\"] = this.enabled;\r\n            if (Array.isArray(this.icons)) {\r\n                data[\"icons\"] = [];\r\n                for (let item of this.icons)\r\n                    data[\"icons\"].push(item.toJSON());\r\n            }\r\n            data[\"supertip\"] = this.supertip ? this.supertip.toJSON() : <any>undefined;\r\n            data[\"actionId\"] = this.actionId;\r\n            if (Array.isArray(this.items)) {\r\n                data[\"items\"] = [];\r\n                for (let item of this.items)\r\n                    data[\"items\"].push(item.toJSON());\r\n            }\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface IControls {\r\n        overriddenByRibbonApi: boolean;\r\n        /** Built in control id of built in control. Maximum length is 64 characters. */\r\n        builtInControlId: string;\r\n        /** App-wide unique ID. Maximum length is 64 characters. */\r\n        id: string;\r\n        type: ControlsType;\r\n        /** Short label of the control. Maximum length is 64 characters. */\r\n        label: string;\r\n        /** Whether the control is initially enabled. */\r\n        enabled: boolean;\r\n        icons: Icons[];\r\n        supertip: Supertip;\r\n        /** The ID of an execution-type action that handles this key combination. Maximum length is 64 characters. */\r\n        actionId: string;\r\n        items: Controls[];\r\n    }\r\n\r\n    export enum ControlsType {\r\n        Button = \"button\",\r\n        Menu = \"menu\"\r\n    }\r\n\r\n    export class Supertip implements ISupertip {\r\n        /** Title of the super tip. Maximum length is 64 characters. */\r\n        title!: string;\r\n        /** Description of the super tip. Maximum length is 128 characters. */\r\n        description!: string;\r\n\r\n        constructor(data?: ISupertip) {\r\n            if (data) {\r\n                for (var property in data) {\r\n                    if (data.hasOwnProperty(property))\r\n                        (<any>this)[property] = (<any>data)[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        init(_data?: any) {\r\n            if (_data) {\r\n                this.title = _data[\"title\"];\r\n                this.description = _data[\"description\"];\r\n            }\r\n        }\r\n\r\n        static fromJS(data: any): Supertip {\r\n            data = typeof data === 'object' ? data : {};\r\n            let result = new Supertip();\r\n            result.init(data);\r\n            return result;\r\n        }\r\n\r\n        toJSON(data?: any) {\r\n            data = typeof data === 'object' ? data : {};\r\n            data[\"title\"] = this.title;\r\n            data[\"description\"] = this.description;\r\n            return data;\r\n        }\r\n    }\r\n\r\n    export interface ISupertip {\r\n        /** Title of the super tip. Maximum length is 64 characters. */\r\n        title: string;\r\n        /** Description of the super tip. Maximum length is 128 characters. */\r\n        description: string;\r\n    } \r\n    } //Mos ","namespace OSF {\r\n    export enum ExtendedManifestSupportTokens {\r\n        Requirements = \"RequirementsToken\",\r\n        Locale = \"LocaleToken\",\r\n        TokenReplaceRegex = '\\\\$\\\\{token\\\\.(\\\\w+)\\\\}',\r\n        ResourceTokenRegEx = \"^\\\\$\\\\{resource\\\\.([A-Za-z0-9_-]+)\\\\}$\",\r\n        ExtendedManifestLoggingPrefix = \"Extended Manifest\",\r\n        ExtendedManifestResourcesLoggingPrefix = \"Extended Manifest Resources\",\r\n        ActionIdMaxLength = 32,\r\n        ActionNameMaxLength = 125\r\n    }\r\n    export enum SdxAssetIds {\r\n        Ideas = \"fa000000029\",\r\n        ExperimentationSdx = \"fa000000059\",\r\n        CopilotChatExcel = \"fa000000124\",\r\n        CopilotChatWord = \"fa000000125\",\r\n        CopilotChatOneNote = \"fa000000128\",\r\n        CopilotChatPpt = \"fa000000129\",\r\n    }\r\n    export const DefaultAllowDisplayCaptureSdxIds = [\r\n        SdxAssetIds.CopilotChatExcel,\r\n        SdxAssetIds.CopilotChatWord,\r\n        SdxAssetIds.CopilotChatOneNote,\r\n        SdxAssetIds.CopilotChatPpt,\r\n    ].join(';');\r\n    export enum HostFeatureGateFlags {\r\n        None = 0,\r\n        Enable3rdPartySetAppContextInIFrameName = 0x02\r\n    }\r\n    export let MaxAppContextLength = 10240;\r\n    export enum HostInfoFlags {\r\n        None = 0,\r\n        SharedApp = 1,\r\n        CustomFunction = 2,\r\n        ProtectedDocDisable = 4,\r\n        ExperimentJsEnabled = 8,\r\n        PublicAddin = 0x10,\r\n        // BundleJsEnabled = 0x20\r\n        IsMos = 0x40,\r\n        IsMonarch = 0x80\r\n    }\r\n\r\n    // only for OMEX\r\n    export enum ManifestRequestTypes {\r\n        Manifest = 1,\r\n        Etoken = 2,\r\n        Both = 3\r\n    }\r\n    export enum ActivationTypes {\r\n        V1Enabled = 0,\r\n        V1S2SEnabled = 1,\r\n        V2Enabled = 2,\r\n        V2S2SEnabled = 3 // only for OMEX\r\n    }\r\n    export enum InvokeResultCode {\r\n        \"S_OK\" = 0,\r\n        \"E_REQUEST_TIME_OUT\" = -2147471590,\r\n        \"E_USER_NOT_SIGNED_IN\" = -2147208619,\r\n        \"E_CATALOG_ACCESS_DENIED\" = -2147471591,\r\n        \"E_CATALOG_REQUEST_FAILED\" = -2147471589,\r\n        \"E_OEM_NO_NETWORK_CONNECTION\" = -2147208640,\r\n        \"E_PROVIDER_NOT_REGISTERED\" = -2147208617,\r\n        \"E_OEM_CACHE_SHUTDOWN\" = -2147208637,\r\n        \"E_OEM_REMOVED_FAILED\" = -2147209421,\r\n        \"E_CATALOG_NO_APPS\" = -1,\r\n        \"E_USER_NO_MAILBOX\" = -2,\r\n        \"E_GENERIC_ERROR\" = -1000,\r\n        \"S_HIDE_PROVIDER\" = 10\r\n    }\r\n\r\n    // These codes are for different notification scenarios. And most of them are shared with rich client.\r\n    export enum ErrorStatusCodes {\r\n        E_OEM_EXTENSION_NOT_ENTITLED = 2147758662,\r\n        E_MANIFEST_SERVER_UNAVAILABLE = 2147758672,\r\n        E_USER_NOT_SIGNED_IN = 2147758677,\r\n        E_MANIFEST_DOES_NOT_EXIST = 2147758673,\r\n        E_OEM_EXTENSION_KILLED = 2147758660,\r\n        E_OEM_OMEX_EXTENSION_KILLED = 2147758686,\r\n        E_MANIFEST_UPDATE_AVAILABLE = 2147758681,\r\n        S_OEM_EXTENSION_TRIAL_MODE = 275013,\r\n        E_OEM_EXTENSION_WITHDRAWN_FROM_SALE = 2147758690,\r\n        E_TOKEN_EXPIRED = 2147758675,\r\n        E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED = 2147757992,\r\n        E_MANIFEST_REFERENCE_INVALID = 2147758678,\r\n        S_USER_CLICKED_BUY = 274205,\r\n        E_MANIFEST_INVALID_VALUE_FORMAT = 2147758654,\r\n        E_TRUSTCENTER_MOE_UNACTIVATED = 2147757996,\r\n        S_OEM_EXTENSION_FLAGGED = 275040,\r\n        S_OEM_EXTENSION_DEVELOPER_WITHDRAWN_FROM_SALE = 275041,\r\n        E_BROWSER_VERSION = 2147758194,\r\n        E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR = -2147209295,\r\n        E_PRIVACY_SERVICE_DISABLED_ADMIN = 2147758792,\r\n        WAC_AgaveUnsupportedStoreType = 1041,\r\n        WAC_AgaveActivationError = 1042,\r\n        WAC_ActivateAttempLoading = 1043,\r\n        WAC_HTML5IframeSandboxNotSupport = 1044,\r\n        WAC_AgaveRequirementsErrorOmex = 1045,\r\n        WAC_AgaveRequirementsError = 1046,\r\n        WAC_AgaveOriginCheckError = 1047,\r\n        WAC_AgavePermissionCheckError = 1048,\r\n        WAC_AgaveHostHandleRequestError = 1049,\r\n        WAC_AgaveUnknownClientAppStatus = 1050,\r\n        WAC_AgaveAnonymousProxyCreationError = 1051,\r\n        WAC_AgaveOsfControlActivationError = 1052,\r\n        WAC_AgaveEntitlementRequestFailure = 1053,\r\n        WAC_AgaveManifestRequestFailure = 1054,\r\n        WAC_AgaveManifestAndEtokenRequestFailure = 1055,\r\n        WAC_FirstPartyAddInListRequestFailure = 1056,\r\n        //WAC_SSOAddinRequireConsent: 1057, // OMEX Consent flow removed\r\n        WAC_SDX_DMSRequestFailed = 1058,\r\n        WAC_SDX_AssetIdNotInDMSResponse = 1059,\r\n        WAC_CustomFunctionsRegistrationError = 1060,\r\n        WAC_WopiHostCheckStatusNotTrusted = 1061,\r\n        WAC_WopiHostCheckStatusNotReady = 1062,\r\n        WAC_AgaveIRMBlockError = 1063 // IRM encryption setting blocking non-1st party agave activation\r\n    }\r\n\r\n    // Parameter value for createStream method\r\n    export enum BWsaConfig {\r\n        defaultMaxStreamRows = 1000\r\n    }\r\n\r\n    // Parameter value for createStream method\r\n    export enum BWsaStreamTypes {\r\n        Static = 1\r\n    }\r\n\r\n    // The definition of these values are also inside \\\\offsos1\\dev15\\otools\\inc\\sqm\\sqmdata.cs\r\n    export enum SQMDataPoints {\r\n        DATAID_APPSFOROFFICEUSAGE = 10595,\r\n        DATAID_APPSFOROFFICENOTIFICATIONS = 10942\r\n    }\r\n    export enum ClientAppInfoReturnType {\r\n        urlOnly = 0,\r\n        etokenOnly = 1,\r\n        both = 2\r\n    }\r\n\r\n    // The following values of object below have to match those of enum HostFrameTrustState\r\n// in % SRCROOT %\\msoserviceplatform\\src\\Browser\\App\\Scripts\\AFrameworkApplication.cs\r\n/// <summary>\r\n/// Different possible values for IsHostFrameTrusted\r\n/// </summary>\r\n    export enum HostFrameTrustState {\r\n        /// <summary>\r\n        /// Default, we haven't checked WOPI UI capablity yet, we are waiting to activate Add-Ins\r\n        /// </summary>\r\n        NotInitialized = 0,\r\n        /// <summary>\r\n        /// we are not activating Add-Ins\r\n        /// </summary>\r\n        NotImplemented = 1,\r\n        /// <summary>\r\n        /// Host indicated via WOPI UI capability it can handle the message, but no response yet. We are waiting to activate Add-ins.\r\n        /// </summary>\r\n        NotReady = 2,\r\n        /// <summary>\r\n        /// Temporary list of hosts that are exempted from sending Host_IsFrameTrusted, set if HostExemptedFromFrameTrustCheck is true\r\n        /// </summary>\r\n        Exempted = 3,\r\n        /// <summary>\r\n        /// Host has failed the trust check as it has been embedded without its consent\r\n        /// </summary>\r\n        NotTrusted = 4,\r\n        /// <summary>\r\n        /// Host confirmed via Host_IsFrameTursted post message that its embedded in its own domain\r\n        /// </summary>\r\n        Trusted = 5\r\n    }\r\n    export enum UpnCheckCode {\r\n        NotSet = 0,\r\n        Match = 1,\r\n        NotMatch = 2\r\n    }\r\n    export enum ProxyCallStatusCode {\r\n        Succeeded = 1,\r\n        Failed = 0,\r\n        ProxyNotReady = -1\r\n    }\r\n    export enum NotificationUxPerfMarker {\r\n        RenderLoadingAnimationStart = \"Agave.NotificationUx.RenderLoadingAnimationStart\",\r\n        RenderLoadingAnimationEnd = \"Agave.NotificationUx.RenderLoadingAnimationEnd\",\r\n        RemoveLoadingAnimationStart = \"Agave.NotificationUx.RemoveLoadingAnimationStart\",\r\n        RemoveLoadingAnimationEnd = \"Agave.NotificationUx.RemoveLoadingAnimationEnd\",\r\n        RenderStage1Start = \"Agave.NotificationUx.RenderStage1Start\",\r\n        RenderStage1End = \"Agave.NotificationUx.RenderStage1End\",\r\n        RemoveStage1Start = \"Agave.NotificationUx.RemoveStage1Start\",\r\n        RemoveStage1End = \"Agave.NotificationUx.RemoveStage1End\",\r\n        RenderStage2Start = \"Agave.NotificationUx.RenderStage2Start\",\r\n        RenderStage2End = \"Agave.NotificationUx.RenderStage2End\",\r\n        RemoveStage2Start = \"Agave.NotificationUx.RemoveStage2Start\",\r\n        RemoveStage2End = \"Agave.NotificationUx.RemoveStage2End\"\r\n    }\r\n    export enum OsfControlActivationPerfMarker {\r\n        ActivationStart = \"Agave.AgaveActivationStart\",\r\n        ActivationEnd = \"Agave.AgaveActivationEnd\",\r\n        DeactivationStart = \"Agave.AgaveDeactivationStart\",\r\n        DeactivationEnd = \"Agave.AgaveDeactivationEnd\",\r\n        SelectionTimeout = \"Agave.AgaveSelectionTimeout\"\r\n    }\r\n    export enum OsfOfficeExtensionManagerPerfMarker {\r\n        GetEntitlementStart = \"Agave.OfficeExtensionManager.GetEntitlementStart\",\r\n        GetEntitlementEnd = \"Agave.OfficeExtensionManager.GetEntitlementEnd\"\r\n    }\r\n    export enum FormFactor {\r\n        Default = \"DefaultSettings\",\r\n        Desktop = \"DesktopSettings\",\r\n        Tablet = \"TabletSettings\",\r\n        Phone = \"PhoneSettings\"\r\n    }\r\n\r\n    // Enum for OsfControl type\r\n    export enum OsfControlTarget {\r\n        Undefined = -1,\r\n        InContent = 0,\r\n        TaskPane = 1,\r\n        Contextual = 2,\r\n        SDXDialog = 3\r\n    }\r\n    export enum OfficeAppType {\r\n        ContentApp = OSF.OsfControlTarget.InContent,\r\n        TaskPaneApp = OSF.OsfControlTarget.TaskPane,\r\n        MailApp = OSF.OsfControlTarget.Contextual,\r\n        SDXDialogApp = OSF.OsfControlTarget.SDXDialog\r\n    }\r\n    export enum OmexRemoveAppStatus {\r\n        Failed = 0,\r\n        Success = 1\r\n    }\r\n    export enum OmexAuthNStatus {\r\n        NotAttempted = -1,\r\n        CheckFailed = 0,\r\n        Authenticated = 1,\r\n        Anonymous = 2,\r\n        Unknown = 3\r\n    }\r\n    export enum OmexEntitlementType {\r\n        Free = \"free\",\r\n        Trial = \"trial\",\r\n        Paid = \"paid\"\r\n    }\r\n    export enum OmexTrialType {\r\n        None = 0,\r\n        Office = 1,\r\n        External = 2\r\n    }\r\n    export enum OmexState {\r\n        Killed = 0,\r\n        OK = 1,\r\n        Withdrawn = 2,\r\n        Flagged = 3,\r\n        DeveloperWithdrawn = 4\r\n    }\r\n    export enum OmexClientAppStatus {\r\n        OK = 1,\r\n        UnknownAssetId = 2,\r\n        KilledAsset = 3,\r\n        NoEntitlement = 4,\r\n        DownloadsExceeded = 5,\r\n        Expired = 6,\r\n        Invalid = 7,\r\n        Revoked = 8,\r\n        ServerError = 9,\r\n        BadRequest = 10,\r\n        LimitedTrial = 11,\r\n        TrialNotSupported = 12,\r\n        EntitlementDeactivated = 13,\r\n        VersionMismatch = 14,\r\n        VersionNotSupported = 15,\r\n        UserIsMinor = 16\r\n    }\r\n    export enum ManifestIdIssuer {\r\n        Microsoft = \"Microsoft\",\r\n        Custom = \"Custom\"\r\n    }\r\n\r\n    // Please keep this mapping in sync with the server-side enum OsfStoreType\r\n    // defined in OemExternalTypes.h and the StoreType above.\r\n    export enum StoreTypeEnum {\r\n        MarketPlace = 0,\r\n        Catalog = 1,\r\n        SPApp = 2,\r\n        Exchange = 3,\r\n        FileSystem = 4,\r\n        Registry = 5,\r\n     //   OneDrive = 9, // OneDrive Catalog was an experiment and is no longer supported.\r\n        PrivateCatalog = 10,\r\n        HardCodedPreinstall = 11,\r\n        FirstParty = 12,\r\n        Sdx = 14,\r\n        UploadFileDevCatalog = 15,\r\n        WopiCatalog = 16\r\n    }\r\n\r\n    // Please keep this mapping in sync with the server-side enum OsfStoreType\r\n    // defined in OemExternalTypes.h and the StoreTypeEnum below.\r\n    export enum StoreType {\r\n        OMEX = \"omex\",\r\n        SPCatalog = \"spcatalog\",\r\n        SPApp = \"spapp\",\r\n        Exchange = \"exchange\",\r\n        FileSystem = \"filesystem\",\r\n        Registry = \"registry\",\r\n        InMemory = \"inmemory\",\r\n    //    OneDrive = \"onedrive\", // OneDrive Catalog was an experiment and is no longer supported.\r\n        PrivateCatalog = \"excatalog\",\r\n        HardCodedPreinstall = \"hardcodedpreinstall\",\r\n        FirstParty = \"firstparty\",\r\n        UploadFileDevCatalog = \"uploadfiledevcatalog\",\r\n        Sdx = \"sdxcatalog\",\r\n        WopiCatalog = \"wopicatalog\"\r\n    }\r\n\r\n    // Enum for OsfControl add-in page status\r\n    export enum OsfControlPageStatus {\r\n        NotStarted = 1,\r\n        Loading = 2,\r\n        Ready = 3,\r\n        FailedHandleRequest = 4,\r\n        FailedOriginCheck = 5,\r\n        FailedPermissionCheck = 6 // Activation failed at permission check\r\n    }\r\n\r\n    // Enum for OsfControl status\r\n    export enum OsfControlStatus {\r\n        NotActivated = 1,\r\n        Activated = 2,\r\n        AppStoreNotReachable = 3,\r\n        InvalidOsfControl = 4,\r\n        UnsupportedStore = 5,\r\n        UnknownStore = 6,\r\n        ActivationFailed = 7,\r\n        NotSandBoxSupported = 8\r\n    }\r\n\r\n    // Enum for OsfControl permission\r\n    export enum OsfControlPermission {\r\n        Restricted = 1,\r\n        ReadDocument = 2,\r\n        WriteDocument = 4,\r\n        ReadItem = 32,\r\n        ReadWriteMailbox = 64,\r\n        ReadAllDocument = 131,\r\n        ReadWriteDocument = 135, // ReadDocument | WriteDocument | ReadAllDocument\r\n        ReadWriteItem = 256\r\n    }\r\n\r\n    //Capability in manifest\r\n    export enum Capability {\r\n        Mailbox = \"Mailbox\",\r\n        Document = \"Document\",\r\n        Workbook = \"Workbook\",\r\n        Project = \"Project\",\r\n        Presentation = \"Presentation\",\r\n        Database = \"Database\",\r\n        Sway = \"Sway\",\r\n        Notebook = \"Notebook\",\r\n        Drawing = \"Drawing\"\r\n    }\r\n    export enum HostCapability {\r\n        Excel = OSF.Capability.Workbook,\r\n        Outlook = OSF.Capability.Mailbox,\r\n        Access = OSF.Capability.Database,\r\n        PowerPoint = OSF.Capability.Presentation,\r\n        Word = OSF.Capability.Document,\r\n        Sway = OSF.Capability.Sway,\r\n        OneNote = OSF.Capability.Notebook,\r\n        Visio = OSF.Capability.Drawing\r\n    }\r\n\r\n    // Maps app host type to manifest host type.\r\n    export let getManifestHostType = function OSF$getManifestHostType(hostType) {\r\n        var manifestHostType;\r\n        switch (hostType) {\r\n            case OSF.HostType.Excel:\r\n                manifestHostType = OSF.ManifestHostType.Workbook;\r\n                break;\r\n            case OSF.HostType.Word:\r\n                manifestHostType = OSF.ManifestHostType.Document;\r\n                break;\r\n            case OSF.HostType.PowerPoint:\r\n                manifestHostType = OSF.ManifestHostType.Presentation;\r\n                break;\r\n            case OSF.HostType.OneNote:\r\n                manifestHostType = OSF.ManifestHostType.Notebook;\r\n                break;\r\n            case OSF.HostType.Outlook:\r\n                manifestHostType = OSF.ManifestHostType.Mailbox;\r\n                break;\r\n            case OSF.HostType.Visio:\r\n                manifestHostType = OSF.ManifestHostType.Drawing;\r\n                break;\r\n            default:\r\n                OsfMsAjaxFactory.msAjaxDebug.trace(\"Invalid host type.\");\r\n                throw \"Invalid hostType.\";\r\n        }\r\n        return manifestHostType;\r\n    };\r\n\r\n    // Maps appName to manifest host type.\r\n    export let getManifestHostTypeFromAppName = function OSF$getModernAppVerCode(appName) {\r\n        var manifestHostType;\r\n        switch (appName) {\r\n            case OSF.AppName.ExcelWebApp:\r\n                manifestHostType = OSF.ManifestHostType.Workbook;\r\n                break;\r\n            case OSF.AppName.PowerpointWebApp:\r\n                manifestHostType = OSF.ManifestHostType.Presentation;\r\n                break;\r\n            case OSF.AppName.WordWebApp:\r\n                manifestHostType = OSF.ManifestHostType.Document;\r\n                break;\r\n            case OSF.AppName.OneNoteWebApp:\r\n                manifestHostType = OSF.ManifestHostType.Notebook;\r\n                break;\r\n            case OSF.AppName.OutlookWebApp:\r\n                manifestHostType = OSF.ManifestHostType.Mailbox;\r\n                break;\r\n            case OSF.AppName.VisioWebApp:\r\n                manifestHostType = OSF.ManifestHostType.Drawing;\r\n                break;\r\n            default:\r\n                OsfMsAjaxFactory.msAjaxDebug.trace(\"Invalid appName.\");\r\n                throw \"Invalid appName.\";\r\n        }\r\n        return manifestHostType;\r\n    };\r\n\r\n    // Maps appName to Omex recognized modern appVercode.\r\n    export let getModernAppVerCode = function OSF$getModernAppVerCode(appName) {\r\n        var appModernVerCode;\r\n        switch (appName) {\r\n            case OSF.AppName.ExcelWebApp:\r\n                appModernVerCode = \"WAC_Excel\";\r\n                break;\r\n            case OSF.AppName.PowerpointWebApp:\r\n                appModernVerCode = \"WAC_PowerPoint\";\r\n                break;\r\n            case OSF.AppName.WordWebApp:\r\n                appModernVerCode = \"WAC_Word\";\r\n                break;\r\n            case OSF.AppName.OneNoteWebApp:\r\n                appModernVerCode = \"WAC_OneNote\";\r\n                break;\r\n            case OSF.AppName.OutlookWebApp:\r\n                appModernVerCode = \"WAC_Outlook\";\r\n                break;\r\n            case OSF.AppName.VisioWebApp:\r\n                appModernVerCode = \"WAC_Visio\";\r\n                break;\r\n            default:\r\n                OsfMsAjaxFactory.msAjaxDebug.trace(\"Invalid appName.\");\r\n                throw \"Invalid appName.\";\r\n        }\r\n        return appModernVerCode;\r\n    };\r\n\r\n    // Maps appName to Omex recognized appVercode.\r\n    export let getAppVerCode = function OSF$getAppVerCode(appName) {\r\n        var appVerCode;\r\n        switch (appName) {\r\n            case OSF.AppName.ExcelWebApp:\r\n                appVerCode = \"excel.exe\"; // TODO: use what client uses and replace it after figuring out what Xl WAC should use.\r\n                break;\r\n            case OSF.AppName.AccessWebApp:\r\n                appVerCode = \"ZAC\"; //TODO: ZAC is for Access. Need to make sure if this is right for AccessWebApp since there is no appVerCode for AccessWebApp defined yet.\r\n                break;\r\n            case OSF.AppName.PowerpointWebApp:\r\n                appVerCode = \"WAP\";\r\n                break;\r\n            case OSF.AppName.WordWebApp:\r\n                appVerCode = \"WAW\";\r\n                break;\r\n            case OSF.AppName.OneNoteWebApp:\r\n                appVerCode = \"WAO\";\r\n                break;\r\n            case OSF.AppName.VisioWebApp:\r\n                appVerCode = \"WAV\";\r\n                break;\r\n            default:\r\n                OsfMsAjaxFactory.msAjaxDebug.trace(\"Invalid appName.\");\r\n                throw \"Invalid appName.\";\r\n        }\r\n        return appVerCode;\r\n    };\r\n\r\n    // Host platform strings for forming host specific filenames\r\n    export enum HostPlatform {\r\n        Web = \"Web\"\r\n    }\r\n\r\n    // Manifest Host type strings\r\n    export enum ManifestHostType {\r\n        Workbook = \"Workbook\",\r\n        Document = \"Document\",\r\n        Presentation = \"Presentation\",\r\n        Notebook = \"Notebook\",\r\n        Mailbox = \"Mailbox\",\r\n        Drawing = \"Drawing\"\r\n    }\r\n\r\n    // Host type strings for forming host specific filenames\r\n    export enum HostType {\r\n        Excel = \"Excel\",\r\n        Outlook = \"Outlook\",\r\n        Access = \"Access\",\r\n        PowerPoint = \"PowerPoint\",\r\n        Word = \"Word\",\r\n        Sway = \"Sway\",\r\n        OneNote = \"OneNote\",\r\n        Visio = \"Visio\"\r\n    }\r\n    export let OmexAppVersions = (function OSF_OmexAppVersions() {\r\n        var nameMap = {}, appNameList = OSF.AppName;\r\n        nameMap[appNameList.ExcelWebApp] = OSF.AppVersion.excelwebapp;\r\n        nameMap[appNameList.WordWebApp] = OSF.AppVersion.wordwebapp;\r\n        nameMap[appNameList.OutlookWebApp] = OSF.AppVersion.outlookwebapp;\r\n        nameMap[appNameList.AccessWebApp] = OSF.AppVersion.access;\r\n        nameMap[appNameList.PowerpointWebApp] = OSF.AppVersion.powerpointwebapp;\r\n        nameMap[appNameList.OneNoteWebApp] = OSF.AppVersion.onenotewebapp;\r\n        nameMap[appNameList.VisioWebApp] = OSF.AppVersion.visiowebapp;\r\n        return nameMap;\r\n    })();\r\n    export let OmexClientNames = (function OSF_OmexClientNames() {\r\n        var nameMap = {}, appNameList = OSF.AppName;\r\n        nameMap[appNameList.ExcelWebApp] = \"WAC_Excel\";\r\n        nameMap[appNameList.WordWebApp] = \"WAC_Word\";\r\n        nameMap[appNameList.OutlookWebApp] = \"WAC_Outlook\";\r\n        nameMap[appNameList.AccessWebApp] = \"WAC_Access\";\r\n        nameMap[appNameList.PowerpointWebApp] = \"WAC_Powerpoint\";\r\n        nameMap[appNameList.OneNoteWebApp] = \"WAC_OneNote\";\r\n        nameMap[appNameList.VisioWebApp] = \"WAC_Visio\";\r\n        return nameMap;\r\n    })();\r\n\r\n    // Http Verbs\r\n    export enum HttpVerb {\r\n        GET = \"GET\",\r\n        POST = \"POST\",\r\n        DELETE = \"DELETE\",\r\n        PUT = \"PUT\"\r\n    }\r\n\r\n    export enum PayloadType {\r\n        OfficeAddin = 1,\r\n        MosAcquisition = 2\r\n    }\r\n\r\n    // MetaOS acquisition/title scope\r\n    export enum TitleScope {\r\n        Public = 'Public',\r\n        Tenant = 'Tenant',\r\n        User = 'User'\r\n    }\r\n\r\n    // MetaOS title acquisition state\r\n    export enum AcquisitionAcquiredState {\r\n        Acquired = \"acquired\",\r\n        Unacquired = \"unacquired\",\r\n        NeedsConsentForUpgrade = \"needsconsentforupgrade\"\r\n    }\r\n\r\n    // MetaOS supported elements types\r\n    export declare type MosSupportedElements = \r\n        \"Activities\" | \"AAD\" | \"Bots\" | \"ComposeExtensions\" | \r\n        \"ConfigurableTabs\" | \"Connectors\" | \"Dynamics\" | \"ExchangeAddIns\" | \r\n        \"Extensions\" | \"FirstPartyPages\" | \"GraphConnector\" | \"LineOfBusiness\" | \"MeetingExtensionDefinition\" | \"OfficeAddIns\" | \"StaticTabs\";\r\n\r\n    // VersionOverrides versions\r\n    export enum VersionOverridesNumber {\r\n        V1_0 = 100,\r\n        V1_1 = 101,\r\n        // Add more here, and also in VersionOverridesNamespace below\r\n        Max\r\n    }\r\n\r\n    // VersionOverrides namespaces\r\n    export enum VersionOverridesNamespace {\r\n        V1_0 = \"http://schemas.microsoft.com/office/mailappversionoverrides\",\r\n        V1_1 = \"http://schemas.microsoft.com/office/mailappversionoverrides/1.1\",\r\n    }\r\n\r\n    // Parser strings\r\n    export enum ParserStrings {\r\n        DesktopFormFactor = \"DesktopFormFactor\",\r\n        Form = \"Form\",\r\n        FormSettings = \"FormSettings\",\r\n        MobileFormFactor = \"MobileFormFactor\",\r\n        OOfficeApp = \"o:OfficeApp\",\r\n        RequestedHeight = \"RequestedHeight\",\r\n        Resources = \"Resources\",\r\n        SourceLocation = \"SourceLocation\",\r\n        VersionOverrides = \"VersionOverrides\",\r\n        Mailappor = \"mailappor:\",\r\n    }\r\n\r\n    export enum PowerPointSlideShowRole {\r\n        Attendee = 0,\r\n        Presenter = 1,\r\n        PrivateViewing = 2,\r\n    }\r\n\r\n    export enum PowerPointSlideShowUIHostType {\r\n        'UnifiedApp',\r\n        'MSTeams',\r\n        'TeamsiOS',\r\n        'TeamsAndroid',\r\n        'Unknown',\r\n    }\r\n}","module OfficeExt {\r\n    export class ManifestUtil {\r\n        static versionLessThan(version1, version2): boolean {\r\n            return OSF.OsfManifestManager.versionLessThan(version1, version2);\r\n        }\r\n        static ParseManifest(para, uiLocale, correlation?: string): Manifest {\r\n            try {\r\n                // @ts-expect-error TS2741\r\n                return new OSF.Manifest.Manifest(para, uiLocale);\r\n            }\r\n            catch (ex) {\r\n                Telemetry.RuntimeTelemetryHelper.LogExceptionTag(\"Invalid manifest:\", ex, correlation, 0x1f01139f /* tag_5aro5 */);\r\n                return null;\r\n            }\r\n        }\r\n        static constructAddInId(solutionId: string, version: string, storeTypeName: string, storeLocation: string): string {\r\n            const addinIdFormat = \"{0}|{1}|{2}|{3}|{4}|||\";\r\n            const addinIdFormatVersion = \"2\";\r\n            return OfficeExt.MsAjaxString.format(addinIdFormat, addinIdFormatVersion, solutionId, version, this.GetStoreTypeId(storeTypeName).toString(), storeLocation);\r\n        }\r\n        private static GetStoreTypeId(storeTypeName: string): number {\r\n            if (storeTypeName == OSF.StoreType.OMEX) {\r\n                return OSF.StoreTypeEnum.MarketPlace;\r\n            }\r\n            else if (storeTypeName == OSF.StoreType.SPCatalog) {\r\n                return OSF.StoreTypeEnum.Catalog;\r\n            }\r\n            else if (storeTypeName == OSF.StoreType.SPApp) {\r\n                return OSF.StoreTypeEnum.SPApp;\r\n            }\r\n            else if (storeTypeName == OSF.StoreType.Exchange) {\r\n                return OSF.StoreTypeEnum.Exchange;\r\n            }\r\n            else if (storeTypeName == OSF.StoreType.FileSystem) {\r\n                return OSF.StoreTypeEnum.FileSystem;\r\n            }\r\n            else if (storeTypeName == OSF.StoreType.Registry) {\r\n                return OSF.StoreTypeEnum.Registry;\r\n            }\r\n            else if (storeTypeName == OSF.StoreType.PrivateCatalog) {\r\n                return OSF.StoreTypeEnum.PrivateCatalog;\r\n            }\r\n            else if (storeTypeName == OSF.StoreType.HardCodedPreinstall) {\r\n                return OSF.StoreTypeEnum.HardCodedPreinstall;\r\n            }\r\n            else if (storeTypeName == OSF.StoreType.FirstParty) {\r\n                return OSF.StoreTypeEnum.FirstParty;\r\n            }\r\n            else if (storeTypeName == OSF.StoreType.UploadFileDevCatalog) {\r\n                return OSF.StoreTypeEnum.UploadFileDevCatalog;\r\n            }\r\n            else if (storeTypeName == OSF.StoreType.WopiCatalog) {\r\n                return OSF.StoreTypeEnum.WopiCatalog;\r\n            }\r\n            return -1;\r\n        }\r\n        static GetStoreTypeName(storeType: string): string {\r\n            var storeTypeId = parseInt(storeType);\r\n            if (storeTypeId == OSF.StoreTypeEnum.MarketPlace) {\r\n                return OSF.StoreType.OMEX;\r\n            }\r\n            else if (storeTypeId == OSF.StoreTypeEnum.Catalog) {\r\n                return OSF.StoreType.SPCatalog;\r\n            }\r\n            else if (storeTypeId == OSF.StoreTypeEnum.SPApp) {\r\n                return OSF.StoreType.SPApp;\r\n            }\r\n            else if (storeTypeId == OSF.StoreTypeEnum.Exchange) {\r\n                return OSF.StoreType.Exchange;\r\n            }\r\n            else if (storeTypeId == OSF.StoreTypeEnum.FileSystem) {\r\n                return OSF.StoreType.FileSystem;\r\n            }\r\n            else if (storeTypeId == OSF.StoreTypeEnum.Registry) {\r\n                return OSF.StoreType.Registry;\r\n            }\r\n            else if (storeTypeId == OSF.StoreTypeEnum.PrivateCatalog) {\r\n                return OSF.StoreType.PrivateCatalog;\r\n            }\r\n            else if (storeTypeId == OSF.StoreTypeEnum.HardCodedPreinstall) {\r\n                return OSF.StoreType.HardCodedPreinstall;\r\n            }\r\n            else if (storeTypeId == OSF.StoreTypeEnum.FirstParty) {\r\n                return OSF.StoreType.FirstParty;\r\n            }\r\n            else if (storeTypeId == OSF.StoreTypeEnum.UploadFileDevCatalog) {\r\n                return OSF.StoreType.UploadFileDevCatalog;\r\n            }\r\n            else if (storeTypeId == OSF.StoreTypeEnum.WopiCatalog) {\r\n                return OSF.StoreType.WopiCatalog;\r\n            }\r\n            return null;\r\n        }\r\n    }\r\n    export class AsyncUtil {\r\n        static Cache: {\r\n            [key: string]: string;\r\n        } = {};\r\n        static NextCheckExpiry: number = 0;\r\n        static failed<TResult, TComplete>(result: IAsyncResult<TResult>, onComplete: (asyncResult: IAsyncResult<TComplete>) => void, value?: TComplete): boolean {\r\n            if (result.status != DataServiceResultCode.Succeeded) {\r\n                var r: IAsyncResult<TComplete> = { status: result.status, httpStatus: result.httpStatus };\r\n                if (value != null) {\r\n                    r.value = value;\r\n                }\r\n                onComplete(r);\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n        // Retry the async operation if it failed, delaying each attempt exponentially\r\n        static retry<T>(operation: () => Promise<T>, options = {} as any): Promise<T> {\r\n            const { retries = 3, factor = 2, minTimeout = 300, maxTimeout = Infinity } = options;\r\n            return new Promise((resolve, reject) => {\r\n                const attempt = (count) => {\r\n                    operation().then(resolve, err => {\r\n                        if (count >= retries) {\r\n                            reject(err);\r\n                            return;\r\n                        }\r\n                        setTimeout(() => attempt(count + 1), Math.min(minTimeout * Math.pow(factor, count), maxTimeout));\r\n                    });\r\n                };\r\n                attempt(0);\r\n            });\r\n        }\r\n        // Return a function that behave the same as the 'func' parameter, except that\r\n        // it will wait fo the time specified in the 'wait' paramter between any two invocation.\r\n        static limitRate(func: Function, wait: number): Function {\r\n            const taskQueue = [];\r\n            let lastRunTask = -Infinity;\r\n            const runTaskQueue = () => {\r\n                const args = taskQueue.shift();\r\n                if (taskQueue.length > 0) {\r\n                    setTimeout(runTaskQueue, wait);\r\n                }\r\n                lastRunTask = performance.now();\r\n                func(...args);\r\n            };\r\n            return (...args) => {\r\n                if (taskQueue.length === 0) {\r\n                    setTimeout(runTaskQueue, Math.max(0, wait - (performance.now() - lastRunTask)));\r\n                }\r\n                taskQueue.push(args);\r\n            };\r\n        }\r\n        // Cache the async operation result using the cacheKey. If it already exists, just return the cached entry as a resolved Promise.\r\n        // Otherwise trigger the async operation and store in memory and localStorage cache\r\n        // The localStorage cache will be expired after the maxAge second has passed (default 3 days)\r\n        static withCache(cacheKey: string, options: {\r\n            forceUpdateCache?: boolean;\r\n            maxAgeInSecs?: number;\r\n            useStaleCache?: boolean;\r\n        }, operation: () => Promise<string>): Promise<{\r\n            cacheType: string;\r\n            value: string;\r\n        }> {\r\n            const { forceUpdateCache = false, maxAgeInSecs = 60 * 60 * 24 * 3 /* default 3 days */, useStaleCache = false } = options;\r\n            if (!forceUpdateCache && AsyncUtil.Cache.hasOwnProperty(cacheKey)) {\r\n                return Promise.resolve({\r\n                    cacheType: 'memory',\r\n                    value: AsyncUtil.Cache[cacheKey]\r\n                });\r\n            }\r\n            const cacheKeyWithPrefix = `__OSF_AsyncCache_${cacheKey}`;\r\n            const cacheKeyWithPrefixStale = `__OSF_AsyncCache_${cacheKey}_stale`;\r\n            const expiriesKey = `__OSF_AsyncCacheExpiry`;\r\n            const now = Date.now();\r\n\r\n            if (OSF.OUtil.getLocalStorage().isLocalStorageAvailable()) {\r\n                try {\r\n                    if (now >= AsyncUtil.NextCheckExpiry) {\r\n                        const expiries = JSON.parse(localStorage.getItem(expiriesKey)) || {};\r\n                        let needUpdateExpiries = false;\r\n                        AsyncUtil.NextCheckExpiry = Infinity;\r\n                        // purge expired entries\r\n                        for (const key in expiries) {\r\n                            if (now > expiries[key]) {\r\n                                localStorage.removeItem(`__OSF_AsyncCache_${key}`);\r\n                                delete expiries[key];\r\n                                needUpdateExpiries = true;\r\n                            }\r\n                            else {\r\n                                AsyncUtil.NextCheckExpiry = Math.min(AsyncUtil.NextCheckExpiry, expiries[key]);\r\n                            }\r\n                        }\r\n                        if (needUpdateExpiries) {\r\n                            localStorage.setItem(expiriesKey, JSON.stringify(expiries));\r\n                        }\r\n                    }\r\n                    if (!forceUpdateCache && localStorage.hasOwnProperty(cacheKeyWithPrefix)) {\r\n                        return Promise.resolve({\r\n                            cacheType: 'localStorage',\r\n                            value: localStorage.getItem(cacheKeyWithPrefix)\r\n                        });\r\n                    }\r\n                }\r\n                catch (e) {\r\n                    Telemetry.RuntimeTelemetryHelper.LogExceptionTag(`failed to get key ${cacheKeyWithPrefix}`, e, null, 0x1f01139e /* tag_5aro4 */);\r\n                }\r\n            }\r\n            return operation().then(result => {\r\n                AsyncUtil.Cache[cacheKey] = result;\r\n                try {\r\n                    const expiries = JSON.parse(localStorage.getItem(expiriesKey)) || {};\r\n                    expiries[cacheKey] = now + maxAgeInSecs * 1000;\r\n                    AsyncUtil.NextCheckExpiry = Math.min(AsyncUtil.NextCheckExpiry, expiries[cacheKey]);\r\n                    localStorage.setItem(expiriesKey, JSON.stringify(expiries));\r\n                    localStorage.setItem(cacheKeyWithPrefix, result);\r\n                    localStorage.setItem(cacheKeyWithPrefixStale, result);\r\n                }\r\n                catch (e) {\r\n                    // localstorage inaccessible due to privacy setting\r\n                }\r\n                return {\r\n                    cacheType: 'none',\r\n                    value: result\r\n                };\r\n            }, ex => {\r\n                if (useStaleCache && OSF.OUtil.getLocalStorage().isLocalStorageAvailable()) {\r\n                    if (localStorage.hasOwnProperty(cacheKeyWithPrefixStale)) {\r\n                        Telemetry.RuntimeTelemetryHelper.LogCommonMessageTag(`stale cache used for ${cacheKeyWithPrefixStale}`, null, 0x1f01139d /* tag_5aro3 */);\r\n                        return Promise.resolve({\r\n                            cacheType: 'localStorage',\r\n                            value: localStorage.getItem(cacheKeyWithPrefixStale)\r\n                        });\r\n                    }\r\n                }\r\n                throw ex;\r\n            });\r\n        }\r\n        // Ponyfill for old browser without fetch, it only includes functionalities we need currently, doesn't implement all of fetch\r\n        static fetch(url: string, options = {} as any): Promise<any> {\r\n            return new Promise((resolve, reject) => {\r\n                const xmlhttp = new XMLHttpRequest();\r\n                const { method = \"GET\", headers = {}, body = null } = options;\r\n                xmlhttp.onreadystatechange = () => {\r\n                    if (xmlhttp.readyState == 4) {\r\n                        resolve({\r\n                            ok: xmlhttp.status >= 200 && xmlhttp.status <= 299,\r\n                            status: xmlhttp.status,\r\n                            statusText: xmlhttp.statusText,\r\n                            text: () => Promise.resolve(xmlhttp.responseText),\r\n                            json: () => Promise.resolve(JSON.parse(xmlhttp.responseText))\r\n                        });\r\n                    }\r\n                };\r\n                xmlhttp.onerror = reject;\r\n                xmlhttp.open(method, url, true);\r\n                for (let key in headers) {\r\n                    xmlhttp.setRequestHeader(key, headers[key]);\r\n                }\r\n                xmlhttp.send(body);\r\n            });\r\n        }\r\n    }\r\n    class CatalogFactoryImp {\r\n        private static _registry = {};\r\n        private static _resolved = {};\r\n        private static _hostInfo: IHostContextInfo;\r\n        static register(storeType: string, creator: (hostInfo: IHostContextInfo) => IAddinCatalog): void {\r\n            this._registry[storeType] = creator;\r\n        }\r\n        static resolve(storeType: string, hostInfo?: IHostContextInfo): IAddinCatalog {\r\n            var catalog = this._resolved[storeType];\r\n            if (catalog != null) {\r\n                return catalog;\r\n            }\r\n            hostInfo = hostInfo || this._hostInfo;\r\n            if (hostInfo != null) {\r\n                var creator = this._registry[storeType];\r\n                if (creator == null) {\r\n                    return null;\r\n                }\r\n                this._resolved[storeType] = catalog = creator(hostInfo);\r\n            }\r\n            return catalog;\r\n        }\r\n        static setHostContext(hostInfo: IHostContextInfo) {\r\n            this._hostInfo = hostInfo;\r\n        }\r\n        static getHostContext(): IHostContextInfo {\r\n            return this._hostInfo;\r\n        }\r\n    }\r\n    OfficeExt.CatalogFactory = CatalogFactoryImp;\r\n}","namespace OSF {\r\n    export var RibbonControlIdMap: any = {};\r\n    export var RibbonGroupIdMap: any = {};\r\n    export var RibbonGroupIdMapMLR: any = {};\r\n    export var RibbonGroupIdMapCommonMLR: any = {};\r\n    export var RibbonGroupIdMapCommonSLR: any = {};\r\n}\r\n\r\nOSF.RibbonControlIdMap = {};\r\nOSF.RibbonGroupIdMap = {};\r\nOSF.RibbonGroupIdMapMLR = {};\r\nOSF.RibbonGroupIdMapCommonMLR = {};\r\nOSF.RibbonGroupIdMapCommonSLR = {};","namespace OSF {\r\n    // Since XmlProcessor can't support xpath query, here we write a method to select grandchild (or deeper) level descendant node.\r\n    export function SelectSingleNode(xmlProcessor: OSF.XmlProcessor, node: any, path: Array<string>, isStrictPath?: boolean): any {\r\n        if (OSF.OUtil.isNullOrUndefined(path))\r\n            return node;\r\n        let currentNode: any = node;\r\n        for (let i: number = 0; i < path.length; i++) {\r\n            currentNode = xmlProcessor.selectSingleNode(path[i], currentNode);\r\n            if (OSF.OUtil.isNullOrUndefined(currentNode)) {\r\n                if (isStrictPath) {\r\n                    return null;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n        return currentNode;\r\n    }\r\n\r\n    // Similar to SelectSingleNode, select grandchild (or deeper) level descendant nodes.\r\n    export function SelectChildNodes(xmlProcessor: OSF.XmlProcessor, name: string, node: any, path: Array<string>, isStrictPath?: boolean): any {\r\n        let currentNode: any = SelectSingleNode(xmlProcessor, node, path, isStrictPath);\r\n        if (OSF.OUtil.isNullOrUndefined(currentNode)) {\r\n            return [];\r\n        }\r\n        return xmlProcessor.selectNodes(name, currentNode);\r\n    }\r\n\r\n    // Convert the number to string for VersionOverrides' version.\r\n    export function GetVersionOverridesString(versionOverridesNumber: OSF.VersionOverridesNumber): string {\r\n        let versionString = \"\";\r\n        if (versionOverridesNumber >= OSF.VersionOverridesNumber.V1_0 && versionOverridesNumber < OSF.VersionOverridesNumber.Max) {\r\n            versionString = \"VersionOverridesV\" + Math.floor(versionOverridesNumber / 100) + \"_\" + (versionOverridesNumber % 100);\r\n        }\r\n        return versionString;\r\n    }\r\n\r\n    // From the VersionOverrides' version as a number in enum, get its node path.\r\n    export function GetVersionOverridesPath(xmlProcessor: OSF.XmlProcessor, namespace: string, versionOverridesNumber: OSF.VersionOverridesNumber): string[] {\r\n        let path: string[] = [];\r\n        if (versionOverridesNumber >= OSF.VersionOverridesNumber.V1_0 && versionOverridesNumber < OSF.VersionOverridesNumber.Max) {\r\n            for (const v in OSF.VersionOverridesNumber) {\r\n                let versionNumber = Number(v);\r\n                if (!isNaN(versionNumber) && versionNumber <= versionOverridesNumber) {\r\n                    let ns: string = namespace;\r\n\r\n                    // for Outlook's VersionOverrides 1.1 and above, we need to make sure the namespace is registered\r\n                    if (versionNumber > VersionOverridesNumber.V1_0) {\r\n                        ns = GetVersionOverridesNamespace(ns, versionNumber);\r\n                        xmlProcessor.addNamespaceMapping(ns.slice(0, -1), OSF.VersionOverridesNamespace[VersionOverridesNumber[versionNumber]]);\r\n                    }\r\n\r\n                    path.push(ns + OSF.ParserStrings.VersionOverrides);\r\n                }\r\n            }\r\n        }\r\n        return path;\r\n    }\r\n\r\n    export function GetVersionOverridesNamespace(namespace: string, versionOverridesNumber?: OSF.VersionOverridesNumber): string {\r\n        let ns: string = namespace;\r\n        if (!OSF.OUtil.isNullOrUndefined(versionOverridesNumber) && versionOverridesNumber > VersionOverridesNumber.V1_0 && ns === OSF.ParserStrings.Mailappor) {\r\n            ns = OSF.ParserStrings.Mailappor.replace(\":\", VersionOverridesNumber[versionOverridesNumber] + \":\");\r\n        }\r\n        return ns;\r\n    }\r\n\r\n    export function GetNamespaceOrDefault(namespace: string): string {\r\n        if (namespace && namespace.length > 0) {\r\n            return namespace;\r\n        }\r\n        return \"ov:\";\r\n    }\r\n}","/// <reference path=\"tsdeclarations\\addinCommands.d.ts\" />\r\n/// <reference path=\"ribbon/RibbonIdMap.ts\" />\r\n/// <reference path=\"../runtime/Utilities/WAC/ParserUtility.ts\" />\r\ndeclare var otel: any;\r\nmodule OfficeExt {\r\n    export module Parser {\r\n        const OfficeControlNodeName = \"OfficeControl\";\r\n        interface Error {\r\n            name: string;\r\n            message: string;\r\n        }\r\n        class AddInManifestException implements Error {\r\n            name: string;\r\n            message: string;\r\n            constructor(message: string) {\r\n                this.name = 'AddinManifestError';\r\n                this.message = this.name + \": \" + message;\r\n                console.error(this.message);\r\n            }\r\n        }\r\n        class AddInInternalException implements Error {\r\n            name: string;\r\n            message: string;\r\n            constructor(message: string) {\r\n                this.name = 'AddinInternalError';\r\n                this.message = message;\r\n            }\r\n        }\r\n        function CheckValueNotNullNorUndefined(objectValue: any, errorMessage: string) {\r\n            if (objectValue == null) {\r\n                throw new AddInManifestException(errorMessage);\r\n            }\r\n        }\r\n        function CheckValueNotContainsInvalidCharacters(stringValue: string, errorMessage: string) {\r\n            // On desktop side did the similar checking at %SRCROOT%\\osfclient\\osfmanifest\\OsfManifestParser.cpp\r\n            // Method: OsfManifestParser::VerifyValidNonMemoText(const WCHAR* wzText, ParserContext* pContext)\r\n            const invalidChars = '\\r\\n\\f\\b\\v\\u0007\\t'; // We replace '\\a' with '\\u0007' in javascript.\r\n            for(let i = 0; i < invalidChars.length; ++i){\r\n                if (stringValue.indexOf(invalidChars[i]) >= 0) {\r\n                    throw new AddInManifestException(errorMessage);\r\n                }\r\n            }\r\n        }\r\n        function GetActionType(action: Mos.Actions): string {\r\n            const type: string = action.type;\r\n            return type === \"openPage\" ? \"ShowTaskpane\" : (type === \"executeFunction\" ? \"ExecuteFunction\" : type);\r\n        }\r\n\r\n        let resIdCounter: number = 0;\r\n\r\n        export class ManifestResourceManager {\r\n            Images: {};\r\n            Urls: {};\r\n            LongStrings: {};\r\n            ShortStrings: {};\r\n            AllLocaleImages: {};\r\n            AllLocaleUrls: {};\r\n            AllLocaleLongStrings: {};\r\n            AllLocaleShortStrings: {};\r\n            namespace: string;\r\n            constructor(context: ParsingContext, namespace?: string, versionOverridesNumber?: OSF.VersionOverridesNumber) {\r\n                this.Images = {};\r\n                this.Urls = {};\r\n                this.LongStrings = {};\r\n                this.ShortStrings = {};\r\n                this.namespace = OSF.GetNamespaceOrDefault(namespace);\r\n                if (context.manifest.getPayloadType() === OSF.PayloadType.OfficeAddin) {\r\n                    let xmlProcessor = context.manifest._xmlProcessor;\r\n                    var officeAppNode = xmlProcessor.selectSingleNode(\"o:OfficeApp\");\r\n\r\n                    var resourcesNode;\r\n                    if (context.manifest.isForOfficeAppManifest()) {\r\n                        this.AllLocaleImages = {};\r\n                        this.AllLocaleUrls = {};\r\n                        this.AllLocaleLongStrings = {};\r\n                        this.AllLocaleShortStrings = {};\r\n        \r\n                        if (OSF.OUtil.isNullOrUndefined(versionOverridesNumber)) {\r\n                            versionOverridesNumber = OSF.VersionOverridesNumber.V1_0;\r\n                        }\r\n\r\n                        let resourcesNodePath: string[] = OSF.GetVersionOverridesPath(xmlProcessor, this.namespace, versionOverridesNumber);\r\n                        resourcesNodePath.push(OSF.GetVersionOverridesNamespace(this.namespace, versionOverridesNumber) + OSF.ParserStrings.Resources);\r\n                        resourcesNode = OSF.SelectSingleNode(xmlProcessor, officeAppNode, resourcesNodePath, true /*isStrictPath*/);\r\n\r\n                        this.parseCollection(context, OSF.SelectChildNodes(xmlProcessor, \"bt:Image\", resourcesNode, [\"bt:Images\"]), this.Images, this.AllLocaleImages);\r\n                        this.parseCollection(context, OSF.SelectChildNodes(xmlProcessor, \"bt:Url\", resourcesNode, [\"bt:Urls\"]), this.Urls, this.AllLocaleUrls);\r\n                        this.parseCollection(context, OSF.SelectChildNodes(xmlProcessor, \"bt:String\", resourcesNode, [\"bt:LongStrings\"]), this.LongStrings, this.AllLocaleLongStrings);\r\n                        this.parseCollection(context, OSF.SelectChildNodes(xmlProcessor, \"bt:String\", resourcesNode, [\"bt:ShortStrings\"]), this.ShortStrings, this.AllLocaleShortStrings);\r\n                    }\r\n                    else {\r\n                        resourcesNode = OSF.SelectSingleNode(xmlProcessor, officeAppNode, [this.namespace + \"VersionOverrides\", this.namespace + \"Resources\"]);\r\n\r\n                        this.parseCollection(context, OSF.SelectChildNodes(xmlProcessor, \"bt:Image\", resourcesNode, [\"bt:Images\"]), this.Images);\r\n                        this.parseCollection(context, OSF.SelectChildNodes(xmlProcessor, \"bt:Url\", resourcesNode, [\"bt:Urls\"]), this.Urls);\r\n                        this.parseCollection(context, OSF.SelectChildNodes(xmlProcessor, \"bt:String\", resourcesNode, [\"bt:LongStrings\"]), this.LongStrings);\r\n                        this.parseCollection(context, OSF.SelectChildNodes(xmlProcessor, \"bt:String\", resourcesNode, [\"bt:ShortStrings\"]), this.ShortStrings);\r\n                    }\r\n                }\r\n            }\r\n            private parseCollection(context: ParsingContext, nodes, map: {}, allLocaleMaps?: {}): void {\r\n                var len = nodes.length;\r\n                for (var i = 0; i < len; i++) {\r\n                    var node = nodes[i];\r\n                    var id = node.getAttribute(\"id\");\r\n                    if (!OSF.OUtil.isNullOrUndefined(allLocaleMaps)) {\r\n                        allLocaleMaps[id] = {};\r\n                        map[id] = context.parseLocaleAwareSettingsAndGetValue(node, allLocaleMaps[id])\r\n                    }\r\n                    else {\r\n                        map[id] = context.parseLocaleAwareSettingsAndGetValue(node);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        export class ParsingContext {\r\n            hostType: string;\r\n            formFactor: string;\r\n            entitlement: AddinEntitlement;\r\n            manifest: Manifest;\r\n            resources: ManifestResourceManager;\r\n            officeGroupCount: number;\r\n            officeControlCount: number;\r\n            insertBefore: string;\r\n            insertAfter: string;\r\n            namespace: string;\r\n            constructor(hostType: string, formFactor: string, entitlement: AddinEntitlement, manifest: Manifest, namespace?: string, versionOverridesNumber?: OSF.VersionOverridesNumber) {\r\n                this.hostType = hostType;\r\n                this.formFactor = formFactor;\r\n                this.entitlement = entitlement;\r\n                this.manifest = manifest;\r\n                this.namespace = OSF.GetNamespaceOrDefault(namespace);\r\n                this.resources = new ManifestResourceManager(this, this.namespace, versionOverridesNumber);\r\n                this.officeGroupCount = 0;\r\n                this.officeControlCount = 0;\r\n            }\r\n            shouldParseNode(node): boolean {\r\n                var overriddenByRibbonApi = this.manifest._xmlProcessor.selectSingleNode(this.namespace + \"OverriddenByRibbonApi\", node);\r\n                if ((overriddenByRibbonApi != null && this.manifest._parseBooleanNode(overriddenByRibbonApi)) && !this.manifest.isForOfficeAppManifest()) {\r\n                    return false;\r\n                }\r\n                return true;\r\n            }\r\n            shouldParseNodeFromMos(node: any): boolean {\r\n                /**\r\n                 * OverriddenByRibbonApi is an optional boolean type property for Group or Control.\r\n                 * When OverriddenByRibbonApi is true, we should not parse the node from Mos, so the Group or Control is overridden and won't be displayed.\r\n                 * By default, OverriddenByRibbonApi is false.\r\n                 */\r\n                return !node.overriddenByRibbonApi;\r\n            }\r\n            parseIdRequired(node): string {\r\n                var id = node.getAttribute(\"id\");\r\n                CheckValueNotNullNorUndefined(id, \"Id required\");\r\n                return id;\r\n            }\r\n            parseIdRequiredFromMos(node: any): string {\r\n                let id: string = node.id;\r\n                CheckValueNotNullNorUndefined(id, \"Id required\");\r\n                return id;\r\n            }\r\n            parseLabel(node): string {\r\n                var child = this.manifest._xmlProcessor.selectSingleNode(this.namespace + \"Label\", node);\r\n                if (child != null) {\r\n                    return this.getShortString(child);\r\n                }\r\n                return null;\r\n            }\r\n            parseLabelRequired(node): string {\r\n                var label = this.parseLabel(node);\r\n                CheckValueNotNullNorUndefined(label, \"Label required\");\r\n                return label;\r\n            }\r\n            parseLabelRequiredFromMos(node: Mos.Tabs | Mos.Groups | Mos.Controls): string {\r\n                let label: string = node.label;\r\n                CheckValueNotNullNorUndefined(label, \"Label required\");\r\n                return label;\r\n            }\r\n            parseResId(node): string {\r\n                if (!OSF.OUtil.isNullOrUndefined(node)) {\r\n                    return node.getAttribute(\"resid\");\r\n                }\r\n                return null;\r\n            }\r\n            parseType(node): string {\r\n                if (!OSF.OUtil.isNullOrUndefined(node)) {\r\n                    return node.getAttribute(\"type\");\r\n                }\r\n                return null;\r\n            }\r\n            parseRequiredSuperTip(node): SuperTip {\r\n                var superTip = this.parseSuperTip(node);\r\n                CheckValueNotNullNorUndefined(superTip, \"SuperTip required\");\r\n                return superTip;\r\n            }\r\n            parseRequiredSupertipFromMos(node): SuperTip {\r\n                const supertip = this.parseSupertipFromMos(node);\r\n                CheckValueNotNullNorUndefined(supertip, \"supertip required\");\r\n                return supertip;\r\n            }\r\n            parseSuperTip(node): SuperTip {\r\n                var superTip = null;\r\n                var child = this.manifest._xmlProcessor.selectSingleNode(this.namespace + \"Supertip\", node);\r\n                if (child != null) {\r\n                    var tipNode = child;\r\n                    var title, description, titleResId, descriptionResId;\r\n                    child = this.manifest._xmlProcessor.selectSingleNode(this.namespace + \"Title\", tipNode);\r\n                    CheckValueNotNullNorUndefined(child, \"Title is necessary for SuperTip.\");\r\n                    title = this.getShortString(child);\r\n                    child = this.manifest._xmlProcessor.selectSingleNode(this.namespace + \"Description\", tipNode);\r\n                    CheckValueNotNullNorUndefined(child, \"Description is necessary for SuperTip.\");\r\n                    description = this.getLongString(child);\r\n                    superTip = {\r\n                        title: title,\r\n                        description: description\r\n                    };\r\n                    if (this.manifest.isForOfficeAppManifest()) {\r\n                        child = this.manifest._xmlProcessor.selectSingleNode(this.namespace + \"Title\", tipNode);\r\n                        superTip.titleResId = this.parseResId(child);\r\n                        child = this.manifest._xmlProcessor.selectSingleNode(this.namespace + \"Description\", tipNode);\r\n                        superTip.descriptionResId = this.parseResId(child);\r\n                    }\r\n                }\r\n                return superTip;\r\n            }\r\n            parseSupertipFromMos(control: Mos.Controls): SuperTip {\r\n                let supertip = null;\r\n                const child: Mos.Supertip = control.supertip;\r\n                if (child != null) {\r\n                    const title: string = child.title;\r\n                    CheckValueNotNullNorUndefined(title, \"Title is necessary for Supertip.\");\r\n                    CheckValueNotContainsInvalidCharacters(title, \"Invalid characters in text value: \" + title);\r\n                    const description: string = child.description;\r\n                    CheckValueNotNullNorUndefined(description, \"Description is necessary for Supertip.\");\r\n                    CheckValueNotContainsInvalidCharacters(description, \"Invalid characters in text value: \" + description);\r\n                    supertip = {\r\n                        title: title,\r\n                        description: description\r\n                    }\r\n                }\r\n                return supertip;\r\n            }\r\n            parseRequiredIcon(node): {} {\r\n                var icon = this.parseIcon(node);\r\n                CheckValueNotNullNorUndefined(icon, \"Icon required\");\r\n\r\n                return icon;\r\n            }\r\n            parseRequiredIconFromMos(node: Mos.Groups | Mos.Controls): {} {\r\n                let icon: {} = this.parseIconFromMos(node);\r\n                CheckValueNotNullNorUndefined(icon, \"Icon required\");\r\n\r\n                return icon;\r\n            }\r\n            parseOptionalIcon(node): {} {\r\n                return this.parseIcon(node);\r\n            }\r\n            parseOptionalIconFromMos(node: Mos.Groups): {} {\r\n                return this.parseIcon(node);\r\n            }\r\n            parseIcon(node): {} {\r\n                var iconNodes = OSF.SelectChildNodes(this.manifest._xmlProcessor, \"bt:Image\", node, [this.namespace + \"Icon\"]);\r\n                var len = iconNodes.length;\r\n                if (len == 0) {\r\n                    return null;\r\n                }\r\n                var icon = {};\r\n                for (var i = 0; i < len; i++) {\r\n                    var iconNode = iconNodes[i];\r\n                    var size = iconNode.getAttribute(\"size\");\r\n                    icon[size] = this.getImageResource(iconNode);\r\n                }\r\n                return icon;\r\n            }\r\n            parseIconFromMos(node: Mos.Groups | Mos.Controls): {} {\r\n                const iconNodes: Mos.Icons[] = node.icons;\r\n                const len: number = iconNodes?.length;\r\n                if (!len || len == 0) {\r\n                    return null;\r\n                }\r\n                let icons: {} = {};\r\n                for (const icon of iconNodes) {\r\n                    this.AddResourceMapAndGetIdHelper(icon.file, this.resources.Images);\r\n                    const size: number = icon.size;\r\n                    icons[size] = icon.file;\r\n                }\r\n                return icons;\r\n            }\r\n            parseIconResId(node) {\r\n                var iconNodes = OSF.SelectChildNodes(this.manifest._xmlProcessor, \"bt:Image\", node, [this.namespace + \"Icon\"]);\r\n                var len = iconNodes.length;\r\n                if (len == 0) {\r\n                    return null;\r\n                }\r\n                var iconResId = {};\r\n                for (var i = 0; i < len; i++) {\r\n                    var iconNode = iconNodes[i];\r\n                    var size = iconNode.getAttribute(\"size\");\r\n                    if (!OSF.OUtil.isNullOrUndefined(size)) {\r\n                        iconResId[size] = iconNode.getAttribute(\"resid\");\r\n                    }\r\n                }\r\n                return iconResId;\r\n            }\r\n            AddResourceMapAndGetIdHelper(resourceValue: string, resourceMap: {}): void {\r\n                CheckValueNotNullNorUndefined(resourceMap, \"resourceMap is not found.\");\r\n                resIdCounter++;\r\n                resourceMap[resIdCounter] = resourceValue;\r\n            }\r\n            checkRequiredGroupIcons(icons: any) {\r\n                CheckValueNotNullNorUndefined(icons[16], \"Icons are missing required size 16\");\r\n                CheckValueNotNullNorUndefined(icons[32], \"Icons are missing required size 32\");\r\n                CheckValueNotNullNorUndefined(icons[80], \"Icons are missing required size 80\");\r\n            }\r\n            parseMultipleChildControls(childNodeNames: string[], node: any, parser: (context: ParsingContext, node: any) => any): any[] {\r\n                var controls = [];\r\n                for (var idx = 0; idx < node.childNodes.length; idx++) {\r\n                    if (childNodeNames.indexOf(node.childNodes[idx].nodeName) !== -1) {\r\n                        controls.push(node.childNodes[idx]);\r\n                    }\r\n                }\r\n                return this.parseControls(controls, parser);\r\n            }\r\n            parseMultipleChildControlsFromMos(childNodeNames: string[], node: any, parseControlFromMos: (context: ParsingContext, node: Mos.Groups | Mos.Controls) => any): any[] {\r\n                let controls: Mos.Groups[] | Mos.Controls[] = [];\r\n                if (childNodeNames[0] == \"Group\") {\r\n                    for (const group of node.groups) {\r\n                        controls.push(group);\r\n                    }\r\n                }\r\n                else {\r\n                    for (const control of node.controls) {\r\n                        controls.push(control);\r\n                    }\r\n                }\r\n                return this.parseControlsFromMos(controls, parseControlFromMos);\r\n            }\r\n            parseChildControls(childNodeName: string, node: any, parser: (context: ParsingContext, node: any) => any): any[] {\r\n                var controls = this.manifest._xmlProcessor.selectNodes(childNodeName, node);\r\n                return this.parseControls(controls, parser);\r\n            }\r\n            parseChildControlsFromMos(childNodeName: string, contextMenu: Mos.ContextMenus, parser: (context: ParsingContext, node: any) => any): any[] {\r\n                let controls: Mos.Menus[] = contextMenu.menus;\r\n                return this.parseControlsFromMos(controls, parser);\r\n            }\r\n            parseControls(nodes: any[], parser: (context: ParsingContext, node: any) => any): any[] {\r\n                var controls = [];\r\n                var len = nodes.length;\r\n                for (var i = 0; i < len; i++) {\r\n                    var e = nodes[i];\r\n                    if (this.shouldParseNode(e)) {\r\n                        var control = parser(this, e);\r\n                        CheckValueNotNullNorUndefined(control, \"parser must return a control.\");\r\n                        controls.push(control);\r\n                    }\r\n                }\r\n                return controls;\r\n            }\r\n            parseControlsFromMos(nodes: any[], parseControlFromMos: (context: ParsingContext, node: any) => any): any[] {\r\n                let controls: any[] = [];\r\n                for (const e of nodes) {\r\n                    if (this.shouldParseNodeFromMos(e)) {\r\n                        const control: any = parseControlFromMos(this, e);\r\n                        CheckValueNotNullNorUndefined(control, \"parseControlFromMos must return a control.\");\r\n                        controls.push(control);\r\n                    }\r\n                }\r\n                return controls;\r\n            }\r\n            parseGroupUnderTab(node): RibbonGroup | OfficeGroup {\r\n                let group: RibbonGroup;\r\n                switch (node.nodeName) {\r\n                    case \"OfficeGroup\":\r\n                        group = new OfficeGroup(this.hostType);\r\n                        this.officeGroupCount++;\r\n                        break;\r\n                    default:\r\n                        group = new RibbonGroup(this.hostType);\r\n                }\r\n                group.parse(this, node);\r\n                return group;\r\n            }\r\n            parseGroupUnderTabFromMos(group: Mos.Groups): RibbonGroup | OfficeGroup {\r\n                let newGroup: RibbonGroup;\r\n                if (OSF.OUtil.isNullOrUndefined(group.id)) {\r\n                    newGroup = new OfficeGroup(this.hostType);\r\n                    this.officeGroupCount++;\r\n                }\r\n                else {\r\n                    newGroup = new RibbonGroup(this.hostType);\r\n                }\r\n                newGroup.parseFromMos(this, group);\r\n                return newGroup;\r\n            }\r\n            parseControlInGroup(node): any {\r\n                var controlType = this.manifest.getNodeXsiType(node);\r\n                var control: UIControlNode;\r\n                if (!controlType && node.nodeName === OfficeControlNodeName) {\r\n                    controlType = 'OfficeControl';\r\n                }\r\n                switch (controlType) {\r\n                    case \"Menu\":\r\n                        control = new MenuControl(controlType, this.namespace);\r\n                        break;\r\n                    case \"Button\":\r\n                        control = new Button(controlType, this.namespace);\r\n                        break;\r\n                    case \"OfficeControl\":\r\n                        control = new OfficeControl();\r\n                        this.officeControlCount++;\r\n                        break;\r\n                    default:\r\n                        throw new AddInManifestException(\"Unsupported control type.\");\r\n                }\r\n                control.parse(this, node);\r\n                return control;\r\n            }\r\n            parseControlInGroupFromMos(control: Mos.Controls): UIControlNode {\r\n                let controlType: string = control.type;\r\n                let newControl: UIControlNode;\r\n                if (OSF.OUtil.isNullOrUndefined(controlType)) {\r\n                    controlType = 'OfficeControl';\r\n                }\r\n                switch (controlType) {\r\n                    case \"menu\":\r\n                        newControl = new MenuControl(\"Menu\");\r\n                        break;\r\n                    case \"button\":\r\n                        newControl = new Button(\"Button\");\r\n                        break;\r\n                    case \"OfficeControl\":\r\n                        newControl = new OfficeControl();\r\n                        this.officeControlCount++;\r\n                        break;\r\n                    default:\r\n                        throw new AddInManifestException(\"Unsupported control type.\");\r\n                }\r\n                newControl.parseFromMos(this, control);\r\n                return newControl;\r\n            }\r\n            parseMenuItem(node): any {\r\n                var item: UIControlNode = new MenuItem(this.namespace);\r\n                item.parse(this, node);\r\n                return item;\r\n            }\r\n            parseMenuItemFromMos(node: Mos.Controls): UIControlNode {\r\n                let item: UIControlNode = new MenuItem();\r\n                item.parseFromMos(this, node);\r\n                return item;\r\n            }\r\n            parseLocaleAwareSettingsAndGetValue(node, allLocaleMap?: {}): any {\r\n                const forAllLocales: boolean = !OSF.OUtil.isNullOrUndefined(allLocaleMap);\r\n                let values: object = forAllLocales ? allLocaleMap : {};\r\n                var defaultValue = node.getAttribute(\"DefaultValue\");\r\n                values[this.manifest._defaultLocale] = defaultValue;\r\n                values[this.manifest._defaultLocale.toLocaleLowerCase()] = defaultValue;\r\n                var overrideNodes = this.manifest._xmlProcessor.selectNodes(\"bt:Override\", node);\r\n                if (overrideNodes) {\r\n                    var len = overrideNodes.length;\r\n                    for (var i = 0; i < len; i++) {\r\n                        var node = overrideNodes[i];\r\n                        var locale = node.getAttribute(\"Locale\");\r\n                        var value = node.getAttribute(\"Value\");\r\n                        if (!forAllLocales) {\r\n                            values[locale] = value;\r\n                        }\r\n                        values[locale.toLocaleLowerCase()] = value;\r\n\r\n                        // Current code assumes that Locale attribute is non null and not undefined so continuing this assumption\r\n                        if (this.manifest.isForOfficeAppManifest()) {\r\n                            this.manifest.addLocaleSeen(locale);\r\n                        }\r\n                    }\r\n                }\r\n                return this.manifest._getDefaultValue(values);\r\n            }\r\n            // Since XmlProcessor can't support xpath query, here we write a method to select grandchild (or deeper) level descendant node.\r\n            selectSingleNode(node: any, path: Array<string>): any {\r\n                if (path == null)\r\n                    return node;\r\n                for (var i = 0; i < path.length; i++) {\r\n                    node = this.manifest._xmlProcessor.selectSingleNode(path[i], node);\r\n                    if (node == null) {\r\n                        break;\r\n                    }\r\n                }\r\n                return node;\r\n            }\r\n            // Similar to selectSingleNode, select grandchild (or deeper) level descendant nodes.\r\n            selectChildNodes(name: string, node: any, path: Array<string>): any {\r\n                node = this.selectSingleNode(node, path);\r\n                if (node == null) {\r\n                    return [];\r\n                }\r\n                return this.manifest._xmlProcessor.selectNodes(name, node);\r\n            }\r\n            getSingleNodeValue(nodeName: string, parentNode: any): string {\r\n                let node = this.manifest._xmlProcessor.selectSingleNode(nodeName, parentNode);\r\n                if (node) {\r\n                    return this.manifest._xmlProcessor.getNodeValue(node);\r\n                }\r\n                return '';\r\n            }\r\n            getResourceByNode(resources: {}, resourceNode): any {\r\n                var resid = resourceNode.getAttribute(\"resid\");\r\n                var res = resources[resid];\r\n                if (this.manifest.isForOfficeAppManifest() && OSF.OUtil.isNullOrUndefined(res)) {\r\n                    if (this.manifest.converterLogging()) {\r\n                        console.error('\\x1b[31m%s\\x1b[0m', \"WARNING: resid: \" + resid + \" is not defined.\");\r\n                    }\r\n                    res = \"\";\r\n                }\r\n                else {\r\n                    CheckValueNotNullNorUndefined(res, \"resid: \" + resid + \" not found\");\r\n                }\r\n                return res;\r\n            }\r\n            getImageResource(resourceNode): any {\r\n                return this.getResourceByNode(this.resources.Images, resourceNode);\r\n            }\r\n            getUrlResource(resourceNode): any {\r\n                return this.getResourceByNode(this.resources.Urls, resourceNode);\r\n            }\r\n            getLongString(resourceNode): any {\r\n                const longString = this.getResourceByNode(this.resources.LongStrings, resourceNode);\r\n                CheckValueNotContainsInvalidCharacters(longString, \"Invalid characters in text value: \" + longString);\r\n                return longString;\r\n            }\r\n            getShortString(resourceNode): any {\r\n                const shortString = this.getResourceByNode(this.resources.ShortStrings, resourceNode);\r\n                CheckValueNotContainsInvalidCharacters(shortString, \"Invalid characters in text value: \" + shortString);\r\n                return shortString;\r\n            }\r\n            getContextMenuType(menu: Mos.Menus): string {\r\n                switch (menu?.type) {\r\n                    case \"cell\":\r\n                        return \"ContextMenuCell\";\r\n                    case \"text\":\r\n                        return \"ContextMenuText\";\r\n                    default:\r\n                        throw new AddInManifestException(\"Unsupported context menu type.\");\r\n                }\r\n            }\r\n        }\r\n        class BuildHelpers {\r\n            static buildControls(context: UIControlBuildingContext, controls: UIControlNode[]): void {\r\n                var len = controls.length;\r\n                for (var i = 0; i < len; i++) {\r\n                    var child = controls[i];\r\n                    child.apply(context);\r\n                }\r\n            }\r\n        }\r\n        interface UIControlBuildingContext {\r\n            functionFile: string;\r\n            actionBuilder: ActionBuilder;\r\n            controlBuilder: UIControlBuilder;\r\n        }\r\n        class AddinBuildingContext {\r\n            functionFile: string;\r\n            builder: AddinBuilder;\r\n            multipleCustomTabsEnabled: boolean = false;\r\n            constructor(functionFile: string, builder: AddinBuilder, multipleCustomTabsEnabled = false) {\r\n                this.functionFile = functionFile;\r\n                this.builder = builder;\r\n                this.multipleCustomTabsEnabled = multipleCustomTabsEnabled;\r\n            }\r\n        }\r\n        interface NodeParser {\r\n            parse(context: ParsingContext, node): void;\r\n            parseFromMos(context: ParsingContext, node): void;\r\n        }\r\n        interface ExtensionPoint extends NodeParser {\r\n            type: string;\r\n            apply(context: AddinBuildingContext): void;\r\n        }\r\n        interface ExtensionPointAction extends NodeParser {\r\n            type: string;\r\n            buildAction(context: UIControlBuildingContext): any;\r\n        }\r\n        interface UIControlNode extends NodeParser {\r\n            apply(context: UIControlBuildingContext): void;\r\n        }\r\n        class GetStartedNode implements NodeParser {\r\n            title: string;\r\n            description: string;\r\n            learnMoreUrl: string;\r\n            namespace: string;\r\n\r\n            constructor(namespace?: string) {\r\n                this.namespace = OSF.GetNamespaceOrDefault(namespace);\r\n            }\r\n\r\n            parse(context: ParsingContext, node): void {\r\n                var xmlProcessor = context.manifest._xmlProcessor;\r\n                var titleNode = xmlProcessor.selectSingleNode(this.namespace + \"Title\", node);\r\n                CheckValueNotNullNorUndefined(titleNode, \"Title is necessary for GetStarted.\");\r\n                this.title = context.getShortString(titleNode);\r\n                var descriptionNode = xmlProcessor.selectSingleNode(this.namespace + \"Description\", node);\r\n                CheckValueNotNullNorUndefined(descriptionNode, \"Description is necessary for GetStarted.\");\r\n                this.description = context.getLongString(descriptionNode);\r\n                var learnMoreNode = xmlProcessor.selectSingleNode(this.namespace + \"LearnMoreUrl\", node);\r\n                this.learnMoreUrl = context.getUrlResource(learnMoreNode);\r\n            }\r\n\r\n            parseFromMos(context: ParsingContext, getStartedMessage: Mos.GetStartedMessages): void {\r\n                this.title = getStartedMessage.title;\r\n                this.description = getStartedMessage.description;\r\n                this.learnMoreUrl = getStartedMessage.learnMoreUrl;\r\n            }\r\n        }\r\n        class ActionBase implements ExtensionPointAction {\r\n            type: string;\r\n            namespace: string;\r\n            constructor(type: string, namespace?: string) {\r\n                this.type = type;\r\n                this.namespace = OSF.GetNamespaceOrDefault(namespace);\r\n            }\r\n            buildAction(context: UIControlBuildingContext): any {\r\n            }\r\n            parse(context: ParsingContext, node): void {\r\n            }\r\n            parseFromMos(context: ParsingContext, node): void {\r\n            }\r\n        }\r\n        class ShowUIAction extends ActionBase {\r\n            title: string = null;\r\n            sourceLocation: string;\r\n            parse(context: ParsingContext, node): void {\r\n                var child = context.manifest._xmlProcessor.selectSingleNode(this.namespace + \"SourceLocation\", node);\r\n                CheckValueNotNullNorUndefined(child, \"SourceLocation is necessary for ShowTaskpane action\");\r\n                this.sourceLocation = context.getUrlResource(child);\r\n                context.manifest.addManifestUrl(this.sourceLocation);\r\n            }\r\n            parseFromMos(context: ParsingContext, node: Mos.Actions): void {\r\n                const runtime: Mos.Runtimes = context.manifest.getExtensionRuntimeByActionId(node.id);\r\n                this.sourceLocation = runtime.code.page;\r\n                context.manifest.addManifestUrl(this.sourceLocation);\r\n            }\r\n        }\r\n        class ShowTaskPaneAction extends ShowUIAction {\r\n            taskpaneId: string;\r\n            sourceLocationResid: string;\r\n            pinnable: boolean = false;\r\n            buildAction(context: UIControlBuildingContext): any {\r\n                return context.actionBuilder.buildShowTaskpane(this.sourceLocation, this.title, this.taskpaneId, this.sourceLocationResid);\r\n            }\r\n            parse(context: ParsingContext, node): void {\r\n                super.parse(context, node);\r\n                var child = context.manifest._xmlProcessor.selectSingleNode(this.namespace + \"TaskpaneId\", node);\r\n                if (child != null) {\r\n                    this.taskpaneId = child.firstChild.nodeValue;\r\n                }\r\n                child = context.manifest._xmlProcessor.selectSingleNode(this.namespace + \"SourceLocation \", node);\r\n                if (child != null) {\r\n                    this.sourceLocationResid = child.getAttribute(\"resid\");\r\n                }\r\n                child = context.manifest._xmlProcessor.selectSingleNode(this.namespace + \"Title\", node);\r\n                if (child != null) {\r\n                    this.title = context.getShortString(child);\r\n                }\r\n\r\n                if (context.manifest.isForOfficeAppManifest()) {\r\n                    var supportsPinningNode = context.manifest._xmlProcessor.selectSingleNode(this.namespace + \"SupportsPinning\", node);\r\n                    if (supportsPinningNode != null) {\r\n                        this.pinnable = context.manifest._parseBooleanNode(supportsPinningNode);\r\n                    }\r\n                }\r\n            }\r\n            parseFromMos(context: ParsingContext, node: Mos.Actions): void {\r\n                super.parseFromMos(context, node);\r\n\r\n                const runtime: Mos.Runtimes = context.manifest.getExtensionRuntimeByActionId(node.id);\r\n                if (!OSF.OUtil.isNullOrUndefined(runtime)) {\r\n                    this.sourceLocationResid = runtime.id;\r\n\r\n                    this.taskpaneId = null;\r\n                    const action: Mos.Actions = context.manifest.getExtensionActionById(node.id);\r\n                    if (!OSF.OUtil.isNullOrUndefined(action) && !OSF.OUtil.isNullOrUndefined(action.view)) {\r\n                        this.taskpaneId = action.view;\r\n                    }\r\n\r\n                    if (!OSF.OUtil.isNullOrUndefined(action.displayName)) {\r\n                        this.title = action.displayName;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        class ExecuteFunctionAction extends ActionBase {\r\n            functionName: string;\r\n            controlId: string;\r\n            buildAction(context: UIControlBuildingContext): any {\r\n                CheckValueNotNullNorUndefined(context.functionFile, \"Function file source url is necessary for ExecuteFunctionAction.\");\r\n                return context.actionBuilder.buildCallFunction(context.functionFile, this.functionName, this.controlId);\r\n            }\r\n            parse(context: ParsingContext, node): void {\r\n                var child = context.manifest._xmlProcessor.selectSingleNode(this.namespace + \"FunctionName\", node);\r\n                CheckValueNotNullNorUndefined(child, \"FunctionName is necessary for ExecuteFunctionAction.\");\r\n                this.functionName = context.manifest._xmlProcessor.getNodeValue(child);\r\n            }\r\n            parseFromMos(conext: ParsingContext, node: Mos.Actions): void {\r\n                const functionName: string = node.displayName;\r\n                CheckValueNotNullNorUndefined(functionName, \"Parsing from Mos: FunctionName is necessary for ExecuteFunctionAction.\");\r\n                this.functionName = functionName;\r\n            }\r\n        }\r\n        class UIEntityBase implements UIEntity, NodeParser {\r\n            id: string;\r\n            label: string;\r\n            parse(context: ParsingContext, node): void {\r\n                this.id = context.parseIdRequired(node);\r\n                this.label = context.parseLabelRequired(node);\r\n            }\r\n            parseFromMos(context: ParsingContext, node: Mos.Tabs | Mos.Groups | Mos.Controls): void {\r\n                this.id = context.parseIdRequiredFromMos(node);\r\n                this.label = context.parseLabelRequiredFromMos(node);\r\n            }\r\n        }\r\n        export class MenuControl extends UIEntityBase implements UIControlNode, UIControl {\r\n            controlType: string;\r\n            children: UIControlNode[];\r\n            icon: {};\r\n            iconResId: {};\r\n            superTip: SuperTip;\r\n            namespace: string;\r\n            labelResId: string;\r\n            constructor(controlType?: string, namespace?: string) {\r\n                super();\r\n                this.controlType = controlType;\r\n                this.namespace = OSF.GetNamespaceOrDefault(namespace);\r\n            }\r\n            apply(context: UIControlBuildingContext): void {\r\n                context.controlBuilder.startBuildMenu(this);\r\n                BuildHelpers.buildControls(context, this.children);\r\n                context.controlBuilder.endBuildMenu();\r\n            }\r\n            parse(context: ParsingContext, node): void {\r\n                if (!context.shouldParseNode(node)) {\r\n                    return;\r\n                }\r\n                super.parse(context, node);\r\n                this.icon = context.parseRequiredIcon(node);\r\n\r\n                if (context.manifest.isForOfficeAppManifest()) {\r\n                    this.iconResId = context.parseIconResId(node);\r\n                }\r\n\r\n                this.superTip = context.parseRequiredSuperTip(node);\r\n                var controls = OSF.SelectChildNodes(context.manifest._xmlProcessor, this.namespace + \"Item\", node, [this.namespace + \"Items\"]);\r\n                if (context.manifest.isForOfficeAppManifest()) {\r\n                    let labelChild: object = null;\r\n                    labelChild = context.manifest._xmlProcessor.selectSingleNode(context.namespace + \"Label\", node);\r\n                    this.labelResId = context.parseResId(labelChild);\r\n                }\r\n                this.children = context.parseControls(controls, (context, node) => {\r\n                    return context.parseMenuItem(node);\r\n                });\r\n            }\r\n            parseFromMos(context: ParsingContext, node: Mos.Controls): void {\r\n                if (!context.shouldParseNodeFromMos(node)) {\r\n                    return;\r\n                }\r\n                super.parseFromMos(context, node);\r\n                this.icon = context.parseRequiredIconFromMos(node);\r\n                this.superTip = context.parseRequiredSupertipFromMos(node);\r\n                const controls: Mos.Controls[] = node.items;\r\n                this.children = context.parseControlsFromMos(controls, (context: ParsingContext, item: Mos.Controls) => {\r\n                    return context.parseMenuItemFromMos(item);\r\n                })\r\n            }\r\n        }\r\n        class ItemControl extends UIEntityBase implements UIControlNode, UIControl {\r\n            controlType: string;\r\n            icon: {};\r\n            iconResId: {};\r\n            superTip: SuperTip;\r\n            action: ExtensionPointAction;\r\n            actionType: string;\r\n            enabled: boolean = true;\r\n            namespace: string;\r\n            labelResId: string;\r\n            constructor(controlType: string, namespace?: string) {\r\n                super();\r\n                this.controlType = controlType;\r\n                this.namespace = OSF.GetNamespaceOrDefault(namespace);\r\n            }\r\n            apply(context: UIControlBuildingContext): void {\r\n                var action = this.action.buildAction(context);\r\n                var control = {\r\n                    id: this.id,\r\n                    label: this.label,\r\n                    icon: this.icon,\r\n                    superTip: this.superTip,\r\n                    actionType: this.actionType,\r\n                    action: action,\r\n                    enabled: this.enabled\r\n                };\r\n                this.applyControl(context, control);\r\n            }\r\n            parse(context: ParsingContext, node): void {\r\n                super.parse(context, node);\r\n                this.icon = this.parseIcon(context, node);\r\n\r\n                if (context.manifest.isForOfficeAppManifest()) {\r\n                    this.iconResId = context.parseIconResId(node);\r\n                }\r\n\r\n                this.superTip = context.parseRequiredSuperTip(node);\r\n                var child = context.manifest._xmlProcessor.selectSingleNode(this.namespace + \"Action\", node);\r\n                CheckValueNotNullNorUndefined(child, \"Action is necessary for itemControl.\");\r\n                var actionType = context.manifest.getNodeXsiType(child);\r\n                var action: ActionBase;\r\n                switch (actionType) {\r\n                    case \"ShowTaskpane\":\r\n                        action = new ShowTaskPaneAction(actionType, this.namespace);\r\n                        break;\r\n                    case \"ExecuteFunction\":\r\n                        var execAction = action = new ExecuteFunctionAction(actionType, this.namespace);\r\n                        execAction.controlId = this.id;\r\n                        break;\r\n                    default:\r\n                        throw new AddInManifestException(\"Unsupported action type.\");\r\n                }\r\n                action.parse(context, child);\r\n                this.actionType = actionType;\r\n                this.action = action;\r\n                var enabledNode = context.manifest._xmlProcessor.selectSingleNode(this.namespace + \"Enabled\", node);\r\n                if (enabledNode != null) {\r\n                    this.enabled = context.manifest._parseBooleanNode(enabledNode);\r\n                }\r\n                if (context.manifest.isForOfficeAppManifest()) {\r\n                    let labelChild: object = null;\r\n                    labelChild = context.manifest._xmlProcessor.selectSingleNode(context.namespace + \"Label\", node);\r\n                    this.labelResId = context.parseResId(labelChild);\r\n                }\r\n            }\r\n            parseFromMos(context: ParsingContext, control: Mos.Controls): void {\r\n                super.parseFromMos(context, control);\r\n                this.icon = this.parseIconFromMos(context, control);\r\n                this.superTip = context.parseRequiredSupertipFromMos(control);\r\n                const child: Mos.Actions = context.manifest.getExtensionActionById(control.actionId);\r\n                CheckValueNotNullNorUndefined(child, \"Parsing from Mos: Action is necessary for itemControl.\");\r\n                const actionType: string = GetActionType(child);\r\n                let action: ActionBase;\r\n                switch (actionType) {\r\n                    case \"ShowTaskpane\":\r\n                        action = new ShowTaskPaneAction(actionType, this.namespace);\r\n                        break;\r\n                    case \"ExecuteFunction\":\r\n                        let execAction: ExecuteFunctionAction = action = new ExecuteFunctionAction(actionType, this.namespace);\r\n                        execAction.controlId = this.id;\r\n                        break;\r\n                    default:\r\n                        throw new AddInManifestException(\"Parsing from Mos: Unsupported action type.\");\r\n                }\r\n                action.parseFromMos(context, child);\r\n                this.actionType = actionType;\r\n                this.action = action;\r\n                this.enabled = control.enabled? control.enabled : true;\r\n            }\r\n            applyControl(context: UIControlBuildingContext, control: UIControlActionable): void {\r\n                throw new AddInInternalException(\"Not implemented method applyControl for ItemControl.\");\r\n            }\r\n            parseIcon(context: ParsingContext, node): {} {\r\n                return context.parseIcon(node);\r\n            }\r\n            parseIconFromMos(context: ParsingContext, node: Mos.Groups | Mos.Controls): {} {\r\n                return context.parseIconFromMos(node);\r\n            }\r\n        }\r\n        class Button extends ItemControl {\r\n            applyControl(context: UIControlBuildingContext, control: UIControlActionable): void {\r\n                context.controlBuilder.addButton(control);\r\n            }\r\n            parseIcon(context: ParsingContext, node): {} {\r\n                return context.parseRequiredIcon(node);\r\n            }\r\n        }\r\n        class MenuItem extends ItemControl {\r\n            constructor(namespace?: string) {\r\n                super(\"MenuItem\", namespace);\r\n            }\r\n            applyControl(context: UIControlBuildingContext, control: UIControlActionable): void {\r\n                context.controlBuilder.addMenuItem(control);\r\n            }\r\n        }\r\n        class OfficeControl extends ItemControl {\r\n            constructor() {\r\n                super('OfficeControl');\r\n                this.label = null;\r\n                this.icon = null;\r\n                this.superTip = null;\r\n                this.actionType = null;\r\n                this.action = null;\r\n                this.enabled = true;\r\n            }\r\n            apply(context: UIControlBuildingContext): void {\r\n                var control = {\r\n                    id: this.id,\r\n                    label: this.label,\r\n                    icon: this.icon,\r\n                    superTip: this.superTip,\r\n                    actionType: this.actionType,\r\n                    action: this.action,\r\n                    enabled: this.enabled\r\n                };\r\n                this.applyControl(context, control);\r\n            }\r\n            parse(context: ParsingContext, node): void {\r\n                try {\r\n                    this.id = context.parseIdRequired(node);\r\n                }\r\n                catch (ex) {\r\n                    throw new AddInManifestException(\"Required id attribute missing for OfficeControl.\");\r\n                }\r\n                if (OSF.RibbonControlIdMap && OSF.RibbonControlIdMap[this.id]) {\r\n                    this.id = OSF.RibbonControlIdMap[this.id];\r\n                }\r\n                else if (!OSF.OUtil.checkFlight(OSF.FlightNames.AddinRibbonIdAllowUnknown)) {\r\n                    throw new AddInManifestException(\"Unsupported control id for OfficeControl.\");\r\n                }\r\n            }\r\n            parseFromMos(context: ParsingContext, control: Mos.Controls): void {\r\n                this.id = control.builtInControlId;\r\n                CheckValueNotNullNorUndefined(this.id, \"Built in control id is required.\");\r\n\r\n                if (OSF.RibbonControlIdMap && OSF.RibbonControlIdMap[this.id]) {\r\n                    this.id = OSF.RibbonControlIdMap[this.id];\r\n                }\r\n                else if (!OSF.OUtil.checkFlight(OSF.FlightNames.AddinRibbonIdAllowUnknown)) {\r\n                    throw new AddInManifestException(\"Unsupported control id for OfficeControl.\");\r\n                }\r\n            }\r\n            applyControl(context: UIControlBuildingContext, control: UIControlActionable): void {\r\n                context.controlBuilder.addNativeControl(control);\r\n            }\r\n        }\r\n        class RibbonTab implements OfficeExt.RibbonTab {\r\n            id: string;\r\n            label: string = null;\r\n            isOfficeTab: boolean = false;\r\n            visible: boolean = true;\r\n            children: RibbonGroup[] = [];\r\n            tabType: string = 'default';\r\n            insertBefore: string = '';\r\n            insertAfter: string = '';\r\n            autoFocus: boolean = false;\r\n            namespace: string;\r\n            constructor(isOfficeTab: boolean, namespace?: string) {\r\n                this.isOfficeTab = isOfficeTab;\r\n                this.namespace = OSF.GetNamespaceOrDefault(namespace);\r\n            }\r\n            apply(context: AddinBuildingContext): void {\r\n                context.builder.ribbonBuilder.startBuildTab(this);\r\n                var len = this.children.length;\r\n                for (var i = 0; i < len; i++) {\r\n                    var child = this.children[i];\r\n                    child.apply(context);\r\n                }\r\n                context.builder.ribbonBuilder.endBuildTab();\r\n            }\r\n            parse(context: ParsingContext, node): void {\r\n                this.id = context.parseIdRequired(node);\r\n                if (!this.isOfficeTab) {\r\n                    this.label = context.parseLabelRequired(node);\r\n                    if (OSF.Settings[\"IsReactRibbonEnabled\"]) {\r\n                        this.insertBefore = context.getSingleNodeValue(this.namespace + \"InsertBefore\", node);\r\n                        this.insertAfter = context.getSingleNodeValue(this.namespace + \"InsertAfter\", node);\r\n                        if (this.insertBefore) {\r\n                            if (this.insertBefore === 'TabHome') {\r\n                                this.autoFocus = true;\r\n                            }\r\n                            context.insertBefore = this.insertBefore;\r\n                        }\r\n                        if (this.insertAfter) {\r\n                            context.insertAfter = this.insertAfter;\r\n                        }\r\n                    }\r\n                }\r\n                if (OSF.Settings[\"IsReactRibbonEnabled\"]) {\r\n                    this.children = context.parseMultipleChildControls([\"Group\", \"OfficeGroup\"], node, (context, node) => {\r\n                        return context.parseGroupUnderTab(node);\r\n                    });\r\n                }\r\n                else {\r\n                    this.children = context.parseMultipleChildControls([\"Group\"], node, (context, node) => {\r\n                        return context.parseGroupUnderTab(node);\r\n                    });\r\n                }\r\n            }\r\n            parseFromMos(context: ParsingContext, tab: Mos.Tabs){\r\n                if (!this.isOfficeTab) {\r\n                    this.id = context.parseIdRequiredFromMos(tab);\r\n                    this.label = context.parseLabelRequiredFromMos(tab);\r\n                    if (OSF.Settings[\"IsReactRibbonEnabled\"]) {\r\n                        const insertPosition: string = tab.position.align;\r\n                        if (insertPosition === \"before\") {\r\n                            this.insertBefore = tab.position.builtInTabId;\r\n                            if (!OSF.OUtil.isNullOrUndefined(this.insertBefore)) {\r\n                                if (this.insertBefore === 'TabHome') {\r\n                                    this.autoFocus = true;\r\n                                }\r\n                                context.insertBefore = this.insertBefore;\r\n                            }\r\n                        }\r\n                        else if (insertPosition === \"after\") {\r\n                            this.insertAfter = tab.position.builtInTabId;\r\n                            if (!OSF.OUtil.isNullOrUndefined(this.insertAfter)) {\r\n                                context.insertAfter = this.insertAfter;\r\n                            }\r\n                        }\r\n                        else {\r\n                            throw new AddInManifestException(\"Unsupported insert position\");\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    this.id = tab.builtInTabId;\r\n                    CheckValueNotNullNorUndefined(this.id, \"Built in tab id is required.\");\r\n                }\r\n                if(OSF.Settings[\"IsReactRibbonEnabled\"]){\r\n                    this.children = context.parseMultipleChildControlsFromMos([\"Group\", \"OfficeGroup\"], tab, (context: ParsingContext, group: Mos.Groups) => {\r\n                        return context.parseGroupUnderTabFromMos(group);\r\n                    });\r\n                }\r\n                else {\r\n                    this.children = context.parseMultipleChildControlsFromMos([\"Group\"], tab, (context: ParsingContext, group: Mos.Groups) => {\r\n                        return context.parseGroupUnderTabFromMos(group);\r\n                    });\r\n                }\r\n            }\r\n        }\r\n        class RibbonGroup extends UIEntityBase {\r\n            icon: {};\r\n            iconResId: {};\r\n            children: UIControlNode[];\r\n            groupType: string = 'Custom';\r\n            hostType: string;\r\n            labelResId: string = null;\r\n\r\n            constructor(hostType: string) {\r\n                super();\r\n                this.hostType = hostType;\r\n            }\r\n            parse(context: ParsingContext, node): void {\r\n                if (!context.shouldParseNode(node)) {\r\n                    return;\r\n                }\r\n                super.parse(context, node);\r\n\r\n                if (context.manifest.isForOfficeAppManifest()) {\r\n                    let labelChild: object = null;\r\n                    labelChild = context.manifest._xmlProcessor.selectSingleNode(context.namespace + \"Label\", node);\r\n                    this.labelResId = context.parseResId(labelChild);\r\n                }\r\n\r\n                if (this.hostType === \"MailHost\") {\r\n                    this.icon = context.parseOptionalIcon(node);\r\n                }\r\n                else {\r\n                    this.icon = context.parseRequiredIcon(node);\r\n                    if(OSF.OUtil.checkFlight(OSF.FlightTreatmentNames.CheckRequiredGroupIconsEnabled)){\r\n                        context.checkRequiredGroupIcons(this.icon);\r\n                    }\r\n                }\r\n\r\n                if (context.manifest.isForOfficeAppManifest()) {\r\n                    this.iconResId = context.parseIconResId(node);\r\n                }\r\n\r\n                if (OSF.Settings[\"IsReactRibbonEnabled\"]) {\r\n                    this.children = context.parseMultipleChildControls([\"Control\", \"OfficeControl\"], node, (context, node) => {\r\n                        return context.parseControlInGroup(node);\r\n                    });\r\n                }\r\n                else {\r\n                    this.children = context.parseMultipleChildControls([\"Control\"], node, (context, node) => {\r\n                        return context.parseControlInGroup(node);\r\n                    });\r\n                }\r\n            }\r\n            parseFromMos(context: ParsingContext, group: Mos.Groups): void {\r\n                if (!context.shouldParseNodeFromMos(group)) {\r\n                    return;\r\n                }\r\n                super.parseFromMos(context, group);\r\n\r\n                if (this.hostType === \"MailHost\") {\r\n                    this.icon = context.parseOptionalIconFromMos(group);\r\n                }\r\n                else {\r\n                    this.icon = context.parseRequiredIconFromMos(group);\r\n                    if(OSF.OUtil.checkFlight(OSF.FlightTreatmentNames.CheckRequiredGroupIconsEnabled)){\r\n                        context.checkRequiredGroupIcons(this.icon);\r\n                    }\r\n                }\r\n\r\n                if (OSF.Settings[\"IsReactRibbonEnabled\"]) {\r\n                    this.children = context.parseMultipleChildControlsFromMos([\"Control\", \"OfficeControl\"], group, (context: ParsingContext, control: Mos.Controls) => {\r\n                        return context.parseControlInGroupFromMos(control);\r\n                    });\r\n                }\r\n                else {\r\n                    this.children = context.parseMultipleChildControlsFromMos([\"Control\"], group, (context: ParsingContext, control: Mos.Controls) => {\r\n                        return context.parseControlInGroupFromMos(control);\r\n                    });\r\n                }\r\n            }\r\n            apply(context: AddinBuildingContext): void {\r\n                context.builder.ribbonBuilder.startBuildGroup(this);\r\n                BuildHelpers.buildControls({\r\n                    functionFile: context.functionFile,\r\n                    actionBuilder: context.builder.actionBuilder,\r\n                    controlBuilder: context.builder.ribbonBuilder\r\n                }, this.children);\r\n                context.builder.ribbonBuilder.endBuildGroup();\r\n            }\r\n        }\r\n        class OfficeGroup extends RibbonGroup {\r\n            mlrId = \"\";\r\n            constructor(hostType: string) {\r\n                super(hostType);\r\n                this.children = null;\r\n                this.label = null;\r\n                this.icon = null;\r\n                this.groupType = 'OfficeGroup';\r\n            }\r\n            parse(context: ParsingContext, node): void {\r\n                try {\r\n                    this.id = context.parseIdRequired(node);\r\n                }\r\n                catch (ex) {\r\n                    throw new AddInManifestException(\"Required id attribute missing for OfficeGroup.\");\r\n                }\r\n                if (OSF.RibbonGroupIdMap && OSF.RibbonGroupIdMap[this.id]) {\r\n                    if (OSF.RibbonGroupIdMapCommonMLR && OSF.RibbonGroupIdMapCommonMLR[this.id]) {\r\n                        this.mlrId = OSF.RibbonGroupIdMapCommonMLR[this.id];\r\n                    }\r\n                    this.id = OSF.RibbonGroupIdMap[this.id];\r\n                }\r\n                else if (!OSF.OUtil.checkFlight(OSF.FlightNames.AddinRibbonIdAllowUnknown)) {\r\n                    throw new AddInManifestException(\"Unsupported id for OfficeGroup.\");\r\n                }\r\n            }\r\n            parseFromMos(context: ParsingContext, group: Mos.Groups): void {\r\n                this.id = group.builtInGroupId;\r\n                CheckValueNotNullNorUndefined(this.id, \"Built in group id is required.\");\r\n\r\n                if (OSF.RibbonGroupIdMap && OSF.RibbonGroupIdMap[this.id]) {\r\n                    if (OSF.RibbonGroupIdMapCommonMLR && OSF.RibbonGroupIdMapCommonMLR[this.id]) {\r\n                        this.mlrId = OSF.RibbonGroupIdMapCommonMLR[this.id];\r\n                    }\r\n                    this.id = OSF.RibbonGroupIdMap[this.id];\r\n                }\r\n                else if (!OSF.OUtil.checkFlight(OSF.FlightNames.AddinRibbonIdAllowUnknown)) {\r\n                    throw new AddInManifestException(\"Unsupported id for OfficeGroup.\");\r\n                }\r\n            }\r\n            apply(context: AddinBuildingContext): void {\r\n                context.builder.ribbonBuilder.addNativeGroup(this);\r\n            }\r\n        }\r\n        class RibbonExtensionPoint implements ExtensionPoint {\r\n            type: string;\r\n            tabs: RibbonTab[];\r\n            namespace: string;\r\n            constructor(type: string, namespace?: string) {\r\n                this.type = type;\r\n                this.tabs = [];\r\n                this.namespace = OSF.GetNamespaceOrDefault(namespace);\r\n            }\r\n            apply(context: AddinBuildingContext): void {\r\n                if (this.type == context.builder.commandSurface) {\r\n                    var len = this.tabs.length;\r\n                    var officeTabCount = 0;\r\n                    var customTabCount = 0;\r\n                    for (var i = 0; i < len; i++) {\r\n                        var tab = this.tabs[i];\r\n                        if (tab.isOfficeTab && officeTabCount < 1) {\r\n                            officeTabCount++;\r\n                        }\r\n                        else if (!tab.isOfficeTab\r\n                            && (customTabCount < 1 || context.multipleCustomTabsEnabled)) {\r\n                            customTabCount++;\r\n                        }\r\n                        else {\r\n                            break;\r\n                        }\r\n                        tab.apply(context);\r\n                    }\r\n                }\r\n            }\r\n            parse(context: ParsingContext, node): void {\r\n                let tabNode = context.manifest._xmlProcessor.selectSingleNode(this.namespace + \"OfficeTab\", node);\r\n                if (tabNode != null) {\r\n                    let tab = new RibbonTab(true, this.namespace);\r\n                    tab.parse(context, tabNode);\r\n                    this.tabs.push(tab);\r\n                }\r\n                // Parse custom tabs\r\n                let tabNodes = context.manifest._xmlProcessor.selectNodes(this.namespace + \"CustomTab\", node);\r\n                if (tabNodes) {\r\n                    let len = tabNodes.length;\r\n                    for (let i = 0; i < len; i++) {\r\n                        tabNode = tabNodes[i];\r\n                        if (tabNode != null) {\r\n                            let tab = new RibbonTab(false, this.namespace);\r\n                            tab.parse(context, tabNode);\r\n                            this.tabs.push(tab);\r\n                        }\r\n                    }\r\n                }\r\n                if (typeof (otel) !== 'undefined' && typeof (otel.sendTelemetryEvent) !== 'undefined') {\r\n                    if (!OSF.OUtil.sendTelemetryEvent(\"Office.Online.Extensibility.Ribbon.OfficeGroupControlCount\",\r\n                           [{ name: \"OfficeControlCount\", int64: context.officeControlCount },\r\n                            { name: \"OfficeGroupCount\", int64: context.officeGroupCount },\r\n                            { name: \"InsertBefore\", string: JSON.stringify(context.insertBefore) },\r\n                            { name: \"InsertAfter\", string: JSON.stringify(context.insertAfter) }])) {\r\n                        otel.sendTelemetryEvent({\r\n                            name: \"Office.Online.Extensibility.Ribbon.OfficeGroupControlCount\",\r\n                            dataFields: [\r\n                               { name: \"OfficeControlCount\", int64: context.officeControlCount },\r\n                               { name: \"OfficeGroupCount\", int64: context.officeGroupCount },\r\n                               { name: \"InsertBefore\", string: JSON.stringify(context.insertBefore) },\r\n                               { name: \"InsertAfter\", string: JSON.stringify(context.insertAfter) }]});\r\n                    }\r\n                }\r\n            }\r\n            parseFromMos(context: ParsingContext, tabs: Mos.Tabs[]): void {\r\n                if (!OSF.OUtil.isNullOrUndefined(tabs)) {\r\n                    for (const tab of tabs) {\r\n                        let newTab: RibbonTab;\r\n                        if (!OSF.OUtil.isNullOrUndefined(tab.builtInTabId)) {\r\n                            newTab = new RibbonTab(true /* officeTab */);\r\n                        }\r\n                        else {\r\n                            newTab = new RibbonTab(false /* customTab */);\r\n                        }\r\n                        newTab.parseFromMos(context, tab);\r\n                        this.tabs.push(newTab);\r\n                    }\r\n                }\r\n                if (typeof (otel) !== 'undefined' && typeof (otel.sendTelemetryEvent) !== 'undefined') {\r\n                    if (!OSF.OUtil.sendTelemetryEvent(\"Office.Online.Extensibility.Ribbon.OfficeGroupControlCount\",\r\n                           [{ name: \"OfficeControlCount\", int64: context.officeControlCount },\r\n                            { name: \"OfficeGroupCount\", int64: context.officeGroupCount },\r\n                            { name: \"InsertBefore\", string: JSON.stringify(context.insertBefore) },\r\n                            { name: \"InsertAfter\", string: JSON.stringify(context.insertAfter) }])) {\r\n                        otel.sendTelemetryEvent({\r\n                            name: \"Office.Online.Extensibility.Ribbon.OfficeGroupControlCount\",\r\n                            dataFields: [\r\n                                { name: \"OfficeControlCount\", int64: context.officeControlCount },\r\n                                { name: \"OfficeGroupCount\", int64: context.officeGroupCount },\r\n                                { name: \"InsertBefore\", string: JSON.stringify(context.insertBefore) },\r\n                                { name: \"InsertAfter\", string: JSON.stringify(context.insertAfter) }]});\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        class OfficeMenuNode implements UIControlNode {\r\n            id: string;\r\n            type: string;\r\n            children: UIControlNode[];\r\n            namespace: string;\r\n            constructor(namespace?: string) {\r\n                this.namespace = OSF.GetNamespaceOrDefault(namespace);\r\n            }\r\n            parse(context: ParsingContext, node): void {\r\n                if (!context.shouldParseNode(node)) {\r\n                    return;\r\n                }\r\n                this.id = context.parseIdRequired(node);\r\n                if (context.manifest.isForOfficeAppManifest()) {\r\n                    this.type = context.parseType(node);\r\n                }\r\n                this.children = context.parseChildControls(this.namespace + \"Control\", node, (context, node) => {\r\n                    return context.parseControlInGroup(node);\r\n                });\r\n            }\r\n            parseFromMos(context: ParsingContext, menu: Mos.Menus): void {\r\n                if (!context.shouldParseNodeFromMos(menu)) {\r\n                    return;\r\n                }\r\n                this.id = context.getContextMenuType(menu);\r\n                this.children = context.parseControlsFromMos(menu.controls, (context: ParsingContext, control: Mos.Controls) => {\r\n                    return context.parseControlInGroupFromMos(control);\r\n                });\r\n            }\r\n            apply(context: UIControlBuildingContext): void {\r\n                context.controlBuilder.startBuildMenu({\r\n                    id: this.id,\r\n                    label: null,\r\n                    superTip: null\r\n                });\r\n                BuildHelpers.buildControls(context, this.children);\r\n                context.controlBuilder.endBuildMenu();\r\n            }\r\n        }\r\n        class ContextMenuExtensionPoint implements ExtensionPoint {\r\n            type: string;\r\n            children: UIControlNode[];\r\n            namespace: string;\r\n            constructor(type: string, namespace?: string) {\r\n                this.type = type;\r\n                this.namespace = OSF.GetNamespaceOrDefault(namespace);\r\n            }\r\n            apply(context: AddinBuildingContext): void {\r\n                if (this.type == context.builder.commandSurface) {\r\n                    BuildHelpers.buildControls({\r\n                        functionFile: context.functionFile,\r\n                        actionBuilder: context.builder.actionBuilder,\r\n                        controlBuilder: context.builder.contextMenuBuilder\r\n                    }, this.children);\r\n                }\r\n            }\r\n            parse(context: ParsingContext, node): void {\r\n                this.children = context.parseChildControls(this.namespace + \"OfficeMenu\", node, (context, node) => {\r\n                    var menu = new OfficeMenuNode(this.namespace);\r\n                    menu.parse(context, node);\r\n                    return menu;\r\n                });\r\n            }\r\n            parseFromMos(context: ParsingContext, contextMenu: Mos.ContextMenus): void {\r\n                this.children = context.parseChildControlsFromMos(\"OfficeMenu\", contextMenu, (context: ParsingContext, menu: Mos.Menus) => {\r\n                    let newMenu: OfficeMenuNode = new OfficeMenuNode();\r\n                    newMenu.parseFromMos(context, menu);\r\n                    return newMenu;\r\n                })\r\n            }\r\n        }\r\n        export class CustomFunctionsExtensionPoint implements ExtensionPoint {\r\n            type: string;\r\n            namespaceResId: string;\r\n            scriptResId: string;\r\n            pageResId: string;\r\n            metadataResId: string;\r\n            constructor(type: string) {\r\n                this.type = type;\r\n            }\r\n            apply(context: AddinBuildingContext): void {\r\n            }\r\n            parse(context: ParsingContext, node): void {\r\n                var namespaceNode = context.manifest._xmlProcessor.selectSingleNode(\"ov:Namespace\", node);\r\n                if (namespaceNode) {\r\n                    this.namespaceResId = namespaceNode.getAttribute(\"resid\");\r\n                }\r\n                var scriptNode = context.manifest._xmlProcessor.selectSingleNode(\"ov:Script\", node);\r\n                if (scriptNode) {\r\n                    this.scriptResId = this._parseSourceLocationResId(context, scriptNode);\r\n                }\r\n                if (!this.scriptResId) {\r\n                    throw new AddInManifestException(\"Missing required <Script> element under element <ExtensionPoint xsi:type='CustomFunctions'>.\");\r\n                }\r\n                var pageNode = context.manifest._xmlProcessor.selectSingleNode(\"ov:Page\", node);\r\n                if (pageNode) {\r\n                    this.pageResId = this._parseSourceLocationResId(context, pageNode);\r\n                }\r\n                if (!this.pageResId) {\r\n                    throw new AddInManifestException(\"Missing required <Page> element under element <ExtensionPoint xsi:type='CustomFunctions'>.\");\r\n                }\r\n                var metadataNode = context.manifest._xmlProcessor.selectSingleNode(\"ov:Metadata\", node);\r\n                if (metadataNode) {\r\n                    this.metadataResId = this._parseSourceLocationResId(context, metadataNode);\r\n                }\r\n                if (!this.metadataResId) {\r\n                    throw new AddInManifestException(\"Missing required <Metadata> element under element <ExtensionPoint xsi:type='CustomFunctions'>.\");\r\n                }\r\n            }\r\n            parseFromMos(context: ParsingContext, node: any): void {\r\n                // TODO: Not Implemented\r\n            }\r\n            _parseSourceLocationResId(context: ParsingContext, node): string {\r\n                var sourceLocationNode = context.manifest._xmlProcessor.selectSingleNode(\"ov:SourceLocation\", node);\r\n                if (sourceLocationNode) {\r\n                    return sourceLocationNode.getAttribute(\"resid\");\r\n                }\r\n                return undefined;\r\n            }\r\n        }\r\n        class AutoRunEvent implements NodeParser {\r\n            type: string;\r\n            functionName: string;\r\n            sendMode: string;\r\n            parse(context: ParsingContext, node): void {\r\n                this.type = node.getAttribute(\"Type\");\r\n                this.functionName = node.getAttribute(\"FunctionName\");\r\n                this.sendMode = node.getAttribute(\"SendMode\");\r\n            }\r\n            parseFromMos(context: ParsingContext, node: any): void {\r\n                // Not Implemented. Outlook is not using our parser.\r\n            }\r\n        }\r\n        class AutoRunExtensionPoint implements ExtensionPoint {\r\n            type: string;\r\n            namespace: string;\r\n            events: AutoRunEvent[];\r\n            resid: string;\r\n            constructor(type: string, namespace?: string) {\r\n                this.type = type;\r\n                this.events = [];\r\n                this.namespace = OSF.GetNamespaceOrDefault(namespace);\r\n            }\r\n            apply(context: AddinBuildingContext): void {\r\n                // Not implemented for now, since it is not needed for the XML-to-JSON manifest converter.\r\n            }\r\n            parse(context: ParsingContext, node): void {\r\n                let launchEventsNode = context.manifest._xmlProcessor.selectSingleNode(this.namespace + \"LaunchEvents\", node);\r\n                if (launchEventsNode == null) {\r\n                    throw new AddInManifestException(\"Missing required <LaunchEvents> element under element <ExtensionPoint xsi:type='LaunchEvent'>.\");\r\n                }\r\n\r\n                let launchEventNodes = context.manifest._xmlProcessor.selectNodes(this.namespace + \"LaunchEvent\", launchEventsNode);\r\n                if (launchEventNodes.length == 0) {\r\n                    throw new AddInManifestException(\"Missing required <LaunchEvent> element under element <LaunchEvents>.\");\r\n                }\r\n\r\n                for (let i = 0; i < launchEventNodes.length; i++) {\r\n                    let event = new AutoRunEvent();\r\n                    event.parse(context, launchEventNodes[i]);\r\n                    this.events.push(event);\r\n                }\r\n\r\n                let sourceLocationNode = context.manifest._xmlProcessor.selectSingleNode(this.namespace + \"SourceLocation\", node);\r\n                if (sourceLocationNode == null) {\r\n                    throw new AddInManifestException(\"Missing required <SourceLocation> element under element <ExtensionPoint xsi:type='LaunchEvent'>.\");\r\n                }\r\n                this.resid = sourceLocationNode.getAttribute(\"resid\");\r\n            }\r\n            parseFromMos(context: ParsingContext, node: any): void {\r\n                // Not Implemented. Outlook is not using our parser.\r\n            }\r\n        }\r\n        export class VersionOverrides implements Addin {\r\n            // Template manifest of all extensions\r\n            private extensionManifest: Manifest;\r\n            private extensionEntitlement: AddinEntitlement;\r\n            type: string;\r\n            description: string;\r\n            getStartedNode: GetStartedNode = null;\r\n            functionFile: string = null;\r\n            functionFileResid: string = null;\r\n            ExtensionPoints: ExtensionPoint[];\r\n            cacheableUrls: Array<string>;\r\n            resources: ManifestResourceManager;\r\n            namespace: string;\r\n            supportsSharedFolders: boolean = false;\r\n\r\n            constructor(namespace?: string) {\r\n                this.cacheableUrls = [];\r\n                this.ExtensionPoints = [];\r\n                this.namespace = OSF.GetNamespaceOrDefault(namespace);\r\n            }\r\n            cacheableResources(): Array<string> {\r\n                return this.cacheableUrls;\r\n            }\r\n            apply(builder: AddinBuilder, errorManager: AddinCommandsErrorManager, multipleCustomTabsEnabled = false): void {\r\n                try {\r\n                    builder.startApplyAddin({\r\n                        entitlement: this.extensionEntitlement,\r\n                        manifest: this.extensionManifest,\r\n                        startedNode: this.getStartedNode,\r\n                        overrides: {\r\n                            type: this.type,\r\n                            description: this.description\r\n                        }\r\n                    });\r\n                    var context = new AddinBuildingContext(this.functionFile, builder, multipleCustomTabsEnabled);\r\n                    var len = this.ExtensionPoints.length;\r\n                    for (var i = 0; i < len; i++) {\r\n                        var ext = this.ExtensionPoints[i];\r\n                        ext.apply(context);\r\n                    }\r\n                    builder.endApplyAddin();\r\n                }\r\n                catch (ex) {\r\n                    if (ex instanceof AddInManifestException) {\r\n                        errorManager.setErrorMessageForAddin(\r\n                            Telemetry.PrivacyRules.GetPrivacyCompliantId(this.extensionEntitlement.solutionId, this.extensionEntitlement.storeType, this.extensionEntitlement.assetId, null, null, this.extensionEntitlement.storeId),\r\n                            Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message);\r\n                    }\r\n                    if (OSF.OUtil.checkFlight(OSF.FlightNames.ManifestParserDevConsoleLog))\r\n                        DevConsole.log(ex);\r\n                    throw ex;\r\n                }\r\n            }\r\n            parse(context: ParsingContext, overridesNode): void {\r\n                this.type = context.manifest.getNodeXsiType(overridesNode);\r\n                var node = context.manifest._xmlProcessor.selectSingleNode(this.namespace + \"Description\", overridesNode);\r\n                if (!OSF.OUtil.isNullOrUndefined(node)) {\r\n                    this.description = context.getLongString(node);\r\n                }\r\n                var hostNodes = OSF.SelectChildNodes(context.manifest._xmlProcessor, this.namespace + \"Host\", overridesNode, [this.namespace + \"Hosts\"]);\r\n                var formFactorNode = null;\r\n                var len = hostNodes.length;\r\n                for (var i = 0; i < len; i++) {\r\n                    var hostNode = hostNodes[i];\r\n                    var hostType = context.manifest.getNodeXsiType(hostNode);\r\n                    if (hostType == context.hostType) {\r\n                        formFactorNode = context.manifest._xmlProcessor.selectSingleNode(this.namespace + context.formFactor, hostNode);\r\n                        if (formFactorNode == null) {\r\n                            formFactorNode = context.manifest._xmlProcessor.selectSingleNode(this.namespace + \"AllFormFactors\", hostNode);\r\n                        }\r\n                        break;\r\n                    }\r\n                }\r\n                var startedNode = context.manifest._xmlProcessor.selectSingleNode(this.namespace + \"GetStarted\", formFactorNode);\r\n                if (!OSF.OUtil.isNullOrUndefined(startedNode)) {\r\n                    this.getStartedNode = new GetStartedNode(this.namespace);\r\n                    this.getStartedNode.parse(context, startedNode);\r\n                }\r\n                node = context.manifest._xmlProcessor.selectSingleNode(this.namespace + \"FunctionFile\", formFactorNode);\r\n                if (!OSF.OUtil.isNullOrUndefined(node)) {\r\n                    this.functionFileResid = node.getAttribute(\"resid\");\r\n                    this.functionFile = context.getUrlResource(node);\r\n                    context.manifest.addManifestUrl(this.functionFile);\r\n                }\r\n                if (context.manifest.isForOfficeAppManifest()) {\r\n                    node = context.manifest._xmlProcessor.selectSingleNode(this.namespace + \"SupportsSharedFolders\", formFactorNode);\r\n                    if (!OSF.OUtil.isNullOrUndefined(node)) {\r\n                        \r\n                        this.supportsSharedFolders = context.manifest._parseBooleanNode(node);\r\n                    }\r\n                }\r\n                var extNodes = context.manifest._xmlProcessor.selectNodes(this.namespace + \"ExtensionPoint\", formFactorNode);\r\n                len = extNodes.length;\r\n                for (var i = 0; i < len; i++) {\r\n                    var extNode = extNodes[i];\r\n                    var extType = context.manifest.getNodeXsiType(extNode);\r\n                    var ext;\r\n                    switch (extType) {\r\n                        case \"Events\":\r\n                            if (context.manifest.isForOfficeAppManifest()) {\r\n                                // Events is unsupported extension type for the xml to json manifest converter, so log an error and skip it\r\n                                console.error('\\x1b[31m%s\\x1b[0m', 'ExtensionPoint type \"Events\" in the XML manifest \"' + context.manifest.getDefaultDisplayName() +\r\n                                    '\" is not supported. Please change the type to \"LaunchEvent\" and then convert it to metaOS manifest.');\r\n                                continue;\r\n                            }\r\n                            throw \"Not Implemented\";\r\n                        case \"PrimaryCommandSurface\":\r\n                            ext = new RibbonExtensionPoint(extType, this.namespace);\r\n                            break;\r\n                        case \"ContextMenu\":\r\n                            ext = new ContextMenuExtensionPoint(extType, this.namespace);\r\n                            break;\r\n                        case \"CustomFunctions\":\r\n                            ext = new CustomFunctionsExtensionPoint(extType);\r\n                            break;\r\n                        case \"LaunchEvent\":\r\n                            ext = new AutoRunExtensionPoint(extType, this.namespace);\r\n                            break;\r\n                        default:\r\n                            if (context.manifest.isForOfficeAppManifest()) {\r\n                                switch (extType) {\r\n                                    case \"MessageReadCommandSurface\":\r\n                                    case \"MessageComposeCommandSurface\":\r\n                                    case \"AppointmentOrganizerCommandSurface\":\r\n                                    case \"AppointmentAttendeeCommandSurface\":\r\n                                    case \"MobileMessageReadCommandSurface\":\r\n                                    case \"MobileMessageComposeCommandSurface\":\r\n                                    case \"MobileAppointmentOrganizerCommandSurface\":\r\n                                    case \"MobileAppointmentAttendeeCommandSurface\":\r\n                                    case \"MobileOnlineMeetingCommandSurface\":\r\n                                    case \"MobileLogEventAppointmentAttendee\":\r\n                                        ext = new RibbonExtensionPoint(extType, this.namespace);\r\n                                        break;\r\n                                    default:\r\n                                        if (!OSF.OUtil.isNullOrUndefined(OSF[\"AppTelemetry\"]) && !OSF.OUtil.isNullOrUndefined(OSF[\"AppTelemetry\"].logAppCommonMessage)) {\r\n                                            OSF[\"AppTelemetry\"].logAppCommonMessage(\"Ignoring unsupported extension point type: \" + extType);\r\n                                        }\r\n                                        continue;\r\n                                }\r\n                            }\r\n                            else {\r\n                                throw new AddInManifestException(\"Unsupported extension type.\");\r\n                            }\r\n                    }\r\n\r\n                    ext.parse(context, extNode);\r\n                    this.ExtensionPoints.push(ext);\r\n                }\r\n                // Cacheable resources\r\n                var images = context.resources.Images;\r\n                for (var e in images) {\r\n                    this.cacheableUrls.push(images[e]);\r\n                }\r\n                this.extensionEntitlement = context.entitlement;\r\n                this.extensionManifest = context.manifest;\r\n                this.resources = context.resources;\r\n            }\r\n            parseFromMos(context: ParsingContext) {\r\n                let description: string = context.manifest.getDescription();\r\n                if (!OSF.OUtil.isNullOrUndefined(description)) {\r\n                    this.description = description;\r\n                }\r\n                const getStartedMessage: Mos.GetStartedMessages = context.manifest.getExtensionGetStartedMessage();\r\n                if (!OSF.OUtil.isNullOrUndefined(getStartedMessage)) {\r\n                    this.getStartedNode = new GetStartedNode(this.namespace);\r\n                    this.getStartedNode.parseFromMos(context, getStartedMessage);\r\n                }\r\n\r\n                const runtimes: Mos.Runtimes[] = context.manifest.getExtensionRuntimes();\r\n                for (const runtime of runtimes) {\r\n                    if (!Mos.AppMetadata.isLegacyRuntime(runtime)) {\r\n                        this.functionFile = runtime.code.page;\r\n                        this.functionFileResid = runtime.id;\r\n                        break;\r\n                    }\r\n                }\r\n\r\n                const ribbon: Mos.Ribbons = context.manifest.getExtensionRibbon();\r\n                if (!OSF.OUtil.isNullOrUndefined(ribbon)) {\r\n                    let primaryExtension: RibbonExtensionPoint = new RibbonExtensionPoint(\"PrimaryCommandSurface\");\r\n                    primaryExtension.parseFromMos(context, ribbon.tabs);\r\n                    this.ExtensionPoints.push(primaryExtension);\r\n                }\r\n\r\n                const contextMenu: Mos.ContextMenus = context.manifest.getExtensionContextMenu();\r\n                if (!OSF.OUtil.isNullOrUndefined(contextMenu)) {\r\n                    let contextMenuExtension: ContextMenuExtensionPoint = new ContextMenuExtensionPoint(\"ContextMenu\");\r\n                    contextMenuExtension.parseFromMos(context, contextMenu);\r\n                    this.ExtensionPoints.push(contextMenuExtension);\r\n                }\r\n\r\n                // TODO: parseFromMos CustomFunciton\r\n\r\n                let images: {} = context.resources.Images;\r\n                for (let e in images) {\r\n                    this.cacheableUrls.push(images[e]);\r\n                }\r\n                this.extensionEntitlement = context.entitlement;\r\n                this.extensionManifest = context.manifest;\r\n            }\r\n        }\r\n        class emptyAddin implements Addin {\r\n            cacheableResources(): Array<string> {\r\n                // No resources\r\n                return [];\r\n            }\r\n            apply(builder: AddinBuilder, errorManager: AddinCommandsErrorManager): void {\r\n                // No extension\r\n            }\r\n        }\r\n        export class AddinCommandsManifestParser {\r\n            hostType: string;\r\n            formFactor: string;\r\n            namespace: string;\r\n            constructor(hostType, formFactor, namespace?: string) {\r\n                this.hostType = hostType;\r\n                this.formFactor = formFactor;\r\n                this.namespace = OSF.GetNamespaceOrDefault(namespace);\r\n            }\r\n            parseExtensions(entitlement: AddinEntitlement, manifest: Manifest, errorManager: AddinCommandsErrorManager, versionOverridesNumber?: OSF.VersionOverridesNumber): Addin {\r\n                try {\r\n                    if (manifest.getPayloadType() === OSF.PayloadType.MosAcquisition) {\r\n                        let versionOverrides: VersionOverrides = new VersionOverrides();\r\n                        versionOverrides.parseFromMos(new ParsingContext(this.hostType, this.formFactor, entitlement, manifest));\r\n                        return versionOverrides;\r\n                    }\r\n                    else {\r\n                        var officeAppNode = manifest._xmlProcessor.selectSingleNode(\"o:OfficeApp\");\r\n                        var overridesNode = manifest._xmlProcessor.selectSingleNode(this.namespace + \"VersionOverrides\", officeAppNode);\r\n                        if (OSF.OUtil.isNullOrUndefined(overridesNode)) {\r\n                            return new emptyAddin();\r\n                        }\r\n    \r\n                        if (manifest.isForOfficeAppManifest()) {\r\n                            // As Outlook has two versionOverrides we need to parse 1_0 and 1_1 based on versionOverridesNumber\r\n                            if (this.hostType === \"MailHost\" && versionOverridesNumber) {\r\n                                let versionOverridesNodePath: string[] = OSF.GetVersionOverridesPath(manifest._xmlProcessor, this.namespace, versionOverridesNumber);\r\n                                let versionOverridesNodeTemp: any = OSF.SelectSingleNode(manifest._xmlProcessor, officeAppNode, versionOverridesNodePath, true /*isStrictPath*/);\r\n                                let versionOverridesType: string = manifest.getNodeXsiType(versionOverridesNodeTemp);\r\n                                let versionOverridesString: string = OSF.GetVersionOverridesString(versionOverridesNumber);\r\n                                if (versionOverridesType === versionOverridesString) {\r\n                                    overridesNode = versionOverridesNodeTemp;\r\n                                }\r\n                            }\r\n                        }\r\n\r\n                        let context: ParsingContext = new ParsingContext(this.hostType, this.formFactor, entitlement, manifest, this.namespace, versionOverridesNumber);\r\n                        let ns: string = OSF.GetVersionOverridesNamespace(this.namespace, versionOverridesNumber);\r\n                        var versionOverrides = new VersionOverrides(ns);\r\n                        // ParsingContext needs 'this.namespace' to load the resources in its constructor. It then needs to use 'ns' for parsing.\r\n                        context.namespace = ns;\r\n                        versionOverrides.parse(context, overridesNode);\r\n                        return versionOverrides;\r\n                    }\r\n                }\r\n                catch (ex) {\r\n                    if (ex instanceof AddInManifestException) {\r\n                        errorManager.setErrorMessageForAddin(\r\n                            Telemetry.PrivacyRules.GetPrivacyCompliantId(entitlement.solutionId, entitlement.storeType, entitlement.assetId, null, null, entitlement.storeId),\r\n                            Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message);\r\n                    }\r\n                    if (OSF.OUtil.checkFlight(OSF.FlightNames.ManifestParserDevConsoleLog))\r\n                        DevConsole.log(ex);\r\n                    throw ex;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}","// The defination of RuntimeLifeTime must be syncd up with defination in SharedRuntime.cs.\r\nenum RuntimeLifeTime {\r\n    Short = 0,\r\n    Long\r\n}\r\nnamespace OSF {\r\n    export namespace Manifest {\r\n        export class RuntimeOverride {\r\n            Resid: string;\r\n            Type: string;\r\n        }\r\n        export let Runtime = function OSF_Manifest_Runtime() {\r\n            this.Resid = null;\r\n            this.LifeTime = RuntimeLifeTime.Short;\r\n            this.Overrides = [] as RuntimeOverride[];\r\n        };\r\n        export class HostApp {\r\n            _appName: any;\r\n            _minVersion: any;\r\n            constructor(appName) {\r\n                this._appName = appName;\r\n                this._minVersion = null;\r\n            }\r\n            getAppName() {\r\n                return this._appName;\r\n            }\r\n            getMinVersion() {\r\n                return this._minVersion;\r\n            }\r\n            _setMinVersion(minVersion) {\r\n                this._minVersion = minVersion;\r\n            }\r\n        }\r\n        export class ExtensionSettings {\r\n            _defaultHeight: any;\r\n            _defaultWidth: any;\r\n            _sourceLocations: any;\r\n            constructor() {\r\n                this._sourceLocations = {};\r\n                this._defaultHeight = null;\r\n                this._defaultWidth = null;\r\n            }\r\n            getDefaultHeight() {\r\n                return this._defaultHeight;\r\n            }\r\n            getDefaultWidth() {\r\n                return this._defaultWidth;\r\n            }\r\n            getSourceLocations() {\r\n                return this._sourceLocations;\r\n            }\r\n            _addSourceLocation(locale, value) {\r\n                this._sourceLocations[locale.toLocaleLowerCase()] = value;\r\n            }\r\n            _setDefaultWidth(defaultWidth) {\r\n                this._defaultWidth = defaultWidth;\r\n            }\r\n            _setDefaultHeight(defaultHeight) {\r\n                this._defaultHeight = defaultHeight;\r\n            }\r\n        }\r\n        export class WebAppInfoAuthorization {\r\n            _resource: any;\r\n            _scopes: any;\r\n            constructor() {\r\n                this._resource = null;\r\n                this._scopes = null;\r\n            }\r\n            getResource() {\r\n                return this._resource;\r\n            }\r\n            getScopes() {\r\n                return this._scopes;\r\n            }\r\n        }\r\n        export class EquivalentAddins {\r\n            _equivalentAddins: any;\r\n            constructor() { this._equivalentAddins = []; }\r\n            isXLLCompatible() {\r\n                for (var i = 0; i < this._equivalentAddins.length; i++) {\r\n                    if ((this._equivalentAddins[i]).isXLLCompatible()) {\r\n                        return true;\r\n                    }\r\n                }\r\n                return false;\r\n            }\r\n            add(equivalentAddin) {\r\n                this._equivalentAddins.push(equivalentAddin);\r\n            }\r\n            getEquivalentAddins() {\r\n                return this._equivalentAddins;\r\n            }\r\n        }\r\n        export class EquivalentAddin {\r\n            _progId: any;\r\n            _displayName: any;\r\n            _fileName: any;\r\n            _type: any;\r\n            constructor() {\r\n                this._progId = null;\r\n                this._displayName = null;\r\n                this._fileName = null;\r\n                this._type = null;\r\n            }\r\n            getProgId() {\r\n                return this._progId;\r\n            }\r\n            getDisplayName() {\r\n                return this._displayName;\r\n            }\r\n            getFileName() {\r\n                return this._fileName;\r\n            }\r\n            getType() {\r\n                return this._type;\r\n            }\r\n            isXLLCompatible() {\r\n                return this._type == \"XLL\";\r\n            }\r\n            isComAddin() {\r\n                return this._type == \"COM\";\r\n            }\r\n        }\r\n        export class Runtimes {\r\n            _runtimes: any;\r\n            constructor() { this._runtimes = []; }\r\n            getSharedRuntime(resid) {\r\n                if (resid == null || this._runtimes == null) {\r\n                    return null;\r\n                }\r\n                for (var i = 0; i < this._runtimes.length; i++) {\r\n                    if (this._runtimes[i] != null && this._runtimes[i].Resid === resid) {\r\n                        return this._runtimes[i];\r\n                    }\r\n                }\r\n                return null;\r\n            }\r\n            add(runtime) {\r\n                if (runtime == null || this._runtimes == null) {\r\n                    return;\r\n                }\r\n                // Check if this._runtimes already contains item with same resid.\r\n                if (this.getSharedRuntime(runtime.Resid) != null) {\r\n                    throw OsfMsAjaxFactory.msAjaxError.argument(\"Manifest parser failure: cannot have same Resid for different runtime.\");\r\n                }\r\n                this._runtimes.push(runtime);\r\n            }\r\n            getRuntimes() {\r\n                return this._runtimes;\r\n            }\r\n        }\r\n        export class Manifest {\r\n            _UILocale: any;\r\n            _allowSnapshot: any;\r\n            _alternateId: any;\r\n            _appDomains: any;\r\n            _capabilities: any;\r\n            _defaultLocale: any;\r\n            _descriptions: any;\r\n            _displayNames: any;\r\n            _equivalentAddins: any;\r\n            _extendedOverrides: any;\r\n            _extendedOverridesTokens: any;\r\n            _extensionSettings: any;\r\n            _highResolutionIconUrls: any;\r\n            _hosts: any;\r\n            _hostsXml: any;\r\n            _iconUrls: any;\r\n            _supportUrls: any;\r\n            _id: any;\r\n            _idIssuer: any;\r\n            _inMemoryEToken: any;\r\n            _manifestSchemaVersion: any;\r\n            _manifestSourceLocationOverrides: any;\r\n            _permissions: any;\r\n            _providerName: any;\r\n            _requirements: any;\r\n            _requirementsXml: any;\r\n            _ribbonExtensionControls: any;\r\n            _signature: any;\r\n            _target: any;\r\n            _version: any;\r\n            _versionOverrides: any;\r\n            _webApplicationAuthorizations: any;\r\n            _webApplicationId: any;\r\n            _webApplicationMsaId: any;\r\n            _webApplicationResource: any;\r\n            _webApplicationScopes: any;\r\n            _xmlProcessor: any;\r\n            _localesSeen: any;\r\n            _payloadType: OSF.PayloadType;\r\n            _solutionRef?: OfficeExt.OsfSolutionReference;\r\n\r\n            /// <summary>\r\n            /// representing the Osf Control manifest\r\n            /// </summary>\r\n            /// <param name=\"para\">manifest XML (type: string)</param>\r\n            /// <param name=\"uiLocale\">UI locale (type: string)</param>\r\n            constructor(para, uiLocale, payloadType?, solutionReference?) {\r\n                this._UILocale = uiLocale || \"en-us\";\r\n                if (!OSF.OUtil.isNullOrUndefined(solutionReference)) {\r\n                    this._solutionRef = solutionReference;\r\n                }\r\n                if (payloadType && payloadType === PayloadType.MosAcquisition) {\r\n                    this._payloadType = PayloadType.MosAcquisition;\r\n                }\r\n                else {\r\n                    this._payloadType = PayloadType.OfficeAddin;\r\n                    if (typeof (para) !== 'string') {\r\n                        para(this);\r\n                        return;\r\n                    }\r\n                    this._displayNames = {};\r\n                    this._descriptions = {};\r\n                    this._iconUrls = {};\r\n                    this._supportUrls = {};\r\n                    this._extensionSettings = {};\r\n                    this._highResolutionIconUrls = {};\r\n                    this._versionOverrides = {};\r\n                    this._ribbonExtensionControls = {};\r\n                    this._localesSeen = {};\r\n                    var versionSpecificDelegate;\r\n                    // Find manifest version\r\n                    this._xmlProcessor = new OSF.XmlProcessor(para, OSF.ManifestNamespaces[\"1.1\"]);\r\n                    if (this._xmlProcessor.selectSingleNode(\"o:OfficeApp\")) {\r\n                        versionSpecificDelegate = OSF_Manifest_Manifest_Manifest1_1;\r\n                        this._manifestSchemaVersion = OSF.ManifestSchemaVersion[\"1.1\"];\r\n                    }\r\n                    else {\r\n                        this._xmlProcessor = new OSF.XmlProcessor(para, OSF.ManifestNamespaces[\"1.0\"]);\r\n                        versionSpecificDelegate = OSF_Manifest_Manifest_Manifest1_0;\r\n                        this._manifestSchemaVersion = OSF.ManifestSchemaVersion[\"1.0\"];\r\n                    }\r\n                    var node = this._xmlProcessor.getDocumentElement();\r\n                    this._target = OSF.OUtil.parseEnum(this.getNodeXsiType(node), OSF.OfficeAppType);\r\n                    var officeAppNode = this._xmlProcessor.selectSingleNode(\"o:OfficeApp\");\r\n                    node = this._xmlProcessor.selectSingleNode(\"o:Id\", officeAppNode);\r\n                    this._id = this._xmlProcessor.getNodeValue(node);\r\n                    if (this.isForOfficeAppManifest()) {\r\n                        this._id = this._id.replace(/\\{|\\}/gi, '');\r\n                    }\r\n                    var guidRegex = new RegExp('^[a-f0-9]{8}(-[a-f0-9]{4}){3}-[a-f0-9]{12}$', 'i');\r\n                    if (!guidRegex.test(this._id)) {\r\n                        throw OsfMsAjaxFactory.msAjaxError.argument(\"Manifest\");\r\n                    }\r\n                    node = this._xmlProcessor.selectSingleNode(\"o:Version\", officeAppNode);\r\n                    // Do not allow any new failures here!\r\n                    try {\r\n                        this._version = this.complementVersion(this._xmlProcessor.getNodeValue(node));\r\n                    }\r\n                    catch {\r\n                        this._version = this._xmlProcessor.getNodeValue(node);\r\n                    }\r\n                    node = this._xmlProcessor.selectSingleNode(\"o:ProviderName\", officeAppNode);\r\n                    this._providerName = this._xmlProcessor.getNodeValue(node);\r\n                    node = this._xmlProcessor.selectSingleNode(\"o:IdIssuer\", officeAppNode);\r\n                    this._idIssuer = this._parseIdIssuer(node);\r\n                    node = this._xmlProcessor.selectSingleNode(\"o:AlternateId\", officeAppNode);\r\n                    if (node) {\r\n                        this._alternateId = this._xmlProcessor.getNodeValue(node);\r\n                    }\r\n                    node = this._xmlProcessor.selectSingleNode(\"o:DefaultLocale\", officeAppNode);\r\n                    this._defaultLocale = this._xmlProcessor.getNodeValue(node);\r\n                    node = this._xmlProcessor.selectSingleNode(\"o:DisplayName\", officeAppNode);\r\n                    this._parseLocaleAwareSettings(node, Function.createDelegate(this, this._addDisplayName));\r\n                    node = this._xmlProcessor.selectSingleNode(\"o:Description\", officeAppNode);\r\n                    this._parseLocaleAwareSettings(node, Function.createDelegate(this, this._addDescription));\r\n                    node = this._xmlProcessor.selectSingleNode(\"o:AppDomains\", officeAppNode);\r\n                    this._appDomains = this._parseAppDomains(node);\r\n                    node = this._xmlProcessor.selectSingleNode(\"o:IconUrl\", officeAppNode);\r\n                    if (node) {\r\n                        this._parseLocaleAwareSettings(node, Function.createDelegate(this, this._addIconUrl));\r\n                    }\r\n                    if (this.isForOfficeAppManifest()) {\r\n                        node = this._xmlProcessor.selectSingleNode(\"o:SupportUrl\", officeAppNode);\r\n                        if (node) {\r\n                            this._parseLocaleAwareSettings(node, Function.createDelegate(this, this._addSupportUrl));\r\n                        }\r\n                    }\r\n                    node = this._xmlProcessor.selectSingleNode(\"o:Signature\", officeAppNode);\r\n                    if (node) {\r\n                        this._signature = this._xmlProcessor.getNodeValue(node);\r\n                    }\r\n                    this._parseExtensionSettings();\r\n                    node = this._xmlProcessor.selectSingleNode(\"o:Permissions\", officeAppNode);\r\n                    this._permissions = this._parsePermission(node);\r\n                    // Taking snapshot is allowed by default\r\n                    this._allowSnapshot = true;\r\n                    node = this._xmlProcessor.selectSingleNode(\"o:AllowSnapshot\", officeAppNode);\r\n                    if (node) {\r\n                        this._allowSnapshot = this._parseBooleanNode(node);\r\n                    }\r\n                    if (this._manifestSchemaVersion === OSF.ManifestSchemaVersion[\"1.1\"] && this._target !== OSF.OfficeAppType.MailApp) {\r\n                        var nodeNamespace = \"ov:\";\r\n                        if (this._target == OSF.OfficeAppType.ContentApp) {\r\n                            nodeNamespace = \"c:\";\r\n                        }\r\n                        node = this._xmlProcessor.selectSingleNode(nodeNamespace + \"VersionOverrides\", officeAppNode);\r\n                        if (node) {\r\n                            this._parseWebApplicationInfo(this, node, nodeNamespace);\r\n                        }\r\n                    }\r\n                    // Com2Web equivalent addin info\r\n                    if (this._manifestSchemaVersion === OSF.ManifestSchemaVersion[\"1.1\"] && this._target == OSF.OfficeAppType.TaskPaneApp) {\r\n                        var nodeNamespace = \"ov:\";\r\n                        node = this._xmlProcessor.selectSingleNode(nodeNamespace + \"VersionOverrides\", officeAppNode);\r\n                        if (node) {\r\n                            var equivalentAddinsNode = this._xmlProcessor.selectSingleNode(nodeNamespace + \"EquivalentAddins\", node);\r\n                            this._equivalentAddins = this._parseEquivalentAddins(equivalentAddinsNode, nodeNamespace);\r\n                        }\r\n                    }\r\n                    // Parsing the sourceLocation overrides for 1st party add-ins.\r\n                    if (this._manifestSchemaVersion === OSF.ManifestSchemaVersion[\"1.1\"]) {\r\n                        var versionOverridesNode = this._xmlProcessor.selectSingleNode(\"ov:VersionOverrides\", officeAppNode);\r\n                        if (versionOverridesNode) {\r\n                            this._manifestSourceLocationOverrides = this._parseSourceLocationOverrides(versionOverridesNode);\r\n                        }\r\n                    }\r\n                    if (this._manifestSchemaVersion === OSF.ManifestSchemaVersion[\"1.1\"] && this._target == OSF.OfficeAppType.TaskPaneApp) {\r\n                        var extendedOverridesNode = this._xmlProcessor.selectSingleNode(\"o:ExtendedOverrides\", officeAppNode);\r\n                        if (extendedOverridesNode != null) {\r\n                            this._parseExtendedOverrides(extendedOverridesNode);\r\n                        }\r\n                        var versionOverridesNode = this._xmlProcessor.selectSingleNode(\"ov:VersionOverrides\", officeAppNode);\r\n                        if (versionOverridesNode !== null) {\r\n                            var hostsNode = this._xmlProcessor.selectSingleNode(\"ov:Hosts\", versionOverridesNode);\r\n                            if (hostsNode !== null) {\r\n                                var hostNodes = this._xmlProcessor.selectNodes(\"ov:Host\", hostsNode);\r\n                                if (hostNodes !== null) {\r\n                                    var len = hostNodes.length;\r\n                                    for (var i = 0; i < len; i++) {\r\n                                        var hostType = this.getNodeXsiType(hostNodes[i]);\r\n                                        // For now, we only support shared runtime feature on word, excel and PPT hosts.\r\n                                        if (hostType !== \"Document\" && hostType !== \"Workbook\" && hostType !== \"Presentation\") {\r\n                                            continue;\r\n                                        }\r\n                                        this._versionOverrides[hostType] = {};\r\n                                        var runtimesNode = this._xmlProcessor.selectSingleNode(\"ov:Runtimes\", hostNodes[i]);\r\n                                        if (runtimesNode) {\r\n                                            // Parse runtimes.\r\n                                            this._versionOverrides[hostType]._runtimes = this._parseRuntimes(runtimesNode);\r\n                                        }\r\n\r\n                                        // Parse add-in commands and cache it.\r\n                                        var addinCommandsParser = new OfficeExt.Parser.AddinCommandsManifestParser(hostType, \"DesktopFormFactor\");\r\n                                        var customFunctionParser = new OfficeExt.Parser.AddinCommandsManifestParser(hostType, \"AllFormFactors\");\r\n                                        var errorManager = {\r\n                                            \"setErrorMessageForAddin\": (errorMessage) => {\r\n                                                OsfMsAjaxFactory.msAjaxDebug.trace(\"Error parsing app manifest: \" + errorMessage);\r\n                                            }\r\n                                        };\r\n\r\n                                        let entitlement: OfficeExt.AddinEntitlement;\r\n                                        if (OSF.OUtil.isChangeGateEnabled('OfficeVSO:0_ParseExtensionSolutionReference')) {\r\n                                            entitlement = this._getEntitlement(this._solutionRef);\r\n                                        }\r\n                                        else {\r\n                                            entitlement = {\r\n                                                solutionId : this._id,\r\n                                                version : this._version,\r\n                                                storeType : null,\r\n                                                storeId: null,\r\n                                                assetId: null,\r\n                                                assetStoreId : null,\r\n                                                targetType: null,\r\n                                            };\r\n                                        }\r\n                                        var addinCommands = (addinCommandsParser.parseExtensions(entitlement, this as any, errorManager)) as OfficeExt.Parser.VersionOverrides;\r\n                                        var customFunction = (customFunctionParser.parseExtensions(entitlement, this as any, errorManager)) as OfficeExt.Parser.VersionOverrides;\r\n                                        this._versionOverrides[hostType]._addinCommandsExtensionPoints = addinCommands.ExtensionPoints;\r\n                                        this._versionOverrides[hostType]._functionFileResid = addinCommands.functionFileResid;\r\n                                        this._versionOverrides[hostType]._customFunctionExtensionPoint = customFunction.ExtensionPoints[0];\r\n                                        this._versionOverrides[hostType]._showTaskpaneControls = this._retrieveAppCommandShowTaskpaneControls(hostType);\r\n                                        if (this.isForOfficeAppManifest()) {\r\n                                            this._versionOverrides[hostType]._getStartedNode = addinCommands.getStartedNode;\r\n                                            this._versionOverrides[hostType]._resources = addinCommands.resources;\r\n                                        }\r\n                                        // validate if taskpaneid and runtime resid pair of show taskpane control is valid or not.\r\n                                        this._validateShowTaskpaneSharedRuntime(hostType);\r\n                                        this._generateRibbonExtensionControlMap(hostType);\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    versionSpecificDelegate.apply(this);\r\n                }\r\n\r\n                function OSF_Manifest_Manifest_Manifest1_0() {\r\n                    var node = this._xmlProcessor.selectSingleNode(\"o:Capabilities\", officeAppNode);\r\n                    var nodes = this._xmlProcessor.selectNodes(\"o:Capability\", node);\r\n                    this._capabilities = this._parseCapabilities(nodes);\r\n                }\r\n                function OSF_Manifest_Manifest_Manifest1_1() {\r\n                    var node = this._xmlProcessor.selectSingleNode(\"o:Hosts\", officeAppNode);\r\n                    this._hosts = this._parseHosts(node);\r\n                    if (node) {\r\n                        // The xml property is supported by IE while outerHTML works with Chrome\r\n                        this._hostsXml = node.xml || node.outerHTML;\r\n                    }\r\n                    node = this._xmlProcessor.selectSingleNode(\"o:Requirements\", officeAppNode);\r\n                    this._requirements = this._parseRequirements(node);\r\n                    if (node) {\r\n                        // The xml property is supported by IE while outerHTML works with Chrome\r\n                        this._requirementsXml = node.xml || node.outerHTML;\r\n                    }\r\n                    node = this._xmlProcessor.selectSingleNode(\"o:HighResolutionIconUrl\", officeAppNode);\r\n                    if (node) {\r\n                        this._parseLocaleAwareSettings(node, Function.createDelegate(this, this._addHighResolutionIconUrl));\r\n                    }\r\n                }\r\n            }\r\n\r\n            getNodeXsiType(node): string {\r\n                if (OSF.OUtil.isChangeGateEnabled('OfficeVSO:0_FixManifestXsiTypeNamespace')) {\r\n                    let nsMapping = this._xmlProcessor.getNamespaceMapping();\r\n                    let ns = OSF.OUtil.isNullOrUndefined(nsMapping) ? null : nsMapping[\"xsi\"];\r\n                    if (!OSF.OUtil.isNullOrUndefined(ns)) {\r\n                        return node.getAttributeNS(ns, \"type\");\r\n                    }\r\n                }\r\n                return node.getAttribute(\"xsi:type\");\r\n            }\r\n            getSourceLocationOverrideByResourceId(resourceId) {\r\n                if (resourceId && this._manifestSourceLocationOverrides) {\r\n                    return this._manifestSourceLocationOverrides[resourceId];\r\n                }\r\n                return null;\r\n            }\r\n            getManifestSchemaVersion() {\r\n                return this._manifestSchemaVersion;\r\n            }\r\n            getMarketplaceID() {\r\n                return this._id;\r\n            }\r\n            getMarketplaceVersion() {\r\n                return this._version;\r\n            }\r\n            getDefaultLocale() {\r\n                return this._defaultLocale;\r\n            }\r\n            getLocale() {\r\n                return this._UILocale;\r\n            }\r\n            getProviderName() {\r\n                return this._providerName;\r\n            }\r\n            getIdIssuer() {\r\n                return this._idIssuer;\r\n            }\r\n            getAlternateId() {\r\n                return this._alternateId;\r\n            }\r\n            getSignature() {\r\n                return this._signature;\r\n            }\r\n            getCapabilities() {\r\n                return this._capabilities;\r\n            }\r\n            getDisplayName(locale) {\r\n                return this._displayNames[locale.toLocaleLowerCase()];\r\n            }\r\n            getDefaultDisplayName() {\r\n                return this._getDefaultValue(this._displayNames);\r\n            }\r\n            getDescription(locale) {\r\n                locale = this._fixLocaleCasing(locale);\r\n                return this._descriptions[locale];\r\n            }\r\n            getDefaultDescription() {\r\n                return this._getDefaultValue(this._descriptions);\r\n            }\r\n            getIconUrl(locale) {\r\n                locale = this._fixLocaleCasing(locale);\r\n                return this._iconUrls[locale];\r\n            }\r\n            getDefaultIconUrl() {\r\n                return this._getDefaultValue(this._iconUrls);\r\n            }\r\n            getSupportUrl(locale) {\r\n                locale = this._fixLocaleCasing(locale);\r\n                return this._supportUrls[locale];\r\n            }\r\n            getDefaultSupportUrl() {\r\n                return this._getDefaultValue(this._supportUrls);\r\n            }\r\n            getSourceLocation(locale, formFactor) {\r\n                var extensionSetting = this._getExtensionSetting(formFactor);\r\n                var sourceLocations = extensionSetting.getSourceLocations();\r\n                return sourceLocations[locale.toLocaleLowerCase()];\r\n            }\r\n            getDefaultSourceLocation(formFactor) {\r\n                var extensionSetting = this._getExtensionSetting(formFactor);\r\n                var sourceLocations = extensionSetting.getSourceLocations();\r\n                return this._getDefaultValue(sourceLocations);\r\n            }\r\n            getDefaultWidth(formFactor?) {\r\n                var extensionSetting = this._getExtensionSetting(formFactor);\r\n                return extensionSetting.getDefaultWidth();\r\n            }\r\n            getDefaultHeight(formFactor?) {\r\n                var extensionSetting = this._getExtensionSetting(formFactor);\r\n                return extensionSetting.getDefaultHeight();\r\n            }\r\n            getTarget() {\r\n                return this._target;\r\n            }\r\n            getOmexTargetCode() {\r\n                switch (this._target) {\r\n                    case OSF.OfficeAppType.ContentApp:\r\n                        return 2;\r\n                    case OSF.OfficeAppType.TaskPaneApp:\r\n                        return 1;\r\n                    case OSF.OfficeAppType.MailApp:\r\n                        return 3;\r\n                    default:\r\n                        return 0;\r\n                }\r\n            }\r\n            getPermission() {\r\n                return this._permissions;\r\n            }\r\n            hasPermission(permissionNeeded) {\r\n                return (this._permissions & permissionNeeded) === permissionNeeded;\r\n            }\r\n            getHosts() {\r\n                return this._hosts;\r\n            }\r\n            getHostsXml() {\r\n                return this._hostsXml;\r\n            }\r\n            getPayloadType() {\r\n                return this._payloadType;\r\n            }\r\n\r\n            /// <summary>\r\n            /// get the app's requirements\r\n            /// </summary>\r\n            /// <accessibility>public</accessibility>\r\n            /// <returns>\r\n            /// an object with two properties:\r\n            /// sets: array of objects with 2 properties each {name, version}\r\n            /// methods: array of strings, each representing a method\r\n            /// if manifest does not support requirements, undefined is returned.\r\n            /// </returns>\r\n            getRequirements() {\r\n                return this._requirements;\r\n            }\r\n\r\n            /// <summary>\r\n            /// get the requirements that the app requires\r\n            /// </summary>\r\n            /// <accessibility>public</accessibility>\r\n            /// <returns>\r\n            /// an object with two properties:\r\n            /// sets: array of objects with 2 properties each {name, version}\r\n            /// methods: array of strings, each representing a method\r\n            /// if manifest does not support requirements, undefined is returned.\r\n            /// </returns>\r\n            getRequirementsXml() {\r\n                return this._requirementsXml;\r\n            }\r\n            getHighResolutionIconUrl(locale) {\r\n                locale = this._fixLocaleCasing(locale);\r\n                return this._highResolutionIconUrls[locale];\r\n            }\r\n            getDefaultHighResolutionIconUrl() {\r\n                return this._getDefaultValue(this._highResolutionIconUrls);\r\n            }\r\n            getAppDomains() {\r\n                return this._appDomains;\r\n            }\r\n            getInMemoryEToken() {\r\n                return this._inMemoryEToken;\r\n            }\r\n            isAllowSnapshot() {\r\n                return this._allowSnapshot;\r\n            }\r\n\r\n            /// <summary>\r\n            /// add manifest domain to app domain list, sourcelocation, appdomain, functionfile.\r\n            /// </summary>\r\n            /// <accessibility>public</accessibility>\r\n            /// <returns>a string representing the domain of the url.</returns>\r\n            addManifestUrl(manifestUrl) {\r\n                var urlDomain = OfficeExt.WACUtils.getDomainForUrl(manifestUrl);\r\n                if (this._appDomains.indexOf(urlDomain) === -1) {\r\n                    this._appDomains.push(urlDomain);\r\n                }\r\n            }\r\n            getWebApplicationResource() {\r\n                return this._webApplicationResource;\r\n            }\r\n            getWebApplicationId() {\r\n                return this._webApplicationId;\r\n            }\r\n            getWebApplicationMsaId() {\r\n                return this._webApplicationMsaId;\r\n            }\r\n            getWebApplicationScopes() {\r\n                return this._webApplicationScopes;\r\n            }\r\n            getWebApplicationAuthorizations() {\r\n                return this._webApplicationAuthorizations;\r\n            }\r\n            getEquivalentAddins() {\r\n                if (this._equivalentAddins) {\r\n                    return this._equivalentAddins.getEquivalentAddins();\r\n                }\r\n                return [];\r\n            }\r\n            isXLLCompatible() {\r\n                if (this._equivalentAddins) {\r\n                    return this._equivalentAddins.isXLLCompatible();\r\n                }\r\n                return false;\r\n            }\r\n            isSSOAddin() {\r\n                return !!this._webApplicationResource && !!this._webApplicationId;\r\n            }\r\n            containsAddinCommands(manifestHostType) {\r\n                var hostNode = this._getCurrentHostTypeNode(manifestHostType);\r\n                if (hostNode !== null) {\r\n                    var formFactorNode = this._xmlProcessor.selectSingleNode(\"ov:DesktopFormFactor\", hostNode);\r\n                    if (formFactorNode != null) {\r\n                        return true;\r\n                    }\r\n                }\r\n                return false;\r\n            }\r\n            getRibbonExtensionControlMap() {\r\n                return this._ribbonExtensionControls;\r\n            }\r\n            getExtendedOverrides() {\r\n                return this._extendedOverrides;\r\n            }\r\n            getExtendedOverridesTokens() {\r\n                if (this._extendedOverridesTokens) {\r\n                    return this._extendedOverridesTokens;\r\n                }\r\n                return [];\r\n            }\r\n            containsCustomFunctions(manifestHostType) {\r\n                var hostNode = this._getCurrentHostTypeNode(manifestHostType);\r\n                if (hostNode !== null) {\r\n                    var formFactorNode = this._xmlProcessor.selectSingleNode(\"ov:AllFormFactors\", hostNode);\r\n                    if (formFactorNode !== null) {\r\n                        var extensionPointNodes = this._xmlProcessor.selectNodes(\"ov:ExtensionPoint\", formFactorNode);\r\n                        if (extensionPointNodes !== null) {\r\n                            var len = extensionPointNodes.length;\r\n                            for (var i = 0; i < len; i++) {\r\n                                var extensionPointType = this.getNodeXsiType(extensionPointNodes[i]);\r\n                                if (extensionPointType === \"CustomFunctions\") {\r\n                                    return true;\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                return false;\r\n            }\r\n            containsCustomFunctionsForAppHost(appHostType) {\r\n                var manifestHostType = OSF.getManifestHostType(appHostType);\r\n                // Note: for Outlook, the manifest comes from host, Outlook does not support customFunctions, so skipping this entirely.\r\n                return appHostType != OSF.HostType.Outlook && this.containsCustomFunctions(manifestHostType);\r\n            }\r\n            getSharedRuntimeForCustomFunctions(manifestHostType) {\r\n                if (manifestHostType == null || this._versionOverrides == null) {\r\n                    return null;\r\n                }\r\n                var host = this._versionOverrides[manifestHostType];\r\n                if (host == null || host._customFunctionExtensionPoint == null || host._runtimes == null) {\r\n                    return null;\r\n                }\r\n                else {\r\n                    return host._runtimes.getSharedRuntime(host._customFunctionExtensionPoint.pageResId);\r\n                }\r\n            }\r\n            getSharedRuntimeForTaskpane(manifestHostType, controlId) {\r\n                if (manifestHostType == null || controlId == null || this._versionOverrides == null) {\r\n                    return null;\r\n                }\r\n                var host = this._versionOverrides[manifestHostType];\r\n                if (host == null || host._showTaskpaneControls == null || host._runtimes == null) {\r\n                    return null;\r\n                }\r\n                var showTaskpaneResid = null;\r\n                this._iterateAppCommandShowTaskpaneControls(host._showTaskpaneControls, (control) => {\r\n                    if (control == null || control.action == null) {\r\n                        return false;\r\n                    }\r\n                    if (control.action.taskpaneId === controlId || control.id === controlId) {\r\n                        showTaskpaneResid = control.action.sourceLocationResid;\r\n                        return true; // Return true will break the iterator.\r\n                    }\r\n                    return false; // Reture false will continue the iterator.\r\n                });\r\n                return showTaskpaneResid == null ? null : host._runtimes.getSharedRuntime(showTaskpaneResid);\r\n            }\r\n            getTaskpaneIdByRuntimeId(manifestHostType, runtimeId) {\r\n                if (manifestHostType == null || runtimeId == null || this._versionOverrides == null) {\r\n                    return null;\r\n                }\r\n                var host = this._versionOverrides[manifestHostType];\r\n                if (host == null || host._showTaskpaneControls == null || host._runtimes == null) {\r\n                    return null;\r\n                }\r\n                var taskpaneId = null;\r\n                this._iterateAppCommandShowTaskpaneControls(host._showTaskpaneControls, (control) => {\r\n                    if (control == null || control.action == null) {\r\n                        return false;\r\n                    }\r\n                    if (control.action.sourceLocationResid === runtimeId) {\r\n                        taskpaneId = control.action.taskpaneId;\r\n                        return true; // Return true will break the iterator.\r\n                    }\r\n                    return false; // Reture false will continue the iterator.\r\n                });\r\n                return taskpaneId;\r\n            }\r\n            getSharedRuntimeById(manifestHostType, runtimeId) {\r\n                if (this._versionOverrides == null) {\r\n                    return null;\r\n                }\r\n                var host = this._versionOverrides[manifestHostType];\r\n                if (host == null || host._runtimes == null) {\r\n                    return null;\r\n                }\r\n                return host._runtimes.getSharedRuntime(runtimeId);\r\n            }\r\n\r\n            /// <summary>\r\n            /// get shared app runtime resid for uiless commands.\r\n            /// Currently, this method only support excel host type, other aplications like word/ppt should shared same interface, but not been validated yet.\r\n            /// </summary>\r\n            /// <accessibility>public</accessibility>\r\n            /// <returns>runtime object containing the shared app url resid; if not in shared app mode, null will be returned.</returns>\r\n            getSharedRuntimeForAppCmdsExecuteFunction(manifestHostType) {\r\n                if (manifestHostType == null || this._versionOverrides == null) {\r\n                    return null;\r\n                }\r\n                var host = this._versionOverrides[manifestHostType];\r\n                if (host == null || host._runtimes == null) {\r\n                    return null;\r\n                }\r\n                else {\r\n                    return host._runtimes.getSharedRuntime(host._functionFileResid);\r\n                }\r\n            }\r\n\r\n            /// <summary>\r\n            /// Get shared runtime id for taskpane or UI-less (Word/PPT don't have custome function).\r\n            /// </summary>\r\n            /// <accessibility>public</accessibility>\r\n            /// <param name=\"manifestHostType\">manifest host type (type: string)</param>\r\n            /// <param name=\"isForUiLess\">get runtime for ui-less if it is true, or get runtime for taskpane if it is false (type: bool)</param>\r\n            /// <param name=\"controlId\">original control id, used for taskpane runtime only (type: string)</param>\r\n            /// <returns>shared runtime resid for taskpane or uiless, or null if not a shared runtime.</returns>\r\n            getSharedRuntimeId(manifestHostType, isForUiLess, controlId) {\r\n                let runtime = isForUiLess ? this.getSharedRuntimeForAppCmdsExecuteFunction(manifestHostType) : this.getSharedRuntimeForTaskpane(manifestHostType, controlId);\r\n                return (runtime !== null) ? runtime.Resid : null;\r\n            }\r\n\r\n            /// <summary>\r\n            /// Check whether the shared runtime has a short life time.\r\n            /// </summary>\r\n            /// <accessibility>public</accessibility>\r\n            /// <param name=\"manifestHostType\">manifest host type (type: string)</param>\r\n            /// <param name=\"resid\">shared runtime id (type: string)</param>\r\n            /// <returns>true if the shared runtime has short life time. false otherwise</returns>\r\n            sharedRuntimeHasShortLifeTime(manifestHostType, resid) {\r\n                if (manifestHostType === null || resid === null || this._versionOverrides === null) {\r\n                    return false;\r\n                }\r\n                var host = this._versionOverrides[manifestHostType];\r\n                if (host === null || host._runtimes === null) {\r\n                    return false;\r\n                }\r\n                let runtime = host._runtimes.getSharedRuntime(resid);\r\n                return (runtime === null) ? false : (runtime.LifeTime === RuntimeLifeTime.Short);\r\n            }\r\n            complementVersion(version: string) {\r\n                // This method complements versions by adding \".0\" where numbers are missing.\r\n                // This method does not introduce any failures. Instead, it lets existing code deal with invalid versions.\r\n                if (RegExp(\"^[0-9]{1,5}(\\\\.[0-9]{1,5}){3}$\").test(version)) {\r\n                    // n.n.n.n\r\n                    // Nothing to do.\r\n                }\r\n                else if (RegExp(\"^[0-9]{1,5}(\\\\.[0-9]{1,5}){2}$\").test(version)) {\r\n                    // n.n.n\r\n                    version = version + \".0\";\r\n                }\r\n                else if (RegExp(\"^[0-9]{1,5}\\\\.[0-9]{1,5}$\").test(version)) {\r\n                    // n.n\r\n                    version = version + \".0.0\";\r\n                }\r\n                else if (RegExp(\"^[0-9]{1,5}$\").test(version)) {\r\n                    // n\r\n                    version = version + \".0.0.0\";\r\n                }\r\n                else {\r\n                    // The version is invalid.\r\n                    // However, we do nothing here.\r\n                    // If we introduce a new failure at this junction point, it may possibly break some scenarios that are currently working.\r\n                    // That's why we defer to the processing code downstream to deal with this invalid version as before.\r\n                }\r\n                return version;\r\n            }\r\n\r\n            isForOfficeAppManifest(): boolean {\r\n                return false;\r\n            }\r\n            converterLogging(): boolean {\r\n                return false;\r\n            }\r\n\r\n            getSolutionReference(): OfficeExt.OsfSolutionReference {\r\n                return this._solutionRef;\r\n            }\r\n\r\n            addLocaleSeen(locale: string): void {\r\n                if (!OSF.OUtil.isNullOrUndefined(locale)) {\r\n                    this._localesSeen[locale.toLowerCase()] = true;\r\n                }\r\n            }\r\n\r\n            _iterateAppCommandShowTaskpaneControls(showTaskpaneControls, callback) {\r\n                if (showTaskpaneControls == null || callback == null) {\r\n                    return;\r\n                }\r\n                for (var i = 0; i < showTaskpaneControls.length; i++) {\r\n                    if (callback(showTaskpaneControls[i])) {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            _generateRibbonExtensionControlMap(manifestHostType) {\r\n                if (manifestHostType == null || this._versionOverrides == null) {\r\n                    return null;\r\n                }\r\n                var host = this._versionOverrides[manifestHostType];\r\n                var ribbonExtensionControls = [];\r\n                // Check if custom ribbon commands are defined in the manifest.\r\n                if (host != null && host._addinCommandsExtensionPoints != null) {\r\n                    var len = host._addinCommandsExtensionPoints.length;\r\n                    for (var i = 0; i < len; i++) {\r\n                        var extPoint = host._addinCommandsExtensionPoints[i];\r\n                        // Only support ribbon commands, not conext menu currently.\r\n                        if (extPoint.type === \"PrimaryCommandSurface\") {\r\n                            if (extPoint.tabs) {\r\n                                // Walk through tabs.\r\n                                for (var tabIdx = 0; tabIdx < extPoint.tabs.length; tabIdx++) {\r\n                                    var tab = extPoint.tabs[tabIdx];\r\n                                    this._ribbonExtensionControls[tab.id] = tab;\r\n                                    this._addRibbonControlsToMap(tab);\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            /// <summary>\r\n            /// Recursively iterate through ribbon controls/children and add them to the cache dictionary.\r\n            /// MenuControl is excluded because it is notsupported by Dynamic Ribbon /Enable/Disable API.\r\n            /// </summary>\r\n            _addRibbonControlsToMap(parentControl) {\r\n                if (parentControl && parentControl.children) {\r\n                    for (var idx = 0; idx < parentControl.children.length; idx++) {\r\n                        var control = parentControl.children[idx];\r\n                        if (control && !(control instanceof OfficeExt.Parser.MenuControl)) {\r\n                            this._ribbonExtensionControls[control.id] = control;\r\n                        }\r\n                        this._addRibbonControlsToMap(control);\r\n                    }\r\n                }\r\n            }\r\n\r\n            /// <summary>\r\n            /// Go though this._versionOverrides[manifestHostType]._addinCommandsExtensionPoints,\r\n            /// get a list of appCommands show taskpane controls.\r\n            /// </summary>\r\n            _retrieveAppCommandShowTaskpaneControls(manifestHostType) {\r\n                if (manifestHostType == null || this._versionOverrides == null) {\r\n                    return null;\r\n                }\r\n                var host = this._versionOverrides[manifestHostType];\r\n                var appCommandShowTaskpaneControls = [];\r\n                if (host != null && host._addinCommandsExtensionPoints != null) {\r\n                    var len = host._addinCommandsExtensionPoints.length;\r\n                    for (var i = 0; i < len; i++) {\r\n                        var extPoint = host._addinCommandsExtensionPoints[i];\r\n                        if (extPoint == null) {\r\n                            continue;\r\n                        }\r\n                        if (extPoint.type === \"PrimaryCommandSurface\") {\r\n                            if (extPoint.tabs == null) {\r\n                                continue;\r\n                            }\r\n                            for (var j = 0; j < extPoint.tabs.length; j++) {\r\n                                var tab = extPoint.tabs[j]; // We could only have one tab, either officeTab or customTab.\r\n                                if (tab == null || tab.children == null) {\r\n                                    continue;\r\n                                }\r\n                                for (var groupIndex = 0; groupIndex < tab.children.length; groupIndex++) {\r\n                                    var group = tab.children[groupIndex];\r\n                                    if (group == null || group.children == null) {\r\n                                        continue;\r\n                                    }\r\n                                    this._getShowTaskpaneControlsFromControlsParent(group, appCommandShowTaskpaneControls);\r\n                                }\r\n                            }\r\n                        }\r\n                        else if (extPoint.type === \"ContextMenu\") {\r\n                            if (extPoint.children == null) {\r\n                                continue;\r\n                            }\r\n                            var officeMenuNode = extPoint.children[0]; // We could only have one officeMenuNode.\r\n                            if (officeMenuNode == null || officeMenuNode.children == null) {\r\n                                continue;\r\n                            }\r\n                            this._getShowTaskpaneControlsFromControlsParent(officeMenuNode, appCommandShowTaskpaneControls);\r\n                        }\r\n                    }\r\n                }\r\n                return appCommandShowTaskpaneControls;\r\n            }\r\n            /// <summary>\r\n            /// Get appCommands showtaskpane controls infomation from controls parent.\r\n            /// For PrimaryCommandSurface, the controls parent should be \"group\";\r\n            /// For ContextMenu, the controls parent should be \"OfficeMenuNode\".\r\n            /// </summary>\r\n            _getShowTaskpaneControlsFromControlsParent(controlsParent, appCommandShowTaskpaneControls) {\r\n                if (controlsParent == null || controlsParent.children == null || appCommandShowTaskpaneControls == null) {\r\n                    return;\r\n                }\r\n                for (var controlIndex = 0; controlIndex < controlsParent.children.length; controlIndex++) {\r\n                    var control = controlsParent.children[controlIndex];\r\n                    if (control != null) {\r\n                        if (control.controlType === \"Button\") {\r\n                            if (control.action != null && control.actionType === \"ShowTaskpane\") {\r\n                                appCommandShowTaskpaneControls.push(control);\r\n                            }\r\n                        }\r\n                        else {\r\n                            // Logic to handle when control type is Menu\r\n                            if (control.children == null) {\r\n                                continue;\r\n                            }\r\n                            for (var itemIndex = 0; itemIndex < control.children.length; itemIndex++) {\r\n                                var menuItem = control.children[itemIndex];\r\n                                if (menuItem != null && menuItem.action != null && menuItem.actionType === \"ShowTaskpane\") {\r\n                                    appCommandShowTaskpaneControls.push(menuItem);\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            /// Currently, this method only support excel host type, other aplications like word/ppt should shared same interface, but not been validated yet.\r\n            _validateShowTaskpaneSharedRuntime(manifestHostType) {\r\n                if (manifestHostType == null || this._versionOverrides == null) {\r\n                    return;\r\n                }\r\n                var host = this._versionOverrides[manifestHostType];\r\n                if (host == null || host._runtimes == null || host._showTaskpaneControls == null) {\r\n                    return;\r\n                }\r\n                var validsharedTaskPaneRuntimes = [];\r\n                this._iterateAppCommandShowTaskpaneControls(host._showTaskpaneControls, (control) => {\r\n                    if (control == null || control.action == null) {\r\n                        return false;\r\n                    }\r\n                    var sharedRuntime = host._runtimes.getSharedRuntime(control.action.sourceLocationResid);\r\n                    var sharedRuntimeId = null;\r\n                    if (sharedRuntime == null || sharedRuntime.LifeTime != RuntimeLifeTime.Long) {\r\n                        if (control.action.taskpaneId == null) {\r\n                            // If not long shared runtime and no taskpaneId provided, we will return false will continue the iterator.\r\n                            return false;\r\n                        }\r\n                    }\r\n                    else {\r\n                        // This will be a shared runtime with long life time, we only need to add long runtime into sharedRuntimeSet.\r\n                        sharedRuntimeId = sharedRuntime.Resid;\r\n                    }\r\n                    var taskpaneIdAndResIdPair = new Array(control.action.taskpaneId, sharedRuntimeId);\r\n                    var needToAddActionToSharedRuntimeSet = true;\r\n                    // Go through all items in sharedRuntimeSet, to determine if action need to be put into the set.\r\n                    // Will throw excetion for invalid scenarios.\r\n                    for (var i = 0; i < validsharedTaskPaneRuntimes.length; i++) {\r\n                        if (validsharedTaskPaneRuntimes[i][0] == taskpaneIdAndResIdPair[0] && validsharedTaskPaneRuntimes[i][1] == taskpaneIdAndResIdPair[1]) {\r\n                            if (taskpaneIdAndResIdPair[0] == null) {\r\n                                throw OsfMsAjaxFactory.msAjaxError.argument(\"Manifest parser failure: resid and taskpaneid not correct\");\r\n                            }\r\n                            else {\r\n                                needToAddActionToSharedRuntimeSet = false;\r\n                                break;\r\n                            }\r\n                        }\r\n                        else if ((validsharedTaskPaneRuntimes[i][1] == taskpaneIdAndResIdPair[1] && validsharedTaskPaneRuntimes[i][1] != null)\r\n                            || (validsharedTaskPaneRuntimes[i][0] == taskpaneIdAndResIdPair[0] && validsharedTaskPaneRuntimes[i][0] != null)) {\r\n                            needToAddActionToSharedRuntimeSet = false;\r\n                            throw OsfMsAjaxFactory.msAjaxError.argument(\"Manifest parser failure: resid and taskpaneid not correct\");\r\n                        }\r\n                    }\r\n                    if (needToAddActionToSharedRuntimeSet) {\r\n                        validsharedTaskPaneRuntimes.push(taskpaneIdAndResIdPair);\r\n                    }\r\n                    return false; // Reture false will continue the iterator.\r\n                });\r\n            }\r\n\r\n            /// <summary>\r\n            /// Help method to get the default value from the locale aware setting object.\r\n            /// Use default locale if it exists, otherwise return the first value.\r\n            /// </summary>\r\n            /// <accessibility>private</accessibility>\r\n            /// <param name=\"locale\">locale aware setting object</param>\r\n            /// <returns>a string representing the default value for the locale aware setting object.</returns>\r\n            _getDefaultValue(obj) {\r\n                var localeValue;\r\n                if (this._UILocale) {\r\n                    localeValue = obj[this._UILocale] || obj[this._UILocale.toLocaleLowerCase()] || undefined;\r\n                }\r\n                if (!localeValue && this._defaultLocale) {\r\n                    localeValue = obj[this._defaultLocale] || obj[this._defaultLocale.toLocaleLowerCase()] || undefined;\r\n                }\r\n                if (!localeValue) {\r\n                    var locale;\r\n                    for (var p in obj) {\r\n                        //return the first value\r\n                        locale = p;\r\n                        break;\r\n                    }\r\n                    localeValue = obj[locale];\r\n                }\r\n                return localeValue;\r\n            }\r\n\r\n            /// <summary>\r\n            /// Help method to parse locale aware settings.\r\n            /// </summary>\r\n            /// <accessibility>private</accessibility>\r\n            /// <param name=\"localeAwareNode\">DOM node</param>\r\n            /// <param name=\"addCallback\">callback to add the parsed locale aware settings</param>\r\n            _getExtensionSetting(formFactor) {\r\n                var extensionSetting;\r\n                if (typeof this._extensionSettings[formFactor] != \"undefined\") {\r\n                    extensionSetting = this._extensionSettings[formFactor];\r\n                }\r\n                else {\r\n                    for (var p in this._extensionSettings) {\r\n                        extensionSetting = this._extensionSettings[p];\r\n                        break;\r\n                    }\r\n                }\r\n                return extensionSetting;\r\n            }\r\n            _addDisplayName(locale, value) {\r\n                this._displayNames[locale.toLocaleLowerCase()] = value;\r\n            }\r\n            _addDescription(locale, value) {\r\n                locale = this._fixLocaleCasing(locale);\r\n                this._descriptions[locale] = value;\r\n            }\r\n            _addIconUrl(locale, value) {\r\n                locale = this._fixLocaleCasing(locale);\r\n                this._iconUrls[locale] = value;\r\n            }\r\n            _addSupportUrl(locale, value) {\r\n                locale = this._fixLocaleCasing(locale);\r\n                this._supportUrls[locale] = value;\r\n            }\r\n            _fixLocaleCasing(locale: string): string {\r\n                // The locales should be insensitive but some are not.\r\n                // Changing this now could break some manifests so just doing it here for the xml to json converter\r\n                if (this.isForOfficeAppManifest() && !OSF.OUtil.isNullOrUndefined(locale)) {\r\n                    return locale.toLowerCase();\r\n                }\r\n                return locale;\r\n            }\r\n            _parseLocaleAwareSettings(localeAwareNode, addCallback) {\r\n                if (!localeAwareNode) {\r\n                    throw OsfMsAjaxFactory.msAjaxError.argument(\"Manifest\");\r\n                }\r\n                var defaultValue = localeAwareNode.getAttribute(\"DefaultValue\");\r\n                addCallback(this._defaultLocale, defaultValue);\r\n                var overrideNodes = this._xmlProcessor.selectNodes(\"o:Override\", localeAwareNode);\r\n                if (overrideNodes) {\r\n                    var len = overrideNodes.length;\r\n                    for (var i = 0; i < len; i++) {\r\n                        var node = overrideNodes[i];\r\n                        var locale = node.getAttribute(\"Locale\");\r\n                        this.addLocaleSeen(locale);\r\n                        var value = node.getAttribute(\"Value\");\r\n                        addCallback(locale, value);\r\n                    }\r\n                }\r\n            }\r\n            _parseBooleanNode(node) {\r\n                if (!node) {\r\n                    return false;\r\n                }\r\n                else {\r\n                    var value = this._xmlProcessor.getNodeValue(node).toLowerCase();\r\n                    return value === \"true\" || value === \"1\";\r\n                }\r\n            }\r\n            _parseIdIssuer(node) {\r\n                if (!node) {\r\n                    return OSF.ManifestIdIssuer.Custom;\r\n                }\r\n                else {\r\n                    var value = this._xmlProcessor.getNodeValue(node);\r\n                    return OSF.OUtil.parseEnum(value, OSF.ManifestIdIssuer);\r\n                }\r\n            }\r\n            _parseCapabilities(nodes) {\r\n                var capabilities = [];\r\n                var capability;\r\n                for (var i = 0; i < nodes.length; i++) {\r\n                    var node = nodes[i];\r\n                    capability = node.getAttribute(\"Name\");\r\n                    capability = OSF.OUtil.parseEnum(capability, OSF.Capability);\r\n                    capabilities.push(capability);\r\n                }\r\n                return capabilities;\r\n            }\r\n            _parsePermission(capabilityNode) {\r\n                if (!capabilityNode) {\r\n                    throw OsfMsAjaxFactory.msAjaxError.argument(\"Manifest\");\r\n                }\r\n                var value = this._xmlProcessor.getNodeValue(capabilityNode);\r\n                return OSF.OUtil.parseEnum(value, OSF.OsfControlPermission);\r\n            }\r\n            _parseExtensionSettings() {\r\n                var settings;\r\n                var settingNode;\r\n                var node;\r\n                for (var formFactor in OSF.FormFactor) {\r\n                    var officeAppNode = this._xmlProcessor.selectSingleNode(\"o:OfficeApp\");\r\n                    settingNode = this._xmlProcessor.selectSingleNode(\"o:\" + OSF.FormFactor[formFactor], officeAppNode);\r\n                    if (settingNode) {\r\n                        settings = new OSF.Manifest.ExtensionSettings();\r\n                        node = this._xmlProcessor.selectSingleNode(\"o:SourceLocation\", settingNode);\r\n                        var addSourceLocation = (locale, value) => {\r\n                            settings._addSourceLocation(locale, value);\r\n                            this.addManifestUrl(value);\r\n                        };\r\n                        this._parseLocaleAwareSettings(node, addSourceLocation);\r\n                        node = this._xmlProcessor.selectSingleNode(\"o:RequestedWidth\", settingNode);\r\n                        if (node) {\r\n                            settings._setDefaultWidth(this._xmlProcessor.getNodeValue(node));\r\n                        }\r\n                        node = this._xmlProcessor.selectSingleNode(\"o:RequestedHeight\", settingNode);\r\n                        if (node) {\r\n                            settings._setDefaultHeight(this._xmlProcessor.getNodeValue(node));\r\n                        }\r\n                        this._extensionSettings[formFactor] = settings;\r\n                    }\r\n                }\r\n                if (!settings) { //no setting found\r\n                    throw OsfMsAjaxFactory.msAjaxError.argument(\"Manifest\");\r\n                }\r\n            }\r\n            _parseHosts(hostsNode) {\r\n                var targetHosts = [];\r\n                if (hostsNode) {\r\n                    var hostNodes = this._xmlProcessor.selectNodes(\"o:Host\", hostsNode);\r\n                    for (var i = 0; i < hostNodes.length; i++) {\r\n                        targetHosts.push(hostNodes[i].getAttribute(\"Name\"));\r\n                    }\r\n                }\r\n                return targetHosts;\r\n            }\r\n\r\n            _parseWebApplicationInfo(obj: any, parentNode: any, nodeNamespace: string): void {\r\n                var webApplicationInfoNode = this._xmlProcessor.selectSingleNode(nodeNamespace + \"WebApplicationInfo\", parentNode);\r\n                if (webApplicationInfoNode) {\r\n                    var webApplicationResourceNode = this._xmlProcessor.selectSingleNode(nodeNamespace + \"Resource\", webApplicationInfoNode);\r\n                    obj._webApplicationResource = this._xmlProcessor.getNodeValue(webApplicationResourceNode);\r\n                    var webApplicationIdNode = this._xmlProcessor.selectSingleNode(nodeNamespace + \"Id\", webApplicationInfoNode);\r\n                    obj._webApplicationId = this._xmlProcessor.getNodeValue(webApplicationIdNode);\r\n                    // MsaId is needed to support in case of AAD (v1) and MSA (login.live.com).\r\n                    // TODO: When migrate to MSAL (v2) this should be deprecated.\r\n                    var webApplicationMsaIdNode = this._xmlProcessor.selectSingleNode(nodeNamespace + \"MsaId\", webApplicationInfoNode);\r\n                    if (webApplicationMsaIdNode) {\r\n                        obj._webApplicationMsaId = this._xmlProcessor.getNodeValue(webApplicationMsaIdNode);\r\n                    }\r\n                    else {\r\n                        obj._webApplicationMsaId = this._webApplicationId;\r\n                    }\r\n                    var webApplicationScopesNode = this._xmlProcessor.selectSingleNode(nodeNamespace + \"Scopes\", webApplicationInfoNode);\r\n                    obj._webApplicationScopes = this._parseWebApplicationScopes(webApplicationScopesNode, nodeNamespace);\r\n                    obj._webApplicationAuthorizations = this._parseWebAppInfoAuthorizations(webApplicationInfoNode, nodeNamespace);\r\n                }\r\n            }\r\n\r\n            _parseWebApplicationScopes(webApplicationScopesNode, nodeNamespace) {\r\n                var scopes = [];\r\n                if (webApplicationScopesNode) {\r\n                    var scopeNodes = this._xmlProcessor.selectNodes(nodeNamespace + \"Scope\", webApplicationScopesNode);\r\n                    for (var i = 0; i < scopeNodes.length; i++) {\r\n                        scopes.push(this._xmlProcessor.getNodeValue(scopeNodes[i]));\r\n                    }\r\n                }\r\n                return scopes;\r\n            }\r\n            _parseWebAppInfoAuthorizations(webAppInfoAuthsNode, nodeNamespace) {\r\n                var authorizations = [];\r\n                var authorizationsNode = this._xmlProcessor.selectSingleNode(nodeNamespace + \"Authorizations\", webAppInfoAuthsNode);\r\n                if (authorizationsNode) {\r\n                    var authorizationNodes = this._xmlProcessor.selectNodes(nodeNamespace + \"Authorization\", authorizationsNode);\r\n                    if (authorizationNodes) {\r\n                        for (var authNodeIndex = 0; authNodeIndex < authorizationNodes.length; authNodeIndex++) {\r\n                            var authNode = authorizationNodes[authNodeIndex];\r\n                            var authorization = new OSF.Manifest.WebAppInfoAuthorization();\r\n                            var resourceNode = this._xmlProcessor.selectSingleNode(nodeNamespace + \"Resource\", authNode);\r\n                            if (resourceNode) {\r\n                                authorization._resource = this._xmlProcessor.getNodeValue(resourceNode);\r\n                            }\r\n                            var scopesNode = this._xmlProcessor.selectSingleNode(nodeNamespace + \"Scopes\", authNode);\r\n                            if (scopesNode) {\r\n                                var scopeNodes = this._xmlProcessor.selectNodes(nodeNamespace + \"Scope\", scopesNode);\r\n                                if (scopeNodes) {\r\n                                    var scopes = [];\r\n                                    for (var scopeNodeIndex = 0; scopeNodeIndex < scopeNodes.length; scopeNodeIndex++) {\r\n                                        var scopeNode = scopeNodes[scopeNodeIndex];\r\n                                        scopes.push(this._xmlProcessor.getNodeValue(scopeNode));\r\n                                    }\r\n                                    authorization._scopes = scopes;\r\n                                }\r\n                            }\r\n                            authorizations.push(authorization);\r\n                        }\r\n                    }\r\n                }\r\n                return authorizations;\r\n            }\r\n            _parseRequirements(requirementsNode, nodeNamespace?: string) {\r\n                var requirements = {\r\n                    sets: [],\r\n                    methods: []\r\n                };\r\n                if (requirementsNode) {\r\n                    let ns: string = OSF.OUtil.isNullOrUndefined(nodeNamespace) ? \"o:\" : nodeNamespace;\r\n                    var setsNode = this._xmlProcessor.selectSingleNode(ns + \"Sets\", requirementsNode);\r\n                    requirements.sets = this._parseSets(setsNode, ns);\r\n                    var methodsNode = this._xmlProcessor.selectSingleNode(ns + \"Methods\", requirementsNode);\r\n                    requirements.methods = this._parseMethods(methodsNode, ns);\r\n                }\r\n                return requirements;\r\n            }\r\n            _parseSets(setsNode, nodeNamespace?: string) {\r\n                var sets = [];\r\n                if (setsNode) {\r\n                    let ns: string = OSF.OUtil.isNullOrUndefined(nodeNamespace) ? \"o:\" : nodeNamespace;\r\n                    var defaultVersion = setsNode.getAttribute(\"DefaultMinVersion\");\r\n                    var setNodes = this._xmlProcessor.selectNodes(ns + \"Set\", setsNode);\r\n                    for (var i = 0; i < setNodes.length; i++) {\r\n                        var setNode = setNodes[i];\r\n                        var overrideVersion = setNode.getAttribute(\"MinVersion\");\r\n                        sets.push({\r\n                            name: setNode.getAttribute(\"Name\"),\r\n                            version: overrideVersion || defaultVersion\r\n                        });\r\n                    }\r\n                }\r\n                return sets;\r\n            }\r\n            _parseMethods(methodsNode, nodeNamespace?: string) {\r\n                var methods = [];\r\n                if (methodsNode) {\r\n                    let ns: string = OSF.OUtil.isNullOrUndefined(nodeNamespace) ? \"o:\" : nodeNamespace;\r\n                    var methodNodes = this._xmlProcessor.selectNodes(ns + \"Method\", methodsNode);\r\n                    for (var i = 0; i < methodNodes.length; i++) {\r\n                        methods.push(methodNodes[i].getAttribute(\"Name\"));\r\n                    }\r\n                }\r\n                return methods;\r\n            }\r\n            _parseSourceLocationOverrides(versionOverridesNode) {\r\n                var idToSouceLocationOverrideMapping = {};\r\n                if (versionOverridesNode) {\r\n                    var resourcesNode = this._xmlProcessor.selectSingleNode(\"ov:Resources\", versionOverridesNode);\r\n                    if (resourcesNode) {\r\n                        var btUrlsNode = this._xmlProcessor.selectSingleNode(\"bt:Urls\", resourcesNode);\r\n                        if (btUrlsNode) {\r\n                            var urlList = this._xmlProcessor.selectNodes(\"bt:Url\", btUrlsNode);\r\n                            if (urlList) {\r\n                                for (var x = 0; x < urlList.length; x++) {\r\n                                    var node = urlList[x];\r\n                                    var id = node.getAttribute(\"id\");\r\n                                    var sourceLocationOverride = node.getAttribute(\"DefaultValue\");\r\n                                    if (id && sourceLocationOverride) {\r\n                                        idToSouceLocationOverrideMapping[id] = sourceLocationOverride;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                return idToSouceLocationOverrideMapping;\r\n            }\r\n            _parseAppDomains(appDomainsNode) {\r\n                var appDomains = [];\r\n                if (appDomainsNode) {\r\n                    var appDomainNodes = this._xmlProcessor.selectNodes(\"o:AppDomain\", appDomainsNode);\r\n                    for (var i = 0; i < appDomainNodes.length; i++) {\r\n                        var url = this._xmlProcessor.getNodeValue(appDomainNodes[i]);\r\n                        if (OSF.OUtil.doesUrlHaveSupportedProtocol(url)) {\r\n                            var appDomain = OfficeExt.WACUtils.getDomainForUrl(url);\r\n                            if (appDomains.indexOf(appDomain) === -1) {\r\n                                appDomains.push(appDomain);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                return appDomains;\r\n            }\r\n            _parseRuntimes(runtimesNode) {\r\n                if (runtimesNode == null) {\r\n                    return null;\r\n                }\r\n                var runtimes = new OSF.Manifest.Runtimes();\r\n                var runtimeNodes = this._xmlProcessor.selectNodes(\"ov:Runtime\", runtimesNode);\r\n                if (runtimeNodes == null) {\r\n                    return null;\r\n                }\r\n                for (var i = 0; i < runtimeNodes.length; i++) {\r\n                    var runtime = this._parseRuntime(runtimeNodes[i]);\r\n                    runtimes.add(runtime);\r\n                }\r\n                return runtimes;\r\n            }\r\n            _parseRuntime(runtimeNode) {\r\n                if (runtimeNode == null) {\r\n                    return null;\r\n                }\r\n                var runtime = new OSF.Manifest.Runtime();\r\n                runtime.Resid = runtimeNode.getAttribute(\"resid\");\r\n                if (runtimeNode.getAttribute(\"lifetime\") === \"long\") {\r\n                    runtime.LifeTime = RuntimeLifeTime.Long;\r\n                }\r\n                else {\r\n                    runtime.LifeTime = RuntimeLifeTime.Short;\r\n                }\r\n                \r\n                if (this.isForOfficeAppManifest()) {\r\n                    var runtimeOverrides = this._xmlProcessor.selectNodes(\"ov:Override\", runtimeNode);\r\n                    if (!OSF.OUtil.isNullOrUndefined(runtimeOverrides) && Array.isArray(runtimeOverrides)) {\r\n                        for (var i = 0; i < runtimeOverrides.length; i++) {\r\n                            let runtimeOverride: RuntimeOverride = new RuntimeOverride();\r\n                            runtimeOverride.Type = runtimeNode.getAttribute(\"type\");\r\n                            runtimeOverride.Resid = runtimeNode.getAttribute(\"resid\");\r\n                            runtime.Overrides.add(runtimeOverride);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                return runtime;\r\n            }\r\n            _parseEquivalentAddins(equivalentAddinsNode, nodeNamespace) {\r\n                var equivalentAddins = new OSF.Manifest.EquivalentAddins();\r\n                if (equivalentAddinsNode) {\r\n                    var equivalentAddinNodes = this._xmlProcessor.selectNodes(nodeNamespace + \"EquivalentAddin\", equivalentAddinsNode);\r\n                    for (var i = 0; i < equivalentAddinNodes.length; i++) {\r\n                        var equivalentAddin = this._parseEquivalentAddin(equivalentAddinNodes[i], nodeNamespace);\r\n                        equivalentAddins.add(equivalentAddin);\r\n                    }\r\n                }\r\n                return equivalentAddins;\r\n            }\r\n            _parseEquivalentAddin(equivalentAddinNode, nodeNamespace) {\r\n                var equivalentAddin = new OSF.Manifest.EquivalentAddin();\r\n                if (equivalentAddinNode) {\r\n                    var progIdNode = this._xmlProcessor.selectSingleNode(nodeNamespace + \"ProgId\", equivalentAddinNode);\r\n                    if (progIdNode) {\r\n                        equivalentAddin._progId = this._xmlProcessor.getNodeValue(progIdNode);\r\n                    }\r\n                    var displayNameNode = this._xmlProcessor.selectSingleNode(nodeNamespace + \"DisplayName\", equivalentAddinNode);\r\n                    if (displayNameNode) {\r\n                        equivalentAddin._displayName = this._xmlProcessor.getNodeValue(displayNameNode);\r\n                    }\r\n                    var fileNameNode = this._xmlProcessor.selectSingleNode(nodeNamespace + \"FileName\", equivalentAddinNode);\r\n                    if (fileNameNode) {\r\n                        equivalentAddin._fileName = this._xmlProcessor.getNodeValue(fileNameNode);\r\n                    }\r\n                    var typeNode = this._xmlProcessor.selectSingleNode(nodeNamespace + \"Type\", equivalentAddinNode);\r\n                    if (typeNode) {\r\n                        var type = \"\" + this._xmlProcessor.getNodeValue(typeNode);\r\n                        equivalentAddin._type = type.toUpperCase();\r\n                    }\r\n                    else {\r\n                        throw OsfMsAjaxFactory.msAjaxError.argument(\"Manifest\");\r\n                    }\r\n                }\r\n                return equivalentAddin;\r\n            }\r\n            _parseExtendedOverrides(extendedOverridesNode) {\r\n                this._extendedOverrides = {\r\n                    url: extendedOverridesNode.getAttribute(\"Url\"),\r\n                    resourcesUrl: extendedOverridesNode.getAttribute(\"ResourcesUrl\"),\r\n                    hasFinalUrls: false\r\n                };\r\n                var extendedOverridesTokensNode = this._xmlProcessor.selectSingleNode(\"o:Tokens\", extendedOverridesNode);\r\n                if (extendedOverridesTokensNode != null) {\r\n                    var extendedOverridesTokenNodes = this._xmlProcessor.selectNodes(\"o:Token\", extendedOverridesTokensNode);\r\n                    if (extendedOverridesTokenNodes != null) {\r\n                        var extendedOverridesTokens: Array<OfficeExt.ExtendedOverridesToken> = [];\r\n                        for (var i = 0; i < extendedOverridesTokenNodes.length; i++) {\r\n                            var curExtendedOverridesTokenNode = extendedOverridesTokenNodes[i];\r\n                            var overridesNode = this._xmlProcessor.selectNodes(\"o:Override\", curExtendedOverridesTokenNode);\r\n                            var overrides = [];\r\n                            var curExtendedOverridesNodeType = this.getNodeXsiType(curExtendedOverridesTokenNode);\r\n                            if (curExtendedOverridesNodeType == OSF.ExtendedManifestSupportTokens.Requirements) {\r\n                                for (var j = 0; j < overridesNode.length; j++) {\r\n                                    var requirements = this._xmlProcessor.selectSingleNode(\"o:Requirements\", overridesNode[j]);\r\n                                    var override: OfficeExt.ExtendedOverridesTokenOverride = {\r\n                                        value: overridesNode[j].getAttribute(\"Value\"),\r\n                                        data: this._parseRequirements(requirements)\r\n                                    };\r\n                                    overrides.push(override);\r\n                                }\r\n                            }\r\n                            else if (curExtendedOverridesNodeType == OSF.ExtendedManifestSupportTokens.Locale) {\r\n                                for (var j = 0; j < overridesNode.length; j++) {\r\n                                    var override: OfficeExt.ExtendedOverridesTokenOverride = {\r\n                                        value: overridesNode[j].getAttribute(\"Value\"),\r\n                                        data: overridesNode[j].getAttribute(\"Locale\").toLowerCase() // make locale value to lowerCase, this helps computeLocaleToken to avoid toLowerCase in for loop\r\n                                    };\r\n                                    overrides.push(override);\r\n                                }\r\n                            }\r\n                            var extendedOverridesToken: OfficeExt.ExtendedOverridesToken = {\r\n                                name: curExtendedOverridesTokenNode.getAttribute(\"Name\"),\r\n                                defaultValue: curExtendedOverridesTokenNode.getAttribute(\"DefaultValue\"),\r\n                                type: this.getNodeXsiType(curExtendedOverridesTokenNode),\r\n                                overrides: overrides\r\n                            };\r\n                            extendedOverridesTokens.push(extendedOverridesToken);\r\n                        }\r\n                        this._extendedOverridesTokens = extendedOverridesTokens;\r\n                    }\r\n                }\r\n            }\r\n            _addHighResolutionIconUrl(locale, url) {\r\n                locale = this._fixLocaleCasing(locale);\r\n                this._highResolutionIconUrls[locale] = url;\r\n            }\r\n            _isAddinCommandsManifest(manifestHostType) {\r\n                return this.containsAddinCommands(manifestHostType)\r\n                    || this.containsCustomFunctions(manifestHostType);\r\n            }\r\n            _getCurrentHostTypeNode(manifestHostType) {\r\n                if (this._xmlProcessor) {\r\n                    var officeAppNode = this._xmlProcessor.selectSingleNode(\"o:OfficeApp\");\r\n                    if (officeAppNode !== null && this.getManifestSchemaVersion() === OSF.ManifestSchemaVersion[\"1.1\"]) {\r\n                        var overridesNode = this._xmlProcessor.selectSingleNode(\"ov:VersionOverrides\", officeAppNode);\r\n                        if (overridesNode !== null) {\r\n                            var hostsNode = this._xmlProcessor.selectSingleNode(\"ov:Hosts\", overridesNode);\r\n                            if (hostsNode !== null) {\r\n                                var hostNodes = this._xmlProcessor.selectNodes(\"ov:Host\", hostsNode);\r\n                                if (hostNodes !== null) {\r\n                                    var len = hostNodes.length;\r\n                                    for (var i = 0; i < len; i++) {\r\n                                        var hostType = this.getNodeXsiType(hostNodes[i]);\r\n                                        if (hostType === manifestHostType) {\r\n                                            return hostNodes[i];\r\n                                        }\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                return null;\r\n            }\r\n\r\n            _getEntitlement(solRef: OfficeExt.OsfSolutionReference): OfficeExt.AddinEntitlement {\r\n                if (OSF.OUtil.isNullOrUndefined(solRef)) {\r\n                    var solRef: OfficeExt.OsfSolutionReference =  {\r\n                            solutionId : this._id,\r\n                            version : this._version,\r\n                            storeType : OSF.StoreType.FileSystem, // if not set we will use Filesystem as default StoreType\r\n                            storeId: this._UILocale,\r\n                            assetId: this._id,\r\n                            assetStoreId : null\r\n                        };\r\n                    this._solutionRef = solRef;\r\n                }\r\n\r\n                let entitlement: OfficeExt.AddinEntitlement = {\r\n                    solutionId : this._solutionRef.solutionId,\r\n                    version : this._solutionRef.version,\r\n                    storeType : this._solutionRef.storeType,\r\n                    storeId: this._solutionRef.storeId,\r\n                    assetId: this._solutionRef.assetId,\r\n                    assetStoreId : this._solutionRef.assetStoreId,\r\n                    targetType: this._target, \r\n                }\r\n\r\n                return entitlement;\r\n            }\r\n        }\r\n    }\r\n}","/// <reference path='OSFManifest.ts' />\r\n/// <reference path='OSFConstants.ts' />\r\n/// <reference path='ParserUtility.ts' />\r\n/// <reference path='RequirementsChecker.ts' />\r\n/// <reference path='../../../jscript/AddinCommandsManifestParser.ts' />\r\n/// <reference path='../../../jscript/officeutil/officeutil.ts' />\r\n\r\nnamespace OSF {\r\n    export namespace Manifest {\r\n        export class FormSetting {\r\n            SourceLocation: string[];\r\n            RequestedHeight: number;\r\n        }\r\n\r\n        // OSF.Manifest.Manifest parses Word, Excel and PowerPoint manifests.  This class is used for translation between the legacy\r\n        // xml manifest and the new metaos json manifest.  It will expose any needed data from the base class that will be used by\r\n        // the Converter class to populate the new metaos manifest.\r\n        // Currently this class is not used by production code but only by this mos/converter.\r\n        export class OfficeAppManifest extends OSF.Manifest.Manifest {\r\n            _namespace: string;\r\n            _hostType: string;\r\n            _formSettings: FormSetting[][];\r\n            _disableEntityHighlighting?: boolean;\r\n            _converterLogging?: boolean;\r\n\r\n            constructor(payload: string, uiLocale: string, converterLogging?: boolean, solRef?: OfficeExt.OsfSolutionReference) {\r\n                super(payload, uiLocale, OSF.PayloadType.OfficeAddin, solRef);\r\n                this._converterLogging = converterLogging;\r\n\r\n                if (this._target === OSF.OfficeAppType.MailApp) {\r\n                    this._namespace = OSF.ParserStrings.Mailappor;\r\n                }\r\n                else if (this._target == OSF.OfficeAppType.TaskPaneApp) {\r\n                    this._namespace = \"ov:\"\r\n                }\r\n                else if (this._target == OSF.OfficeAppType.ContentApp) {\r\n                    this._namespace = \"c:\"\r\n                }\r\n\r\n                if (this._target === OSF.OfficeAppType.MailApp || this._target === OSF.OfficeAppType.TaskPaneApp) {\r\n                    this._parseOverrideCore();\r\n                }\r\n            }\r\n\r\n            isForOfficeAppManifest() {\r\n                return true;\r\n            }\r\n            converterLogging(): boolean {\r\n                return (this._converterLogging == true);\r\n            }\r\n\r\n            _parseExtensionSettings() {\r\n                if (this._target == OSF.OfficeAppType.MailApp) {\r\n                    this._parseFormSettings();\r\n                    this._parseDisableEntityHighlighting();\r\n                }\r\n                else {\r\n                    super._parseExtensionSettings();\r\n                }\r\n            }\r\n\r\n            _parseFormSettings(): void {\r\n                const formFactorSettings: string[] = [\"DesktopSettings\", \"TabletSettings\", \"PhoneSettings\"];\r\n\r\n                let officeAppNode = this._xmlProcessor.selectSingleNode(ParserStrings.OOfficeApp);\r\n                let formNodes = OSF.SelectChildNodes(this._xmlProcessor, \"o:\" + ParserStrings.Form, officeAppNode, [\"o:\" + ParserStrings.FormSettings]);\r\n                this._formSettings = [];\r\n\r\n                for (const formNode of formNodes) {\r\n                    const formType: string = this.getNodeXsiType(formNode);\r\n                    if (OSF.OUtil.isNullOrUndefined(formType)) {\r\n                        throw OsfMsAjaxFactory.msAjaxError.argument(\"Form node without a type.\");\r\n                    }\r\n\r\n                    this._formSettings[formType] = {};\r\n \r\n                    for (let ff of formFactorSettings) {\r\n                        let settingsNode = this._xmlProcessor.selectSingleNode(\"o:\" + ff, formNode);\r\n                        if (!OSF.OUtil.isNullOrUndefined(settingsNode)) {\r\n                            this._formSettings[formType][ff] = {};\r\n\r\n                            let sourceLocationNode = this._xmlProcessor.selectSingleNode(\"o:\" + ParserStrings.SourceLocation, settingsNode);\r\n                            if (!OSF.OUtil.isNullOrUndefined(sourceLocationNode)) {\r\n                                this._formSettings[formType][ff].SourceLocation = {};\r\n\r\n                                let addSourceLocationCallback = (locale: string, value: string) => {\r\n                                    this._formSettings[formType][ff].SourceLocation[locale] = value;\r\n                                };\r\n                                this._parseLocaleAwareSettings(sourceLocationNode, addSourceLocationCallback);\r\n                            }\r\n\r\n                            let requestedHeightNode = this._xmlProcessor.selectSingleNode(\"o:\" + ParserStrings.RequestedHeight, settingsNode);\r\n                            if (!OSF.OUtil.isNullOrUndefined(requestedHeightNode)) {\r\n                                this._formSettings[formType][ff].RequestedHeight = this._xmlProcessor.getNodeValue(requestedHeightNode);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            _parseDisableEntityHighlighting(): void {\r\n                let officeAppNode = this._xmlProcessor.selectSingleNode(ParserStrings.OOfficeApp);\r\n                let disableEntityHighlightingNode = this._xmlProcessor.selectSingleNode(\"o:DisableEntityHighlighting\", officeAppNode);\r\n                if (!OSF.OUtil.isNullOrUndefined(disableEntityHighlightingNode)) {\r\n                    let value: string = this._xmlProcessor.getNodeValue(disableEntityHighlightingNode).toLowerCase();\r\n                    this._disableEntityHighlighting = (value === \"true\" || value === \"1\");\r\n                }\r\n            }\r\n\r\n            _parseOverrideCore() {\r\n\r\n                let officeAppNode = this._xmlProcessor.selectSingleNode(\"o:OfficeApp\");\r\n                let node: any;\r\n\r\n                // Com2Web equivalent addin info\r\n                if (this._manifestSchemaVersion === OSF.ManifestSchemaVersion[\"1.1\"]) {\r\n                    let ns: string = this._namespace;\r\n                    node = this._xmlProcessor.selectSingleNode(this._namespace + \"VersionOverrides\", officeAppNode);\r\n\r\n                    // Outlook's equivalent add-ins node is defined in VersionOverrides V1.1, not in V1.0.\r\n                    if (this._target === OSF.OfficeAppType.MailApp) {\r\n                        let versionOverridesNodePath: string[] = OSF.GetVersionOverridesPath(this._xmlProcessor, ns, OSF.VersionOverridesNumber.V1_1);\r\n                        node = OSF.SelectSingleNode(this._xmlProcessor, officeAppNode, versionOverridesNodePath, true /*isStrictPath*/);\r\n                        ns = OSF.GetVersionOverridesNamespace(ns, OSF.VersionOverridesNumber.V1_1);\r\n                    }\r\n\r\n                    if (!OSF.OUtil.isNullOrUndefined(node)) {\r\n                        let equivalentAddinsNode = this._xmlProcessor.selectSingleNode(ns + \"EquivalentAddins\", node);\r\n                        this._equivalentAddins = this._parseEquivalentAddins(equivalentAddinsNode, ns);\r\n                    }\r\n                }\r\n\r\n                if (this._manifestSchemaVersion === OSF.ManifestSchemaVersion[\"1.1\"]) {\r\n                    // Let's try to find VersonOverrides nodes, V1_0, V1_1, V1_2, ..., in this order one by one, until the desired node does not exist.\r\n                    for (const v in OSF.VersionOverridesNumber) {\r\n                        // Since the enum will be iterated twice, one for values as numbers and one for keys as string, let's only do the values.\r\n                        let versionOverridesNumber: number = Number(v);\r\n                        if (isNaN(versionOverridesNumber) || versionOverridesNumber == OSF.VersionOverridesNumber.Max) {   // also ignore 'Max'\r\n                            continue;\r\n                        }\r\n\r\n                        // Get the VersionOverrides node. Handle it if exists or otherwise stop.\r\n                        let versionOverridesNodePath: string[] = OSF.GetVersionOverridesPath(this._xmlProcessor, this._namespace, versionOverridesNumber);\r\n                        let versionOverridesNode: any = OSF.SelectSingleNode(this._xmlProcessor, officeAppNode, versionOverridesNodePath, true /*isStrictPath*/);\r\n                        if (OSF.OUtil.isNullOrUndefined(versionOverridesNode)) {\r\n                            break;\r\n                        }\r\n\r\n                        this._parseRuntimesAndVersionOverrides(versionOverridesNode, versionOverridesNumber);\r\n                    }\r\n                }\r\n            }\r\n\r\n            _parseRuntimesAndVersionOverrides(versionOverridesNode: any, versionOverridesNumber: OSF.VersionOverridesNumber): void {\r\n                let versionOverridesString: string = this.getNodeXsiType(versionOverridesNode);\r\n                if (versionOverridesString === OSF.GetVersionOverridesString(versionOverridesNumber)) {\r\n                    let ns: string = OSF.GetVersionOverridesNamespace(this._namespace, versionOverridesNumber);\r\n                    let hostsNode = this._xmlProcessor.selectSingleNode(ns + \"Hosts\", versionOverridesNode);\r\n                    if (!OSF.OUtil.isNullOrUndefined(hostsNode)) {\r\n                        let hostNodes = this._xmlProcessor.selectNodes(ns + \"Host\", hostsNode);\r\n                        let len = OSF.OUtil.isNullOrUndefined(hostNodes) ? 0 : hostNodes.length;\r\n                        for (let i = 0; i < len; i++) {\r\n\r\n                            this._hostType = this.getNodeXsiType(hostNodes[i]);\r\n\r\n                            let versionOverrides: object;\r\n\r\n                            if (this._hostType !== \"MailHost\") {\r\n                                // For WXP, there is not separate index and it just goes into the main override\r\n                                // We start off with the colletion of values that have already been parsed by the base parser\r\n                                versionOverrides = this._versionOverrides[this._hostType];\r\n                            }\r\n\r\n                            if (OSF.OUtil.isNullOrUndefined(this._versionOverrides[this._hostType])) {\r\n                                this._versionOverrides[this._hostType] = {};\r\n                            }\r\n\r\n                            if (OSF.OUtil.isNullOrUndefined(this._versionOverrides[this._hostType][versionOverridesNumber])) {\r\n                                versionOverrides = {};\r\n                                versionOverrides[\"_addinCommandsExtensionPoints\"] = {};\r\n                                versionOverrides[\"_functionFileResid\"] = {};\r\n                                versionOverrides[\"_supportsSharedFolders\"] = {};\r\n                            }\r\n\r\n                            versionOverrides[\"_webApplicationInfo\"] = {};\r\n                            this._parseWebApplicationInfo(versionOverrides[\"_webApplicationInfo\"], versionOverridesNode, ns);\r\n\r\n                            let connectedServiceControlsScopesNode = OSF.SelectSingleNode(this._xmlProcessor, versionOverridesNode, [ns + \"ConnectedServiceControls\", ns + \"Scopes\"], true /*isStrictPath*/);\r\n                            versionOverrides[\"_connectedServiceControlsScopes\"] = this._parseWebApplicationScopes(connectedServiceControlsScopesNode, ns);\r\n\r\n                            let extendedPermissionsNode = this._xmlProcessor.selectSingleNode(ns + \"ExtendedPermissions\", versionOverridesNode);\r\n                            versionOverrides[\"_extendedPermissions\"] = this._parseExtendedPermissions(extendedPermissionsNode, ns);\r\n\r\n                            let requirementsNode = this._xmlProcessor.selectSingleNode(ns + \"Requirements\", versionOverridesNode);\r\n                            if (!OSF.OUtil.isNullOrUndefined(requirementsNode)) {\r\n                                versionOverrides[\"_requirements\"] = this._parseRequirements(requirementsNode, \"bt:\")\r\n                            }\r\n\r\n                            let runtimesNode = this._xmlProcessor.selectSingleNode(ns + \"Runtimes\", hostNodes[i]);\r\n                            if (runtimesNode) {\r\n                                versionOverrides[\"_runtimes\"] = this._parseRuntimes(runtimesNode, ns);\r\n                            }\r\n\r\n                            let formFactors: string[] = [\"DesktopFormFactor\", \"MobileFormFactor\"];\r\n                            let formFactorIrrelevantPropertiesObtained: boolean = false;\r\n                            for (const formFactor of formFactors) {\r\n                                let addinCommandVersion = this._parseVersionOverridesFormFactor(this._hostType, versionOverridesNumber, formFactor);\r\n                                versionOverrides[\"_addinCommandsExtensionPoints\"][formFactor] = addinCommandVersion.ExtensionPoints;\r\n                                versionOverrides[\"_functionFileResid\"][formFactor] = addinCommandVersion.functionFileResid;\r\n                                versionOverrides[\"_supportsSharedFolders\"][formFactor] = addinCommandVersion.supportsSharedFolders;\r\n                                if (!formFactorIrrelevantPropertiesObtained) {\r\n                                    versionOverrides[\"_description\"] = addinCommandVersion.description;\r\n                                    versionOverrides[\"_resources\"] = addinCommandVersion.resources;\r\n                                    formFactorIrrelevantPropertiesObtained = true;\r\n                                }\r\n                            }\r\n\r\n                            // Now assign these back once they've been filled up with information\r\n                            if (this._hostType === \"MailHost\") {\r\n                                this._versionOverrides[this._hostType][versionOverridesNumber] = versionOverrides;\r\n                            } else {\r\n                                // For WXP, there is not separate index (100, 101 etc.) and it just goes into the main override\r\n                                // We alto take some relevant fields from the _versionOverrides that was parsed by the base OSFManifest\r\n                                // and merge them into the values parsed here.\r\n                                versionOverrides[\"_getStartedNode\"] = this._versionOverrides[this._hostType][\"_getStartedNode\"];\r\n                                versionOverrides[\"_customFunctionExtensionPoint\"] = this._versionOverrides[this._hostType][\"_customFunctionExtensionPoint\"];\r\n                                this._versionOverrides[this._hostType] = versionOverrides;\r\n                            }\r\n\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            _parseExtendedPermissions(extendedPermissionsNode: any, nodeNamespace: string): string[] {\r\n                let extendedPermissions: string[] = [];\r\n                if (!OSF.OUtil.isNullOrUndefined(extendedPermissionsNode)) {\r\n                    let extendedPermissionNodes = this._xmlProcessor.selectNodes(nodeNamespace + \"ExtendedPermission\", extendedPermissionsNode);\r\n                    for (const extendedPermissionNode of extendedPermissionNodes) {\r\n                        extendedPermissions.push(this._xmlProcessor.getNodeValue(extendedPermissionNode));\r\n                    }\r\n                }\r\n                return extendedPermissions;\r\n            }\r\n\r\n            _parseRuntimes(runtimesNode: any, nodeNamespace?: string): OSF.Manifest.Runtimes {\r\n                let runtimes = new OSF.Manifest.Runtimes();\r\n                let ns: string = OSF.OUtil.isNullOrUndefined(nodeNamespace) ? this._namespace : nodeNamespace!;\r\n                if (!OSF.OUtil.isNullOrUndefined(runtimesNode)) {\r\n                    let runtimeNodes = this._xmlProcessor.selectNodes(ns + \"Runtime\", runtimesNode);\r\n                    if (!OSF.OUtil.isNullOrUndefined(runtimeNodes)) {\r\n                        for (let i = 0; i < runtimeNodes.length; i++) {\r\n                            let runtime = this._parseRuntime(runtimeNodes[i], ns);\r\n                            runtimes.add(runtime);\r\n                        }\r\n                    }\r\n                }\r\n                return runtimes;\r\n            }\r\n\r\n            _parseRuntime(runtimeNode: any, nodeNamespace?: string): any {\r\n                if (OSF.OUtil.isNullOrUndefined(runtimeNode)) {\r\n                    return null;\r\n                }\r\n                let runtime = new OSF.Manifest.Runtime();\r\n                runtime.Resid = runtimeNode.getAttribute(\"resid\");\r\n                if (runtimeNode.getAttribute(\"lifetime\") == \"long\") {\r\n                    runtime.LifeTime = RuntimeLifeTime.Long;\r\n                }\r\n                else {\r\n                    runtime.LifeTime = RuntimeLifeTime.Short;\r\n                }\r\n\r\n                let ns: string = OSF.OUtil.isNullOrUndefined(nodeNamespace) ? this._namespace : nodeNamespace!;\r\n                let overrideNodes = this._xmlProcessor.selectNodes(ns + \"Override\", runtimeNode);\r\n                if (!OSF.OUtil.isNullOrUndefined(overrideNodes)) {\r\n                    for (let i = 0; i < overrideNodes.length; i++) {\r\n                        let override = new RuntimeOverride();\r\n                        override.Resid = overrideNodes[i].getAttribute(\"resid\");\r\n                        override.Type = overrideNodes[i].getAttribute(\"type\");\r\n                        runtime.Overrides.push(override);\r\n                    }\r\n                }  \r\n                return runtime;\r\n            }\r\n\r\n            _parseVersionOverridesFormFactor(hostType: string, versionOverridesNumber: OSF.VersionOverridesNumber, formFactor: string): any {\r\n                // Parse add-in commands and cache it.\r\n                let addinCommandsParser = new OfficeExt.Parser.AddinCommandsManifestParser(hostType, formFactor, this._namespace);\r\n                let errorManager = {\r\n                    \"setErrorMessageForAddin\": (errorMessage) => {\r\n                        OsfMsAjaxFactory.msAjaxDebug.trace(\"Error parsing app manifest: \" + errorMessage);\r\n                    }\r\n                };\r\n\r\n                let entitlement: OfficeExt.AddinEntitlement;\r\n                if (OSF.OUtil.isChangeGateEnabled('OfficeVSO:0_ParseExtensionSolutionReference')) {\r\n                    entitlement = this._getEntitlement(this._solutionRef);\r\n                }\r\n                else {\r\n                    entitlement = {\r\n                        solutionId : this._id,\r\n                        version : this._version,\r\n                        storeType : null,\r\n                        storeId: null,\r\n                        assetId: null,\r\n                        assetStoreId : null,\r\n                        targetType: null,\r\n                    };\r\n                }\r\n\r\n                const addinCommands = (addinCommandsParser.parseExtensions(entitlement, this as any, errorManager, versionOverridesNumber)) as OfficeExt.Parser.VersionOverrides;\r\n                return addinCommands;\r\n            }\r\n\r\n            _getVersionOverrides(versionOverridesNumber: OSF.VersionOverridesNumber): any {\r\n                // The base parser for WXP puts the properties at this._versionOverrides[this._hostType] and do not use versionOverrides Number like Outlook.\r\n                if (!OSF.OUtil.isNullOrUndefined(this._versionOverrides[this._hostType]) && OSF.OUtil.isNullOrUndefined(versionOverridesNumber)) {\r\n                    return this._versionOverrides[this._hostType];\r\n                }\r\n                else if (!OSF.OUtil.isNullOrUndefined(this._versionOverrides[this._hostType])) {\r\n                    return this._versionOverrides[this._hostType][versionOverridesNumber];\r\n                }\r\n                else {\r\n                    return null;\r\n                }\r\n            }\r\n\r\n            getLocalesSeen() {\r\n                return this._localesSeen;\r\n            }\r\n\r\n            getFormSettings(): FormSetting[][] {\r\n                return this._formSettings;\r\n            }\r\n\r\n            getDisableEntityHighlighting(): boolean | undefined {\r\n                return this._disableEntityHighlighting;\r\n            }\r\n\r\n            getVersionOverridesDescription(versionOverridesNumber: OSF.VersionOverridesNumber): string | undefined {\r\n                return this._getVersionOverrides(versionOverridesNumber)?._description;\r\n            }\r\n\r\n            getVersionOverridesRequirements(versionOverridesNumber: OSF.VersionOverridesNumber): any {\r\n                return this._getVersionOverrides(versionOverridesNumber)?._requirements;\r\n            }\r\n\r\n            getWebApplicationInfo(versionOverridesNumber: OSF.VersionOverridesNumber): any {\r\n                return this._getVersionOverrides(versionOverridesNumber)?._webApplicationInfo;\r\n            }\r\n\r\n            getConnectedServiceControlsScopes(versionOverridesNumber: OSF.VersionOverridesNumber): string[] | undefined {\r\n                return this._getVersionOverrides(versionOverridesNumber)?._connectedServiceControlsScopes;\r\n            }\r\n\r\n            getExtendedPermissions(versionOverridesNumber: OSF.VersionOverridesNumber): string[] | undefined {\r\n                return this._getVersionOverrides(versionOverridesNumber)?._extendedPermissions;\r\n            }\r\n\r\n            getRuntimes(versionOverridesNumber: OSF.VersionOverridesNumber): any {\r\n                return this._getVersionOverrides(versionOverridesNumber)?._runtimes?.getRuntimes();\r\n            }\r\n\r\n            getExtensionPoints(versionOverridesNumber: OSF.VersionOverridesNumber, formFactor: string): any {\r\n                return this._getVersionOverrides(versionOverridesNumber)?._addinCommandsExtensionPoints[formFactor];\r\n            }\r\n\r\n            getFunctionFileResid(versionOverridesNumber: OSF.VersionOverridesNumber, formFactor: string): string {\r\n                return this._getVersionOverrides(versionOverridesNumber)?._functionFileResid[formFactor] || \"\";\r\n            }\r\n\r\n            getResources(versionOverridesNumber: OSF.VersionOverridesNumber): object {\r\n                return this._getVersionOverrides(versionOverridesNumber)?._resources;\r\n            }\r\n\r\n            getSupportsSharedFolders(versionOverridesNumber: OSF.VersionOverridesNumber, formFactor: string): boolean {\r\n                return this._getVersionOverrides(versionOverridesNumber)?._supportsSharedFolders[formFactor] || false;\r\n            }\r\n        }\r\n    }\r\n}","namespace Mos {\r\n    export class AppMetadata extends OSF.Manifest.Manifest {\r\n        _acquisition:Mos.Acquisition;\r\n        _actualPayload: OSF.PayloadType;\r\n        _hostType: string;\r\n        _hostInfo: OfficeExt.IHostContextInfo;\r\n\r\n        static fromString(payload:string, payloadType: OSF.PayloadType, locale: string, solutionRef?: OfficeExt.OsfSolutionReference): AppMetadata {\r\n            let acquisition: Mos.Acquisition = new Mos.Acquisition();\r\n            acquisition.init(JSON.parse(payload));\r\n            return new this(acquisition, payloadType, locale, solutionRef);\r\n        }\r\n\r\n        static fromAcquisition(acquisition: Mos.Acquisition, locale: string, solutionRef?: OfficeExt.OsfSolutionReference): AppMetadata {\r\n            return new this(acquisition, OSF.PayloadType.MosAcquisition, locale, solutionRef);\r\n        }\r\n\r\n        constructor(acquisition: Mos.Acquisition, payloadType: OSF.PayloadType, locale: string, solutionRef?: OfficeExt.OsfSolutionReference) {\r\n            if (acquisition.titleDefinition.elementDefinitions.officeAddIns?.length > 0) {\r\n                // If the JSON payload contains a UTF-16 BOM character it will fail the JSON.parse as well as XML parsing. We should remove the BOM\r\n                let xmlPayload: string = acquisition.titleDefinition.elementDefinitions.officeAddIns[0].xmlDefinition;\r\n                \r\n                let codepointLength = OSF.OUtil.getBOMCodepointLength(xmlPayload);\r\n                if (codepointLength > 0) {\r\n                    xmlPayload = xmlPayload.substring(codepointLength);\r\n                }\r\n\r\n                super(xmlPayload,locale, OSF.PayloadType.OfficeAddin, solutionRef); // Payload type passed to Osf.Manifest is OfficeAddin\r\n                this._acquisition = acquisition;\r\n            }\r\n            else {\r\n                super(\"\", locale, OSF.PayloadType.MosAcquisition, solutionRef);\r\n                this._acquisition = acquisition;\r\n\r\n                this._hostInfo = null;\r\n                this._hostInfo = OfficeExt.CatalogFactory.getHostContext();\r\n                if (!OSF.OUtil.isNullOrUndefined(this._hostInfo)) {\r\n                    this._hostType = OSF.getManifestHostType(this._hostInfo.hostType);\r\n                }\r\n                // If the Acquisition payload contains extension\r\n                if (acquisition.titleDefinition.elementDefinitions.extensions?.length > 0) {\r\n                    this._populateManifest();\r\n                }\r\n            }\r\n\r\n            this._actualPayload = payloadType;\r\n        }\r\n\r\n        private _populateManifest() {\r\n            this._initPopulator();\r\n            this._populateBaseProperties();\r\n            this._populateExtensionSettings();\r\n            this._populateAddinCommands();\r\n            this._populateWebApplicationInfo();\r\n        }\r\n\r\n        private _initPopulator() {\r\n            // initialize members\r\n            this._displayNames = {};\r\n            this._descriptions = {};\r\n            this._iconUrls = {};\r\n            this._extensionSettings = {};\r\n            this._highResolutionIconUrls = {};\r\n            this._ribbonExtensionControls = {};\r\n            this._versionOverrides = {};\r\n            this._versionOverrides[this._hostType] = {};\r\n        }\r\n\r\n        private _populateBaseProperties() {\r\n            this._manifestSchemaVersion = \"1.1\";\r\n            this._id = this._acquisition.assetId;\r\n            this._providerName = \"Microsoft\";//this._acquisition.titleDefinition.developerName;\r\n            this._defaultLocale = this._UILocale;\r\n\r\n            this._allowSnapshot = true; //TODO\r\n            this._idIssuer = OSF.ManifestIdIssuer.Custom;\r\n\r\n            this._addDisplayName(this._UILocale, this._acquisition.titleDefinition.name);\r\n            this._addDescription(this._UILocale, \"Acquisition Sample\"/*this._acquisition.mosTitleDefinition.shortDescription*/);\r\n\r\n            this._populateBaseOfficeAppType();\r\n            this._populateBaseVersion();\r\n            this._populateBaseDomains();\r\n            this._populateBasePermissions();\r\n            this._populateRuntimes();\r\n            //this._populateExtendedOverrides();\r\n        }\r\n\r\n        private _populateBaseOfficeAppType() {\r\n            // For WXP only Taskpane and Content App is supported.\r\n            // Design for Content App is not finalized yet for MetaOS so setting it to just TaskpaneApp for now.\r\n            this._target = OSF.OfficeAppType.TaskPaneApp; // need to see what we can set\r\n        }\r\n\r\n        private _populateBaseVersion() {\r\n            try {\r\n                this._version = this.complementVersion(this._acquisition.titleDefinition.version);\r\n            }\r\n            catch {\r\n                this._version = this._acquisition.titleDefinition.version;\r\n            }\r\n        }\r\n\r\n        private _populateBasePermissions() {\r\n            this._permissions = OSF.OsfControlPermission.Restricted;\r\n            this.getControlPermissionsFromMosPermissions();\r\n        }\r\n\r\n        private getControlPermissionsFromMosPermissions() {\r\n            let permissions: Mos.Permissions = this.getExtensionPermissions();\r\n            if (!OSF.OUtil.isNullOrUndefined(permissions)) {\r\n                for (let i: number = 0; i < permissions.resourceSpecific.length; i++) {\r\n                    const resourceSpecific: Mos.ResourceSpecific = permissions.resourceSpecific[i];\r\n                    if (resourceSpecific.type === Mos.ResourceSpecificType.Delegated) {\r\n                        switch(resourceSpecific.name) {\r\n                            case \"Document.Restricted.User\":\r\n                                if (this._permissions < OSF.OsfControlPermission.Restricted) {\r\n                                    this._permissions = OSF.OsfControlPermission.Restricted;\r\n                                }\r\n                                break;\r\n                            case \"Document.Read.User\":\r\n                                if (this._permissions < OSF.OsfControlPermission.ReadDocument) {\r\n                                    this._permissions = OSF.OsfControlPermission.ReadDocument;\r\n                                }\r\n                                break;\r\n                            case \"Document.Read.All.User\":\r\n                                if (this._permissions < OSF.OsfControlPermission.ReadAllDocument) {\r\n                                    this._permissions = OSF.OsfControlPermission.ReadAllDocument;\r\n                                }\r\n                                break;\r\n                            case \"Document.Write.User\":\r\n                                if (this._permissions < OSF.OsfControlPermission.WriteDocument) {\r\n                                    this._permissions = OSF.OsfControlPermission.WriteDocument;\r\n                                }\r\n                                break;\r\n                            case \"Document.ReadWrite.User\":\r\n                                if (this._permissions < OSF.OsfControlPermission.ReadWriteDocument) {\r\n                                    this._permissions = OSF.OsfControlPermission.ReadWriteDocument;\r\n                                }\r\n                                break;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        private _populateBaseDomains() {\r\n            this._appDomains = []; //TODO\r\n        }\r\n\r\n        // override base method\r\n        private _populateExtensionSettings() {\r\n            let settings;\r\n            for (let formFactor in OSF.FormFactor) {\r\n                settings = new OSF.Manifest.ExtensionSettings();\r\n                settings._addSourceLocation(this._UILocale, this._acquisition.titleDefinition.elementDefinitions.extensions[0].runtimes[0].code.page);\r\n                this.addManifestUrl(this._acquisition.titleDefinition.elementDefinitions.extensions[0].runtimes[0].code.page);\r\n                this._extensionSettings[formFactor] = settings;\r\n            }\r\n            if (!settings) { //no setting found\r\n                throw OsfMsAjaxFactory.msAjaxError.argument(\"Manifest\");\r\n            }\r\n        }\r\n\r\n        private _populateAddinCommands(){\r\n            // Populate add-in commands and cache it.\r\n            let addinCommandsParser: OfficeExt.Parser.AddinCommandsManifestParser = new OfficeExt.Parser.AddinCommandsManifestParser(this._hostType, \"DesktopFormFactor\");\r\n            let errorManager = {\r\n                \"setErrorMessageForAddin\": (errorMessage) => {\r\n                    OsfMsAjaxFactory.msAjaxDebug.trace(\"Error parsing app manifest: \" + errorMessage);\r\n                }\r\n            };\r\n\r\n            let entitlement: OfficeExt.AddinEntitlement;\r\n            if (OSF.OUtil.isChangeGateEnabled('OfficeVSO:0_ParseExtensionSolutionReference')) {\r\n                entitlement = this._getEntitlement(this._solutionRef);\r\n            }\r\n            else {\r\n                entitlement = {\r\n                    solutionId : this._id,\r\n                    version : this._version,\r\n                    storeType : null,\r\n                    storeId: null,\r\n                    assetId: this._id, // Feature 5311421: need to set assetId properly dependent on storeType and if Private Catalog addin is from store.\r\n                    assetStoreId : null,\r\n                    targetType: null,\r\n                };\r\n            }\r\n\r\n            // TODO: customFunction using customFunctionParser\r\n\r\n            let addinCommands = (addinCommandsParser.parseExtensions(entitlement, this as any, errorManager)) as OfficeExt.Parser.VersionOverrides;\r\n            this._versionOverrides[this._hostType]._addinCommandsExtensionPoints = addinCommands.ExtensionPoints;\r\n            this._versionOverrides[this._hostType]._functionFileResid = addinCommands.functionFileResid;\r\n            this._versionOverrides[this._hostType]._showTaskpaneControls = this._retrieveAppCommandShowTaskpaneControls(this._hostType);\r\n            // validate if taskpaneid and runtime resid pair of show taskpane control is valid or not.\r\n            this._validateShowTaskpaneSharedRuntime(this._hostType);\r\n            this._generateRibbonExtensionControlMap(this._hostType);\r\n        }\r\n\r\n        private _populateWebApplicationInfo() {\r\n            const webApplicationInfo: WebApplicationInfo = this.getWebApplicationInfo();\r\n            if (!OSF.OUtil.isNullOrUndefined(webApplicationInfo)) {\r\n                this._webApplicationResource = webApplicationInfo.resource;\r\n                this._webApplicationId = webApplicationInfo.id;\r\n            }\r\n        }\r\n\r\n        private _populateRuntimes() {\r\n            let mosRuntimes: Mos.Runtimes[] = this.getExtensionRuntimes();\r\n            let runtimes: OSF.Manifest.Runtimes = new OSF.Manifest.Runtimes();\r\n            mosRuntimes.forEach(function(mosRuntime: Mos.Runtimes) {\r\n                let runtime = new OSF.Manifest.Runtime();\r\n                runtime.Resid = mosRuntime.id;\r\n                runtime.LifeTime = mosRuntime.lifetime === \"long\"? RuntimeLifeTime.Long : RuntimeLifeTime.Short;\r\n                // We need to only add this runtime if the lifetime is long(SharedRuntime) as on WAC, a runtime in the runtimes list will be considered as a shared runtime\r\n                // this behavior is different on Win32.\r\n                if (runtime.LifeTime === RuntimeLifeTime.Long) {\r\n                    runtimes.add(runtime);\r\n                }\r\n            });\r\n\r\n            this._versionOverrides[this._hostType]._runtimes = runtimes;\r\n        }\r\n\r\n        public containsAddinCommands(manifestHostType): boolean {\r\n            if (this.containsExtension()) {\r\n                return this.getExtensionShortcut() != null ||\r\n                 this.getExtensionRibbon() != null ||\r\n                 this.getExtensionContextMenu() != null ||\r\n                 this.getAddinCommandRuntimes().length > 0;\r\n            }\r\n            else if (this.containsOfficeAddin()) {\r\n                return super.containsAddinCommands(manifestHostType);\r\n            }\r\n            return false;\r\n        }\r\n\r\n        public containsCustomFunctions(manifestHostType): boolean {\r\n            return false; //TODO\r\n        }\r\n\r\n        public getAcquisition(): Mos.Acquisition {\r\n            return this._acquisition;\r\n        }\r\n\r\n        // AppMetadata getters\r\n        public getExtensionRuntimes(): Mos.Runtimes[] {\r\n            let runtimes: Mos.Runtimes[] = [];\r\n            if (this.containsExtension() && !OSF.OUtil.isNullOrUndefined(this._acquisition.titleDefinition.elementDefinitions.extensions[0].runtimes))\r\n            {\r\n                for (const runtime of this._acquisition.titleDefinition.elementDefinitions.extensions[0].runtimes) {\r\n                    if (Mos.AppMetadata.checkRequirements(runtime.requirements)) {\r\n                        runtimes.push(runtime);\r\n                    }\r\n                }\r\n            }\r\n\r\n            return runtimes;\r\n        }\r\n\r\n        public getLegacyExtensionRuntime(): Mos.Runtimes {\r\n            let legacyRuntime: Mos.Runtimes;\r\n            if (this.containsExtension())\r\n            {\r\n                for(const runtime of this.getExtensionRuntimes()) {\r\n                    // if no actual legacy runtime is found then return the first runtime as the legacy runtime.\r\n                    legacyRuntime = runtime;\r\n                    if(Mos.AppMetadata.isLegacyRuntime(runtime)) {\r\n                        return runtime;\r\n                    }\r\n                }\r\n            }\r\n\r\n            return legacyRuntime;\r\n        }\r\n\r\n        public getAddinCommandRuntimes(): Mos.Runtimes[] {\r\n            let runtimes: Mos.Runtimes[] = [];\r\n            if (this.containsExtension() && !OSF.OUtil.isNullOrUndefined(this._acquisition.titleDefinition.elementDefinitions.extensions[0].runtimes))\r\n            {\r\n                for (const runtime of this._acquisition.titleDefinition.elementDefinitions.extensions[0].runtimes) {\r\n                    if (Mos.AppMetadata.checkRequirements(runtime.requirements) &&\r\n                        !Mos.AppMetadata.isLegacyRuntime(runtime)) {\r\n                        runtimes.push(runtime);\r\n                    }\r\n                }\r\n            }\r\n\r\n            return runtimes;\r\n        }\r\n\r\n        public getExtensionGetStartedMessage(): Mos.GetStartedMessages {\r\n            if (this.containsExtension() && !OSF.OUtil.isNullOrUndefined(this._acquisition.titleDefinition.elementDefinitions.extensions[0].getStartedMessages))\r\n            {\r\n                for (const getStartedMessage of this._acquisition.titleDefinition.elementDefinitions.extensions[0].getStartedMessages) {\r\n                    if (Mos.AppMetadata.checkRequirements(getStartedMessage.requirements)) {\r\n                        return getStartedMessage;\r\n                    }\r\n                }\r\n            }\r\n\r\n            return null;\r\n        }\r\n\r\n        public getExtensionShortcut(): Mos.Shortcuts {\r\n            if (this.containsExtension() && !OSF.OUtil.isNullOrUndefined(this._acquisition.titleDefinition.elementDefinitions.extensions[0].shortcuts))\r\n            {\r\n                for (const shortcut of this._acquisition.titleDefinition.elementDefinitions.extensions[0].shortcuts) {\r\n                    if (Mos.AppMetadata.checkRequirements(shortcut.requirements)) {\r\n                        return shortcut;\r\n                    }\r\n                }\r\n            }\r\n\r\n            return null;\r\n        }\r\n\r\n        public getExtensionRibbon(): Mos.Ribbons {\r\n            if (this.containsExtension() && !OSF.OUtil.isNullOrUndefined(this._acquisition.titleDefinition.elementDefinitions.extensions[0].ribbons))\r\n            {\r\n                for (const ribbon of this._acquisition.titleDefinition.elementDefinitions.extensions[0].ribbons) {\r\n                    if (Mos.AppMetadata.checkRequirements(ribbon.requirements)) {\r\n                        return ribbon;\r\n                    }\r\n                }\r\n            }\r\n\r\n            return null;\r\n        }\r\n\r\n        public getExtensionContextMenu(): Mos.ContextMenus {\r\n            if (this.containsExtension() && !OSF.OUtil.isNullOrUndefined(this._acquisition.titleDefinition.elementDefinitions.extensions[0].contextMenus))\r\n            {\r\n                for (const contextMenu of this._acquisition.titleDefinition.elementDefinitions.extensions[0].contextMenus) {\r\n                    if (Mos.AppMetadata.checkRequirements(contextMenu.requirements)) {\r\n                        return contextMenu;\r\n                    }\r\n                }\r\n            }\r\n\r\n            return null;\r\n        }\r\n\r\n        public getExtensionAlternatives(): Mos.Alternatives {\r\n            if (this.containsExtension() && !OSF.OUtil.isNullOrUndefined(this._acquisition.titleDefinition.elementDefinitions.extensions[0].alternatives))\r\n            {\r\n                for (const alternative of this._acquisition.titleDefinition.elementDefinitions.extensions[0].alternatives) {\r\n                    if (Mos.AppMetadata.checkRequirements(alternative.requirements)) {\r\n                        return alternative;\r\n                    }\r\n                }\r\n            }\r\n            return null;\r\n        }\r\n\r\n        public getExtensionPermissions(): Mos.Permissions {\r\n            return this._acquisition.titleDefinition?.authorization?.permissions;\r\n        }\r\n\r\n        public getExtensionActionById(id: string): Mos.Actions {\r\n            const runtimes: Mos.Runtimes[] = this.getExtensionRuntimes();\r\n            for (let i: number = 0; i < runtimes.length; i++) {\r\n                for (let j: number = 0; j < runtimes[i].actions.length; j++) {\r\n                    if (runtimes[i].actions[j].id === id) {\r\n                        return runtimes[i].actions[j];\r\n                    }\r\n                }\r\n            };\r\n\r\n            return null;\r\n        }\r\n\r\n        public getExtensionRuntimeByActionId(id: string): Mos.Runtimes {\r\n            const runtimes: Mos.Runtimes[] = this.getExtensionRuntimes();\r\n            for (const runtime of runtimes) {\r\n                for (const action of runtime.actions) {\r\n                    if (action.id === id) {\r\n                        return runtime;\r\n                    }\r\n                }\r\n            }\r\n\r\n            return null;\r\n        }\r\n\r\n        public getSource(): string {\r\n            return this._acquisition.titleDefinition.ingestionSource;\r\n        }\r\n\r\n        public getState(): string {\r\n            return this._acquisition.acquisitionState;\r\n        }\r\n\r\n        public getTitleId(): string {\r\n            return this._acquisition.titleId;\r\n        }\r\n\r\n        public getAssetId(): string {\r\n            return this._acquisition.assetId;\r\n        }\r\n\r\n        public getManifestId(): string {\r\n            return this._acquisition.manifestId;\r\n        }\r\n\r\n        public getScope(): string {\r\n            return this._acquisition.titleDefinition.scope;\r\n        }\r\n\r\n        public getVersion(): string {\r\n            return this._version;\r\n        }\r\n\r\n        public toJSON(): any {\r\n            return this._acquisition.toJSON();\r\n        }\r\n\r\n        private getWebApplicationInfo(): WebApplicationInfo {\r\n            return this._acquisition?.titleDefinition?.webApplicationInfo;\r\n        }\r\n\r\n        static checkRequirements(requirements: Mos.Requirements): boolean {\r\n            // TODO: Need to implement requirement checker\r\n            return true;\r\n        }\r\n\r\n        static isLegacyRuntime(runtime: Mos.Runtimes): boolean {\r\n            return !(runtime.actions?.length > 0) &&\r\n                !(runtime.functions?.length > 0);\r\n        }\r\n\r\n        public containsExtension(): boolean {\r\n            return  this._acquisition?.titleDefinition?.elementDefinitions.extensions?.length > 0;\r\n        }\r\n\r\n        public containsOfficeAddin(): boolean {\r\n            return  this._acquisition?.titleDefinition?.elementDefinitions.officeAddIns?.length > 0;\r\n        }\r\n    }\r\n}\r\n","namespace OSF {\r\n    export let AddinIdInfo = (function (addinIdString: string) {\r\n        // Here is the format of the addinId and an example of it (ignore the whitespaces):\r\n        //\r\n        //      formatVersion | solutionId                           | solutionVersion | storeTypeId | storeLocation |||\r\n        //                  2 | c5daabb3-e185-4e8c-adfc-1a7b7283fb6f | 1.0.0.0         | 5           | developer     |||\r\n        //\r\n        var addinIdItemSeparator = \"|\";\r\n        var tokens = addinIdString.split(addinIdItemSeparator);\r\n        var addinIdFormatVersion = \"2\";\r\n        var formatVersionIndex = 0;\r\n        var solutionIdIndex = 1;\r\n        var solutionVersionIndex = 2;\r\n        var storeTypeIdIndex = 3;\r\n        var storeLocationIndex = 4;\r\n        if (tokens.length != 8) {\r\n            Telemetry.RuntimeTelemetryHelper.LogCommonMessageTag(\"OSF.AddinIdInfo.constructor: Unexpected format of the addinId\", null /*appCorrelationId*/, 0x1f31c5c8 /* tag_5m2xi */);\r\n        }\r\n        var _formatVersion = tokens[formatVersionIndex];\r\n        var _solutionId = tokens[solutionIdIndex];\r\n        var _solutionVersion = tokens[solutionVersionIndex];\r\n        var _storeTypeId = tokens[storeTypeIdIndex];\r\n        var _storeLocation = tokens[storeLocationIndex];\r\n        var _compliantSolutionId = null;\r\n        if (_formatVersion != addinIdFormatVersion) {\r\n            Telemetry.RuntimeTelemetryHelper.LogCommonMessageTag(`OSF.AddinIdInfo.constructor: Unexpected format version: ${_formatVersion}.`, null /*appCorrelationId*/, 0x1f31c5c9 /* tag_5m2xj */);\r\n        }\r\n        return {\r\n            getSolutionId: function OSF_AddinIdInfo$getSolutionId() {\r\n                return _solutionId;\r\n            },\r\n            getSolutionVersion: function OSF_AddinIdInfo$getSolutionVersion() {\r\n                return _solutionVersion;\r\n            },\r\n            getFormatVersion: function OSF_AddinIdInfo$getFormatVersion() {\r\n                return _formatVersion;\r\n            },\r\n            getStoreTypeId: function OSF_AddinIdInfo$getStoreTypeId() {\r\n                return _storeTypeId;\r\n            },\r\n            getStoreLocation: function OSF_AddinIdInfo$getStoreLocation() {\r\n                return _storeLocation;\r\n            },\r\n            getPrivacyCompliantSolutionId: function OSF_AddinIdInfo$getPrivacyCompliantSolutionId() {\r\n                // Bug#6244148 - AddinInfo always returning \"Private\" for SolutionIds from Centralized deployed addins\r\n                //  This class doesn't support passing in the AssetId which is required to check if an Add in is public for the PrivateCatalog scenario.\r\n                if (_compliantSolutionId == null) {\r\n                    _compliantSolutionId = Telemetry.PrivacyRules.GetPrivacyCompliantId(_solutionId, OfficeExt.ManifestUtil.GetStoreTypeName(_storeTypeId), null /* assetId */, null, null, _storeLocation);\r\n                }\r\n                return _compliantSolutionId == null ? _solutionId : _compliantSolutionId;\r\n            },\r\n    \r\n            needToRestoreManifest: function OSF_AddinIdInfo$needToRestoreManifest() {\r\n                return _storeTypeId == OSF.StoreTypeEnum.Registry.toString();\r\n            }\r\n        };\r\n    });\r\n\r\n    /// <summary>\r\n    /// manifest manager\r\n    /// in charge of managing manifest retrieval and caching.\r\n    /// </summary>\r\n    /// <accessibility>public</accessibility>\r\n    export let OsfManifestManager = (function () {\r\n        var _cachedManifests = {};\r\n        var _UILocale = \"en-us\";\r\n        var _pendingRequests = {};\r\n        /// <summary>\r\n        /// help method to generate cache key.\r\n        /// </summary>\r\n        /// <accessibility>private</accessibility>\r\n        /// <param name=\"marketplaceID\">marketplaceID (type: string)</param>\r\n        /// <param name=\"marketplaceVersion\">marketplaceVersion (type: string)</param>\r\n        /// <returns>a string representing the generated cache key.</returns>\r\n        function _generateKey(marketplaceID, marketplaceVersion) {\r\n            return marketplaceID + \"_\" + marketplaceVersion;\r\n        }\r\n        return {\r\n            /// <summary>\r\n            /// get manifest, if it exists in the cache, just reuse it, otherwise retrieve it from corporate gallery.\r\n            /// </summary>\r\n            /// <accessibility>public</accessibility>\r\n            /// <param name=\"osfControl\">osfControl (type: OsfControl)</param>\r\n            /// <param name=\"onCompleted\">callback for get manifest (type: Function)</param>\r\n            getManifestAsync: function OSF_OsfManifestManager$getManifestAsync(context, onCompleted) {\r\n                OSF.OUtil.validateParamObject(context, {\r\n                    \"osfControl\": { type: Object, mayBeNull: false },\r\n                    \"referenceInUse\": { type: Object, mayBeNull: false }\r\n                }, onCompleted);\r\n\r\n                var me = this;\r\n                var reference = context.referenceInUse;\r\n                var cacheManifestKey = reference.solutionId;\r\n                if (context.osfControl != null && context.osfControl._sharedRuntimeId != null && context.osfControl._sharedRuntimeId.length > 0) {\r\n                    cacheManifestKey = OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(reference.solutionId, context.osfControl._sharedRuntimeId);\r\n                }\r\n                var cacheKey = _generateKey(cacheManifestKey, reference.version);\r\n                var manifest = _cachedManifests[cacheKey];\r\n                context.manifestCached = false;\r\n                if (manifest) {\r\n                    context.manifestCached = true;\r\n                    if (me.manifestContainsDownloadResources(manifest)) {\r\n                        me.downloadResourcesAsync(context, onCompleted, manifest, cacheKey);\r\n                    }\r\n                    else {\r\n                        onCompleted({ \"statusCode\": OSF.ProxyCallStatusCode.Succeeded, \"value\": manifest, \"context\": context });\r\n                    }\r\n                }\r\n                else if (context.clientEndPoint && context.manifestUrl) {\r\n                    Telemetry.AppLoadTimeHelper.ManifestRequestStart(context.osfControl._telemetryContext);\r\n                    var onRetrieveManifestCompleted = function (asyncResult) {\r\n                        if (asyncResult.statusCode === OSF.ProxyCallStatusCode.Succeeded && asyncResult.value) {\r\n                            var osfControl;\r\n                            try {\r\n                                osfControl = asyncResult.context.osfControl;\r\n                                var manifestString;\r\n                                if (typeof (asyncResult.value) === \"string\") {\r\n                                    //we have this check here to avoid breaking with old CC server that returns string instead of object\r\n                                    //TODO remove it later.\r\n                                    asyncResult.context.manifestCached = true; //for now, set cached flag to avoid showing warning for old CC server.\r\n                                    manifestString = asyncResult.value;\r\n                                }\r\n                                else {\r\n                                    asyncResult.context.manifestCached = asyncResult.value.cached;\r\n                                    manifestString = asyncResult.value.manifest;\r\n                                }\r\n                                Telemetry.AppLoadTimeHelper.SetManifestDataCachedFlag(osfControl._telemetryContext, asyncResult.value.cached);\r\n                                asyncResult.value = new OSF.Manifest.Manifest(manifestString, osfControl._contextActivationMgr.getAppUILocale());\r\n                                OSF.OsfManifestManager.cacheManifest(reference.solutionId, reference.version, asyncResult.value);\r\n                            }\r\n                            catch (ex) {\r\n                                asyncResult.value = null;\r\n                                var appCorrelationId;\r\n                                if (osfControl) {\r\n                                    appCorrelationId = osfControl._appCorrelationId;\r\n                                }\r\n                                var message = \"Invalid manifest in getManifestAsync.\";\r\n                                OfficeExt.WACUtils.logExceptionToBrowserConsole(message, ex);\r\n                                Telemetry.RuntimeTelemetryHelper.LogExceptionTag(message, ex, appCorrelationId, 0x1f31c5ca /* tag_5m2xk */);\r\n                            }\r\n                        }\r\n                        else {\r\n                            Telemetry.RuntimeTelemetryHelper.LogExceptionTag(\"getManifestAsync failed:\" + OfficeExt.WACUtils.serializeObjectToString(asyncResult), null, null, 0x1f31c5cb /* tag_5m2xl */);\r\n                        }\r\n                        if (me.manifestContainsDownloadResources(manifest)) {\r\n                            me.downloadResourcesAsync(context, onCompleted, asyncResult.value, cacheKey);\r\n                        }\r\n                        else {\r\n                            onCompleted(asyncResult);\r\n                        }\r\n                    };\r\n                    var params = {\r\n                        \"manifestUrl\": context.manifestUrl,\r\n                        \"id\": reference.solutionId,\r\n                        \"version\": reference.version,\r\n                        \"clearCache\": context.clearCache || false\r\n                    };\r\n                    this._invokeProxyMethodAsync(context, \"OEM_getManifestAsync\", onRetrieveManifestCompleted, params);\r\n                }\r\n                else {\r\n                    onCompleted({ \"statusCode\": OSF.ProxyCallStatusCode.Failed, \"value\": null, \"context\": context });\r\n                }\r\n            },\r\n            /// <summary>\r\n            /// Safely checks if the given object is a manifest that contains download resources.\r\n            /// This functions acts as a gate check to preserve old behavior for manifests that don't contain download resources.\r\n            /// For now, we only handle ExtendedOverrides. CustomFunctions follow.\r\n            /// </summary>\r\n            manifestContainsDownloadResources: function OSF_OsfManifestManager$manifestContainsDownloadResources(manifest) {\r\n                return this.manifestContainsExtendedOverrides(manifest);\r\n            },\r\n            /// <summary>\r\n            /// Safely checks if the given object is a manifest that contains ExtendedOverrides.\r\n            /// This functions acts as a gate check to preserve old behavior for manifests that don't contain ExtendedOverrides.\r\n            /// </summary>\r\n            manifestContainsExtendedOverrides: function OSF_OsfManifestManager$manifestContainsExtendedOverrides(manifest) {\r\n                return typeof manifest === \"object\" && typeof manifest.getExtendedOverrides === \"function\" && typeof manifest.getExtendedOverrides() === \"object\";\r\n            },\r\n            /// <summary>\r\n            /// Downloads and parses satellite resources if exist in the manifest.\r\n            /// </summary>\r\n            downloadResourcesAsync: function OSF_OsfManifestManager$downloadResourcesAsync(context, onCompleted, manifest, cacheKey) {\r\n                if (this.manifestContainsExtendedOverrides(manifest)) {\r\n                    this.downloadExtendedOverridesAsync(context, onCompleted, manifest, cacheKey);\r\n                }\r\n            },\r\n            /// <summary>\r\n            /// Downloads and parses ExtendedOverrides if exists in the manifest.\r\n            /// </summary>\r\n            downloadExtendedOverridesAsync: function OSF_OsfManifestManager$downloadExtendedOverridesAsync(context, onCompleted, manifest, cacheKey) {\r\n                var me = this;\r\n                const completeWithSuccess = (context, onCompleted, manifest) => {\r\n                    onCompleted({ \"statusCode\": OSF.ProxyCallStatusCode.Succeeded, \"value\": manifest, \"context\": context });\r\n                };\r\n                const completeWithError = (context, onCompleted, ex, message) => {\r\n                    const appCorrelationId = context.osfControl._appCorrelationId;\r\n                    OfficeExt.WACUtils.logExceptionToBrowserConsole(message, ex);\r\n                    Telemetry.RuntimeTelemetryHelper.LogExceptionTag(message, ex, appCorrelationId, 0x1f31c5cc /* tag_5m2xm */);\r\n                    // Remove from the manifest from cache if it's there.\r\n                    if (me._cachedManifests && me._cachedManifests[cacheKey]) {\r\n                        me._cachedManifests[cacheKey] = undefined;\r\n                    }\r\n                    onCompleted({ \"statusCode\": OSF.ProxyCallStatusCode.Failed, \"value\": null, \"context\": context });\r\n                };\r\n                // Double-check the gating condition.\r\n                if (!this.manifestContainsExtendedOverrides(manifest)) {\r\n                    completeWithError(context, onCompleted, \"Unreachable\", \"Unreachable code path executed!\");\r\n                }\r\n                try {\r\n                    let isInserted = context.osfControl.getInitializationReason() == Microsoft.Office.WebExtension.InitializationReason.Inserted;\r\n                    context.osfControl.processManifestForExtendedOverrides(manifest, isInserted)\r\n                        .then(() => completeWithSuccess(context, onCompleted, manifest))[\"catch\"]((ex) => completeWithError(context, onCompleted, ex, \"Invalid ExtendedOverrides content.\"));\r\n                }\r\n                catch (ex) {\r\n                    completeWithError(context, onCompleted, ex, \"Unexpected exception from OsfControlV2.processManifestForExtendedOverrides()\");\r\n                }\r\n            },\r\n            /// <summary>\r\n            /// get app instance info from app instance id.\r\n            /// </summary>\r\n            /// <accessibility>public</accessibility>\r\n            /// <param name=\"context\">context for this call</param>\r\n            /// <param name=\"onCompleted\">callback for get app instance info (type: Function)</param>\r\n            getAppInstanceInfoByIdAsync: function OSF_OsfManifestManager$getAppInstanceInfoByIdAsync(context, onCompleted) {\r\n                OSF.OUtil.validateParamObject(context, {\r\n                    \"webUrl\": { type: String, mayBeNull: false },\r\n                    \"appInstanceId\": { type: String, mayBeNull: false },\r\n                    \"clientEndPoint\": { type: Object, mayBeNull: false }\r\n                }, onCompleted);\r\n                var params = { \"webUrl\": context.webUrl, \"appInstanceId\": context.appInstanceId, \"clearCache\": context.clearCache || false };\r\n                this._invokeProxyMethodAsync(context, \"OEM_getSPAppInstanceInfoByIdAsync\", onCompleted, params);\r\n            },\r\n            /// <summary>\r\n            /// get SP token from product id.\r\n            /// </summary>\r\n            /// <accessibility>public</accessibility>\r\n            /// <param name=\"context\">context for this call</param>\r\n            /// <param name=\"onCompleted\">callback for get SP token (type: Function)</param>\r\n            getSPTokenByProductIdAsync: function OSF_OsfManifestManager$getSPTokenByProductIdAsync(context, onCompleted) {\r\n                OSF.OUtil.validateParamObject(context, {\r\n                    \"appWebUrl\": { type: String, mayBeNull: false },\r\n                    \"productId\": { type: String, mayBeNull: false }\r\n                }, onCompleted);\r\n                var me = this;\r\n                var createSharePointProxyCompleted = function (clientEndPoint) {\r\n                    if (clientEndPoint) {\r\n                        var params = { \"webUrl\": context.appWebUrl, \"productId\": context.productId, \"clearCache\": context.clearCache || false, \"clientEndPoint\": clientEndPoint };\r\n                        me._invokeProxyMethodAsync(context, \"OEM_getSPTokenByProductIdAsync\", onCompleted, params);\r\n                    }\r\n                    else {\r\n                        onCompleted({ \"statusCode\": OSF.ProxyCallStatusCode.ProxyNotReady, \"value\": null, \"context\": context });\r\n                    }\r\n                };\r\n                context.osfControl._contextActivationMgr._createSharePointIFrameProxy(context.appWebUrl, createSharePointProxyCompleted);\r\n            },\r\n            getSPAppEntitlementsAsync: function OSF_OsfManifestManager$getSPAppEntitlementsAsync(context, onCompleted) {\r\n                OSF.OUtil.validateParamObject(context, {\r\n                    \"osfControl\": { type: Object, mayBeNull: false },\r\n                    \"referenceInUse\": { type: Object, mayBeNull: false },\r\n                    \"baseUrl\": { type: String, mayBeNull: false },\r\n                    \"pageUrl\": { type: String, mayBeNull: false },\r\n                    \"webUrl\": { type: String, mayBeNull: true }\r\n                }, onCompleted);\r\n                if (!context.webUrl) {\r\n                    //webUrl hasn't been resolved from pageUrl yet\r\n                    var aElement = document.createElement('a');\r\n                    aElement.href = context.pageUrl;\r\n                    var pathName = aElement.pathname;\r\n                    var subPaths = pathName.split(\"/\");\r\n                    var subPathCount = subPaths.length - 1;\r\n                    var path = aElement.href.substring(0, aElement.href.length - pathName.length);\r\n                    if (path && path.charAt(path.length - 1) !== '/') {\r\n                        path += '/';\r\n                    }\r\n                    var paths = [path];\r\n                    for (var i = 0; i < subPathCount; i++) {\r\n                        if (subPaths[i]) {\r\n                            path = path + subPaths[i] + \"/\";\r\n                            paths.push(path);\r\n                        }\r\n                    }\r\n                    aElement = null;\r\n                    var me = this;\r\n                    var contextActivationMgr = context.osfControl._contextActivationMgr;\r\n                    var baseUrl = paths.pop();\r\n                    var onResolvePageUrlCompleted = function (asyncResult) {\r\n                        if (asyncResult.statusCode === OSF.ProxyCallStatusCode.Succeeded) {\r\n                            var resolvedUrl = asyncResult.value;\r\n                            if (resolvedUrl && resolvedUrl.charAt(resolvedUrl.length - 1) !== '/') {\r\n                                resolvedUrl += '/';\r\n                            }\r\n                            contextActivationMgr._webUrl = resolvedUrl;\r\n                            asyncResult.context.webUrl = resolvedUrl;\r\n                            asyncResult.context.appWebUrl = resolvedUrl;\r\n                            me.getCorporateCatalogEntitlementsAsync(asyncResult.context, onCompleted);\r\n                        }\r\n                        else {\r\n                            //resolve web url from page url failed\r\n                            onCompleted(asyncResult);\r\n                        }\r\n                    };\r\n                    var createSPAppProxyCompleted = function (clientEndPoint) {\r\n                        if (clientEndPoint) {\r\n                            context.clientEndPoint = clientEndPoint;\r\n                            var params = { \"pageUrl\": context.pageUrl, \"baseUrl\": baseUrl, \"clearCache\": context.clearCache || false };\r\n                            me._invokeProxyMethodAsync(context, \"OEM_getSPAppWebUrlFromPageUrlAsync\", onResolvePageUrlCompleted, params);\r\n                        }\r\n                        else if (paths.length > 0) {\r\n                            baseUrl = paths.pop();\r\n                            contextActivationMgr._createSharePointIFrameProxy(baseUrl, createSPAppProxyCompleted);\r\n                        }\r\n                        else {\r\n                            onCompleted({ \"statusCode\": OSF.ProxyCallStatusCode.Failed, \"value\": null, \"context\": context });\r\n                        }\r\n                    };\r\n                    contextActivationMgr._createSharePointIFrameProxy(baseUrl, createSPAppProxyCompleted);\r\n                }\r\n                else {\r\n                    this.getCorporateCatalogEntitlementsAsync(context, onCompleted);\r\n                }\r\n            },\r\n            /// <summary>\r\n            /// get corporate catalog entitlements\r\n            /// </summary>\r\n            /// <accessibility>public</accessibility>\r\n            /// <param name=\"context\">context for get entitlement call</param>\r\n            /// <param name=\"onCompleted\">callback (type: Function)</param>\r\n            getCorporateCatalogEntitlementsAsync: function OSF_OsfManifestManager$getCorporateCatalogEntitlementsAsync(context, onCompleted) {\r\n                OSF.OUtil.validateParamObject(context, {\r\n                    \"osfControl\": { type: Object, mayBeNull: false },\r\n                    \"referenceInUse\": { type: Object, mayBeNull: false },\r\n                    \"webUrl\": { type: String, mayBeNull: false }\r\n                }, onCompleted);\r\n                // Corporate Authentication starts\r\n                Telemetry.AppLoadTimeHelper.AuthenticationStart(context.osfControl._telemetryContext);\r\n                var me = this;\r\n                var retries = 0;\r\n                var createSharePointProxyCompleted = function (clientEndPoint) {\r\n                    if (clientEndPoint) {\r\n                        // Corporate Authentication is done.\r\n                        Telemetry.AppLoadTimeHelper.AuthenticationEnd(context.osfControl._telemetryContext);\r\n                        context.clientEndPoint = clientEndPoint;\r\n                        var params = {\r\n                            \"webUrl\": context.webUrl,\r\n                            \"applicationName\": OSF.HostCapability[context.hostType],\r\n                            \"officeExtentionTarget\": (context.noTargetType || context.osfControl.getOsfControlType() === OSF.OsfControlTarget.TaskPane) /*TODO */ ? null : context.osfControl.getOsfControlType(),\r\n                            // There are other type of Apps such as DictionaryApp we don't handle in the code right now. So we will not filter them out by putting TargetType as null for Taskpane only.\r\n                            \"clearCache\": context.clearCache || false,\r\n                            \"supportedManifestVersions\": {\r\n                                \"1.0\": true,\r\n                                \"1.1\": true\r\n                            }\r\n                        };\r\n                        me._invokeProxyMethodAsync(context, \"OEM_getEntitlementSummaryAsync\", onCompleted, params);\r\n                    }\r\n                    else {\r\n                        if (retries < OSF.Constants.AuthenticatedConnectMaxTries) {\r\n                            retries++;\r\n                            setTimeout(function () {\r\n                                context.osfControl._contextActivationMgr._createSharePointIFrameProxy(context.webUrl, createSharePointProxyCompleted);\r\n                            }, 500);\r\n                        }\r\n                        else {\r\n                            onCompleted({\r\n                                \"statusCode\": OSF.ProxyCallStatusCode.ProxyNotReady,\r\n                                \"value\": null,\r\n                                \"context\": context\r\n                            });\r\n                        }\r\n                    }\r\n                };\r\n                context.osfControl._contextActivationMgr._createSharePointIFrameProxy(context.webUrl, createSharePointProxyCompleted);\r\n            },\r\n            _invokeProxyMethodAsync: function OSF_OsfManifestManager$_invokeProxyMethodAsync(context, methodName, onCompleted, params) {\r\n                var clientEndPointUrl = params.clientEndPoint ? params.clientEndPoint._targetUrl : context.clientEndPoint._targetUrl;\r\n                var requestKeyParts = [clientEndPointUrl, methodName];\r\n                var runtimeType;\r\n                for (var p in params) {\r\n                    runtimeType = typeof params[p];\r\n                    if (runtimeType === \"string\" || runtimeType === \"number\" || runtimeType === \"boolean\") {\r\n                        requestKeyParts.push(params[p]);\r\n                    }\r\n                }\r\n                var requestKey = requestKeyParts.join(\".\");\r\n                var myPendingRequests = _pendingRequests;\r\n                var newRequestHandler = { \"onCompleted\": onCompleted, \"context\": context, \"methodName\": methodName };\r\n                var pendingRequestHandlers = myPendingRequests[requestKey];\r\n                if (!pendingRequestHandlers) {\r\n                    myPendingRequests[requestKey] = [newRequestHandler];\r\n                    var onMethodCallCompleted = function (errorCode, response) {\r\n                        var value = null;\r\n                        var statusCode = OSF.ProxyCallStatusCode.Failed;\r\n                        if (errorCode === 0 && response.status) {\r\n                            value = response.result;\r\n                            statusCode = OSF.ProxyCallStatusCode.Succeeded;\r\n                        }\r\n                        var currentPendingRequests = myPendingRequests[requestKey];\r\n                        delete myPendingRequests[requestKey];\r\n                        var pendingRequestHandlerCount = currentPendingRequests.length;\r\n                        for (var i = 0; i < pendingRequestHandlerCount; i++) {\r\n                            var currentRequestHandler = currentPendingRequests.shift();\r\n                            // Control id is optional, if this is a call associated to an app use it for logging information.  Some calls may have no control.\r\n                            var appCorrelationId;\r\n                            try {\r\n                                if (currentRequestHandler.context && currentRequestHandler.context.osfControl) {\r\n                                    appCorrelationId = currentRequestHandler.context.osfControl._appCorrelationId;\r\n                                }\r\n                                if (response && response.failureInfo) {\r\n                                    Telemetry.RuntimeTelemetryHelper.LogProxyFailure(appCorrelationId, currentRequestHandler.methodName, response.failureInfo);\r\n                                }\r\n                                currentRequestHandler.onCompleted({ \"statusCode\": statusCode, \"value\": value, \"context\": currentRequestHandler.context });\r\n                            }\r\n                            catch (ex) {\r\n                                var message = \"_invokeProxyMethodAsync failed.\";\r\n                                OfficeExt.WACUtils.logExceptionToBrowserConsole(message, ex);\r\n                                Telemetry.RuntimeTelemetryHelper.LogExceptionTag(message, ex, appCorrelationId, 0x1f31c5cd /* tag_5m2xn */);\r\n                            }\r\n                        }\r\n                    };\r\n                    //allow clientEndPoint override\r\n                    var clientEndPoint = context.clientEndPoint;\r\n                    if (params.clientEndPoint) {\r\n                        clientEndPoint = params.clientEndPoint;\r\n                        delete params.clientEndPoint;\r\n                    }\r\n                    // for all OMEX requests, pass in major.minor.revision as office version\r\n                    if (context.referenceInUse && context.referenceInUse.storeType === OSF.StoreType.OMEX) {\r\n                        params.officeVersion = OSF.Constants.ThreePartsFileVersion;\r\n                    }\r\n                    clientEndPoint.invoke(methodName, onMethodCallCompleted, params);\r\n                }\r\n                else {\r\n                    pendingRequestHandlers.push(newRequestHandler);\r\n                }\r\n            },\r\n            removeOmexCacheAsync: function OSF_OsfManifestManager$removeOmexCacheAsync(context, onCompleted) {\r\n                OSF.OUtil.validateParamObject(context, {\r\n                    \"osfControl\": { type: Object, mayBeNull: false },\r\n                    \"referenceInUse\": { type: Object, mayBeNull: false },\r\n                    \"clientEndPoint\": { type: Object, mayBeNull: false }\r\n                }, onCompleted);\r\n\r\n                var reference = context.referenceInUse;\r\n                var params: any = {\r\n                    \"applicationName\": context.hostType,\r\n                    \"assetID\": reference.solutionId,\r\n                    \"officeExtentionTarget\": context.osfControl.getOsfControlType(),\r\n                    \"clearEntitlement\": context.clearEntitlement || false,\r\n                    \"clearToken\": context.clearToken || false,\r\n                    \"clearAppState\": context.clearAppState || false,\r\n                    \"clearManifest\": context.clearManifest || false,\r\n                    \"appVersion\": context.appVersion\r\n                };\r\n                if (context.anonymous) {\r\n                    params.contentMarket = reference.storeId;\r\n                }\r\n                else {\r\n                    params.assetContentMarket = context.osfControl._omexEntitlement.contentMarket;\r\n                    params.userContentMarket = reference.storeId;\r\n                }\r\n                this._invokeProxyMethodAsync(context, \"OMEX_removeCacheAsync\", onCompleted, params);\r\n            },\r\n            /// <summary>\r\n            /// purge manifest from cache\r\n            /// </summary>\r\n            /// <accessibility>public</accessibility>\r\n            /// <param name=\"marketplaceID\">marketplaceID (type: string)</param>\r\n            /// <param name=\"marketplaceVersion\">marketplaceVersion (type: string)</param>\r\n            purgeManifest: function OSF_OsfManifestManager$purgeManifest(marketplaceID, marketplaceVersion) {\r\n                var e = Function._validateParams(arguments, [\r\n                    { name: \"marketplaceID\", type: String, mayBeNull: false },\r\n                    { name: \"marketplaceVersion\", type: String, mayBeNull: false }\r\n                ]);\r\n                if (e)\r\n                    throw e;\r\n                var cacheKey = _generateKey(marketplaceID, marketplaceVersion);\r\n                if (typeof _cachedManifests[cacheKey] != \"undefined\") {\r\n                    delete _cachedManifests[cacheKey];\r\n                }\r\n            },\r\n            /// <summary>\r\n            /// cache manifest from XML string (Pass in marketplaceID and marketplaceVersion explictly to work around issues\r\n            /// where version known to host apps are different from version in the manfiest file. )\r\n            /// </summary>\r\n            /// <accessibility>public</accessibility>\r\n            /// <param name=\"marketplaceID\">marketplaceID (type: string)</param>\r\n            /// <param name=\"marketplaceVersion\">marketplaceVersion (type: string)</param>\r\n            /// <param name=\"manifestXml\">The XML string of the manifest</param>\r\n            /// <param name=\"uiLocale\">The UI locale used to process the manifest</param>\r\n            cacheManifestFromXml: function OSF_OsfManifestManager$cacheManifestFromXml(marketplaceID, marketplaceVersion, manifestXml, uiLocale) {\r\n                var e = Function._validateParams(arguments, [\r\n                    { name: \"marketplaceID\", type: String, mayBeNull: false },\r\n                    { name: \"marketplaceVersion\", type: String, mayBeNull: false },\r\n                    { name: \"manifestXml\", type: String, mayBeNull: false },\r\n                    { name: \"uiLocale\", type: String, mayBeNull: false }\r\n                ]);\r\n                if (e)\r\n                    throw e;\r\n                this.cacheManifest(marketplaceID, marketplaceVersion, new OSF.Manifest.Manifest(manifestXml, uiLocale));\r\n            },\r\n            /// <summary>\r\n            /// cache manifest (Pass in marketplaceID and marketplaceVersion explictly to work around issues\r\n            /// where version known to host apps are different from version in the manfiest file. )\r\n            /// </summary>\r\n            /// <accessibility>public</accessibility>\r\n            /// <param name=\"marketplaceID\">marketplaceID (type: string)</param>\r\n            /// <param name=\"marketplaceVersion\">marketplaceVersion (type: string)</param>\r\n            /// <param name=\"manifest\">manifest object</param>\r\n            cacheManifest: function OSF_OsfManifestManager$cacheManifest(marketplaceID, marketplaceVersion, manifest) {\r\n                var e = Function._validateParams(arguments, [\r\n                    { name: \"marketplaceID\", type: String, mayBeNull: false },\r\n                    { name: \"marketplaceVersion\", type: String, mayBeNull: false },\r\n                    { name: \"manifest\", type: Object, mayBeNull: false }\r\n                ]);\r\n                if (e)\r\n                    throw e;\r\n                var cacheKey = _generateKey(marketplaceID, marketplaceVersion);\r\n                manifest._UILocale = manifest._UILocale || _UILocale;\r\n                _cachedManifests[cacheKey] = manifest;\r\n            },\r\n            /// <summary>\r\n            /// check to see if manifest is already cached.\r\n            /// </summary>\r\n            /// <accessibility>public</accessibility>\r\n            /// <param name=\"marketplaceID\">marketplaceID (type: string)</param>\r\n            /// <param name=\"marketplaceVersion\">marketplaceVersion (type: string)</param>\r\n            hasManifest: function OSF_OsfManifestManager$hasManifest(marketplaceID, marketplaceVersion) {\r\n                var e = Function._validateParams(arguments, [\r\n                    { name: \"marketplaceID\", type: String, mayBeNull: false },\r\n                    { name: \"marketplaceVersion\", type: String, mayBeNull: false }\r\n                ]);\r\n                if (e)\r\n                    throw e;\r\n                var cacheKey = _generateKey(marketplaceID, marketplaceVersion);\r\n                if (typeof _cachedManifests[cacheKey] != \"undefined\")\r\n                    return true;\r\n                return false;\r\n            },\r\n            /// <summary>\r\n            /// check to see if manifest already exist for control\r\n            /// </summary>\r\n            /// <accessibility>public</accessibility>\r\n            /// <param name=\"context\">OSF control context</param>\r\n            hasManifestForControl: function OSF_OsfManifestManager$hasManifestForControl(context) {\r\n                OSF.OUtil.validateParamObject(context, {\r\n                    \"referenceInUse\": { type: Object, mayBeNull: false }\r\n                }, null);\r\n                return this.hasManifest(context.referenceInUse.solutionId, context.referenceInUse.version);\r\n            },\r\n            /// <summary>\r\n            /// get cached manifest.\r\n            /// </summary>\r\n            /// <accessibility>public</accessibility>\r\n            /// <param name=\"marketplaceID\">marketplaceID (type: string)</param>\r\n            /// <param name=\"marketplaceVersion\">marketplaceVersion (type: string)</param>\r\n            getCachedManifest: function OSF_OsfManifestManager$getCachedManifest(marketplaceID, marketplaceVersion) {\r\n                var e = Function._validateParams(arguments, [\r\n                    { name: \"marketplaceID\", type: String, mayBeNull: false },\r\n                    { name: \"marketplaceVersion\", type: String, mayBeNull: false }\r\n                ]);\r\n                if (e)\r\n                    throw e;\r\n                var cacheKey = _generateKey(marketplaceID, marketplaceVersion);\r\n                return _cachedManifests[cacheKey];\r\n            },\r\n            /// <summary>\r\n            /// get manifestCacheKey for sharedRuntime.\r\n            /// </summary>\r\n            /// <accessibility>public</accessibility>\r\n            /// <param name=\"marketplaceID\">marketplaceID (type: string)</param>\r\n            /// <param name=\"sharedRuntimeId\">sharedRuntimeId (type: string)</param>\r\n            getSharedRuntimeManifestCacheKey: function OSF_OsfManifestManager$getSharedRuntimeManifestCacheKey(marketplaceID, sharedRuntimeId) {\r\n                var e = Function._validateParams(arguments, [\r\n                    { name: \"marketplaceID\", type: String, mayBeNull: false },\r\n                    { name: \"sharedRuntimeId\", type: String, mayBeNull: false }\r\n                ]);\r\n                if (e)\r\n                    throw e;\r\n                return marketplaceID + sharedRuntimeId;\r\n            },\r\n            /// <summary>\r\n            /// is version1 less than version2\r\n            /// </summary>\r\n            /// <accessibility>public</accessibility>\r\n            /// <param name=\"version1\">version1 (type: string)</param>\r\n            /// <param name=\"version2\">version2 (type: string)</param>\r\n            versionLessThan: function OSF_OsfManifestManager$versionLessThan(version1, version2) {\r\n                var version1Parts = version1.split(\".\");\r\n                var version2Parts = version2.split(\".\");\r\n                var len = Math.min(version1Parts.length, version2Parts.length);\r\n                var version1Part, version2Part, i;\r\n                for (i = 0; i < len; i++) {\r\n                    try {\r\n                        version1Part = parseFloat(version1Parts[i]);\r\n                        version2Part = parseFloat(version2Parts[i]);\r\n                        if (version1Part != version2Part) {\r\n                            return version1Part < version2Part;\r\n                        }\r\n                    }\r\n                    catch (ex) { }\r\n                }\r\n                //all digits are the same except the remaining ones\r\n                if (version1Parts.length >= version2Parts.length) {\r\n                    return false;\r\n                }\r\n                else {\r\n                    //version1Parts.length < version2Parts.length\r\n                    //handle the case like \"12.0\" vs. \"12.0.0.0\"\r\n                    len = version2Parts.length;\r\n                    var remainingSum = 0;\r\n                    for (i = version1Parts.length; i < len; i++) {\r\n                        try {\r\n                            version2Part = parseFloat(version2Parts[i]);\r\n                        }\r\n                        catch (ex) {\r\n                            version2Part = 0;\r\n                        }\r\n                        remainingSum += version2Part;\r\n                    }\r\n                    return remainingSum > 0;\r\n                }\r\n            },\r\n            _setUILocale: function (UILocale) { _UILocale = UILocale; }\r\n        };\r\n    })();\r\n}","module OfficeExt {\r\n    export interface ShortcutKeyPlatformAvailability {\r\n        \"web\"?: string;\r\n        \"default\"?: string;\r\n    }\r\n    export interface ExtendedManifestShortcut {\r\n        action: string;\r\n        key: ShortcutKeyPlatformAvailability;\r\n    }\r\n    export interface ExtendedManifestAction {\r\n        id: string;\r\n        type?: string;\r\n        name: string;\r\n    }\r\n    export interface ExtendedManifestResources {\r\n        [id: string]: {\r\n            value: string;\r\n            comment: string;\r\n        };\r\n    }\r\n    export interface ExtendedManifest {\r\n        shortcuts?: ExtendedManifestShortcut[];\r\n        actions?: ExtendedManifestAction[];\r\n        resources?: {\r\n            \"default\": ExtendedManifestResources;\r\n        };\r\n    }\r\n}","module OfficeExt {\r\n    export interface ExtendedManifestCacheEntry {\r\n        addinId: string;\r\n        extendedManifest: ExtendedManifest;\r\n    }\r\n}","module OfficeExt {\r\n    export interface ExtendedOverridesTokenOverride {\r\n        value: string;\r\n        data: any;\r\n    }\r\n    export interface ExtendedOverridesToken {\r\n        name: string;\r\n        defaultValue: string;\r\n        type: string;\r\n        overrides: ExtendedOverridesTokenOverride[];\r\n    }\r\n    export interface ExtendedOverridesComputedTokens {\r\n        [name: string]: string;\r\n    }\r\n}"]}