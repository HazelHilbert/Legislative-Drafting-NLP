{"version":3,"file":"conversionContext.js","sourceRoot":"","sources":["../src/conversionContext.ts"],"names":[],"mappings":"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","sourcesContent":["import { OSF } from '../lib/osfmos';\r\nimport { CommandSurfaceType } from './converter';\r\nimport * as MOS from './mosManifest';\r\n\r\nexport class ConversionContext {\r\n\r\n    private _formFactor: OSF.FormFactor;\r\n    private _hostType: OSF.ManifestHostType;\r\n    private _currentFunctionFileResid: string;\r\n    private _currentVersionOverrideNumber: OSF.VersionOverridesNumber;\r\n    private _currentVersionOverrideCapabilities: MOS.Capabilities[];\r\n    private _currentRibbonIndex: number = ConversionContext.UnsetIndex;\r\n    private _currentMenuIndex: number = ConversionContext.UnsetIndex;\r\n    private _currentTabIndex: number = ConversionContext.UnsetIndex;\r\n    private _currentGroupIndex: number = ConversionContext.UnsetIndex;\r\n    private _currentControlIndex: number = ConversionContext.UnsetIndex;\r\n\r\n    private _currentMenuItemIndex: number = ConversionContext.UnsetIndex;\r\n\r\n    private _currentIconIndex: number = ConversionContext.UnsetIndex;\r\n\r\n    // Context menu related localization file indexes\r\n    private _currentContextMenuIndex: number = ConversionContext.UnsetIndex;\r\n    private _currentContextMenuMenuIndex: number = ConversionContext.UnsetIndex;\r\n    private _currentContextMenuMenuButtonIndex: number = ConversionContext.UnsetIndex;\r\n    private _currentContextMenuMenuControlIndex: number = ConversionContext.UnsetIndex;\r\n    private _currentContextMenuMenuControlMenuItemIndex: number = ConversionContext.UnsetIndex;\r\n\r\n    private _currentCommandSurfaceType: CommandSurfaceType = CommandSurfaceType.None;\r\n\r\n    public static UnsetIndex: number = -1;\r\n\r\n    constructor() {\r\n        this._hostType = null;\r\n        this._formFactor = null;\r\n    }\r\n\r\n    getFormFactor(): OSF.FormFactor {\r\n        return this._formFactor;\r\n    }\r\n\r\n    setFormFactor(formFactor: OSF.FormFactor): void {\r\n        this._formFactor = formFactor;\r\n    }\r\n\r\n    getManifestHostType(): OSF.ManifestHostType {\r\n        return this._hostType;\r\n    }\r\n\r\n    setManifestHostType(hostType: OSF.ManifestHostType): void {\r\n        this._hostType = hostType;\r\n    }\r\n\r\n    getCurrentFunctionFileResid(): string {\r\n        return this._currentFunctionFileResid;\r\n    }\r\n\r\n    setCurrentFunctionFileResid(currentFunctionFileResid: string): void {\r\n        this._currentFunctionFileResid = currentFunctionFileResid;\r\n    }\r\n\r\n    getCurrentVersionOverrideCapabilities(): MOS.Capabilities[] {\r\n        return this._currentVersionOverrideCapabilities;\r\n    }\r\n\r\n    getCurrentVersionOverrideNumber(): OSF.VersionOverridesNumber {\r\n        return this._currentVersionOverrideNumber;\r\n    }\r\n\r\n    setCurrentVersionOverrideAndCapabilities(versionOverrideNumber: OSF.VersionOverridesNumber, versionOverrideCapabilities: MOS.Capabilities[]): void {\r\n        this._currentVersionOverrideNumber = versionOverrideNumber;\r\n        this._currentVersionOverrideCapabilities = versionOverrideCapabilities;\r\n    }\r\n\r\n    getCurrentRibbonIndex(): number {\r\n        return this._currentRibbonIndex;\r\n    }\r\n\r\n    setCurrentRibbonIndex(ribbonIndex: number) {\r\n        this._currentRibbonIndex = ribbonIndex;\r\n    }\r\n\r\n    getCurrentMenuIndex(): number {\r\n        return this._currentMenuIndex;\r\n    }\r\n\r\n    setCurrentMenuIndex(menuIndex: number) {\r\n        this._currentMenuIndex = menuIndex;\r\n    }\r\n\r\n    getCurrentTabIndex(): number {\r\n        return this._currentTabIndex;\r\n    }\r\n\r\n    setCurrentTabIndex(tabIndex: number) {\r\n        this._currentTabIndex = tabIndex;\r\n    }\r\n\r\n    getCurrentGroupIndex(): number {\r\n        return this._currentGroupIndex;\r\n    }\r\n\r\n    setCurrentGroupIndex(groupIndex: number) {\r\n        this._currentGroupIndex = groupIndex;\r\n    }\r\n\r\n    getCurrentControlIndex(): number {\r\n        return this._currentControlIndex;\r\n    }\r\n\r\n    setCurrentControlIndex(controlIndex: number) {\r\n        this._currentControlIndex = controlIndex;\r\n    }\r\n\r\n    getCurrentMenuItemIndex(): number {\r\n        return this._currentMenuItemIndex;\r\n    }\r\n\r\n    setCurrentMenuItemIndex(menuItemIndex: number) {\r\n        this._currentMenuItemIndex = menuItemIndex;\r\n    }\r\n\r\n    setCurrentCommandSurfaceType(commandSurfaceType: CommandSurfaceType) {\r\n        this._currentCommandSurfaceType = commandSurfaceType;\r\n    }\r\n\r\n    // Context menu related localization indexes\r\n    getCurrentContextMenuIndex(): number {\r\n        return this._currentContextMenuIndex;\r\n    }\r\n\r\n    setCurrentContextMenuIndex(contextMenuIndex: number) {\r\n        this._currentContextMenuIndex = contextMenuIndex;\r\n    }\r\n\r\n    getCurrentContextMenuMenuIndex(): number {\r\n        return this._currentContextMenuMenuIndex;\r\n    }\r\n\r\n    setCurrentContextMenuMenuIndex(contextMenuMenuIndex: number) {\r\n        this._currentContextMenuMenuIndex = contextMenuMenuIndex;\r\n    }\r\n\r\n    getCurrentContextMenuMenuButtonIndex(): number {\r\n        return this._currentContextMenuMenuButtonIndex;\r\n    }\r\n\r\n    setCurrentContextMenuMenuButtonIndex(contextMenuMenuButtonIndex: number) {\r\n        this._currentContextMenuMenuButtonIndex = contextMenuMenuButtonIndex;\r\n    }\r\n\r\n    getCurrentContextMenuMenuControlIndex(): number {\r\n        return this._currentContextMenuMenuControlIndex;\r\n    }\r\n\r\n    setCurrentContextMenuMenuControlIndex(contextMenuMenuControlIndex: number) {\r\n        this._currentContextMenuMenuControlIndex = contextMenuMenuControlIndex;\r\n    }\r\n\r\n    getCurrentContextMenuMenuControlMenuItemIndex(): number {\r\n        return this._currentContextMenuMenuControlMenuItemIndex;\r\n    }\r\n\r\n    setCurrentContextMenuMenuControlMenuItemIndex(contextMenuMenuControlMenuItemIndex: number) {\r\n        this._currentContextMenuMenuControlMenuItemIndex = contextMenuMenuControlMenuItemIndex;\r\n    }\r\n\r\n    getCurrentIconIndex(): number {\r\n        return this._currentIconIndex;\r\n    }\r\n\r\n    setCurrentIconIndex(iconIndex: number) {\r\n        this._currentIconIndex = iconIndex;\r\n    }\r\n\r\n    isInRibbon() {\r\n        return this._currentCommandSurfaceType == CommandSurfaceType.Ribbon;\r\n    }\r\n}"]}